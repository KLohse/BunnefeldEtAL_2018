(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    940224,      24118]
NotebookOptionsPosition[    871363,      22510]
NotebookOutlinePosition[    871977,      22534]
CellTagsIndexPosition[    871889,      22529]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["This is File S1 from Lohse et al. 2016", "Text",
 CellChangeTimes->{{3.732885956091267*^9, 
  3.7328859649105263`*^9}},ExpressionUUID->"f7a4efa7-ff31-4f88-a6b9-\
9d9bb1f99926"],

Cell[CellGroupData[{

Cell["Estimating divergence and gene flow", "Title",
 CellChangeTimes->{{3.603604952312727*^9, 3.6036049820167522`*^9}, {
   3.623488370120676*^9, 3.623488372919299*^9}, {3.6234885284003773`*^9, 
   3.6234885434557037`*^9}, {3.631599688911038*^9, 3.631599702639179*^9}, {
   3.631600095622492*^9, 3.631600109872755*^9}, {3.631600147182869*^9, 
   3.631600183623365*^9}, 
   3.648617593947657*^9},ExpressionUUID->"3a0687c2-ed86-4466-9947-\
9281ca3059ca"],

Cell[TextData[StyleBox["This file gives an overview of the methodology, and \
defines all necessary functions.  \[OpenCurlyDoubleQuote]Evaluate \
intialisation\[CloseCurlyDoubleQuote] to set up the functions.  Examples are \
given in separate notebooks.  There is also an index file that notes changes \
between versions, and changes that are still to be implemented.",
 FontSlant->"Italic"]], "Text",
 CellChangeTimes->{{3.65259427352314*^9, 3.652594375804229*^9}, {
  3.6526031148663692`*^9, 
  3.652603116113709*^9}},ExpressionUUID->"21f9aa25-4abe-43ca-88ba-\
f3d750f5cd6f"],

Cell[CellGroupData[{

Cell["Overview", "Subsection",
 CellChangeTimes->{{3.648619472801449*^9, 3.648619475377356*^9}, {
   3.6486206969823303`*^9, 3.64862069854235*^9}, 3.649067199866506*^9, 
   3.652593573102405*^9},ExpressionUUID->"a447e314-ab41-4d3e-b70c-\
48d5c5b7f011"],

Cell[CellGroupData[{

Cell["Generating functions for IM models", "Subsubsection",
 CellChangeTimes->{{3.648619491288269*^9, 
  3.648619496423718*^9}},ExpressionUUID->"64aeef17-fe0c-4aed-9ef8-\
ebccd2807961"],

Cell[TextData[{
 "We show how to derive the probability of mutational configurations, defined \
as counts of the various types of mutation in non-recombining blocks.  The \
general method is described by Lohse et al. (2011).  A wide variety of \
isolation-with-migration models can be fitted, including splits of ancestral \
populations into different demes, different population sizes between demes, \
steady migration between demes, admixture events, changes in population size \
through time, and bottlenecks.  A generating function (GF) is calculated for \
the model; this is a function of the model parameters, and of a set of dummy \
variables ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Omega]", "S"], TraditionalForm]],ExpressionUUID->
  "b73fdcab-1ad8-4084-9ccc-89cc23083fdf"],
 " that correspond to the lengths of all possible branches.  Differentiating \
wrt the ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Omega]", "S"], TraditionalForm]],ExpressionUUID->
  "e1f195e5-04fc-4184-9c7d-b8168bc3b075"],
 " gives the probability of each mutational configuration, and the \
probabilities of all configurations can be tabulated from the coefficients of \
a series expansion in the ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Omega]", "S"], TraditionalForm]],ExpressionUUID->
  "d3a78fa6-4400-46b7-8404-ef714b92cca2"],
 ".  The probability of observing various configurations across a large \
number of blocks is then found by multiplying across this table."
}], "Text",
 CellChangeTimes->{{3.631601522019054*^9, 3.63160192969578*^9}, {
   3.631602942318577*^9, 3.631602950415794*^9}, 3.634892946518256*^9, {
   3.6407876591562138`*^9, 3.640787660420361*^9}, {3.648619150325385*^9, 
   3.648619279705769*^9}, {3.648619355078156*^9, 3.648619459323292*^9}, {
   3.648620216662868*^9, 3.6486204303898897`*^9}, {3.652594402070085*^9, 
   3.652594444233171*^9}},ExpressionUUID->"e2e479dd-4549-49fe-8275-\
56c8a15f1c12"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Speeding up the calculations", "Subsubsection",
 CellChangeTimes->{{3.6486195609625397`*^9, 3.648619568665971*^9}, {
  3.653125486236116*^9, 
  3.653125486651985*^9}},ExpressionUUID->"844119fc-2f2a-4249-b396-\
1da2c6103043"],

Cell["\<\
A direct calculation of the table of probabilities is not feasible for more \
than two or three sampled genomes.  Here, we implement some computational \
tricks that make the calculations feasible for larger samples and more \
elaborate models.  Exact calculations are still only feasible for small \
samples (up to ~ 6 genomes, say); we do not consider here approximate methods \
that could be used with larger samples.\
\>", "Text",
 CellChangeTimes->{{3.648435140349572*^9, 3.6484353788445673`*^9}, {
  3.648435417874132*^9, 3.648435524402556*^9}, {3.648620627170137*^9, 
  3.648620651482544*^9}},ExpressionUUID->"9e41d31d-7ab5-4fbc-af86-\
368b9741598e"],

Cell["\<\
The general strategy is to initially automatically generate the GF of the \
rooted genealogies with unique labels for all individuals. We then make use \
of symmetries (i.e. where genes sampled from the same population are \
exchangeable) by conditioning on a single random labeling per equivalence \
class, noting that the full GF can be written as a sum of the GFs of such \
class representatives. To remove phase and outgroup information, we combine \
all branch variables that contribute to each of the site types.\
\>", "Text",
 CellChangeTimes->{{3.631601522019054*^9, 3.63160192969578*^9}, {
   3.631602942318577*^9, 3.631602950415794*^9}, 3.634892946518256*^9, {
   3.6407876591562138`*^9, 3.640787660420361*^9}, {3.648619150325385*^9, 
   3.648619177627041*^9}, {3.6486204673643513`*^9, 3.648620509278319*^9}, {
   3.648620576074177*^9, 3.648620618429861*^9}, 3.6509932589064837`*^9, {
   3.652594488333506*^9, 
   3.652594522115635*^9}},ExpressionUUID->"55f4cd3b-4ce7-417c-ae22-\
cc4823ca2d4c"],

Cell["\<\
Tricks include:
\t- separating the GF into a sum over the possible topologies
\t- separating topologies into classes that are equivalent, and only \
calculating one term in each class
\t- treating unrooted or unphased diploid data, and merging equivalent branches
\t- calculating the probabilities of mutational configurations using a series \
expansion of the GF
\t- tabulating numbers of mutations only up to some maximum number, and then \
finding the residual probability
\t- choosing an appropriate algorithm to maximise the likelihood, and using \
numerical rather than symbolic expressions
We emphasise that these computational tricks do not affect the probabilities, \
which are still calculated exactly.  \
\>", "Text",
 CellChangeTimes->{{3.648435532137195*^9, 3.648435564768014*^9}, {
  3.648435605021577*^9, 3.6484358915442667`*^9}, {3.64843602670229*^9, 
  3.648436077946838*^9}},ExpressionUUID->"f92675d8-e811-4724-94ba-\
e8d4b1c185d7"],

Cell["\<\
This notebook contains two sets of functions. The first set calculates a \
generating function under a wide variety of models; this is a function of a \
set of dummy variables, \[Omega][], which correspond to all the possible \
branch lengths in the genealogy.  The second set use this GF to compile a \
table of probabilities of the various mutational configurations.  The GF is \
also a function of the model parameters, but this does not affect the \
calculation of mutational configurations, which is independent of the \
evolutionary model.\
\>", "Text",
 CellChangeTimes->{{3.649129319681541*^9, 3.649129420952932*^9}, {
  3.649129607792952*^9, 
  3.649129748905961*^9}},ExpressionUUID->"97f46963-a78f-4d60-a391-\
3b067709095c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Extensions", "Subsubsection",
 CellChangeTimes->{{3.648624300435268*^9, 
  3.6486243019464693`*^9}},ExpressionUUID->"7042b99e-8114-4b47-b926-\
f5cdf2df9e63"],

Cell["\<\
We illustrate these methods using some simple models, elaborated in separate \
notebooks. However, the same code can be used for a wide variety of IM \
models, with arbitrary numbers of demes, varying population size, population \
splits, and so on.  The limiting factor is that numerical maximisation is \
slow with large numbers of parameters, and there will in any case be limited \
statistical power to estimate multiple parameters.\
\>", "Text",
 CellChangeTimes->{{3.648624559169705*^9, 3.64862458195492*^9}, {
  3.652594776870125*^9, 
  3.6525947896675377`*^9}},ExpressionUUID->"7334a2a7-c99b-4d09-83d7-\
0e37bc1e4caf"],

Cell["\<\
Lohse et al. (2011) show how the GF can be calculated for multiple loci; this \
is implemented in the Supplementary Notebook that accompanies that paper.  We \
have not included that case here, because the number of mutational \
configurations that must be tabulated is daunting, and because it is not \
clear how best to make inferences from data from linked loci.\
\>", "Text",
 CellChangeTimes->{{3.648624388653493*^9, 
  3.648624544233768*^9}},ExpressionUUID->"89f80040-ddcc-4cc9-b539-\
9e8c7602cbe1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Using ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " "
}], "Subsubsection",
 CellChangeTimes->{{3.6486209754976177`*^9, 
  3.648620982978167*^9}},ExpressionUUID->"ba2660ee-e049-4625-b9fa-\
cbc0be43d981"],

Cell[TextData[{
 "The notebook uses some compact ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " notation for applying rules to expressions (",
 StyleBox["expr",
  FontSlant->"Italic"],
 "/.",
 StyleBox["rules",
  FontSlant->"Italic"],
 "), for mapping functions onto lists of expressions ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"f", "/@", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["x", "1"], ",", "\[Ellipsis]"}], "}"}]}], ")"}], 
   TraditionalForm]],ExpressionUUID->"83254ba4-4f86-47bd-8d6e-d0423472f29d"],
 ", and for defining \[OpenCurlyDoubleQuote]pure functions ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"e", ".", "g", ".", " ", 
      RowBox[{"(", 
       SuperscriptBox["#", "2"], ")"}]}], "&"}], ")"}], TraditionalForm]],
  ExpressionUUID->"ca6fd561-c956-4c67-8869-0252f90d2107"],
 ".  Documentation can be found using ?",
 StyleBox["f; ",
  FontSlant->"Italic"],
 "there is a useful summary in ",
 ButtonBox["Tips.nb",
  BaseStyle->"Hyperlink",
  ButtonData->{
    FrontEnd`FileName[{
      ParentDirectory[
       ParentDirectory[]], "Teaching", "Mathematica tutorials"}, "Tips.nb", 
     CharacterEncoding -> "UTF-8"], None}],
 ". "
}], "Text",
 CellChangeTimes->{{3.648446623633012*^9, 3.648446762151266*^9}, {
   3.648458328983987*^9, 3.648458359734538*^9}, 
   3.648623934445451*^9},ExpressionUUID->"84f33182-6d41-4e98-b4eb-\
5db68bf49f1e"],

Cell[TextData[{
 "To set up the notebook, \[OpenCurlyDoubleQuote]Evaluate initialisation\
\[CloseCurlyDoubleQuote].  Variables and functions that have already been \
defined appear in black, whilst those not yet defined are in blue. To find \
information about a function ",
 StyleBox["f",
  FontSlant->"Italic"],
 ", type ?",
 StyleBox["f ",
  FontSlant->"Italic"],
 "and enter. "
}], "Text",
 CellChangeTimes->{{3.6348929658923283`*^9, 3.634892997547686*^9}, {
   3.634894207800303*^9, 3.63489427515018*^9}, 3.6407877167278967`*^9, 
   3.643521687076406*^9, {3.646479549634202*^9, 3.646479676690362*^9}, 
   3.6486132425362263`*^9, {3.6486238952635937`*^9, 
   3.648623919742113*^9}},ExpressionUUID->"3d69a7b8-f1c0-473d-92ff-\
98a0a3721787"],

Cell[TextData[{
 "Comments and explanations are hidden within subsections - double click cell \
brackets at right to open these.  To find information about a function, use ?",
 StyleBox["name",
  FontSlant->"Italic"],
 " and evaluate.  There are also notes and examples associated with each \
function definition in the following section."
}], "Text",
 CellChangeTimes->{{3.634895969682015*^9, 3.634895998089867*^9}, {
  3.64078777875527*^9, 3.640787781571271*^9}, {3.64078803653331*^9, 
  3.640788082782996*^9}, {3.648623814861347*^9, 
  3.648623847075623*^9}},ExpressionUUID->"fdc4232c-aa3e-42fe-9f00-\
f3a07cc5f15b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Definitions", "Section",
 CellChangeTimes->{{3.601670665829073*^9, 3.601670679484147*^9}, {
   3.601694550481846*^9, 3.601694553265922*^9}, 
   3.646480536949188*^9},ExpressionUUID->"326bfea6-c39b-4cee-9c1b-\
6358a0449362"],

Cell[CellGroupData[{

Cell["Elementary functions", "Subsection",
 CellChangeTimes->{{3.648379152195405*^9, 3.648379161585387*^9}, 
   3.649067196067739*^9, 
   3.652594900318328*^9},ExpressionUUID->"8ed832cc-ea33-4ff6-ac79-\
acf68ebdaf5d"],

Cell[CellGroupData[{

Cell["TakeAway", "Subsubsection",
 CellChangeTimes->{
  3.635415257246471*^9},ExpressionUUID->"074b4d2e-2d98-40d8-9198-\
6aa03a338e73"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TakeAway", "::", "usage"}], " ", "=", " ", 
   "\"\<TakeAway[U,V]  gives the set U, minus elements V. Note that this is \
not the same as Complement[U,V] if U contains repeated elements. \>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.635415134687251*^9, 
  3.635415142486827*^9}},ExpressionUUID->"502f5bef-fbcd-4889-a62e-\
50e95d3b2592"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TakeAway", "[", 
    RowBox[{"U_List", ",", " ", 
     RowBox[{"{", "}"}]}], "]"}], " ", ":=", " ", "U"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TakeAway", "[", 
    RowBox[{"U_List", ",", " ", 
     RowBox[{"{", "v_", "}"}]}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Drop", "[", 
     RowBox[{"U", ",", " ", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"U", ",", " ", "v"}], "]"}], ",", 
         RowBox[{"{", "_Integer", "}"}]}], "]"}], "\[LeftDoubleBracket]", "1",
        "\[RightDoubleBracket]"}]}], "]"}], " ", "/;", " ", 
    RowBox[{
     RowBox[{"Complement", "[", 
      RowBox[{
       RowBox[{"{", "v", "}"}], ",", " ", "U"}], "]"}], " ", "==", " ", 
     RowBox[{"{", "}"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TakeAway", "[", 
    RowBox[{"U_List", ",", " ", "V_List"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"TakeAway", "[", 
     RowBox[{
      RowBox[{"TakeAway", "[", 
       RowBox[{"U", ",", " ", 
        RowBox[{"Take", "[", 
         RowBox[{"V", ",", " ", "1"}], "]"}]}], "]"}], ",", " ", 
      RowBox[{"Drop", "[", 
       RowBox[{"V", ",", " ", "1"}], "]"}]}], "]"}], " ", "/;", " ", 
    RowBox[{
     RowBox[{"Complement", "[", 
      RowBox[{"V", ",", " ", "U"}], "]"}], " ", "==", " ", 
     RowBox[{"{", "}"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TakeAway", "[", 
    RowBox[{"U_List", ",", " ", "W__List", ",", " ", "V_List"}], "]"}], " ", ":=",
    " ", 
   RowBox[{"TakeAway", "[", 
    RowBox[{
     RowBox[{"TakeAway", "[", 
      RowBox[{"U", ",", " ", "W"}], "]"}], ",", " ", "V"}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.635415092660428*^9, {3.635423241447563*^9, 3.635423250510593*^9}, {
   3.635423284325955*^9, 
   3.6354232877005033`*^9}},ExpressionUUID->"6998dca8-c099-4bf9-bc74-\
2a6947d4de5d"],

Cell[TextData[StyleBox["Example:",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.6483791717763147`*^9, 
  3.648379173096691*^9}},ExpressionUUID->"587c77e1-2cbf-46cf-9b9a-\
9aa031a1cc22"],

Cell[TextData[{
 "This takes just one element ",
 Cell[BoxData[
  FormBox["c", TraditionalForm]],ExpressionUUID->
  "848b8159-8e19-4ece-a873-4f0c02602ec4"],
 " from the list:"
}], "Text",
 CellChangeTimes->{{3.6483792183962297`*^9, 
  3.648379247090029*^9}},ExpressionUUID->"3a14f1d0-3cd2-49b5-a003-\
4fe0b0078bd0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TakeAway", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"a", ",", "b", ",", "c", ",", "c", ",", "d"}], "}"}], ",", 
   RowBox[{"{", "c", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.648379177210347*^9, 
  3.6483792305407743`*^9}},ExpressionUUID->"37562080-7547-48c9-b2fc-\
e8a43a33af86"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}]], "Output",
 CellChangeTimes->{
  3.648379208612919*^9},ExpressionUUID->"bd7027e5-28b1-4ff7-9e0f-\
3652be669990"]
}, Closed]],

Cell[TextData[{
 "This takes away ",
 StyleBox["both",
  FontSlant->"Italic"],
 " elements, in effect wrapping Union[] around the arguments"
}], "Text",
 CellChangeTimes->{{3.648379249129736*^9, 
  3.6483792900945253`*^9}},ExpressionUUID->"a652f8f8-dee6-41f0-aedb-\
3a2f96bd2e91"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Complement", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"a", ",", "b", ",", "c", ",", "c", ",", "d"}], "}"}], ",", 
   RowBox[{"{", "c", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.648379177210347*^9, 
  3.648379215034762*^9}},ExpressionUUID->"b654a977-3a10-4176-bd8e-\
e34b254873cf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"a", ",", "b", ",", "d"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6483792156231956`*^9},ExpressionUUID->"67a55135-e5ba-401d-b188-\
fd8ab8ed0eaf"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["TopologyQ", "Subsubsection",
 CellChangeTimes->{{3.635398235752491*^9, 
  3.6353982380955*^9}},ExpressionUUID->"ecf1388c-e184-4237-8b47-f101b7f6678c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TopologyQ", "::", "usage"}], "=", 
   "\"\<TopologyQ[lineages,topology] tests whether a set of lineages is \
consistent with a given topology.  For example, {{a,b},{c},{d}} is consistent \
with {{{a,b},c},d}, but {{a,d},{b},{c}} is not.  This simply checks that each \
set of lineages is included in PossibleSets[tp]. TopologyQ[lineages,All] \
returns True.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.635399880189966*^9, 3.635400069664876*^9}, {
  3.6354005718421087`*^9, 3.635400605874658*^9}, {3.6354011700578833`*^9, 
  3.635401208178042*^9}, {3.635402611646208*^9, 3.635402618587385*^9}, {
  3.6354026623503933`*^9, 3.635402666646537*^9}, {3.6354028887576103`*^9, 
  3.635402936071601*^9}, {3.64870466056958*^9, 
  3.6487046732788553`*^9}},ExpressionUUID->"41c92cdf-6e5c-445d-9807-\
62ca0ce4c9b0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TopologyQ", "[", 
    RowBox[{"ln_List", ",", "All"}], "]"}], ":=", "True"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TopologyQ", "[", 
    RowBox[{"ln_List", ",", "tp_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ps", "=", 
       RowBox[{"PossibleSets", "[", "tp", "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"ps", ",", "#"}], "]"}], "&"}], "/@", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{"ln", ",", 
          RowBox[{"{", "_", "}"}]}], "]"}]}], ")"}]}]}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.635399880189966*^9, 3.635400069664876*^9}, {
  3.6354005718421087`*^9, 3.635400605874658*^9}, {3.6354011700578833`*^9, 
  3.6354012738377447`*^9}, {3.635402946916794*^9, 3.635402969201475*^9}, {
  3.635403186103554*^9, 3.635403204192589*^9}, {3.648704681155156*^9, 
  3.648704687119898*^9}},ExpressionUUID->"c87a5841-0c26-49c2-bb02-\
18a2abe09eb3"],

Cell[TextData[{
 StyleBox["Note: ",
  FontWeight->"Bold"],
 "There is s subtlety to the notation.  A set of lineages is a list of lists, \
where each element gives the ",
 StyleBox["set of genes",
  FontSlant->"Italic"],
 " to which the lineage is ancestral - here, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "c", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}]}], "}"}], TraditionalForm]],
  ExpressionUUID->"be006c9e-ea51-480a-a75d-0412ce3f6c93"],
 ", for example; the first element, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"{", "c", "}"}], ","}], TraditionalForm]],ExpressionUUID->
  "e02bfb59-5d28-4e78-8978-5d68792003e0"],
 " represents a lineage ancestral to a single gene, ",
 Cell[BoxData[
  FormBox["c", TraditionalForm]],ExpressionUUID->
  "216c4ad2-1255-4db6-b96b-aefb45d4fd87"],
 ", for example.  In contrast, a topology is a grouping of ",
 StyleBox["genes",
  FontSlant->"Italic"],
 " - for example, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}], ",", "c"}], "}"}], TraditionalForm]],
  ExpressionUUID->"677b9994-7e47-4a50-83e6-4e00395ee373"],
 ", with ",
 Cell[BoxData[
  FormBox["c", TraditionalForm]],ExpressionUUID->
  "b8c76bf1-cd4a-44a4-a124-def38758e5dd"],
 " appearing, ",
 StyleBox["not ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   RowBox[{"{", "c", "}"}], TraditionalForm]],ExpressionUUID->
  "7d9e0a75-52a4-4262-bde0-4d148f4fb389"]
}], "Text",
 CellChangeTimes->{{3.6483785014158278`*^9, 3.6483785708826637`*^9}, {
  3.648378609384694*^9, 3.648378734150469*^9}, {3.6483787651253843`*^9, 
  3.648378849835339*^9}},ExpressionUUID->"df85d171-d1ae-46f0-aaa2-\
970f3127f93b"]
}, Closed]],

Cell[CellGroupData[{

Cell["PossibleSets", "Subsubsection",
 CellChangeTimes->{{3.635402397107658*^9, 
  3.635402400556016*^9}},ExpressionUUID->"923f18b6-adf4-4479-82ea-\
2b45611314da"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PossibleSets", "::", "usage"}], "=", 
   "\"\<PossibleSets[topology] stores the possible sets of lineages that are \
consistent with the given topology.  The topology is represented as a nested \
list.   With n leaves, and a bifurcating tree, there are n-2 possible sets \
(not counting single leaves).  Leaves must not themselves be lists.\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.635402405165969*^9, 3.635402469849811*^9}, {
   3.635402544830288*^9, 3.635402560158761*^9}, {3.6354026697938843`*^9, 
   3.635402774470647*^9}, {3.635402831242029*^9, 3.635402833793144*^9}, {
   3.6354028654030743`*^9, 3.63540287285155*^9}, 
   3.6354271315880623`*^9},ExpressionUUID->"b3d499eb-1346-4fab-90ae-\
8156850352ae"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PossibleSets", "[", "tp_List", "]"}], ":=", 
   RowBox[{
    RowBox[{"PossibleSets", "[", "tp", "]"}], "=", 
    RowBox[{"Sort", "[", 
     RowBox[{"Append", "[", 
      RowBox[{
       RowBox[{"Sort", "/@", 
        RowBox[{"(", 
         RowBox[{"Flatten", "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Extract", "[", 
              RowBox[{"tp", ",", 
               RowBox[{"Drop", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"-", "1"}]}], "]"}]}], "]"}], "&"}], "/@", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"tp", ",", "List"}], "]"}], ",", 
              RowBox[{"{", "0", "}"}]}], "]"}]}], ")"}]}], ")"}]}], ",", 
       RowBox[{"Sort", "[", 
        RowBox[{"Flatten", "[", "tp", "]"}], "]"}]}], "]"}], "]"}]}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.635402405165969*^9, 3.635402469849811*^9}, {
  3.635402544830288*^9, 3.635402560158761*^9}, {3.6354026697938843`*^9, 
  3.6354028102795877`*^9}, {3.635427176479856*^9, 
  3.635427193989367*^9}},ExpressionUUID->"80b21b43-8228-4d24-bec9-\
9a3bfae9bb0e"],

Cell[TextData[{
 StyleBox["Example: ",
  FontWeight->"Bold"],
 "Only these three lineages are consistent with this topology - others, such \
as ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{"b", ",", "c"}], "}"}], TraditionalForm]],ExpressionUUID->
  "86680a0d-d2d1-470b-b33c-d648fe0d57b7"],
 ", are not.  Note that ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", "e", "}"}], TraditionalForm]],ExpressionUUID->
  "16108216-b7fa-46a1-967a-cad38ef28c4f"],
 " is ",
 StyleBox["not",
  FontSlant->"Italic"],
 " included."
}], "Text",
 CellChangeTimes->{{3.648379529354115*^9, 
  3.648379582502389*^9}},ExpressionUUID->"a2848378-2cc3-4c95-a80a-\
d94ac41701be"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PossibleSets", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c", ",", "d"}], "}"}], ",", "e"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.648379380401804*^9, 3.648379386360121*^9}, {
  3.648379424693874*^9, 
  3.648379426045465*^9}},ExpressionUUID->"d9aabede-a630-4c5a-9ba4-\
48d90338685e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"a", ",", "b"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", "d"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "e"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.648379386654624*^9, 
  3.648379427075062*^9},ExpressionUUID->"1ff5fac7-0fc4-4bf1-8bda-\
49260330ba51"]
}, Closed]],

Cell[TextData[{
 "If one writes ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", "e", "}"}], TraditionalForm]],ExpressionUUID->
  "16187f8c-4b9e-4001-9930-37f9678467e0"],
 " as a list (i.e. a lineage ancestral to ",
 Cell[BoxData[
  FormBox["e", TraditionalForm]],ExpressionUUID->
  "f48c2a83-bed9-4bf4-8d0b-16cfbe43d93f"],
 ").  then ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", "e", "}"}], TraditionalForm]],ExpressionUUID->
  "e19e32c0-9ace-43e1-9b9d-e9571e5e943e"],
 " is included."
}], "Text",
 CellChangeTimes->{{3.648379587917509*^9, 3.648379602820932*^9}, {
  3.648379788847403*^9, 
  3.648379805180389*^9}},ExpressionUUID->"c15a53fc-d624-46fc-b365-\
9710fdc88426"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PossibleSets", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c", ",", "d"}], "}"}], ",", 
    RowBox[{"{", "e", "}"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.648379380401804*^9, 3.648379386360121*^9}, {
  3.648379424693874*^9, 3.648379426045465*^9}, {3.6483794566214113`*^9, 
  3.648379459522036*^9}},ExpressionUUID->"439becb0-9149-4161-b28c-\
8a1cd9900b16"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "e", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "b"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", "d"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "e"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.648379459778854*^9},ExpressionUUID->"26de7c2c-8991-4471-804f-\
0d970d128db7"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["NumberInClass", "Subsubsection",
 CellChangeTimes->{{3.635430615781393*^9, 
  3.635430619621765*^9}},ExpressionUUID->"eb08f095-d55d-4382-8ee9-\
013088866cfe"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NumberInClass", "::", "usage"}], "=", 
   "\"\<NumberInClass[{a,a,b,c,c}] gives the number of topologies in each of \
the classes defined by Topologies[{a,a,b,c,c}].  This works by simple \
enumeration, and so may be slow for large sets.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.635430622547295*^9, 3.635430707867975*^9}, {
  3.635430813459064*^9, 
  3.635430813747366*^9}},ExpressionUUID->"a294714f-e9ca-4cbe-8457-\
0cb4912f94a7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NumberInClass", "::", "badMatch"}], "=", 
   "\"\<The order of the topologies is `1`, which does not match \
Topologies[`2`]\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.635432182794982*^9, 
  3.6354322199960318`*^9}},ExpressionUUID->"965b652a-2ba6-4687-bd9e-\
d2d385e3897c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NumberInClass", "[", "s_List", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "ds", ",", 
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "s", "]"}]}], ",", "res"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ds", "=", 
       RowBox[{"Array", "[", 
        RowBox[{"a", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"Tally", "[", 
         RowBox[{"FullSort", "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Topologies", "[", "ds", "]"}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"a", "[", "j_", "]"}], "\[RuleDelayed]", 
              RowBox[{
              "s", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}], 
             "}"}]}], ")"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{
          RowBox[{
          "res", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          "\[Equal]", 
          RowBox[{"Topologies", "[", "s", "]"}]}], "]"}], ",", 
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"NumberInClass", "::", "badMatch"}], ",", 
          RowBox[{
          "res", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
          "s"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
      "res", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.635430442767926*^9, 3.635430490167961*^9}, {
  3.635430525474424*^9, 3.635430548249612*^9}, {3.635430817982793*^9, 
  3.635430917524417*^9}, {3.635432232589527*^9, 3.635432423254033*^9}, {
  3.635433978183531*^9, 
  3.635433983272138*^9}},ExpressionUUID->"801b0ad3-4e9c-4033-a962-\
91cea8bf0198"],

Cell[TextData[{
 StyleBox["Example",
  FontWeight->"Bold"],
 ": There are 35 classes of topology connecting ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{"a", ",", "a", ",", "b", ",", "c", ",", "c"}], "}"}], 
   TraditionalForm]],ExpressionUUID->"90decb46-c52c-4b51-9dbc-39e8effcf591"],
 ", and a total of 105 possible topologies in all:"
}], "Text",
 CellChangeTimes->{{3.648379842857263*^9, 3.648379844297029*^9}, {
  3.6483799490171423`*^9, 3.648379994427697*^9}, {3.648385750588764*^9, 
  3.6483857749339333`*^9}},ExpressionUUID->"f99fb33b-7e8c-4f92-946c-\
d5522321e7cc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Transpose", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Topologies", "[", 
     RowBox[{"{", 
      RowBox[{"a", ",", "a", ",", "b", ",", "c", ",", "c"}], "}"}], "]"}], 
    ",", 
    RowBox[{"NumberInClass", "[", 
     RowBox[{"{", 
      RowBox[{"a", ",", "a", ",", "b", ",", "c", ",", "c"}], "}"}], "]"}]}], 
   "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.6483798564667263`*^9, 
  3.648379889607298*^9}},ExpressionUUID->"ee2d2288-886a-43ca-a533-\
4ef068b68613"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", 
           RowBox[{"{", 
            RowBox[{"c", ",", "c"}], "}"}]}], "}"}]}], "}"}]}], "}"}], ",", 
     "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", 
         RowBox[{"{", 
          RowBox[{"c", ",", 
           RowBox[{"{", 
            RowBox[{"b", ",", "c"}], "}"}]}], "}"}]}], "}"}]}], "}"}], ",", 
     "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", 
           RowBox[{"{", 
            RowBox[{"c", ",", "c"}], "}"}]}], "}"}]}], "}"}]}], "}"}], ",", 
     "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", 
         RowBox[{"{", 
          RowBox[{"c", ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "c"}], "}"}]}], "}"}]}], "}"}]}], "}"}], ",", 
     "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", 
           RowBox[{"{", 
            RowBox[{"b", ",", "c"}], "}"}]}], "}"}]}], "}"}]}], "}"}], ",", 
     "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "c"}], "}"}]}], "}"}]}], "}"}]}], "}"}], ",", 
     "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", 
         RowBox[{"{", 
          RowBox[{"c", ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "b"}], "}"}]}], "}"}]}], "}"}]}], "}"}], ",", 
     "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"c", ",", "c"}], "}"}]}], "}"}]}], "}"}], ",", "2"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "c"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "c"}], "}"}]}], "}"}]}], "}"}], ",", "4"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b", ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", 
           RowBox[{"{", 
            RowBox[{"c", ",", "c"}], "}"}]}], "}"}]}], "}"}]}], "}"}], ",", 
     "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b", ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", 
         RowBox[{"{", 
          RowBox[{"c", ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "c"}], "}"}]}], "}"}]}], "}"}]}], "}"}], ",", 
     "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b", ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "c"}], "}"}]}], "}"}]}], "}"}]}], "}"}], ",", 
     "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b", ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", 
         RowBox[{"{", 
          RowBox[{"c", ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "a"}], "}"}]}], "}"}]}], "}"}]}], "}"}], ",", 
     "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "a"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"c", ",", "c"}], "}"}]}], "}"}]}], "}"}], ",", "1"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "c"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "c"}], "}"}]}], "}"}]}], "}"}], ",", "2"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c", ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", 
           RowBox[{"{", 
            RowBox[{"b", ",", "c"}], "}"}]}], "}"}]}], "}"}]}], "}"}], ",", 
     "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c", ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "c"}], "}"}]}], "}"}]}], "}"}]}], "}"}], ",", 
     "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c", ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", 
         RowBox[{"{", 
          RowBox[{"c", ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "b"}], "}"}]}], "}"}]}], "}"}]}], "}"}], ",", 
     "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c", ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "c"}], "}"}]}], "}"}]}], "}"}]}], "}"}], ",", 
     "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c", ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", 
         RowBox[{"{", 
          RowBox[{"c", ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "a"}], "}"}]}], "}"}]}], "}"}]}], "}"}], ",", 
     "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c", ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "b"}], "}"}]}], "}"}]}], "}"}]}], "}"}], ",", 
     "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c", ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "a"}], "}"}]}], "}"}]}], "}"}]}], "}"}], ",", 
     "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "a"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "c"}], "}"}]}], "}"}]}], "}"}], ",", "2"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "c"}], "}"}]}], "}"}]}], "}"}], ",", "4"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "a"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", 
         RowBox[{"{", 
          RowBox[{"c", ",", "c"}], "}"}]}], "}"}]}], "}"}], ",", "1"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "a"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "c"}], "}"}]}], "}"}]}], "}"}], ",", "2"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", 
         RowBox[{"{", 
          RowBox[{"c", ",", "c"}], "}"}]}], "}"}]}], "}"}], ",", "2"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "c"}], "}"}]}], "}"}]}], "}"}], ",", "4"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "c"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "c"}], "}"}]}], "}"}]}], "}"}], ",", "4"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "c"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "c"}], "}"}]}], "}"}]}], "}"}], ",", "4"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "c"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}]}], "}"}]}], "}"}], ",", "4"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", "c"}], "}"}]}], "}"}], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "c"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", "c"}], "}"}]}], "}"}], ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"b", ",", "c"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "a"}], "}"}]}], "}"}]}], "}"}], ",", "2"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"b", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "a"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", "c"}], "}"}]}], "}"}], ",", "1"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.648379849481998*^9, 
  3.648379889966628*^9}},ExpressionUUID->"808d5727-1310-4a6c-b08a-\
9b7e0618fe40"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{"NumberInClass", "[", 
     RowBox[{"{", 
      RowBox[{"a", ",", "a", ",", "b", ",", "c", ",", "c"}], "}"}], "]"}], 
    "]"}], ",", 
   RowBox[{"Total", "[", 
    RowBox[{"NumberInClass", "[", 
     RowBox[{"{", 
      RowBox[{"a", ",", "a", ",", "b", ",", "c", ",", "c"}], "}"}], "]"}], 
    "]"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.648379915568795*^9, 
  3.648379945336842*^9}},ExpressionUUID->"95395ca8-ebc8-4af6-81f3-\
ba9dbe9988a8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"35", ",", "105"}], "}"}]], "Output",
 CellChangeTimes->{{3.64837991795042*^9, 
  3.648379946021072*^9}},ExpressionUUID->"38d39f74-bae8-4c7f-a0d0-\
974161180059"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Topologies", "Subsubsection",
 CellChangeTimes->{{3.635412878019844*^9, 
  3.635412881058634*^9}},ExpressionUUID->"e8a2aed4-3551-4cdc-b019-\
c58dbe5c9a43"],

Cell[TextData[{
 "Given a set of genes, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "a", ",", "a", ",", "b", ",", "c", ",", "c", ",", "\[Ellipsis]"}], "}"}],
     ","}], TraditionalForm]],ExpressionUUID->
  "a89e090b-be06-4d18-9f9a-e476504be609"],
 " some of which are equivalent, I would like to find all distinct \
bifurcating topologies that connect them.  I do this by working back, \
coalescence by coalescence, until there is just one pair remaining."
}], "Text",
 CellChangeTimes->{{3.635412883834505*^9, 3.635412999082615*^9}, {
  3.635415517819189*^9, 3.635415518315497*^9}, {3.648380017483759*^9, 
  3.648380017793998*^9}, {3.648385620103608*^9, 
  3.648385620567734*^9}},ExpressionUUID->"422b373e-fa98-424a-9c33-\
49082341091a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Topologies", "::", "usage"}], "=", 
   "\"\<Topologies[{a,b,c,d}] lists all the distinct topologies, represented \
as nested lists\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6354155209047813`*^9, 
  3.6354155607992907`*^9}},ExpressionUUID->"99c083bd-9def-42f4-b5fc-\
34b0707238e4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Topologies", "[", "x_List", "]"}], ":=", 
   RowBox[{"First", "/@", 
    RowBox[{"NestWhile", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Union", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Coalesce", "/@", "#"}], ",", "1"}], "]"}], "]"}], "&"}], 
      ",", 
      RowBox[{"{", "x", "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Union", "[", 
         RowBox[{"Length", "/@", "#"}], "]"}], "\[NotEqual]", 
        RowBox[{"{", "1", "}"}]}], "&"}]}], "]"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6354155644410257`*^9, 3.635415583329145*^9}, {
  3.6354163188821907`*^9, 
  3.63541632334894*^9}},ExpressionUUID->"d1677830-95b5-4070-97dc-\
a3507b4d2055"],

Cell[TextData[{
 StyleBox["Example: ",
  FontWeight->"Bold"],
 " There are only 3 kinds of topology that can connect 5 equivalent genes"
}], "Text",
 CellChangeTimes->{{3.6483855393753*^9, 3.648385546005373*^9}, {
  3.648385588555849*^9, 
  3.648385615744213*^9}},ExpressionUUID->"2b034d71-7500-4399-860e-\
2ac7fff16624"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Topologies", "[", 
  RowBox[{"{", 
   RowBox[{"a", ",", "a", ",", "a", ",", "a", ",", "a"}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.648385562562654*^9, 
  3.6483855653597307`*^9}},ExpressionUUID->"f8485a2b-6eaa-4784-b595-\
241b3bfcdabe"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"a", ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "a"}], "}"}]}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "a"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "a"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "a"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "a"}], "}"}]}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.64838556747213*^9},ExpressionUUID->"e2bfb1fc-dfbd-4ff9-b986-8f1ab0e0062e"]
}, Closed]],

Cell[TextData[{
 "There are 35 classes of topology that can connect genes ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{"a", ",", "a", ",", "b", ",", "c", ",", "c"}], "}"}], 
   TraditionalForm]],ExpressionUUID->"a861382d-6209-4ead-8495-230bf9fa5043"],
 ":"
}], "Text",
 CellChangeTimes->{{3.648385789106874*^9, 
  3.6483858212064753`*^9}},ExpressionUUID->"f688d631-7a75-439f-a0c1-\
58e4788f353c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Topologies", "[", 
  RowBox[{"{", 
   RowBox[{"a", ",", "a", ",", "b", ",", "c", ",", "c"}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.648385514111842*^9, 
  3.648385522097041*^9}},ExpressionUUID->"1c3143ed-b2f1-4189-9f4b-\
61abbef148ac"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"a", ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", 
         RowBox[{"{", 
          RowBox[{"c", ",", "c"}], "}"}]}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "c"}], "}"}]}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", 
         RowBox[{"{", 
          RowBox[{"c", ",", "c"}], "}"}]}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "c"}], "}"}]}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "c"}], "}"}]}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "c"}], "}"}]}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}]}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", "c"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "c"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", "c"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"b", ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", 
         RowBox[{"{", 
          RowBox[{"c", ",", "c"}], "}"}]}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"b", ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "c"}], "}"}]}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"b", ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "c"}], "}"}]}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"b", ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "a"}], "}"}]}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"b", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "a"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", "c"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"b", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "c"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "c"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "c"}], "}"}]}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "c"}], "}"}]}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}]}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "c"}], "}"}]}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "a"}], "}"}]}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}]}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "a"}], "}"}]}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "a"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", "c"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "c"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "a"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", "c"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "a"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", "c"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", "c"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "c"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "c"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", "c"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "c"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "c"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "c"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", "c"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "c"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "c"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b", ",", "c"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "a"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b", ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "a"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", "c"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6483855224756947`*^9},ExpressionUUID->"02402006-efdb-4bcc-8da4-\
511a7134be00"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Topologies", "[", 
   RowBox[{"{", 
    RowBox[{"a", ",", "a", ",", "b", ",", "c", ",", "c"}], "}"}], "]"}], "//",
   "Length"}]], "Input",
 CellChangeTimes->{{3.648385533201118*^9, 
  3.6483855343767138`*^9}},ExpressionUUID->"ff1ae728-8759-426a-bf1a-\
cb52871b41bf"],

Cell[BoxData["35"], "Output",
 CellChangeTimes->{
  3.648385535386878*^9},ExpressionUUID->"13598d37-71a5-4acf-9ab3-\
495a8001ba1c"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Checking Topologies[]", "Subsubsection",
 CellChangeTimes->{{3.635423543555541*^9, 
  3.6354235476280537`*^9}},ExpressionUUID->"c5d572ea-26e2-4968-9059-\
e5753eb37c9c"],

Cell[TextData[{
 "This table gives the number of classes of topology that connect ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "3b9604f9-be05-4718-ad62-a58355018bcc"],
 " distinct genes; ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "e426a7db-d4d0-40aa-9495-1bbc3b9696a6"],
 " genes divided evenly into two classes (e.g. two demes); and ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "89744720-12db-4f8a-aca0-b99449a39f9b"],
 " equivalent genes: "
}], "Text",
 CellChangeTimes->{{3.635419344306099*^9, 3.635419347809807*^9}, {
  3.6354234362864647`*^9, 3.63542353864427*^9}, {3.64838597722007*^9, 
  3.648385980105413*^9}, {3.648386141397861*^9, 
  3.648386211951383*^9}},ExpressionUUID->"e91de41e-f259-40f9-843e-\
1cf593a852e5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Prepend", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"Length", "[", 
         RowBox[{"Topologies", "[", 
          RowBox[{"Array", "[", 
           RowBox[{
            RowBox[{
             SubscriptBox["a", "#"], "&"}], ",", "j"}], "]"}], "]"}], "]"}], 
        ",", 
        RowBox[{"Length", "[", 
         RowBox[{"Topologies", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"ConstantArray", "[", 
             RowBox[{
              SubscriptBox["a", "1"], ",", 
              RowBox[{"Quotient", "[", 
               RowBox[{"j", ",", "2"}], "]"}]}], "]"}], ",", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{
              SubscriptBox["a", "2"], ",", 
              RowBox[{"j", "-", 
               RowBox[{"Quotient", "[", 
                RowBox[{"j", ",", "2"}], "]"}]}]}], "]"}]}], "]"}], "]"}], 
         "]"}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"Topologies", "[", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"a", ",", "j"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "2", ",", "8"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "\"\<n\>\"", ",", "\"\<unranked\>\"", ",", "\"\<EC 2 pops\>\"", ",", 
      "\"\<EC 1 pop\>\""}], "}"}]}], "]"}], "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.635413004711526*^9, 3.635413054257152*^9}, {
  3.635413165704029*^9, 3.6354131670790367`*^9}, {3.635414040211862*^9, 
  3.635414041458109*^9}, {3.635414757617115*^9, 3.6354147585157948`*^9}, {
  3.63541543975776*^9, 3.6354154406636457`*^9}, {3.635415601254883*^9, 
  3.635415627476869*^9}, {3.6354156631087112`*^9, 3.6354156732788982`*^9}, {
  3.63541633107458*^9, 3.635416417975109*^9}, {3.635416470955229*^9, 
  3.6354164816980667`*^9}, {3.635418414221887*^9, 3.635418429374042*^9}, {
  3.635419118631534*^9, 3.635419332331726*^9}, {3.648386062278162*^9, 
  3.648386067683971*^9}},ExpressionUUID->"6571711a-6152-4135-8583-\
777311ae919b"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"n\"\>", "\<\"unranked\"\>", "\<\"EC 2 pops\"\>", "\<\"EC 1 pop\"\>"},
    {"2", "1", "1", "1"},
    {"3", "3", "2", "1"},
    {"4", "15", "6", "2"},
    {"5", "105", "15", "3"},
    {"6", "945", "49", "6"},
    {"7", "10395", "155", "11"},
    {"8", "135135", "560", "23"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.635415607770631*^9, 3.63541562811982*^9}, {
   3.6354156677413883`*^9, 3.635415673646297*^9}, {3.635416327330633*^9, 
   3.6354163399566717`*^9}, 3.635416418748438*^9, {3.6354164721963673`*^9, 
   3.635416493330533*^9}, 3.6354191805305853`*^9, 3.63541931258001*^9, 
   3.635419380716414*^9, 3.6354233650220118`*^9, 3.64768810857603*^9, 
   3.648386081034157*^9},ExpressionUUID->"128fcc25-d233-40fa-afa4-\
bcaacbd5da67"]
}, Closed]],

Cell[TextData[{
 "The calculation is done by using ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "2c874052-af58-42b9-8dc5-02cd955f66d7"],
 " distinct genes; ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "0c24a49d-b993-4f08-8454-c1e0253f4a97"],
 " genes divided equally into two types; and ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "dff762f7-6311-4643-8330-3b2eb224511e"],
 " equivalent genes:"
}], "Text",
 CellChangeTimes->{{3.6483860775209217`*^9, 3.648386127078227*^9}, {
  3.648386157974084*^9, 
  3.648386171674485*^9}},ExpressionUUID->"dc836fb1-2f75-491e-9a73-\
1c98cf3e86da"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["a", "#"], "&"}], ",", "5"}], "]"}], ",", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"ConstantArray", "[", 
      RowBox[{
       SubscriptBox["a", "1"], ",", 
       RowBox[{"Quotient", "[", 
        RowBox[{"5", ",", "2"}], "]"}]}], "]"}], ",", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{
       SubscriptBox["a", "2"], ",", 
       RowBox[{"5", "-", 
        RowBox[{"Quotient", "[", 
         RowBox[{"5", ",", "2"}], "]"}]}]}], "]"}]}], "]"}], ",", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"a", ",", "5"}], "]"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.648385998047673*^9, 
  3.648386056260489*^9}},ExpressionUUID->"31afedfd-e921-47ec-8c36-\
b833531a6d16"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["a", "1"], ",", 
     SubscriptBox["a", "2"], ",", 
     SubscriptBox["a", "3"], ",", 
     SubscriptBox["a", "4"], ",", 
     SubscriptBox["a", "5"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["a", "1"], ",", 
     SubscriptBox["a", "1"], ",", 
     SubscriptBox["a", "2"], ",", 
     SubscriptBox["a", "2"], ",", 
     SubscriptBox["a", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "a", ",", "a", ",", "a", ",", "a"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.648386020378886*^9, 3.6483860448094673`*^9}, 
   3.648386130124015*^9},ExpressionUUID->"3b044db7-ed1c-49c9-9a25-\
ae4d86804035"]
}, Closed]],

Cell["This is the table from the paper:", "Text",
 CellChangeTimes->{{3.648386217029827*^9, 
  3.648386221606104*^9}},ExpressionUUID->"4da63e05-fe7f-412c-99c0-\
671bc4c70270"],

Cell[BoxData[
 GraphicsBox[
  TagBox[RasterBox[CompressedData["
1:eJzsvQ1MW8e6NrruXbJ0EQgZKQqyJciNLUEUX4s0lgzhWiatZLKba7KrLyap
gFSNSb9iopOa7t3C1yamSRC7O1bSWMluZZrIaYvTnYNTFTcnkDaQNtCbQk6C
b3dBbEjb2KfNnz9T2JB8OMSLu2bNWv5dPzY/CaTzqKpi1lrz88477zwz8847
q42v/bf//r9jGPan/4P833/bWf/s66/v/B9bxeSP8j1/Mr2655Vdz+/58yuv
vvJ6kREn//h//28Y9pD8B/j37GIg6O11Htl/evDRoqT+NIAY+8cX9ndt3Xee
dEEQEBAQEBYPRNDX67QeOj10/0mXZJniaRLgfV/vaev+vw89YW70NIkUYV4I
dpoyMX5kamxDbJ9O33DWamRgopFp6gwmPicCg1+caDZv08gNdu/DeRd0xN1Y
rtAduzGvVH7zON/ZqcnFOSsrM3WOzbeoEfh7mrYqJWncMlzimBkbPH+y+bVy
zTq9feRJFyYpELfPVsszxCXWgWmC4w1fe7UCF2+yDkw83qLB3P0DjtfLtMUq
suPgq0oPXZl8AoVIDWC6evIv5nKNXN/iXYD0Ht5ur5Hj2SXWq9MLkFoiZsYG
TpnLNmpUskwsTVp6qG8ytCj5LDgSDOZCS37RsLCmnjMXsu807Hjri9scPTsW
EwM247bGc95gUm8LIIlhEtvwimVXiSwTX+hBZHHweJosJYT+6VwyAiTGrjnM
L2g168ny4FL9ob7UyhO60bpLI8/k5EaPC0tJpAhPHMCMZT3f/N09yiaOdZpk
wHBpbBSpJoLes7XKbB6mCq0gm0aHJj1njx19Qy8VYZjOdmMeGg+M/GtaaVpU
weYFYsiqZiH2RHD0ZLk0b6E7RfCGTbf02D4xPfDpR1eFmOakx3XscL1+9dIr
fzQmBk58enWG/hEa/WCTGMfzXu+aCHO82MqGhuybJBi+ztzlf+xFfXjbtVOa
vsM1HiIClxq1OdItH44udSr6m8f1wdF6vXSBet/s7PSofYsYS88zf7kY0y3i
9pkq6apK161Z4m5P43NZ0m0nRxdnVrHASDSYCy75RcLCmXoegNZ8YVPjpUAK
5H1qtPWVkh0fj86f8INxTlra3ANzZ7g/U9ngj+2163HQRnAAXVhmlZytjiDG
HnLgsTTZXLAYAkwdhNdVJU+vdI3PzgR69muzZFtODqdsp7m50ePF0hApwpPH
zC2HYbX54gP6ZxzbJxG8ad8iq7/MZTyENHrIpsmcrz2ZHP72e38IUvQFGfVu
2DTsy/gTvfWbfg9snwhcqFOuTa6mS7H8UZgJdL2hFPNZ1FQqu9gYseuyloD9
Tx2wyyxpzgnx0GvfjC/joS3BYC4byS+EqefE1KCtLKfUNpgqbyduddQWFVp6
5ruDdsuhX13X/YDOPZ7tk/nctJfK6ntnFp5ZpWi+hO1hFBa1yeaGpUFNvXYd
Pm87jdg+wtLCo0D3hy39YTVIZPuzIe8Xh7jd8h8H24dYwFGPk+0vBpYeWw4O
t1atTZoRLb3yR0AERz+ukqfzWdTUKrvIWCr2P3UsG8653Ic2xPZZEBqxlYgU
5u65tCn4Nk1d3xOYVwkCl4619IWnDIlsfzb0k/vQmaFHC61+qZmvJOxhDBDb
Z8fC2OmlYu2XhEgRlh5Y2D4Aca/PXltSsLGi5mW9Iluq29vhozWY1uid77ka
yxXAPQzPVLx4uPcuswSTaE+mbrTvLVOrNygkOJ6rNZ9JdpuVfdQLTfY1a8Ui
8aYPUvCIYGX7IY+1tL77YdDX/b5Zl8s43IUmPW3Npo2SsANe0Nfn+sBi1Mkz
S4/2XTxcXgDMPr6qtOnryBYzKa5jLyklcpVmvVz+XMXmvGi2TASu2E26Au32
GuNmhXi1ruGcD5Sc9pA3qORa2zVv51/KFVkgYeAxGAjeaG80UBlhK9W7z3pD
/JK87+v7zA6KKNUcvdR7+EWqXdKofeiZ2dCwY0eJAhwlSJMoijSacmv/JFgR
6msxlai0FbuMeqVYuqmh4yYjzuTZPpnI34zqPLmqWFO8TllS89e/vlJY1uKd
FRLpLJeCEUHfdy5Qk/xMzZG+3iOMTDY39QAFC406dmjIypN/kiiKNZrnrf0z
lFjc+w2KLUDl2CtLUPIs1EVqxK2TwWFndZFCt8NUs10jTUuCdIWFsEEly8qU
lzW0j1BVnOy3lmuKo0qrKTW5eH2xgyPt9X+QywsUkvRM+R/q2oajBg2OAiej
nNyV5dBMCom9Dyh5tVqWrwKurVly/d72G1NRpSdzeUsnz19P5pKZX1oX283j
z+Dw2ISpUeerBYrSnaZXKsBxGz5mMtNvfV5TFNXcGq3JdZuvUUgF6zl1sFon
V5rav6VoVbrcdI6bF7IVhvZ/Nqgkf7ANDnc2b2e626G+yUlKFYHSYuINu9t/
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
KlxW9ubxLt+4h8koXW54u6V75CZzRxVppczkC34uSf5GfZlJFX5nU9v1W54z
FgNwPMBE6yqtX/lCsyHvpztAmelbNojApUYt7PIbTfZvf774OpC1+LnGb/q7
jjcYFJlU7SoPtHT7OIVMBEfPmGGse9LgVBxwdzbHshRukY79Lw4Fe+d81+mD
letEsN2b2jy3rrdZDFTjkRp1uAtcExP0tlVTm4yrSpu6vQNnbQeg0CIqF1NZ
73+6bBZKOJEacevkiF2/VibJVuhfBpcWyQurncNCCxrwipNckURRXLxOoa5q
7vwJbkL4uk8cNEK3alJz3rFFdJgFIe+ZXcosLA6MozhngSc9QsrJ/S2fZtr3
GqhUSf05cKIb3s5D3dqjlWZKFEXFSqW68t1OL7PwFfrRtQte4xIN6Pb5m8d1
/ABsUyY1bvmTFM4gk0nEis1GcKHV2oLqVh5qFPJ1txzcSTnVA80/aDvLdG2O
RpkccFpgEGzqfT715i5M5IIhcqr75+PdP1Mdl6ogvsaw78PumyPMCyKJ7rXj
3T/6OczpN54LsQZzxNvNJnkWcCkqp+kGeZlLwQ13eJ7+zQ+6fXcYo0HafsO+
lu6bN7voFzBy1vl+t+82DBi4/rliuXy9plghzdlUT19SlqKp97boZaslYqXe
WFNToZUXvOoc5T98DRdjmZsOIG63GsQ5ZY7RsDaAoy75z+hfqSrf7YxREhCu
XwqCnIMf9wdtz4vn44EMhsnXy1XQkzldpnvFAoZJKu2IJogk2pojXaQmnN5H
N5/S0NTBa2o4EWerqapyd70Ye/h1gOBVgIQmY6+vkEmhbnaD/X0lOPXTf0Qr
UW81vWP/4tr/l+qgFqKuPqwolODU0dFitXrTv9n77kVamVWAqXXkWT4Zko3Y
st8IPdUB2Tju8vyWOs2AmLrhPlChkuKZMpVGU6wq2lTb0gdbkKPAnAPx+Qv/
LtwK4UvxyCZ9purYldjrz1LXSa5+SrN9LCbMGgICwu8WC3jO4neHmbEBe9XG
1zv8E77+i50QbucH+wz5ZdGnTZcoiLGr9qqy3R2/TvuuXqBL3+784G1D/rbE
E5QIywQpHmdeYIDLfXIZR4tUMPWDtXRF5AowBASEhcCU25gb9qNDQED4HQOx
/bmCuH2mSiqOOFSE/37v9Esvz8cD4bGA8Lqq5DGugMzfnS/tcfkfsX+FsNTx
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
u0zw+yUSiO0jLBP8fjvpogGxfQQEhKWA4M2LDSAeiUiz96KP2/lwYTAzNvBh
jVoa5ZWepSh7vYVxNV+SuO+7uFcDBFTScJEzstxCgRi72lJTLIkICM9UbKlr
ucLixLvM8FjFuIRABAbbLaVZZIvmVbakeukzAsLjxO+1ky4i5iNSIujraNBk
kaOkpqGDN8ocAgICAj+Cvu5TUZfxfcAe5GehQYwNXersvNC/DG7+C/m6P4wS
0LHIAb3FBBEYunSh88LVp8bCPxkxPnk8mf6FgDAH/F476SJiXiKNuyr3GGso
QgQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQE
BAQEBASEeeK+r/e0df/fhxYqUvvvAkhoCAhLB0TQ1+u0Hjo9tNgRsRCeesyM
DZ6zv/N+d2CpGXc06CAgpAqyO58/2fxauWad3j6S+ucPb7fXyPHsEuvVaeGX
Hx9m+ixrRGpLXyoH1m+07tLIwYXZSzw4MBEY/OJEs3mbRm6wex8+2bIsEaER
Y9cc5he0mvWyTByX6g/1Ld1gwsTts9XyDHGJdWB6McPjLAElAVfV175QathZ
U6GR4mlS7Rvt3iXRrx5TE7Dn7R9wvF6mLVbJxBi+qvTQlQWOUhL6p3NXCdkL
Fi6k9tSN9r16uZgOb2vY774xtRDJLiyW8Cg26WlrftOok+NM/Ftz098cDpvF
pFeAZsLwgsY+dj18MGjdGPnqyFe+xxxAZeKbprJ1VPBeoZsdFtzaEL72agUu
3mQdmEh8uEQGnfnC31aZBSMjJ95+iICwCJj0uI4drtevJnuOxjaU1CfT1058
dI25amh61L5FjKXnmb9k6ZaPH8Gfu09/4RmbIUZtWnxDk+c+Eeg//eGFG5yB
B4npgU8/usoMuQt8FcjEwIlPryZ/KVOMYLkQmvScPXb0Db1UtFSu13ni96dQ
N+qmV7rGwaW3+7VZsi0nhxd5YIxVGwHEqEFo9INNYhzPe71rYvHK+OSVhPCf
q82Tldl/oPIOel0mpbjA1HH78ZeEwuNvAlZQVxun73CNh4jApUZtjnTLh6ML
UoQY07GAF+hMjdi3ZmUq9caamsrn5JCdPgG5CWHJj2LEkFUNeN0qo/se87d7
buMqiuytMXXeY/nmwUVzrgiL/+oxI5l73BbB2oSG7JskGL7O3OVn/rSoI/Uc
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
XriJmspjLZPuIAmpQnGJMiWFVdZPOzpdVqDb4QKnYsQSFOaW4wVRpJuwlYPy
TBHLS2sOfex2n9inzyO1lTkQzSPniFsLLs7X1fy11f2ZY98WGZgy0kc1l80o
xgoutm/7nrLtpMz09pthtbjXaVLm1X8zzfJVDIixoUtn6jVkWbLzNeV7T/Xe
nPCerSWLisuKddvqHD2+af/AsW1STJRrvkgVjqcJKExftZZIpeUnKfoHjW24
p/BrDr+1+cVVuYocFAxOH/UTevqlM2P9LLUbuLbM8SM14f+pve5ZKcg33Jqp
jtQJ4DEpwnormJrwIMUGagN0ZW3nfQLsN7W9uaWs8pUy/Svtvnkt9QtXh6sd
7w+7bXsNa0jBi1avf6H2LZMmGxO/6IxfPUNY0kjRTk701hdgWJ6p0x95mTlI
kjhehTxNBRE7SS1K4NG9GPgfknNvUYltBPwJ2oRCSz9cybjvadqAYSv1jp/A
L2Dc0oCVgykPHi6t60rphD8R6Dn2+r6WvnuE32nIIO3n/UDfh3W7bb0BVo3l
sCHpLzrvwfen+i2qSPGmv7UU5IR9VqltOAxbscs9znZmLV5S432WIhwDB4eZ
N6ABzCqh9srjX5+5XL9KxJgC+FS0KjL3ESRyvHLmY/uR5zR3IhG61lSQHhU6
gJhyV2eEbTV8O22r41fYVjN+96uAveXWdT8geIUG86UlwAEBubHUhg2p1ShF
tj/TW78Kw1eaOu5HnhbU906wF47Ommk7IJ8MjKaLFGCsBtEm2whVNjjiKxv7
4cABPxe94Lg1w99VhZVk4rwpJ52hAcwEEy9uGpgSKhW0GOlKyxWYNDQCIr3j
1ix71vFiAI4KEQ92WivyLf2PWN+OEziL2ixmE/BXlqppXkMvZAUhj7W0vpvL
ZiVM6YWsZTIdhIvtS8ud3uhORxc4JSMWB2oaxZSNFdSpQyyn0sUoApQtJjO6
7wjJOTTu2kG2SpQbM+z7+Apj+/gyGsVYwcn2h6huSPL1jALLt7QxIucmGZRM
hNh+pDL0ulC4MBlq6/c0aZxyG8kWgGIXaILpEdsmUfS8g/jeqs6ge4qA5vBb
m9C4e9cKcpQwOOGEKzRoLYysWpBN3W5c/TI9PY/UQojtc43UXFLiNCm8eiuc
mvAgxYL7HaaVOCWQqdHWPdveueS/dbZano7r7F6uT5KFYDfkbEdYM94+jrCk
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
RCvNlCiKipVKdeW7nV4qMtWkp+1gpRK8vVJtbG7z/ORpa6QCSpNZV1m7vCFv
i162WiJW6o01NRVaecGrTvrS9vuDtufFi+DGH/J+ugMUANw+843nAn0HB5aj
NR3tApeA7KMlo9jW1Aku66FuvNpIhQLGcElhZXMHt7td0NtWTTkjRW79oD8X
SRTFRUpFccznMYK9S9DDDfk7V2tq6fv5vDkvHRxkaLzk93Ud31uuAGLMVFY2
tnR74y2loJzhLWbwUhLxBpPjSv/RP0hUL5AK8cXg7fBFNris7M3jXb7xcGrp
csPbLd0jN5kXyMHQTL4QmrrhPlChkuKZMhW4SKloU21LX9SaLbvQJgecFhiZ
n9TJnQeB4nE2E6fcQt7ulv1GeMpDXGQ8eNzl+S2xIVKv0Sx1ZRK8mWglODrR
f0QrUW81vWOn7mWOVhuyU9CmHrTdRpP9258vvk6NmM9Rceyj1aDbO3DWdgBm
Hd128IqrXFC/4nUKdVVz509URwpRLUn1L7J2TW2eW9fbLAY5Dj8/3OWb4uqq
QJn5lYSWTfgKHvLFZ6qOXYlawuUq1W+U+DJhwzW1Xb/lOWOhojQDI2D9yjcR
Fi+Z9cE2zx1fonhDP7p2QfFGI9zBufXzu4utbGqzaE0gVNnQiF2/VibJVuhf
BjRYXljtZD3HSirhiYNG6NtP9sp3bC4Pbco4rWXSHSTadHzT30XfDSeSaGuO
dP087jm9z0BVV6Q0NHWQiSRtxBi5JSDC1uJBhwxd/1yxXL5eU6yQ5myqj7m8
iUvOVH4U00hbv3GjPF+lKVJI5br66CuKlskoFieSSY/r8L4aHRQknqnYYm76
m8Nh27dTC5ogU1lm/msbtFrkFHj9VnqfCNzxt3enBl4MgYtV29488lWiAkTu
jcLz9G9+AC6uotUVw+WGfS3dN28yL2C5OvP7VNX4mgDeu6SXwzMoq3T1+00q
mcpgtjp7fUGCS3NCgkNSGMTPzm26qOnweJ9Fvy2ylcBIzGaBtWBaM+WROjFj
7iGPtHmCehuHFAf3eNxxG+XiTR+M0gUd6zu0RandbiyvbOj4L/obMKHIYmLA
UvdwMUcAqBkTE1qWHQLV4WjH3zzOxkpVeDBlOgICAgICAsKcQIxdtVeV7e74
ddp39UInRLvzg7cN+dtiTrohLDMk5XrEBeRFgPCEMC+9XRTccugjlB5sTDA+
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
n5NMvf57TSonXqz3miVeVHa8lGOliabapz15SIX/6adI+S9H5EfVkyd6QhQI
SozUPnG/qz6bu0rNFHXT0VL7cQZ9aywGb663YQvz4aN+XQkXw3DxG112v86Y
En6YpKGXVaY5p4f6rk/OUKIRmuGag27arJXjYsOWg9SHxGy/roCLY3h2fdd9
36l5wjFyqkKQmN5wMUDBzdvM1VkVp0aYyfw5e9cbYnJIyFEY7qyvJoZG08kp
mi60KIikxZJbwdMxw04cy1B3Tka3gJHgHNTl4ivcfp+c16RxEivNUyv4G0uC
rOrpHIxbZmDGVtQCDcZXmsZjXLC1TLyo7Hgpx0oTZbUf9f9A7a8RYqL2Z0Za
q4X4qjXTjaj23TiH9QUc8hBS+z9k+/qGvkASUoRAM1yjBFf7btDb55EyPVV9
lm28NzusL+GxnD1u2r1bP+w1NU38ZCjehMVIza4gMxZVEk9Ou5Ii+5ausrA1
ovBMdqozYvR85m2mPQkB7Zf47cGD6Hlezfc1ZWFcmX4w7ny56DV9j9qnX8Rm
hfF2jAu2lmFUdvWfzc0VIuTLhyeLXjrW+4B6+4/Hez9HLqN8dfvg51XCRAwX
qzvuUb5kdQWSwr21LytEKQL52x3jDjSlMP5Ps6FJJc9Kln5o7f2wQsRDTqaC
ndqeB566RJ0rE2ZlS5/LSN4kqviwl562YspxwGT9WCXmUe6p6cXaH+zMmTOj
7W+X5uRsF/FxPE2m+WbEU+FnRkyvSkTF1epX9krT8ChrA/Kmej5FjpFidful
1qqtOJZIL6UR9ssGtVwi21Or2iniPiNvPDPupJ6Y9TR6BkKB9PiF3mMvUY80
QVDc0sPMznl3wY7x7r+ppZsw8o5q39WbB6aD3Olqq/0PGr+j3iO/9rOeEzU5
/ARUK4SlhzvuuFfRyNs/ocrPED6HvBmTtygaT3s5f7LIjJDHU66kDc8LhRIR
PzFZ+Hx9201v19QA9+PglcFx01STJ5LvU1NejtH1RXeOd/1FU8x398LTA20t
r8r4HKYvYMJm5cLk4uPW88cqJMk+dThYRZqzW0+qC7Jlew+oFGKuoKSRfshh
rrbEiuS6FfJH/1IlTsvI3p4t3CrfW5IRkdqfHTEekIqQkz/OF+VLZS/orHPM
1f6qyskUklfL4JH1pLF9mHp9c5ODZ6i2IK5tPXNCtZ0KD+AKFU2UuWAIWTEC
1X6w33IRqiLNjFreVYrKvK4W7BERjpHWGsk2eXVt7V6pYEWm11jVvnPK8tqL
TLTLTF9TNjKDm+s6H7N2xY4xU/OxvungPxGB2qcCtNEr4r/S2kM+WNr3Z4vi
MG3NaJb1foHFE0TtT7XXvHiSjsmnRBpJprqT3b+RGPvy9WPWgLn9x7+MTvi+
G1pEZTf1zQRcY1ntl5j8j7CdyArgenTssIv2YLcw16d7QZonQiVP4IvypFKp
TG2+x/arlBgoEjJXkFQcu+iy0sHtWxgLP2ZWy7NRTCWenPGclAYFDvjVCrJz
PN0g3yp8bisf5wqL32gbCXyPoR7XiL4YZ3/7cYbzqlaSiHFKfMaqawjHzdYD
5cryvMzio1bbaGdLtUJZra4tz8lU+MjjlS4FpbLJTiW78rBOf/RIZQ4K+KGG
VPM3LR++rRSilb408a6D76llXCxVaRqZMO3luQbLxF1jaQLOq2yzoeXjH9r1
lank6UmbRaVvGS1n249XkafjubpBuoUjzzd5quxdSvo+vWssT8BwbslHI05X
OfBkfvZ+XduZzvY/KQUcDC/UDT4hj7zXXpspoZez7T0NOaRSymr44Ql1yfl+
7TZ8u3aACt+YvtAgzgmyur0k0CNoUJLDHCzpGXFZ3XuvSrkcrrL1HvGzqSIN
S6qxzBCuG0mvNP9KWuSh7m/1lZnknSRxxaVHPrF0mo9XktIuOVc3QD0D7y6Y
FBWfV0meb/a8bvY77Vldta+W/u9MOCA3S177p1bLaSPtJ+wKlSVsZ+oyeZl1
Z2yUUaSWg3FusX6QEUv+MiPM8cg7UcKRNFtnCeedU2U8VzRiiqbbcbu93s/9
OERlmOnX5uMSLfWgndM9h8XPRNsd0X8FymvmZ/pmd/ufK1NJ8Z/IFe06Yvx7
Z/uHlWiATNXhIBVpYqK1gocnqSzI2hK3jKUpGG+/2TYf5mpLrUjUmbQPgLDC
OER5BCDPnMijdAOW4OZsHa9lciR1HROE52r8Yv2Aw2VZSPNB9kO1Rz+3WD45
osgk7YE7VDZcRfJT+8F/iy5L8Ip0fvR0vSyN+tt9teCPaP6KdtsmifYq1WDJ
r/KeYXGKWCZsat8xbKqSuOr5sEGOJj0SlKalxquEV/ueV4TzhPLao61/txjf
ory+Uwp0V6hudVnvF1gSrGr/8R3Ty6lMI6XdS8jKscdkW2YOu9tGxWYsrb77
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
    "], {{0, 315}, {1018, 0}}, {0, 255},
    ColorFunction->RGBColor],
   BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
   Selectable->False],
  BaseStyle->"ImageGraphics",
  ImageSize->Automatic,
  ImageSizeRaw->{1018, 315},
  PlotRange->{{0, 1018}, {0, 315}}]], "Input",ExpressionUUID->"f266b7cc-3268-\
4bc1-af86-812b1a69594e"]
}, Closed]],

Cell[CellGroupData[{

Cell["FullSort", "Subsubsection",
 CellChangeTimes->{{3.635433883800494*^9, 
  3.635433885079672*^9}},ExpressionUUID->"8a6907f6-d834-4953-88e4-\
94f4c3d1ba3b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FullSort", "::", "usage"}], "=", 
   "\"\<FullSort[topology] sorts the topology into the standard order. (For \
obscure reasons, //.{{f_,g_}:>Sort[{f,g}] does not acheive this)\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.635433887310375*^9, 3.6354339548856373`*^9}, 
   3.648386235080338*^9},ExpressionUUID->"3a4ce4bd-b986-48d6-95c8-\
6f5beedd1e73"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FullSort", "[", "xx_List", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"j", ",", "yy"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"yy", "=", "xx"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"yy", "=", 
         RowBox[{"Replace", "[", 
          RowBox[{"yy", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"f_", ",", "g_"}], "}"}], ":>", 
             RowBox[{"Sort", "[", 
              RowBox[{"{", 
               RowBox[{"f", ",", "g"}], "}"}], "]"}]}], "}"}], ",", "j"}], 
          "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"Depth", "[", "xx", "]"}]}], "}"}]}], "]"}], ";", 
      RowBox[{"Sort", "[", "yy", "]"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.635433420569437*^9, 3.635433504016863*^9}, {
   3.635433544548807*^9, 3.635433730759738*^9}, 
   3.6354339608242893`*^9},ExpressionUUID->"11ef8699-b8c3-4cb3-a610-\
1d3b7475a33d"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Functions used to generate the equations for the GF", "Subsection",
 CellChangeTimes->{{3.648375522324498*^9, 3.648375524780567*^9}, {
   3.6483863585321817`*^9, 3.648386369690352*^9}, 3.649067193427823*^9, 
   3.652594901876499*^9},ExpressionUUID->"0f17e556-9c84-4b17-af83-\
cd41fc646a2e"],

Cell[CellGroupData[{

Cell["TotalRate", "Subsubsection",ExpressionUUID->"2581fa0b-9613-45d4-9c65-2c201e061751"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TotalRate", "::", "usage"}], "=", 
   "\"\<TotalRate[{{{a},{b},{c}},{{d},{e}},\[Ellipsis]},{{x},{y},\[Ellipsis]}]\
 gives the total rate of events for a given configuration of leaves. \
Coalescence\[Rule]\[Lambda] gives coalescence at rate \[Lambda][{x}] in deme \
{x}. Migration->M represents migrationat rate M[{x},{y}] from population {x} \
to {y}, forwards in time.   Splits\[Rule]\[CapitalLambda] represents \
splitting of a population {{x},{y}} into separate demes at rate \
\[CapitalLambda][{{x},{y}}]. Note that M=4Nm, whereas \[CapitalLambda]=2N\
\[Lambda]. Admixture->{{A,a},\[Ellipsis]} represents admixture events at rate \
A, and similarly for Bottlenecks\[Rule]{{B,b},\[Ellipsis]}, ChangeMigration\
\[Rule]{{dM,M},\[Ellipsis]} and ChangeCoalescence->{{d\[Lambda],\[Lambda]},\
\[Ellipsis]}. Throughout, both lineages and demes must be represented as \
lists, so that they can be merged. Deme labels {{x},{y}\[Ellipsis]} must not \
contain repeated elements. TotalRate[{{a},{b},{c}}] applies to a single \
population, and takes options Coalescence, ChangeCoalescence and Bottlenecks. \
Note:\!\(\*
StyleBox[\" \",
FontWeight->\"Plain\"]\) with a single deme, option arguments must be \
functions.  For example, Coalescence\[Rule]\[Lambda] will generate rates \
\[Lambda][] in a single deme, and \[Lambda][{x}] in deme {x}.\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.451816735029539*^9, 3.451816786916415*^9}, {
   3.497629761358994*^9, 3.497629763785015*^9}, {3.4976297953268433`*^9, 
   3.497629796177835*^9}, {3.4976312437584333`*^9, 3.497631251347822*^9}, {
   3.4976312951211357`*^9, 3.497631322550315*^9}, {3.497631467429196*^9, 
   3.4976314772511663`*^9}, {3.497631861636842*^9, 3.497631907905373*^9}, {
   3.497632272114015*^9, 3.497632276591793*^9}, {3.62218719285336*^9, 
   3.6221871971082478`*^9}, {3.635238352908266*^9, 3.635238371929744*^9}, {
   3.635239518112859*^9, 3.6352395348883743`*^9}, {3.63531288277566*^9, 
   3.635312885551495*^9}, {3.635405965943934*^9, 3.6354060797746077`*^9}, 
   3.648377962896132*^9, {3.6488145337237043`*^9, 3.648814646382881*^9}, {
   3.6488148550038958`*^9, 3.648814875146448*^9}, {3.648814976602009*^9, 
   3.64881500815162*^9}, {3.648815221139121*^9, 3.648815286604352*^9}, {
   3.648871775778758*^9, 3.6488717933842916`*^9}, {3.648871935867702*^9, 
   3.648871936716035*^9}, {3.648872344335485*^9, 3.648872417087748*^9}, {
   3.648880746778699*^9, 3.648880761951223*^9}, {3.648983045304351*^9, 
   3.648983089243732*^9}},ExpressionUUID->"67bd780e-f933-4ff4-98d0-\
612ce68cec0a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "TotalRate", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Coalescence", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"1", "&"}], ")"}]}], ",", 
     RowBox[{"Migration", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"0", "&"}], ")"}]}], ",", 
     RowBox[{"Splits", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"0", "&"}], ")"}]}], ",", 
     RowBox[{"Admixture", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"Bottlenecks", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"ChangeMigration", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"ChangeCoalescence", "\[Rule]", 
      RowBox[{"{", "}"}]}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4518159913405237`*^9, 3.4518160543109493`*^9}, {
   3.451816084824759*^9, 3.451816085343013*^9}, {3.451816198429022*^9, 
   3.451816209393592*^9}, {3.4518168024238453`*^9, 3.4518168307262173`*^9}, 
   3.451816862041689*^9, {3.451821840411628*^9, 3.451821875315342*^9}, {
   3.497627603748337*^9, 3.497627605314517*^9}, {3.497627666679673*^9, 
   3.497627679021369*^9}, {3.4976297537649307`*^9, 3.49762977502563*^9}, {
   3.497631373992587*^9, 3.497631378492118*^9}, {3.497631918209988*^9, 
   3.497631935311631*^9}, {3.497632280534531*^9, 3.49763228123324*^9}, {
   3.497632325816998*^9, 3.497632326052711*^9}, 3.4976337522143908`*^9, {
   3.5079752010503683`*^9, 3.5079752376266193`*^9}, {3.550477996920599*^9, 
   3.5504780075922728`*^9}, {3.550478086446879*^9, 3.550478143829822*^9}, {
   3.5504781863729763`*^9, 3.550478187404554*^9}, {3.635239834268675*^9, 
   3.635239836742868*^9}, {3.635239877861697*^9, 3.635239881724243*^9}, {
   3.6353126277849483`*^9, 3.635312628175696*^9}, {3.635313736095487*^9, 
   3.635313852854196*^9}, {3.635406095499138*^9, 3.635406123248563*^9}, {
   3.6354062328130093`*^9, 3.6354062586134987`*^9}, {3.6488146754511538`*^9, 
   3.648814699763324*^9}, {3.648814836085121*^9, 3.648814847830405*^9}, {
   3.648814881608336*^9, 3.648814963305421*^9}, {3.6488150161644583`*^9, 
   3.648815047201336*^9}, {3.648872333296805*^9, 3.648872341959145*^9}, {
   3.648882091493219*^9, 3.648882140116662*^9}, 
   3.6489831566925783`*^9},ExpressionUUID->"8d19bd57-053a-484e-a59d-\
7bd4bf5f9ef8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TotalRate", "[", 
    RowBox[{"xx_List", ",", "opts___Rule"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"nn", "=", 
        RowBox[{"Length", "[", "xx", "]"}]}], " ", 
       RowBox[{"(*", 
        RowBox[{"number", " ", "of", " ", "lineages"}], "*)"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]", "=", 
        RowBox[{
         RowBox[{"Coalescence", "/.", 
          RowBox[{"{", "opts", "}"}]}], "/.", 
         RowBox[{"Options", "[", "TotalRate", "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"d\[Lambda]\[Lambda]", "=", 
        RowBox[{
         RowBox[{"ChangeCoalescence", "/.", 
          RowBox[{"{", "opts", "}"}]}], "/.", 
         RowBox[{"Options", "[", "TotalRate", "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Bb", "=", 
        RowBox[{
         RowBox[{"Bottlenecks", "/.", 
          RowBox[{"{", "opts", "}"}]}], "/.", 
         RowBox[{"Options", "[", "TotalRate", "]"}]}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{"nn", 
         RowBox[{"(", 
          RowBox[{"nn", "-", "1"}], ")"}]}], "2"], 
       RowBox[{"\[Lambda]", "[", "]"}]}], "+", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"d\[Lambda]\[Lambda]", "\[Equal]", 
         RowBox[{"{", "}"}]}], ",", "0", ",", 
        RowBox[{
         RowBox[{"d\[Lambda]\[Lambda]", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "[", "]"}]}], 
       "]"}], "+", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Bb", "==", 
         RowBox[{"{", "}"}]}], ",", "0", ",", 
        RowBox[{
         RowBox[{"Bb", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "[", "]"}]}], 
       "]"}]}]}], 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"total", " ", "rate", " ", "of", " ", "coalescence"}], ",", " ", 
      RowBox[{
      "bottlenecks", " ", "and", " ", "changes", " ", "in", " ", 
       "coalescence", " ", "rate"}]}], " ", "*)"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4518159913405237`*^9, 3.4518160543109493`*^9}, {
   3.451816084824759*^9, 3.451816085343013*^9}, {3.451816198429022*^9, 
   3.451816209393592*^9}, {3.4518168024238453`*^9, 3.4518168307262173`*^9}, 
   3.451816862041689*^9, {3.451821840411628*^9, 3.451821875315342*^9}, {
   3.497627603748337*^9, 3.497627605314517*^9}, {3.497627666679673*^9, 
   3.497627679021369*^9}, {3.4976297537649307`*^9, 3.49762977502563*^9}, {
   3.497631373992587*^9, 3.497631378492118*^9}, {3.497631918209988*^9, 
   3.497631935311631*^9}, {3.497632280534531*^9, 3.49763228123324*^9}, {
   3.497632325816998*^9, 3.497632326052711*^9}, 3.4976337522143908`*^9, {
   3.5079752010503683`*^9, 3.5079752376266193`*^9}, {3.550477996920599*^9, 
   3.5504780075922728`*^9}, {3.550478086446879*^9, 3.550478143829822*^9}, {
   3.5504781863729763`*^9, 3.550478187404554*^9}, {3.635239834268675*^9, 
   3.635239836742868*^9}, {3.635239877861697*^9, 3.635239881724243*^9}, {
   3.6353126277849483`*^9, 3.635312628175696*^9}, {3.635313736095487*^9, 
   3.635313852854196*^9}, {3.635406095499138*^9, 3.635406123248563*^9}, {
   3.6354062328130093`*^9, 3.6354062586134987`*^9}, {3.6488146754511538`*^9, 
   3.64881468009098*^9}, {3.648871718573523*^9, 3.648871756963749*^9}, {
   3.648871805833426*^9, 3.6488718638748713`*^9}, {3.648880652113934*^9, 
   3.648880684518241*^9}, {3.648881112144669*^9, 3.648881117629635*^9}, {
   3.648983123895363*^9, 3.6489831317834578`*^9}, {3.648983166004671*^9, 
   3.648983188576106*^9}, {3.648983296428936*^9, 3.6489833134011602`*^9}, {
   3.6489835339448977`*^9, 
   3.648983609317795*^9}},ExpressionUUID->"cfc236ec-0504-41da-8cc1-\
aed15d039338"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TotalRate", "[", 
    RowBox[{"xx_List", ",", "dl_List", ",", "opts___Rule"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"nn", "=", 
        RowBox[{"Length", "/@", "xx"}]}], " ", 
       RowBox[{"(*", 
        RowBox[{
        "lists", " ", "number", " ", "of", " ", "lineages", " ", "within", 
         " ", "each", " ", "deme"}], "*)"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]", "=", 
        RowBox[{
         RowBox[{"Coalescence", "/.", 
          RowBox[{"{", "opts", "}"}]}], "/.", 
         RowBox[{"Options", "[", "TotalRate", "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"M", "=", 
        RowBox[{
         RowBox[{"Migration", "/.", 
          RowBox[{"{", "opts", "}"}]}], "/.", 
         RowBox[{"Options", "[", "TotalRate", "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[CapitalLambda]", "=", 
        RowBox[{
         RowBox[{"Splits", "/.", 
          RowBox[{"{", "opts", "}"}]}], "/.", 
         RowBox[{"Options", "[", "TotalRate", "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Aa", "=", 
        RowBox[{
         RowBox[{"Admixture", "/.", 
          RowBox[{"{", "opts", "}"}]}], "/.", 
         RowBox[{"Options", "[", "TotalRate", "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dmm", "=", 
        RowBox[{
         RowBox[{"ChangeMigration", "/.", 
          RowBox[{"{", "opts", "}"}]}], "/.", 
         RowBox[{"Options", "[", "TotalRate", "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"d\[Lambda]\[Lambda]", "=", 
        RowBox[{
         RowBox[{"ChangeCoalescence", "/.", 
          RowBox[{"{", "opts", "}"}]}], "/.", 
         RowBox[{"Options", "[", "TotalRate", "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Bb", "=", 
        RowBox[{
         RowBox[{"Bottlenecks", "/.", 
          RowBox[{"{", "opts", "}"}]}], "/.", 
         RowBox[{"Options", "[", "TotalRate", "]"}]}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Total", "[", 
       RowBox[{"\[CapitalLambda]", "/@", 
        RowBox[{"Subsets", "[", 
         RowBox[{"dl", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], 
      RowBox[{"(*", " ", 
       RowBox[{
       "rate", " ", "of", " ", "splits", " ", "between", " ", "each", " ", 
        "pair", " ", "of", " ", "demes"}], "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{"nn", 
          RowBox[{"(", 
           RowBox[{"nn", "-", "1"}], ")"}]}], "2"], ".", 
        RowBox[{"(", 
         RowBox[{"\[Lambda]", "/@", "dl"}], ")"}]}], ")"}], 
      RowBox[{"(*", 
       RowBox[{
       "total", " ", "rate", " ", "of", " ", "coalescence", " ", "within", 
        " ", "demes"}], "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Outer", "[", 
           RowBox[{"M", ",", "dl", ",", "dl", ",", "1"}], "]"}], ".", "nn"}], 
         "/.", 
         RowBox[{
          RowBox[{"M", "[", 
           RowBox[{"a_", ",", "a_"}], "]"}], "\[Rule]", "0"}]}], "]"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "sum", " ", "of", " ", "all", " ", "pairwise", " ", "migration", " ", 
         "rates"}], ",", " ", 
        RowBox[{
        "weighted", " ", "by", " ", "#", " ", "of", " ", "lineages", " ", 
         "in", " ", "the", " ", "deme", " ", "that", " ", "receives", " ", 
         "migrants"}]}], "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Bb", "\[Equal]", 
         RowBox[{"{", "}"}]}], ",", "0", ",", 
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{"Bb", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "/@", "dl"}], 
         "]"}]}], "]"}], " ", 
      RowBox[{"(*", " ", 
       RowBox[{"total", " ", "rate", " ", "of", " ", "bottlenecks"}], " ", 
       "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"d\[Lambda]\[Lambda]", "\[Equal]", 
         RowBox[{"{", "}"}]}], ",", "0", ",", 
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{"d\[Lambda]\[Lambda]", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "/@", "dl"}], 
         "]"}]}], "]"}], " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "total", " ", "rate", " ", "of", " ", "changes", " ", "in", " ", 
        "coalescence", " ", "rate"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"dmm", "\[Equal]", 
         RowBox[{"{", "}"}]}], ",", "0", ",", 
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Outer", "[", 
            RowBox[{
             RowBox[{"dmm", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", "dl", 
             ",", "dl", ",", "1"}], "]"}], "/.", 
           RowBox[{
            RowBox[{
             RowBox[{"dmm", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "[", 
             RowBox[{"a_", ",", "a_"}], "]"}], "\[Rule]", "0"}]}], ",", "2"}],
          "]"}]}], " ", "]"}], 
      RowBox[{"(*", " ", 
       RowBox[{
       "total", " ", "rate", " ", "of", " ", "changes", " ", "in", " ", 
        "migration", " ", "rate"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Aa", "\[Equal]", 
         RowBox[{"{", "}"}]}], ",", "0", ",", 
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Outer", "[", 
            RowBox[{
             RowBox[{"Aa", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", "dl", 
             ",", "dl", ",", "1"}], "]"}], "/.", 
           RowBox[{
            RowBox[{
             RowBox[{"Aa", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "[", 
             RowBox[{"a_", ",", "a_"}], "]"}], "\[Rule]", "0"}]}], ",", "2"}],
          "]"}]}], "]"}]}]}], " ", 
    RowBox[{"(*", " ", 
     RowBox[{"total", " ", "rate", " ", "of", " ", "admixture"}], " ", "*)"}],
     "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4518159913405237`*^9, 3.4518160543109493`*^9}, {
   3.451816084824759*^9, 3.451816085343013*^9}, {3.451816198429022*^9, 
   3.451816209393592*^9}, {3.4518168024238453`*^9, 3.4518168307262173`*^9}, 
   3.451816862041689*^9, {3.451821840411628*^9, 3.451821875315342*^9}, {
   3.497627603748337*^9, 3.497627605314517*^9}, {3.497627666679673*^9, 
   3.497627679021369*^9}, {3.4976297537649307`*^9, 3.49762977502563*^9}, {
   3.497631373992587*^9, 3.497631378492118*^9}, {3.497631918209988*^9, 
   3.497631935311631*^9}, {3.497632280534531*^9, 3.49763228123324*^9}, {
   3.497632325816998*^9, 3.497632326052711*^9}, 3.4976337522143908`*^9, {
   3.5079752010503683`*^9, 3.5079752376266193`*^9}, {3.550477996920599*^9, 
   3.5504780075922728`*^9}, {3.550478086446879*^9, 3.550478143829822*^9}, {
   3.5504781863729763`*^9, 3.550478187404554*^9}, {3.635239834268675*^9, 
   3.635239836742868*^9}, {3.635239877861697*^9, 3.635239881724243*^9}, {
   3.6353126277849483`*^9, 3.635312628175696*^9}, {3.635313736095487*^9, 
   3.635313852854196*^9}, 3.63540612548092*^9, {3.648813736326969*^9, 
   3.648813750426256*^9}, {3.648880767273836*^9, 3.6488807798705606`*^9}, {
   3.648881302405336*^9, 3.6488813588415203`*^9}, {3.6488813965735807`*^9, 
   3.6488814085790653`*^9}, {3.648881446807107*^9, 3.648881557396146*^9}, {
   3.648881646527388*^9, 3.648881771019841*^9}, 3.6488818276218023`*^9, {
   3.648882229751313*^9, 3.648882263374414*^9}, {3.6489831952191353`*^9, 
   3.648983263386076*^9}, {3.648984303931117*^9, 
   3.6489843192250023`*^9}},ExpressionUUID->"5a00e024-704f-4bbe-a4fd-\
bcbdfddb79c6"],

Cell[TextData[{
 StyleBox["Note: ",
  FontWeight->"Bold"],
 "Each ",
 Cell[BoxData[
  FormBox["M", TraditionalForm]],ExpressionUUID->
  "4c201591-80d3-45a1-a6c3-fc27208ce7ee"],
 " is weighted by the total number of lineages in the deme that ",
 StyleBox["receives",
  FontSlant->"Italic"],
 " migrants. Empty demes can ",
 StyleBox["contribute",
  FontSlant->"Italic"],
 " migrants: tracing back in time, lineages move out into that empty deme.  \
Bottlenecks, admixture, and changes in migration or coalescence rate are not \
weighted by the number of lineages."
}], "Text",
 CellChangeTimes->{{3.635312632460329*^9, 3.635312725379075*^9}, {
   3.6353129711649323`*^9, 3.635313047282246*^9}, 3.648375511133774*^9, {
   3.648375546187461*^9, 3.648375603030176*^9}, {3.6488817826713753`*^9, 
   3.648881814921812*^9}},ExpressionUUID->"6f7503e5-4993-4132-8be2-\
82e59462e2ce"],

Cell[TextData[{
 StyleBox["Example: ",
  FontWeight->"Bold"],
 "For a single deme, the default is a coalescence rate of \[Lambda]=1. With \
three lineages, the total rate is 3:"
}], "Text",
 CellChangeTimes->{{3.635313113470725*^9, 3.635313135808564*^9}, {
  3.648375606717548*^9, 3.648375608229952*^9}, {3.6483782154258347`*^9, 
  3.6483782893300467`*^9}, {3.648883194393914*^9, 3.64888320525548*^9}, {
  3.648883464407257*^9, 
  3.6488834764541063`*^9}},ExpressionUUID->"abe1135b-9aef-42e0-a5c1-\
dd5ab51c05d5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TotalRate", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", "a", "}"}], ",", 
    RowBox[{"{", "b", "}"}], ",", 
    RowBox[{"{", "c", "}"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.6488831181721973`*^9, 3.6488831182995853`*^9}, {
  3.648883318564322*^9, 
  3.648883322797155*^9}},ExpressionUUID->"ed4a3e72-dbb5-410e-ad7f-\
950ca7fd2ac3"],

Cell[BoxData["3"], "Output",
 CellChangeTimes->{3.648883118719936*^9, 
  3.648883323681561*^9},ExpressionUUID->"7cd490f3-c1a9-4902-a6db-\
ef23943e12bb"]
}, Open  ]],

Cell["\<\
The coalescence rate can be specified, as well as the rate of bottlenecks and \
of changes in coalescence rate.  Note that these are given as functions \
\[Lambda][] etc:\
\>", "Text",
 CellChangeTimes->{{3.6488832243344297`*^9, 3.6488832379883823`*^9}, {
  3.648883484637354*^9, 
  3.648883535696526*^9}},ExpressionUUID->"5f906413-2ac0-47f1-b65c-\
f4719431f5cc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TotalRate", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "a", "}"}], ",", 
     RowBox[{"{", "b", "}"}], ",", 
     RowBox[{"{", "c", "}"}]}], "}"}], ",", 
   RowBox[{"Coalescence", "\[Rule]", "\[Lambda]"}], ",", 
   RowBox[{"Bottlenecks", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["B", "1"], ",", 
        SubscriptBox["b", "1"]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["B", "2"], ",", 
        SubscriptBox["b", "2"]}], "}"}]}], "}"}]}], ",", 
   RowBox[{"ChangeCoalescence", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"d\[Lambda]", ",", "\[Lambda]"}], "}"}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6488831181721973`*^9, 3.648883161092469*^9}, 
   3.648883480317281*^9, {3.6489841773335323`*^9, 
   3.648984210832409*^9}},ExpressionUUID->"21c570a2-5c36-41fc-84f7-\
a393d69f78b7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"d\[Lambda]", "[", "]"}], "+", 
  RowBox[{"3", " ", 
   RowBox[{"\[Lambda]", "[", "]"}]}], "+", 
  RowBox[{
   SubscriptBox["B", "1"], "[", "]"}]}]], "Output",
 CellChangeTimes->{{3.648883142817683*^9, 3.648883161514488*^9}, 
   3.6488834810281553`*^9, {3.648984173156488*^9, 
   3.648984211553134*^9}},ExpressionUUID->"60890c30-50d8-4c87-92c5-\
e6a03d585a60"]
}, Open  ]],

Cell[TextData[{
 StyleBox["Example: ",
  FontWeight->"Bold"],
 "There are 3 demes, with 3, 2, 0 lineages respectively.  By default, the \
coalescence rate is 1 in all demes, and the total rate of coalescence is \
3+1=4:"
}], "Text",
 CellChangeTimes->{{3.635313113470725*^9, 3.635313135808564*^9}, {
  3.648375606717548*^9, 3.648375608229952*^9}, {3.6483782154258347`*^9, 
  3.6483782893300467`*^9}, {3.6488836026096888`*^9, 
  3.648883655820673*^9}},ExpressionUUID->"f327042f-69bf-40a4-9175-\
1f07054afe58"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TotalRate", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "a", "}"}], ",", 
       RowBox[{"{", "b", "}"}], ",", 
       RowBox[{"{", "c", "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "d", "}"}], ",", 
       RowBox[{"{", "e", "}"}]}], "}"}], ",", 
     RowBox[{"{", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "x", "}"}], ",", 
     RowBox[{"{", "y", "}"}], ",", 
     RowBox[{"{", "z", "}"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.648882164295373*^9, 3.64888216444665*^9}, {
  3.6488835459087677`*^9, 
  3.648883590475039*^9}},ExpressionUUID->"4e4c986b-f769-4d92-b18e-\
e166afd7f0fc"],

Cell[BoxData["4"], "Output",
 CellChangeTimes->{
  3.648882164863351*^9, {3.64888224093207*^9, 3.648882265642234*^9}, {
   3.648883585810589*^9, 
   3.6488835908275127`*^9}},ExpressionUUID->"15846b39-91c8-4dec-a64e-\
a9924b4e1ad8"]
}, Open  ]],

Cell[TextData[{
 StyleBox["Example: ",
  FontWeight->"Bold"],
 "There are three split rates, and 6 migration rates.  Demes ",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", ",", " ", "y", ",", " ", "z"}], TraditionalForm]],
  ExpressionUUID->"9b24f148-c056-4ff4-8706-b34789997483"],
 " have 3, 2, 0 lineages, respectively, and so the total rate of migration is \
weighted by the numbers in the ",
 StyleBox["receiving",
  FontSlant->"Italic"],
 " deme:"
}], "Text",
 CellChangeTimes->{{3.635313113470725*^9, 3.635313135808564*^9}, {
  3.648375606717548*^9, 3.648375608229952*^9}, {3.6483782154258347`*^9, 
  3.6483782893300467`*^9}, {3.6488836638680277`*^9, 3.64888369629713*^9}, {
  3.648883762780196*^9, 
  3.648883771641354*^9}},ExpressionUUID->"ab7c987f-55d7-4c5b-81a3-\
3966a9236f76"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TotalRate", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "a", "}"}], ",", 
       RowBox[{"{", "b", "}"}], ",", 
       RowBox[{"{", "c", "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "d", "}"}], ",", 
       RowBox[{"{", "e", "}"}]}], "}"}], ",", 
     RowBox[{"{", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "x", "}"}], ",", 
     RowBox[{"{", "y", "}"}], ",", 
     RowBox[{"{", "z", "}"}]}], "}"}], ",", 
   RowBox[{"Coalescence", "\[Rule]", "\[Lambda]"}], ",", 
   RowBox[{"Migration", "\[Rule]", "M"}], ",", 
   RowBox[{"Splits", "\[Rule]", "\[CapitalLambda]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.635313061544705*^9, 3.635313094159091*^9}, {
  3.648881970697094*^9, 3.648881973198722*^9}, {3.648882022712433*^9, 
  3.648882025838879*^9}, {3.648882215414015*^9, 3.6488822174376097`*^9}, {
  3.648882272805374*^9, 3.6488823389852*^9}, {3.648883709388687*^9, 
  3.648883718164032*^9}},ExpressionUUID->"47a3cba9-4a71-413f-818d-\
f01facde48a9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"M", "[", 
       RowBox[{
        RowBox[{"{", "x", "}"}], ",", 
        RowBox[{"{", "y", "}"}]}], "]"}]}], "+", 
     RowBox[{"3", " ", 
      RowBox[{"M", "[", 
       RowBox[{
        RowBox[{"{", "y", "}"}], ",", 
        RowBox[{"{", "x", "}"}]}], "]"}]}], "+", 
     RowBox[{"3", " ", 
      RowBox[{"M", "[", 
       RowBox[{
        RowBox[{"{", "z", "}"}], ",", 
        RowBox[{"{", "x", "}"}]}], "]"}]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"M", "[", 
       RowBox[{
        RowBox[{"{", "z", "}"}], ",", 
        RowBox[{"{", "y", "}"}]}], "]"}]}]}], ")"}]}], "+", 
  RowBox[{"3", " ", 
   RowBox[{"\[Lambda]", "[", 
    RowBox[{"{", "x", "}"}], "]"}]}], "+", 
  RowBox[{"\[Lambda]", "[", 
   RowBox[{"{", "y", "}"}], "]"}], "+", 
  RowBox[{"\[CapitalLambda]", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "x", "}"}], ",", 
     RowBox[{"{", "y", "}"}]}], "}"}], "]"}], "+", 
  RowBox[{"\[CapitalLambda]", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "x", "}"}], ",", 
     RowBox[{"{", "z", "}"}]}], "}"}], "]"}], "+", 
  RowBox[{"\[CapitalLambda]", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "y", "}"}], ",", 
     RowBox[{"{", "z", "}"}]}], "}"}], "]"}]}]], "Output",
 CellChangeTimes->{{3.6353130835889397`*^9, 3.6353130949263887`*^9}, 
   3.647688087357798*^9, 3.648881973650655*^9, 3.648882027396564*^9, 
   3.648882154305357*^9, 3.648882218371873*^9, {3.64888228153393*^9, 
   3.648882298036325*^9}, 3.6488823426635237`*^9, 
   3.648883719160013*^9},ExpressionUUID->"dea33539-a749-4dbf-be90-\
f51f674cb5dc"]
}, Open  ]],

Cell[TextData[{
 "Bottlenecks and changes in coalescence rate can be specified for each deme. \
 These are ",
 StyleBox["not",
  FontSlant->"Italic"],
 " weighted by he numbers of lineages:"
}], "Text",
 CellChangeTimes->{{3.6488838175747004`*^9, 
  3.648883852586637*^9}},ExpressionUUID->"d722d91d-e663-44d0-a7bd-\
782703758edc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TotalRate", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "a", "}"}], ",", 
       RowBox[{"{", "b", "}"}], ",", 
       RowBox[{"{", "c", "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "d", "}"}], ",", 
       RowBox[{"{", "e", "}"}]}], "}"}], ",", 
     RowBox[{"{", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "x", "}"}], ",", 
     RowBox[{"{", "y", "}"}], ",", 
     RowBox[{"{", "z", "}"}]}], "}"}], ",", 
   RowBox[{"Bottlenecks", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"B", ",", "b"}], "}"}], "}"}]}], ",", 
   RowBox[{"ChangeCoalescence", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"d\[Lambda]", ",", "\[Lambda]"}], "}"}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.635313061544705*^9, 3.635313094159091*^9}, {
  3.648881970697094*^9, 3.648881973198722*^9}, {3.648882022712433*^9, 
  3.648882025838879*^9}, {3.648882215414015*^9, 3.6488822174376097`*^9}, {
  3.648882272805374*^9, 3.6488823389852*^9}, {3.648883709388687*^9, 
  3.648883718164032*^9}, {3.648883788852009*^9, 3.648883802450025*^9}, {
  3.648984227799491*^9, 
  3.648984234254281*^9}},ExpressionUUID->"b993c862-135f-4cdb-a3d9-\
88696157adda"],

Cell[BoxData[
 RowBox[{"4", "+", 
  RowBox[{"B", "[", 
   RowBox[{"{", "x", "}"}], "]"}], "+", 
  RowBox[{"B", "[", 
   RowBox[{"{", "y", "}"}], "]"}], "+", 
  RowBox[{"B", "[", 
   RowBox[{"{", "z", "}"}], "]"}], "+", 
  RowBox[{"d\[Lambda]", "[", 
   RowBox[{"{", "x", "}"}], "]"}], "+", 
  RowBox[{"d\[Lambda]", "[", 
   RowBox[{"{", "y", "}"}], "]"}], "+", 
  RowBox[{"d\[Lambda]", "[", 
   RowBox[{"{", "z", "}"}], "]"}]}]], "Output",
 CellChangeTimes->{3.648883805987212*^9, 3.6489842345537367`*^9, 
  3.6489843276813087`*^9},ExpressionUUID->"3a5b3590-7371-4399-a139-\
f2a4b9f0173c"]
}, Open  ]],

Cell[TextData[{
 "Similarly, admixture and changes in migration can be specified for each ",
 StyleBox["pair",
  FontSlant->"Italic"],
 " of demes:"
}], "Text",
 CellChangeTimes->{{3.648883882280519*^9, 
  3.648883929587192*^9}},ExpressionUUID->"28df6ca7-346a-4914-a10b-\
b555620b5ff6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TotalRate", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "a", "}"}], ",", 
       RowBox[{"{", "b", "}"}], ",", 
       RowBox[{"{", "c", "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "d", "}"}], ",", 
       RowBox[{"{", "e", "}"}]}], "}"}], ",", 
     RowBox[{"{", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "x", "}"}], ",", 
     RowBox[{"{", "y", "}"}], ",", 
     RowBox[{"{", "z", "}"}]}], "}"}], ",", 
   RowBox[{"Admixture", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"A", ",", "a"}], "}"}], "}"}]}], ",", 
   RowBox[{"ChangeMigration", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["dM", "1"], ",", 
       SubscriptBox["M", "1"]}], "}"}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.635313061544705*^9, 3.635313094159091*^9}, {
  3.648881970697094*^9, 3.648881973198722*^9}, {3.648882022712433*^9, 
  3.648882025838879*^9}, {3.648882215414015*^9, 3.6488822174376097`*^9}, {
  3.648882272805374*^9, 3.6488823389852*^9}, {3.648883709388687*^9, 
  3.648883718164032*^9}, {3.648883788852009*^9, 3.648883802450025*^9}, {
  3.648883855878977*^9, 3.648883879001214*^9}, {3.6489842488615*^9, 
  3.6489842609549923`*^9}},ExpressionUUID->"02a4cc28-0677-4c4c-a630-\
b9e6bde3d1b1"],

Cell[BoxData[
 RowBox[{"4", "+", 
  RowBox[{"A", "[", 
   RowBox[{
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"{", "y", "}"}]}], "]"}], "+", 
  RowBox[{"A", "[", 
   RowBox[{
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"{", "z", "}"}]}], "]"}], "+", 
  RowBox[{"A", "[", 
   RowBox[{
    RowBox[{"{", "y", "}"}], ",", 
    RowBox[{"{", "x", "}"}]}], "]"}], "+", 
  RowBox[{"A", "[", 
   RowBox[{
    RowBox[{"{", "y", "}"}], ",", 
    RowBox[{"{", "z", "}"}]}], "]"}], "+", 
  RowBox[{"A", "[", 
   RowBox[{
    RowBox[{"{", "z", "}"}], ",", 
    RowBox[{"{", "x", "}"}]}], "]"}], "+", 
  RowBox[{"A", "[", 
   RowBox[{
    RowBox[{"{", "z", "}"}], ",", 
    RowBox[{"{", "y", "}"}]}], "]"}], "+", 
  RowBox[{
   SubscriptBox["dM", "1"], "[", 
   RowBox[{
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"{", "y", "}"}]}], "]"}], "+", 
  RowBox[{
   SubscriptBox["dM", "1"], "[", 
   RowBox[{
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"{", "z", "}"}]}], "]"}], "+", 
  RowBox[{
   SubscriptBox["dM", "1"], "[", 
   RowBox[{
    RowBox[{"{", "y", "}"}], ",", 
    RowBox[{"{", "x", "}"}]}], "]"}], "+", 
  RowBox[{
   SubscriptBox["dM", "1"], "[", 
   RowBox[{
    RowBox[{"{", "y", "}"}], ",", 
    RowBox[{"{", "z", "}"}]}], "]"}], "+", 
  RowBox[{
   SubscriptBox["dM", "1"], "[", 
   RowBox[{
    RowBox[{"{", "z", "}"}], ",", 
    RowBox[{"{", "x", "}"}]}], "]"}], "+", 
  RowBox[{
   SubscriptBox["dM", "1"], "[", 
   RowBox[{
    RowBox[{"{", "z", "}"}], ",", 
    RowBox[{"{", "y", "}"}]}], "]"}]}]], "Output",
 CellChangeTimes->{3.64888387934796*^9, 3.648984262727776*^9, 
  3.648984333128593*^9},ExpressionUUID->"76340fd8-7fe3-4c28-9eb1-\
632a0df681bd"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Mergers", "Subsubsection",
 CellChangeTimes->{
  3.451818698672311*^9},ExpressionUUID->"08197be9-9ef7-453d-a481-\
90f09b68d4bc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Mergers", "::", "usage"}], 
   "\"\<Mergers[{{a},{b},{c}}] or Mergers[{{a},{b},{c}},All] returns a list \
of all pairwise coalescences between these lineages. \
Mergers[{{a},{b},{c}},{{a,b},c}] only permits mergers consistent with the \
topology {{a,b},c}} - in this example, only {{a,b},c}}. \
Mergers[k,{{a},{b},{c}}] or Mergers[k,{{a},{b},{c}},topology] lists all \
possible results of k coalescence events; this list may contain repeated \
elements,if there are multiple paths to the same configuration. An error is \
returned if the list itself is inconsistent with the topology. Lineages must \
be represented as lists.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.451818222076124*^9, 3.4518182556868553`*^9}, {
   3.4976314372065563`*^9, 3.4976314474277554`*^9}, 3.635313592695074*^9, {
   3.635398045775536*^9, 3.6353981099455357`*^9}, {3.6353982044893417`*^9, 
   3.635398211776782*^9}, {3.6354033815967216`*^9, 3.635403401709271*^9}, {
   3.635407777492799*^9, 3.6354077879482393`*^9}, {3.648378348720195*^9, 
   3.648378363976548*^9}, {3.648704284120883*^9, 3.648704284359638*^9}, {
   3.648704316765977*^9, 3.648704413317686*^9}, 3.6489608699907713`*^9, {
   3.6489669048234262`*^9, 
   3.648966926547826*^9}},ExpressionUUID->"94754a15-2050-4bc8-8b57-\
270fefec9189"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Mergers", "::", "badList"}], "=", 
   "\"\<Lineages `1` are not consistent with the topology `2`\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.451818222076124*^9, 3.4518182556868553`*^9}, {
   3.4976314372065563`*^9, 3.4976314474277554`*^9}, 3.635313592695074*^9, {
   3.635398045775536*^9, 3.6353981099455357`*^9}, {3.6353982044893417`*^9, 
   3.635398211776782*^9}, {3.6354033815967216`*^9, 3.635403401709271*^9}, {
   3.6354035897693644`*^9, 3.635403610817892*^9}, {3.635403653857675*^9, 
   3.635403682430653*^9}},ExpressionUUID->"bea4a3a2-59b0-4939-a1dc-\
6244ce7171ef"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Mergers", "[", 
    RowBox[{"xl", ":", 
     RowBox[{"{", "___List", "}"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sort", "[", 
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"DeleteCases", "[", 
           RowBox[{"xl", ",", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
            "1", ",", "1"}], "]"}], ",", 
          RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
           ",", "1", ",", "1"}], "]"}], ",", 
        RowBox[{"Sort", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"#", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}], "&"}], "/@", 
    RowBox[{"Subsets", "[", 
     RowBox[{"xl", ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.451818030139701*^9, 3.451818039159565*^9}, {
  3.451818083352036*^9, 3.451818205946638*^9}, {3.451818444871463*^9, 
  3.451818485781789*^9}, {3.4518233595494757`*^9, 3.45182336340567*^9}, {
  3.580111679510167*^9, 3.5801116859233913`*^9}, {3.5801117471950808`*^9, 
  3.5801117476081247`*^9}, {3.635413276494858*^9, 3.63541328125351*^9}, {
  3.646727540627717*^9, 
  3.6467275426323347`*^9}},ExpressionUUID->"a7d09c71-4537-402b-b03c-\
32f25c42f6db"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Mergers", "[", 
    RowBox[{
     RowBox[{"xl", ":", 
      RowBox[{"{", "___List", "}"}]}], ",", "All"}], "]"}], ":=", 
   RowBox[{"Mergers", "[", "xl", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Mergers", "[", 
    RowBox[{
     RowBox[{"xl", ":", 
      RowBox[{"{", "___List", "}"}]}], ",", "tp_List"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"TopologyQ", "[", 
      RowBox[{"xl", ",", "tp"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"Mergers", "[", "xl", "]"}], ",", 
       RowBox[{
        RowBox[{"TopologyQ", "[", 
         RowBox[{"#", ",", "tp"}], "]"}], "&"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{
        RowBox[{"Mergers", "::", "badList"}], ",", "xl", ",", "tp"}], "]"}], 
      ";", 
      RowBox[{"{", "}"}]}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.451818030139701*^9, 3.451818039159565*^9}, {
  3.451818083352036*^9, 3.451818205946638*^9}, {3.451818444871463*^9, 
  3.451818485781789*^9}, {3.4518233595494757`*^9, 3.45182336340567*^9}, {
  3.580111679510167*^9, 3.5801116859233913`*^9}, {3.5801117471950808`*^9, 
  3.5801117476081247`*^9}, {3.635403713088331*^9, 3.635403793348155*^9}, {
  3.6354077590919313`*^9, 
  3.635407770155489*^9}},ExpressionUUID->"1bbafd58-0170-4600-b488-\
a01adb7a94bb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Mergers", "[", 
    RowBox[{"0", ",", 
     RowBox[{"xl", ":", 
      RowBox[{"{", "___List", "}"}]}]}], "]"}], ":=", 
   RowBox[{"{", "xl", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Mergers", "[", 
    RowBox[{"1", ",", 
     RowBox[{"xl", ":", 
      RowBox[{"{", "___List", "}"}]}]}], "]"}], ":=", 
   RowBox[{"Mergers", "[", "xl", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Mergers", "[", 
    RowBox[{"k_Integer", ",", 
     RowBox[{"xl", ":", 
      RowBox[{"{", "___List", "}"}]}]}], "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Mergers", "/@", 
      RowBox[{"Mergers", "[", 
       RowBox[{
        RowBox[{"k", "-", "1"}], ",", "xl"}], "]"}]}], ",", "1"}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.648704601561614*^9, 3.648704613939699*^9}, {
  3.648704725882399*^9, 3.6487047685909243`*^9}, {3.6487048188109293`*^9, 
  3.648704851584279*^9}},ExpressionUUID->"c6d6864b-fcd0-40e3-a7a3-\
afd87a5af402"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Mergers", "[", 
    RowBox[{"k_Integer", ",", 
     RowBox[{"xl", ":", 
      RowBox[{"{", "___List", "}"}]}], ",", "All"}], "]"}], ":=", 
   RowBox[{"Mergers", "[", 
    RowBox[{"k", ",", "xl"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Mergers", "[", 
    RowBox[{"0", ",", 
     RowBox[{"xl", ":", 
      RowBox[{"{", "___List", "}"}]}], ",", "tp_List"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"TopologyQ", "[", 
      RowBox[{"xl", ",", "tp"}], "]"}], ",", 
     RowBox[{"{", "xl", "}"}], ",", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{
        RowBox[{"Mergers", "::", "badList"}], ",", "xl", ",", "tp"}], "]"}], 
      ";", 
      RowBox[{"{", "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Mergers", "[", 
    RowBox[{"1", ",", 
     RowBox[{"xl", ":", 
      RowBox[{"{", "___List", "}"}]}], ",", "tp_List"}], "]"}], ":=", 
   RowBox[{"Mergers", "[", 
    RowBox[{"xl", ",", "tp"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Mergers", "[", 
    RowBox[{"k_Integer", ",", 
     RowBox[{"xl", ":", 
      RowBox[{"{", "___List", "}"}]}], ",", "tp_List"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"TopologyQ", "[", 
      RowBox[{"xl", ",", "tp"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Mergers", "[", 
          RowBox[{"#", ",", "tp"}], "]"}], "&"}], "/@", 
        RowBox[{"Mergers", "[", 
         RowBox[{
          RowBox[{"k", "-", "1"}], ",", "xl", ",", "tp"}], "]"}]}], ",", 
       "1"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{
        RowBox[{"Mergers", "::", "badList"}], ",", "xl", ",", "tp"}], "]"}], 
      ";", 
      RowBox[{"{", "}"}]}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.648704430992427*^9, 3.648704583716632*^9}, {
  3.648704940932972*^9, 3.648705027442993*^9}, {3.648705227722139*^9, 
  3.648705262703402*^9}},ExpressionUUID->"2e6899c5-b78a-4677-8f84-\
c95fb1d1efc8"],

Cell[TextData[{
 StyleBox["Example: ",
  FontWeight->"Bold"],
 "There are three ways to merge three lineages:"
}], "Text",
 CellChangeTimes->{{3.648378449428393*^9, 
  3.648378472139143*^9}},ExpressionUUID->"b6507b80-f75f-47c7-86a4-\
7a6b02b5e910"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Mergers", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", "a", "}"}], ",", 
    RowBox[{"{", "b", "}"}], ",", 
    RowBox[{"{", "c", "}"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.648378444842012*^9, 
  3.6483784450013857`*^9}},ExpressionUUID->"93d82a3d-e9d1-4939-8613-\
b68f7de2e37a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "c", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "b", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "c"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "a", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "c"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.648378445522908*^9},ExpressionUUID->"116af4c4-4faa-4371-ac53-\
d01638ee3c44"]
}, Open  ]],

Cell[TextData[{
 "Only one of these is consistent with the topology ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "b"}], "}"}], ",", "c"}], "}"}], ":"}], 
   TraditionalForm]],ExpressionUUID->"c7b53f2d-6fc3-4273-9467-06f0975d3a5f"]
}], "Text",
 CellChangeTimes->{{3.648378475410614*^9, 
  3.648378498147299*^9}},ExpressionUUID->"d5f93be5-2ffa-45b2-a649-\
a88ac808c860"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Mergers", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "a", "}"}], ",", 
     RowBox[{"{", "b", "}"}], ",", 
     RowBox[{"{", "c", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}], ",", "c"}], "}"}]}], "]"}]], "Input",Exp\
ressionUUID->"c9e1abd1-1a84-44e5-8cee-d8b398134bbd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", "c", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "b"}], "}"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.648378379973009*^9},ExpressionUUID->"73f4bb8f-fe0a-4dc5-9d2e-\
db6138952342"]
}, Open  ]],

Cell[TextData[{
 StyleBox["Example",
  FontWeight->"Bold"],
 " : There are 180 ways in which 3 coalescences can occur amongst 5 lineages: \
 "
}], "Text",
 CellChangeTimes->{{3.648705316022217*^9, 3.648705328264365*^9}, {
  3.648705371285046*^9, 3.648705483859062*^9}},
 FontWeight->"Plain",ExpressionUUID->"86b587e6-8ad0-4e98-8723-2b4b0c06b9db"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Mergers", "[", 
  RowBox[{"3", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "a", "}"}], ",", 
     RowBox[{"{", "b", "}"}], ",", 
     RowBox[{"{", "c", "}"}], ",", 
     RowBox[{"{", "d", "}"}], ",", 
     RowBox[{"{", "e", "}"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6487041790301332`*^9, 3.648704233699513*^9}, {
  3.64870430103309*^9, 3.648704307421282*^9}, {3.6487047756861563`*^9, 
  3.6487047770943737`*^9}, {3.648704857756185*^9, 3.6487048879179688`*^9}, {
  3.648705042669861*^9, 3.648705048695251*^9}, {3.64870536066319*^9, 
  3.6487053922565193`*^9}},ExpressionUUID->"0a1f2d4a-1118-4e92-a220-\
e758196a29d7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c", ",", "d"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "e", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c", ",", "e"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "d"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "d", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d", ",", "e"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "e", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "d", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d", ",", "e"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "c", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c", ",", "e"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "d"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "e", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "c", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c", ",", "d"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "d", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "c", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b", ",", "d"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "c", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "c"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "e", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b", ",", "e"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "c", ",", "d"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "c"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "d", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d", ",", "e"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "e", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "d", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d", ",", "e"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "c"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "b", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b", ",", "e"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "c", ",", "d"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "e", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "b", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b", ",", "d"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "c", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "d", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "b", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b", ",", "c"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "d"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "c", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "e", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b", ",", "e"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "c", ",", "d"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "d"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "c", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "c", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c", ",", "e"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "d"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "e", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "c", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c", ",", "e"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "d"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "d"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "c", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "b", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b", ",", "e"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "c", ",", "d"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "e", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "b", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b", ",", "c"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "c", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "b", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b", ",", "c"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "e"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "c", ",", "d"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "d", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b", ",", "d"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "c", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "e"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "c", ",", "d"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "c", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c", ",", "d"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "d", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "c", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c", ",", "d"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "e"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "c", ",", "d"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "b", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b", ",", "d"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "c", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "d", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "b", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b", ",", "c"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "c", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "b", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b", ",", "c"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "d"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "c", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "e", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b", ",", "c"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "e"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "c", ",", "d"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "d", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d", ",", "e"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "e", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "d", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d", ",", "e"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b", ",", "c"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "a", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "e"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "c", ",", "d"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "e", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "a", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "d"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "c", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "d", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "a", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b", ",", "d"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "c", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "c"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "e", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b", ",", "d"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "c", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "e"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "c", ",", "d"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "c", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c", ",", "e"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "d"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "e", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "c", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c", ",", "e"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "d"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b", ",", "d"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "c", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "a", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "e"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "c", ",", "d"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "e", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "a", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "c"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "c", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "a", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b", ",", "e"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "c", ",", "d"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "c"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "d", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b", ",", "e"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "c", ",", "d"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "d"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "c", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "c", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c", ",", "d"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "d", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "c", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c", ",", "d"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b", ",", "e"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "c", ",", "d"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "a", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "d"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "c", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "d", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "a", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "c"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "c", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "a", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c", ",", "d"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "e", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c", ",", "d"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "e"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "c", ",", "d"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "b", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b", ",", "e"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "c", ",", "d"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "e", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "b", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c", ",", "d"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b", ",", "e"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "c", ",", "d"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "a", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "e"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "c", ",", "d"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "e", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "a", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "b", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "a", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c", ",", "e"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "d"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "d", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c", ",", "e"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "d"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "d"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "c", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "b", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b", ",", "d"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "c", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "d", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "b", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c", ",", "e"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "d"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b", ",", "d"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "c", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "a", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "d"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "c", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "d", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "a", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "b", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "a", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d", ",", "e"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "c", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d", ",", "e"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "c"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "b", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b", ",", "c"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "c", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "b", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d", ",", "e"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b", ",", "c"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "a", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "c"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "c", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "a", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "b", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "a", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "c", ",", "d", ",", "e"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.648704307767214*^9, 3.6487047809000673`*^9, {3.648704862517308*^9, 
   3.6487048893509417`*^9}, 3.6487050491696157`*^9, {3.648705362246922*^9, 
   3.648705365100977*^9}},ExpressionUUID->"e4545564-a141-4c03-8c0f-\
7e8cb3b9b44a"]
}, Closed]],

Cell["\<\
There are 15 distinct coalescence events, each represented 9 or 18 times:\
\>", "Text",
 CellChangeTimes->{{3.648705316022217*^9, 3.648705328264365*^9}, {
  3.648705371285046*^9, 3.6487054932019653`*^9}},
 FontWeight->"Plain",ExpressionUUID->"dbaec02f-60bf-4c40-97df-119532810518"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Tally", "[", 
  RowBox[{"Mergers", "[", 
   RowBox[{"3", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "a", "}"}], ",", 
      RowBox[{"{", "b", "}"}], ",", 
      RowBox[{"{", "c", "}"}], ",", 
      RowBox[{"{", "d", "}"}], ",", 
      RowBox[{"{", "e", "}"}]}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.64870505879425*^9, 3.648705061127795*^9}, 
   3.64870539355886*^9, {3.6487054321989737`*^9, 
   3.648705435444249*^9}},ExpressionUUID->"cbe4964e-ea80-4ffe-8b83-\
c2cf67e51518"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"c", ",", "d"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b", ",", "e"}], "}"}]}], "}"}], ",", "9"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", "9"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "e", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}]}], "}"}], ",", 
     "18"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"c", ",", "e"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b", ",", "d"}], "}"}]}], "}"}], ",", "9"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "d", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b", ",", "c", ",", "e"}], "}"}]}], "}"}], ",", 
     "18"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"d", ",", "e"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], "}"}], ",", "9"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "c", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
     "18"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"b", ",", "d"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "c", ",", "e"}], "}"}]}], "}"}], ",", "9"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "c"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", "9"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"b", ",", "e"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "c", ",", "d"}], "}"}]}], "}"}], ",", "9"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "b", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
     "18"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"b", ",", "c"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", "9"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "d"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", "c", ",", "e"}], "}"}]}], "}"}], ",", "9"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "e"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", "c", ",", "d"}], "}"}]}], "}"}], ",", "9"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "a", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", "c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", 
     "18"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.648705061701075*^9, 3.64870525441637*^9, {3.648705433644246*^9, 
   3.64870543579628*^9}},ExpressionUUID->"56f922e8-175d-4451-aaca-\
d4b49421adf6"]
}, Open  ]],

Cell[TextData[{
 "If we restrict to coalescence consistent with a specific topology, then \
there are only 3 routes to a single type of coalescence event.  These three \
routes correspond to three times when the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{"a", ",", "b"}], "}"}], TraditionalForm]],ExpressionUUID->
  "36c1f5bb-46c3-4371-bb3a-7618d8b0175a"],
 " coalescence can occur, relative to the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{"d", ",", "e"}], "}"}], TraditionalForm]],ExpressionUUID->
  "f993e52d-ed52-47f0-bbe9-2e2a9d30a47a"],
 " and the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{"c", ",", 
     RowBox[{"{", 
      RowBox[{"d", ",", "e"}], "}"}]}], "}"}], TraditionalForm]],
  ExpressionUUID->"34eda57c-9d30-42b4-b234-e1336c4c96f1"],
 " coalescences:"
}], "Text",
 CellChangeTimes->{{3.648705496032814*^9, 3.6487055352624893`*^9}, {
   3.648967022889624*^9, 3.648967077826927*^9}, 
   3.651907477229561*^9},ExpressionUUID->"5acdb7eb-cad5-494c-86f0-\
1fb3cdb8f155"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Tally", "[", 
  RowBox[{"Mergers", "[", 
   RowBox[{"3", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "a", "}"}], ",", 
      RowBox[{"{", "b", "}"}], ",", 
      RowBox[{"{", "c", "}"}], ",", 
      RowBox[{"{", "d", "}"}], ",", 
      RowBox[{"{", "e", "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "b"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"c", ",", 
        RowBox[{"{", 
         RowBox[{"d", ",", "e"}], "}"}]}], "}"}]}], "}"}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6487050996836452`*^9, 3.648705126447997*^9}, 
   3.648966969443737*^9},ExpressionUUID->"2c5d2bb0-664f-4a3e-8175-\
d9cd78dd7149"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "b"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"c", ",", "d", ",", "e"}], "}"}]}], "}"}], ",", "3"}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.648705142809517*^9, {3.648705257226458*^9, 3.648705265227058*^9}, 
   3.64896697203897*^9},ExpressionUUID->"1e7658b7-8e44-4546-acb4-\
4c68bef80d57"]
}, Open  ]],

Cell[TextData[{
 StyleBox["Note: ",
  FontWeight->"Bold"],
 "There is s subtlety to the notation.  A set of lineages is a list of lists, \
where each element gives the ",
 StyleBox["set of genes",
  FontSlant->"Italic"],
 " to which the lineage is ancestral - here, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "c", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}]}], "}"}], TraditionalForm]],
  ExpressionUUID->"25232c56-1cb0-439e-af45-94d35d0b266b"],
 ", for example; the first element, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"{", "c", "}"}], ","}], TraditionalForm]],ExpressionUUID->
  "5f7c13df-800f-4f2d-951a-fc913f80bf31"],
 " represents a lineage ancestral to a single gene, ",
 Cell[BoxData[
  FormBox["c", TraditionalForm]],ExpressionUUID->
  "4066b00a-9ce9-4076-be56-5432f6e8a89c"],
 ", for example.  In contrast, a topology is a grouping of ",
 StyleBox["genes",
  FontSlant->"Italic"],
 " - for example, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}], ",", "c"}], "}"}], TraditionalForm]],
  ExpressionUUID->"171faf8b-a478-4ca4-8cd0-0b31d309afeb"],
 ", with ",
 Cell[BoxData[
  FormBox["c", TraditionalForm]],ExpressionUUID->
  "1ab16d48-d470-40f9-bac2-9f5d238dd83e"],
 " appearing, ",
 StyleBox["not ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   RowBox[{"{", "c", "}"}], TraditionalForm]],ExpressionUUID->
  "74248aba-0e97-4a21-b10a-3f7e57d27a31"]
}], "Text",
 CellChangeTimes->{{3.6483785014158278`*^9, 3.6483785708826637`*^9}, {
  3.648378609384694*^9, 3.648378734150469*^9}, {3.6483787651253843`*^9, 
  3.648378849835339*^9}},ExpressionUUID->"415fcbba-8a0b-45a6-8b53-\
a96cfee9967d"],

Cell[TextData[{
 StyleBox["Note:",
  FontWeight->"Bold"],
 " Mergers[] with multiple coalescence is used by Bottleneck[], which finds \
the chance of all the possible configurations of lineages before a bottleneck"
}], "Text",
 CellChangeTimes->{{3.6487055491333103`*^9, 
  3.648705628118795*^9}},ExpressionUUID->"e8eb7cbe-1f46-40f8-ac46-\
100324d0ebd1"]
}, Closed]],

Cell[CellGroupData[{

Cell["Coalesce", "Subsubsection",
 CellChangeTimes->{
  3.451818698672311*^9, {3.635413454032022*^9, 
   3.63541346085605*^9}},ExpressionUUID->"59c2b858-19b0-475f-bf67-\
ba779edcf2a3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Coalesce", "::", "usage"}], 
   "\"\<Coalesce[{{a},{b},{c}}]  returns a list of all pairwise coalescences \
between these lineages - here, {{a},{{b},{c}}}, \
{{b},{{a},{c}}},{{c},{{a},{b}}}.  Similar to Mergers[], except that coalesced \
lineages are wrapped within a list rather than being actually merged.  Unlike \
Mergers[], allows for repeated elements, but does not allow restriction by \
topology. \>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.451818222076124*^9, 3.4518182556868553`*^9}, {
   3.4976314372065563`*^9, 3.4976314474277554`*^9}, 3.635313592695074*^9, {
   3.635398045775536*^9, 3.6353981099455357`*^9}, {3.6353982044893417`*^9, 
   3.635398211776782*^9}, {3.6354033815967216`*^9, 3.635403401709271*^9}, {
   3.635407777492799*^9, 3.6354077879482393`*^9}, {3.6354134649238358`*^9, 
   3.635413581144397*^9}, {3.635414012381578*^9, 3.635414022949156*^9}, {
   3.635414888350437*^9, 3.6354149095276957`*^9}, {3.648378965806285*^9, 
   3.64837896809056*^9}, {3.648702881859393*^9, 
   3.648702883577691*^9}},ExpressionUUID->"d36e7862-70fb-4bbd-bd8e-\
b9ac6c1f7110"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Coalesce", "[", "xl_List", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sort", "[", 
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{"TakeAway", "[", 
         RowBox[{"xl", ",", "#"}], "]"}], ",", 
        RowBox[{"Sort", "[", "#", "]"}]}], "]"}], "]"}], "&"}], "/@", 
    RowBox[{"Union", "[", 
     RowBox[{"Subsets", "[", 
      RowBox[{"xl", ",", 
       RowBox[{"{", "2", "}"}]}], "]"}], "]"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.451818030139701*^9, 3.451818039159565*^9}, {
  3.451818083352036*^9, 3.451818205946638*^9}, {3.451818444871463*^9, 
  3.451818485781789*^9}, {3.4518233595494757`*^9, 3.45182336340567*^9}, {
  3.580111679510167*^9, 3.5801116859233913`*^9}, {3.5801117471950808`*^9, 
  3.5801117476081247`*^9}, {3.635413276494858*^9, 3.63541328125351*^9}, {
  3.6354135874592457`*^9, 3.635413602485037*^9}, {3.635413636392185*^9, 
  3.6354136373088293`*^9}, {3.6354153353090553`*^9, 
  3.635415402821834*^9}},ExpressionUUID->"e86cd6d0-f540-42bf-9c83-\
6d180477be5f"],

Cell[TextData[{
 StyleBox["Note: ",
  FontWeight->"Bold"],
 "This is used by Topologies[]"
}], "Text",
 CellChangeTimes->{{3.64837889296805*^9, 
  3.64837892454147*^9}},ExpressionUUID->"6070d45e-8fbb-48d2-b984-\
f348528c7760"]
}, Closed]],

Cell[CellGroupData[{

Cell["GetVars", "Subsubsection",
 CellChangeTimes->{{3.45182333275708*^9, 
  3.451823333787324*^9}},ExpressionUUID->"737e3dd8-a292-4228-8696-\
79555d007ac7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GetVars", "::", "usage"}], "=", 
   "\"\<GetVars[expr,\[Psi]] lists the configurations of genes in all terms \
of the form \[Psi][\[Omega],genes,options], \
GetVars[{expr,\[Ellipsis]},\[Psi]] lists all the variables.\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.497632920580324*^9, 3.4976329291921988`*^9}, {
   3.4976329854931927`*^9, 3.497633037474268*^9}, 3.498097194985917*^9, {
   3.498097545833837*^9, 3.4980975850214443`*^9}, {3.635317126178891*^9, 
   3.635317139699143*^9}, 3.635425575451908*^9, {3.648804815427701*^9, 
   3.648804817291717*^9}},ExpressionUUID->"5fd9da0a-90ae-45f4-bf3b-\
92bb7c65bf26"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GetVars", "[", 
    RowBox[{"expr_", ",", "GF_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"ListQ", "[", "expr", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Union", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GetVars", "[", 
          RowBox[{"#", ",", "GF"}], "]"}], "&"}], "/@", "expr"}], "]"}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Union", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Extract", "[", 
         RowBox[{"expr", ",", "#"}], "]"}], "&"}], "/@", 
       RowBox[{"Position", "[", 
        RowBox[{"expr", ",", 
         RowBox[{"GF", "[", 
          RowBox[{"_", ",", "_List", ",", "___Rule"}], "]"}]}], "]"}]}], 
      "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.451822657243087*^9, 3.451822746008271*^9}, {
   3.4518228511200027`*^9, 3.4518228552555523`*^9}, {3.4518231233008337`*^9, 
   3.451823126122283*^9}, {3.451825055953274*^9, 3.451825060693722*^9}, {
   3.4976329661543083`*^9, 3.497632970343267*^9}, {3.498097632822756*^9, 
   3.498097662204915*^9}, {3.635317143451827*^9, 3.635317144765822*^9}, {
   3.635317624050997*^9, 3.635317629162792*^9}, {3.635425588394508*^9, 
   3.635425588675036*^9}, {3.6488048081981707`*^9, 3.6488048099405823`*^9}, {
   3.648804849143743*^9, 3.648804850656608*^9}, 
   3.6488049013610764`*^9},ExpressionUUID->"a3d51502-7b9c-4621-b40d-\
86f9f12955f6"]
}, Closed]],

Cell[CellGroupData[{

Cell["GetConfigs", "Subsubsection",
 CellChangeTimes->{{3.640790723484235*^9, 3.6407907281310787`*^9}, {
  3.64084630117013*^9, 
  3.640846311139369*^9}},ExpressionUUID->"02b2cf0e-9605-4864-98e1-\
7f6ddb3e75fc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GetConfigs", "::", "usage"}], "=", 
   "\"\<GetConfigs[expr,\[Psi]] finds all the sets of genes that appear in \
terms of the form \[Psi][\[Omega],{{a},{b,c}}]\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.640790732481947*^9, 
  3.640790818265112*^9}},ExpressionUUID->"ab794894-1d72-4611-97cd-\
7e8f450b196d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GetConfigs", "[", 
    RowBox[{"expr_", ",", "\[Psi]_"}], "]"}], ":=", 
   RowBox[{"Union", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"GetVars", "[", 
        RowBox[{"expr", ",", "\[Psi]"}], "]"}], "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", "1"}], 
     "]"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.640790829148787*^9, 
  3.640790848531934*^9}},ExpressionUUID->"657acbd3-4c26-470d-8271-\
766da023ffee"]
}, Closed]],

Cell[CellGroupData[{

Cell["GetConfigsGF", "Subsubsection",
 CellChangeTimes->{{3.640790723484235*^9, 3.6407907281310787`*^9}, {
  3.6408463129220324`*^9, 
  3.6408463132339582`*^9}},ExpressionUUID->"46c06752-90e0-453d-9d3d-\
be993bf61793"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GetConfigsGF", "::", "usage"}], "=", 
   "\"\<GetConfigsGF[GF,\[Omega]] finds all the sets of genes that appear in \
terms of the form \[Omega][{a,b}]\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.640790732481947*^9, 3.640790818265112*^9}, {
  3.640846316267313*^9, 
  3.640846346461569*^9}},ExpressionUUID->"0b05257e-a7d1-4267-9767-\
d7d8d649f656"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GetConfigsGF", "[", 
    RowBox[{"expr_", ",", "\[Omega]_"}], "]"}], ":=", 
   RowBox[{"Union", "[", 
    RowBox[{"First", "/@", 
     RowBox[{"Cases", "[", 
      RowBox[{"expr", ",", 
       RowBox[{"\[Omega]", "[", "_List", "]"}], ",", "All"}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.640790829148787*^9, 3.640790848531934*^9}, {
  3.640846319231914*^9, 3.640846357989459*^9}, {3.640854194714225*^9, 
  3.640854199923027*^9}},ExpressionUUID->"03ee06da-0ca2-4c1c-b26d-\
bb5e26f62e84"]
}, Closed]],

Cell[CellGroupData[{

Cell["GetVarsDemes", "Subsubsection",
 CellChangeTimes->{{3.45182333275708*^9, 3.451823333787324*^9}, {
  3.635425539851357*^9, 
  3.635425541170786*^9}},ExpressionUUID->"9f00eaee-a0c3-46a5-a9eb-\
30e9a1ad4577"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GetVarsDemes", "::", "usage"}], "=", 
   "\"\<GetVarsDemes[expr,\[Psi]] lists the configurations of genes in all \
terms of the form \[Psi][\[Omega],genes,demes,opts], GetVarsDemes[{expr,\
\[Ellipsis]},\[Psi]] lists all the variables.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.497632920580324*^9, 3.4976329291921988`*^9}, {
   3.4976329854931927`*^9, 3.497633037474268*^9}, 3.498097194985917*^9, {
   3.498097545833837*^9, 3.4980975850214443`*^9}, {3.635317126178891*^9, 
   3.635317139699143*^9}, {3.6354255446560802`*^9, 3.635425552553075*^9}, {
   3.6488048646186523`*^9, 
   3.6488048678229437`*^9}},ExpressionUUID->"70d5a0af-1ac3-4ceb-9720-\
ae692810ec47"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GetVarsDemes", "[", 
    RowBox[{"expr_", ",", "GF_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"ListQ", "[", "expr", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Union", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GetVarsDemes", "[", 
          RowBox[{"#", ",", "GF"}], "]"}], "&"}], "/@", "expr"}], "]"}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Union", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Extract", "[", 
         RowBox[{"expr", ",", "#"}], "]"}], "&"}], "/@", 
       RowBox[{"Position", "[", 
        RowBox[{"expr", ",", 
         RowBox[{"GF", "[", 
          RowBox[{"_", ",", "_List", ",", "_List", ",", "___Rule"}], "]"}]}], 
        "]"}]}], "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.451822657243087*^9, 3.451822746008271*^9}, {
   3.4518228511200027`*^9, 3.4518228552555523`*^9}, {3.4518231233008337`*^9, 
   3.451823126122283*^9}, {3.451825055953274*^9, 3.451825060693722*^9}, {
   3.4976329661543083`*^9, 3.497632970343267*^9}, {3.498097632822756*^9, 
   3.498097662204915*^9}, {3.635317143451827*^9, 3.635317144765822*^9}, {
   3.635317624050997*^9, 3.635317629162792*^9}, {3.635425558769045*^9, 
   3.635425562410087*^9}, {3.648804879980044*^9, 3.648804886748499*^9}, 
   3.6490616991982613`*^9},ExpressionUUID->"8f405b22-4024-4f73-a317-\
cec9b78152e3"]
}, Closed]],

Cell[CellGroupData[{

Cell["ReduceOpts", "Subsubsection",
 CellChangeTimes->{{3.648884095716659*^9, 
  3.648884097459572*^9}},ExpressionUUID->"d985a7b0-998d-4394-89c9-\
a0dc5b33465f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ReduceOpts", "::", "usage"}], "=", "\"\<ReduceOpts[{\!\(\*
StyleBox[\"opts\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"}\",
FontSlant->\"Italic\"]\)] reeduces the options to a standard form by removing \
any that are identical to the defaults Options[MakeEqns], and \nthen \
sorting\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.648884103275025*^9, 3.648884161077829*^9}, {
  3.6488845584969254`*^9, 3.648884582151867*^9}, {3.648889431598661*^9, 
  3.648889432072884*^9}},ExpressionUUID->"d2b3cc18-e546-4041-87fc-\
2269d489910f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ReduceOpts", "[", 
    RowBox[{"opts", ":", 
     RowBox[{"{", "___Rule", "}"}]}], "]"}], ":=", 
   RowBox[{"Sort", "[", 
    RowBox[{"DeleteCases", "[", 
     RowBox[{"opts", ",", 
      RowBox[{"Alternatives", "@@", 
       RowBox[{"Options", "[", "MakeEqns", "]"}]}]}], "]"}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.648884510342744*^9, 
  3.6488845840785513`*^9}},ExpressionUUID->"c9818029-35c9-4144-977a-\
b3612c0e287c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["DropEventsList", "Subsubsection",
 CellChangeTimes->{
  3.648907761078803*^9},ExpressionUUID->"1d5e5e10-68b9-4f90-9c3b-\
95ffc8b3e2f3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DropEventsList", "::", "usage"}], "=", 
   "\"\<DropEventsList[{opts},Bottlenecks] drops the first element \
{\!\(\*SubscriptBox[\(B\), \(1\)]\),\!\(\*SubscriptBox[\(b\), \(1\)]\)} from \
Bottlenecks->{{\!\(\*SubscriptBox[\(B\), \(1\)]\),\!\(\*SubscriptBox[\(b\), \
\(1\)]\)},\[Ellipsis]}\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.648907344707821*^9, 3.648907411564396*^9}, {
   3.648907669393721*^9, 3.648907755877214*^9}, 
   3.648907793993238*^9},ExpressionUUID->"74394061-48f7-4d86-812f-\
edd297e37869"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DropEventsList", "[", 
    RowBox[{
     RowBox[{"ol", ":", 
      RowBox[{"{", "___Rule", "}"}]}], ",", 
     RowBox[{"e", ":", 
      RowBox[{"(", 
       RowBox[{
       "Bottlenecks", "|", "Admixture", "|", "ChangeMigration", "|", 
        "ChangeCoalescence"}], ")"}]}]}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"ReduceOpts", "[", 
    RowBox[{"ol", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"e", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"_", ",", "_"}], "}"}], ",", "x___List"}], "}"}]}], ")"}],
        "\[RuleDelayed]", 
       RowBox[{"(", 
        RowBox[{"e", "\[Rule]", 
         RowBox[{"{", "x", "}"}]}], ")"}]}], "}"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6489077657730503`*^9, 3.648907857051743*^9}, {
  3.6489807626650343`*^9, 
  3.648980770973627*^9}},ExpressionUUID->"df9f7f96-6f16-4899-9010-\
14838c778756"],

Cell[TextData[{
 StyleBox["Example:",
  FontWeight->"Bold"],
 " This drops the first element from the list of admixture events:"
}], "Text",
 CellChangeTimes->{{3.648969957693182*^9, 
  3.648969984881727*^9}},ExpressionUUID->"ab5ad28c-37df-44cd-9e7e-\
3a454475fc3b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DropEventsList", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Coalescence", "\[Rule]", "\[Lambda]"}], ",", 
     RowBox[{"Bottlenecks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"B", ",", "b"}], "}"}], "}"}]}], ",", 
     RowBox[{"Admixture", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["A", "1"], ",", 
          SubscriptBox["a", "1"]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["A", "2"], ",", 
          SubscriptBox["a", "2"]}], "}"}]}], "}"}]}]}], "}"}], ",", 
   "Admixture"}], "]"}]], "Input",
 CellChangeTimes->{{3.648898116830276*^9, 3.648898128275367*^9}, {
  3.648898214304063*^9, 3.64889827049504*^9}, {3.64890658223897*^9, 
  3.6489066050964327`*^9}, {3.648907234405525*^9, 3.6489073304619703`*^9}, {
  3.648907865574258*^9, 3.6489079046392403`*^9}, {3.6489699182153797`*^9, 
  3.6489699400060053`*^9}},ExpressionUUID->"e9ff2071-c5f2-4489-a146-\
98417710d7b4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Coalescence", "\[Rule]", "\[Lambda]"}], ",", 
   RowBox[{"Bottlenecks", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"B", ",", "b"}], "}"}], "}"}]}], ",", 
   RowBox[{"Admixture", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["A", "2"], ",", 
       SubscriptBox["a", "2"]}], "}"}], "}"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6488981226309347`*^9, 3.648898128569633*^9}, 
   3.6489072756137238`*^9, {3.648907320847207*^9, 3.6489073312812023`*^9}, {
   3.6489078775361032`*^9, 3.6489079053858967`*^9}, 
   3.648969941031382*^9},ExpressionUUID->"e13468c5-23d8-4821-aac1-\
79f780928855"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["ChangeEventsList", "Subsubsection",
 CellChangeTimes->{{3.648980411013132*^9, 3.648980417732791*^9}, 
   3.64898045908678*^9},ExpressionUUID->"656e961f-21d6-4b40-809e-\
243fbd781929"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChangeEventsList", "::", "usage"}], "=", 
   "\"\<ChangeEventsList[{opts},event,\[Lambda]] drops one event from the \
list, and changes the corresponding parameter to \[Lambda].\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.648980421965066*^9, 3.648980490573897*^9}, {
  3.648980577894066*^9, 3.6489806399410057`*^9}, {3.648980685105031*^9, 
  3.648980710557013*^9}},ExpressionUUID->"c52f1af0-f8ee-4347-85e5-\
6e9b4f87bf3a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChangeEventsList", "[", 
    RowBox[{
     RowBox[{"{", "opts___Rule", "}"}], ",", 
     RowBox[{"e", ":", 
      RowBox[{"(", 
       RowBox[{"ChangeMigration", "|", "ChangeCoalescence"}], ")"}]}], ",", 
     "\[Lambda]_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"de", "=", 
        RowBox[{"DropEventsList", "[", 
         RowBox[{
          RowBox[{"{", "opts", "}"}], ",", "e"}], "]"}]}], ",", 
       RowBox[{"e2", "=", 
        RowBox[{"Switch", "[", 
         RowBox[{
         "e", ",", "ChangeMigration", ",", "Migration", ",", 
          "ChangeCoalescence", ",", "Coalescence", ",", "_", ",", "Null"}], 
         "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"ReduceOpts", "[", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"FreeQ", "[", 
         RowBox[{"de", ",", "e2"}], "]"}], ",", 
        RowBox[{"Append", "[", 
         RowBox[{"de", ",", 
          RowBox[{"e2", "\[Rule]", "\[Lambda]"}]}], "]"}], ",", 
        RowBox[{"de", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"e2", "\[Rule]", "_"}], ")"}], "\[RuleDelayed]", 
           RowBox[{"(", 
            RowBox[{"e2", "\[Rule]", "\[Lambda]"}], ")"}]}], "}"}]}]}], "]"}],
       "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.648980421965066*^9, 3.648980490573897*^9}, {
   3.648980577894066*^9, 3.64898066574933*^9}, {3.6489807138769693`*^9, 
   3.6489807364963427`*^9}, 3.64898084335283*^9, {3.648981007887176*^9, 
   3.648981105367984*^9}, {3.6489819281845617`*^9, 
   3.648982061402437*^9}},ExpressionUUID->"ac279f8e-9173-412e-a669-\
725033b66a89"],

Cell[TextData[{
 StyleBox["Example:",
  FontWeight->"Bold"],
 " One event is dropped from the list, and the corresponding parameter is \
changed to the new value:"
}], "Text",
 CellChangeTimes->{{3.6489822150680532`*^9, 3.648982228058218*^9}, {
  3.648982276436829*^9, 
  3.648982299242991*^9}},ExpressionUUID->"ac9e3311-f96a-40a6-a058-\
511998e615c1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ChangeEventsList", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ChangeCoalescence", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["d\[Lambda]", "1"], ",", 
          SubscriptBox["\[Lambda]", "1"]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["d\[Lambda]", "2"], ",", 
          SubscriptBox["\[Lambda]", "2"]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Coalescence", "\[Rule]", 
      SubscriptBox["\[Lambda]", "0"]}]}], "}"}], ",", "ChangeCoalescence", 
   ",", 
   SubscriptBox["\[Lambda]", "new"]}], "]"}]], "Input",
 CellChangeTimes->{{3.6489820696257763`*^9, 3.648982163303887*^9}, {
  3.648982295405128*^9, 
  3.6489822957491207`*^9}},ExpressionUUID->"1a585cfb-eebe-400c-a379-\
d35a93aa9918"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ChangeCoalescence", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["d\[Lambda]", "2"], ",", 
       SubscriptBox["\[Lambda]", "2"]}], "}"}], "}"}]}], ",", 
   RowBox[{"Coalescence", "\[Rule]", 
    SubscriptBox["\[Lambda]", "new"]}]}], "}"}]], "Output",
 CellChangeTimes->{3.648982175728672*^9, 
  3.64898229613209*^9},ExpressionUUID->"373acdf4-8e38-4ce9-935a-c5a1d69cef4c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ChangeEventsList", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ChangeCoalescence", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["d\[Lambda]", "1"], ",", 
          SubscriptBox["\[Lambda]", "1"]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["d\[Lambda]", "2"], ",", 
          SubscriptBox["\[Lambda]", "2"]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Bottlenecks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"B", ",", "b"}], "}"}], "}"}]}]}], "}"}], ",", 
   "ChangeCoalescence", ",", 
   SubscriptBox["\[Lambda]", "1"]}], "]"}]], "Input",
 CellChangeTimes->{{3.6489820696257763`*^9, 
  3.648982194565035*^9}},ExpressionUUID->"2bfcf3b5-f168-4dce-ad30-\
8e3da3f923af"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Bottlenecks", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"B", ",", "b"}], "}"}], "}"}]}], ",", 
   RowBox[{"ChangeCoalescence", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["d\[Lambda]", "2"], ",", 
       SubscriptBox["\[Lambda]", "2"]}], "}"}], "}"}]}], ",", 
   RowBox[{"Coalescence", "\[Rule]", 
    SubscriptBox["\[Lambda]", "1"]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6489821959803658`*^9},ExpressionUUID->"92f9ef06-9ab4-4ee3-a2a5-\
8a0728116cd5"]
}, Open  ]],

Cell["The list of options is reduced to the standard form:", "Text",
 CellChangeTimes->{{3.648982236112558*^9, 
  3.64898227022948*^9}},ExpressionUUID->"cb1cf122-99b0-4757-bce5-\
ff286a3c34a4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ChangeEventsList", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ChangeCoalescence", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["d\[Lambda]", "1"], ",", 
          SubscriptBox["\[Lambda]", "1"]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["d\[Lambda]", "2"], ",", 
          SubscriptBox["\[Lambda]", "2"]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Bottlenecks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"B", ",", "b"}], "}"}], "}"}]}]}], "}"}], ",", 
   "ChangeCoalescence", ",", 
   RowBox[{"1", "&"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6489820696257763`*^9, 
  3.648982205837265*^9}},ExpressionUUID->"c2ecc48d-bed4-47dd-b80e-\
ece61ace5d12"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Bottlenecks", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"B", ",", "b"}], "}"}], "}"}]}], ",", 
   RowBox[{"ChangeCoalescence", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["d\[Lambda]", "2"], ",", 
       SubscriptBox["\[Lambda]", "2"]}], "}"}], "}"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.648982207716259*^9},ExpressionUUID->"2adc1528-aebf-4b67-b2f5-\
a37e03c9794a"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["MakeDemesUniform", "Subsubsection",
 CellChangeTimes->{{3.64931890051528*^9, 
  3.649318928615368*^9}},ExpressionUUID->"8bf25564-71fa-4233-8a47-\
fb7e8c52f3d5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeDemesUniform", "::", "usage"}], "=", 
   "\"\<MakeDemesUniform[{{{a},{b}},{{c}},{}},{{x},{y},{z}}] replaces leaves \
by deme lables, giving {{{x},{x}},{{y}},{}}\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.649318930951178*^9, 
  3.649319033159669*^9}},ExpressionUUID->"2aaada0d-7e81-48b9-8792-\
705f4d14b64e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeDemesUniform", "[", 
    RowBox[{"xl_List", ",", "dl_List"}], "]"}], ":=", 
   RowBox[{"MapThread", "[", 
    RowBox[{"ConstantArray", ",", 
     RowBox[{"{", 
      RowBox[{"dl", ",", 
       RowBox[{"Length", "/@", "xl"}]}], "}"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.649318785477518*^9, 3.649318893371916*^9}, {
  3.649318961702798*^9, 3.64931896578093*^9}, {3.6493190370586853`*^9, 
  3.649319059885713*^9}},ExpressionUUID->"0db856c8-6daf-43f6-af18-\
dd4190891868"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Options for the GF", "Subsection",
 CellChangeTimes->{{3.648802348722434*^9, 3.6488023565138073`*^9}, {
   3.648802530594768*^9, 3.648802531473261*^9}, 3.649067187556526*^9, 
   3.652594906676034*^9},ExpressionUUID->"2eef33ad-4cf9-40c8-95ed-\
6ac172d60282"],

Cell[CellGroupData[{

Cell["Topology", "Subsubsection",
 CellChangeTimes->{{3.648953497677114*^9, 
  3.648953499444983*^9}},ExpressionUUID->"58529069-2eb3-4146-bde3-\
9cd56c5ee74d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Topology", "::", "usage"}], "=", "\"\<Topology\[Rule]\!\(\*
StyleBox[\"top\",
FontSlant->\"Italic\"]\) is an option for MakeBottlenecks that restricts to \
aspecific topology. \>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.497629915230047*^9, 3.497629937826552*^9}, {
   3.4976299715556097`*^9, 3.4976300002856693`*^9}, {3.4976314832831306`*^9, 
   3.497631483541554*^9}, {3.4976318525913553`*^9, 3.49763185456774*^9}, {
   3.497632351711234*^9, 3.497632383439411*^9}, {3.498187415590383*^9, 
   3.498187415637122*^9}, {3.627881660084319*^9, 3.627881674477385*^9}, {
   3.6278819675306463`*^9, 3.627881988444644*^9}, {3.635238219889872*^9, 
   3.635238285639118*^9}, 3.635238343424089*^9, {3.635238374369809*^9, 
   3.635238376777821*^9}, {3.635313183358533*^9, 3.635313184925727*^9}, {
   3.63531678033641*^9, 3.635316781705367*^9}, {3.6354061482665653`*^9, 
   3.635406182677664*^9}, {3.635406737790051*^9, 3.635406803061761*^9}, {
   3.6354068990209103`*^9, 3.635406901348206*^9}, {3.6486262525026503`*^9, 
   3.648626331018236*^9}, {3.64879941891805*^9, 3.648799539324835*^9}, {
   3.648799581665966*^9, 3.648799691398391*^9}, {3.648801695511958*^9, 
   3.648801827064864*^9}, {3.648801865730854*^9, 3.6488020500822563`*^9}, {
   3.64880210122921*^9, 3.648802125531103*^9}, {3.648802674679535*^9, 
   3.648802862884204*^9}, 3.648802908953746*^9, {3.648953525297969*^9, 
   3.648953544274025*^9}, {3.6489585599994707`*^9, 
   3.6489585830351954`*^9}},ExpressionUUID->"9ab565f9-400d-4e1b-92cd-\
cfc613cf09f0"]
}, Closed]],

Cell[CellGroupData[{

Cell["Coalescence", "Subsubsection",
 CellChangeTimes->{{3.6488020628134604`*^9, 
  3.648802064893271*^9}},ExpressionUUID->"7c140e51-e2df-449a-a00a-\
470ca6650d74"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Coalescence", "::", "usage"}], "=", 
   "\"\<Coalescence is an option for MakeEqns[\[Psi][\[Ellipsis]]]. \
Coalesence\[Rule]\[Lambda] sets the rate of coalescence in deme {x} to \
\[Lambda][{x}], scaled relative to 2N.  \>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.497629915230047*^9, 3.497629937826552*^9}, {
   3.4976299715556097`*^9, 3.4976300002856693`*^9}, {3.4976314832831306`*^9, 
   3.497631483541554*^9}, {3.4976318525913553`*^9, 3.49763185456774*^9}, {
   3.497632351711234*^9, 3.497632383439411*^9}, {3.498187415590383*^9, 
   3.498187415637122*^9}, {3.627881660084319*^9, 3.627881674477385*^9}, {
   3.6278819675306463`*^9, 3.627881988444644*^9}, {3.635238219889872*^9, 
   3.635238285639118*^9}, 3.635238343424089*^9, {3.635238374369809*^9, 
   3.635238376777821*^9}, {3.635313183358533*^9, 3.635313184925727*^9}, {
   3.63531678033641*^9, 3.635316781705367*^9}, {3.6354061482665653`*^9, 
   3.635406182677664*^9}, {3.635406737790051*^9, 3.635406803061761*^9}, {
   3.6354068990209103`*^9, 3.635406901348206*^9}, {3.6486262525026503`*^9, 
   3.648626331018236*^9}, {3.64879941891805*^9, 3.648799539324835*^9}, {
   3.648799581665966*^9, 3.648799691398391*^9}, {3.648801695511958*^9, 
   3.648801827064864*^9}, {3.648801865730854*^9, 3.6488020500822563`*^9}, {
   3.64880210122921*^9, 3.648802125531103*^9}, {3.648802674679535*^9, 
   3.648802862884204*^9}, 
   3.648802908953746*^9},ExpressionUUID->"f949fc07-bbb8-4c91-a796-\
91e4de380434"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Migration", "Subsubsection",
 CellChangeTimes->{{3.64880206863687*^9, 
  3.6488020701325912`*^9}},ExpressionUUID->"02922003-270a-4c05-ad7e-\
5b964a556504"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Migration", "::", "usage"}], "=", 
   "\"\<Migration is an option for MakeEqns[\[Psi][\[Ellipsis]]]. Migration\
\[Rule]M sets the rate of coalescence from deme {y} to deme {x}, forwards in \
time, to M[{y},{x}], scaled relative to 4N.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.497629915230047*^9, 3.497629937826552*^9}, {
   3.4976299715556097`*^9, 3.4976300002856693`*^9}, {3.4976314832831306`*^9, 
   3.497631483541554*^9}, {3.4976318525913553`*^9, 3.49763185456774*^9}, {
   3.497632351711234*^9, 3.497632383439411*^9}, {3.498187415590383*^9, 
   3.498187415637122*^9}, {3.627881660084319*^9, 3.627881674477385*^9}, {
   3.6278819675306463`*^9, 3.627881988444644*^9}, {3.635238219889872*^9, 
   3.635238285639118*^9}, 3.635238343424089*^9, {3.635238374369809*^9, 
   3.635238376777821*^9}, {3.635313183358533*^9, 3.635313184925727*^9}, {
   3.63531678033641*^9, 3.635316781705367*^9}, {3.6354061482665653`*^9, 
   3.635406182677664*^9}, {3.635406737790051*^9, 3.635406803061761*^9}, {
   3.6354068990209103`*^9, 3.635406901348206*^9}, {3.6486262525026503`*^9, 
   3.648626331018236*^9}, {3.64879941891805*^9, 3.648799539324835*^9}, {
   3.648799581665966*^9, 3.648799691398391*^9}, {3.648801695511958*^9, 
   3.648801827064864*^9}, {3.648801865730854*^9, 3.6488020500822563`*^9}, {
   3.64880210122921*^9, 3.648802125531103*^9}, {3.648802674679535*^9, 
   3.648802814482525*^9}, {3.648802943899317*^9, 3.648802998782454*^9}, {
   3.6488031770069523`*^9, 
   3.648803183181054*^9}},ExpressionUUID->"0fefccfe-082c-4f8c-a8f7-\
cb74bcc2ca4f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Splits", "Subsubsection",
 CellChangeTimes->{{3.648803207738394*^9, 
  3.648803209049933*^9}},ExpressionUUID->"66b92d20-c698-482c-8e04-\
403da9c9243e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Splits", "::", "usage"}], "=", 
   "\"\<Splits is an option for MakeEqns[\[Psi][\[Ellipsis]]].  Splits\[Rule]\
\[CapitalLambda] sets the rate of splits of the population {{x},{y}} into two \
populations {x} and {y} (forwards in time) to \[CapitalLambda][{{x},{y}}]. \
Scaled relative to 2N.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.648803211998987*^9, 
  3.648803259469643*^9}},ExpressionUUID->"68b12fe8-77ab-4c79-a2ac-\
c63daf119797"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Admixture", "Subsubsection",
 CellChangeTimes->{{3.648802076939749*^9, 
  3.648802085258667*^9}},ExpressionUUID->"c3e321dc-d8c5-49d7-ac35-\
991937c12847"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Admixture", "::", "usage"}], "=", 
   "\"\<Admixture is an option for MakeEqns[\[Psi][\[Ellipsis]]]. Admixture\
\[Rule]{{\!\(\*SubscriptBox[\(A\), \(1\)]\),\!\(\*SubscriptBox[\(a\), \
\(1\)]\)},\[Ellipsis]} sets the rate \!\(\*SubscriptBox[\(A\), \
\(i\)]\)[{y},{x}] of admixture events where there is a probability \
\!\(\*SubscriptBox[\(a\), \(i\)]\)[{y},{x}] that a lineage in {x} came from \
{y} (looking back in time). There may be multiple events, specified by the \
list. \>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.497629915230047*^9, 3.497629937826552*^9}, {
   3.4976299715556097`*^9, 3.4976300002856693`*^9}, {3.4976314832831306`*^9, 
   3.497631483541554*^9}, {3.4976318525913553`*^9, 3.49763185456774*^9}, {
   3.497632351711234*^9, 3.497632383439411*^9}, {3.498187415590383*^9, 
   3.498187415637122*^9}, {3.627881660084319*^9, 3.627881674477385*^9}, {
   3.6278819675306463`*^9, 3.627881988444644*^9}, {3.635238219889872*^9, 
   3.635238285639118*^9}, 3.635238343424089*^9, {3.635238374369809*^9, 
   3.635238376777821*^9}, {3.635313183358533*^9, 3.635313184925727*^9}, {
   3.63531678033641*^9, 3.635316781705367*^9}, {3.6354061482665653`*^9, 
   3.635406182677664*^9}, {3.635406737790051*^9, 3.635406803061761*^9}, {
   3.6354068990209103`*^9, 3.635406901348206*^9}, {3.6486262525026503`*^9, 
   3.648626331018236*^9}, {3.64879941891805*^9, 3.648799539324835*^9}, {
   3.648799581665966*^9, 3.648799691398391*^9}, {3.648801695511958*^9, 
   3.648801827064864*^9}, {3.648801865730854*^9, 3.6488020500822563`*^9}, {
   3.64880210122921*^9, 3.648802125531103*^9}, {3.648802674679535*^9, 
   3.648802814482525*^9}, {3.648802943899317*^9, 3.648802998782454*^9}, {
   3.6488031770069523`*^9, 3.648803204591975*^9}, 3.6488032677287207`*^9, {
   3.648803311410555*^9, 
   3.6488033860184517`*^9}},ExpressionUUID->"2096ac4b-28d7-4fec-906c-\
ffc532a7c012"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bottlenecks", "Subsubsection",
 CellChangeTimes->{{3.648802310175404*^9, 
  3.648802312310198*^9}},ExpressionUUID->"e0e60506-d4c3-4132-ad94-\
f69aaf0a3a10"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Bottlenecks", "::", "usage"}], "=", 
   "\"\<Bottlenecks is an option for MakeEqns[\[Psi][\[Ellipsis]]]. \
Bottlenecks\[Rule]{{\!\(\*SubscriptBox[\(B\), \(1\)]\),\!\(\*SubscriptBox[\(b\
\), \(1\)]\)},\[Ellipsis]} sets the rate \!\(\*SubscriptBox[\(B\), \
\(i\)]\)[{y},{x}] of bottlenecks, where there is a probability \
\!\(\*SubscriptBox[\(b\), \(i\)]\)[{x}] of pairwise coalescence. There may be \
multiple events, specified by the list. \>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6488033528582287`*^9, 3.64880335456995*^9}, {
  3.648803395181395*^9, 
  3.648803464794347*^9}},ExpressionUUID->"3a5cc303-cd34-4577-b564-\
ea50658806f8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["ChangeMigration", "Subsubsection",
 CellChangeTimes->{{3.6488023199971*^9, 
  3.648802323429182*^9}},ExpressionUUID->"c5de2121-0401-4872-b96c-\
e8e79e85b665"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChangeMigration", "::", "usage"}], "=", 
   "\"\<ChangeMigration is an option for MakeEqns[\[Psi][\[Ellipsis]]]. \
ChangeMigration\[Rule]{{\!\(\*SubscriptBox[\(dM\), \
\(1\)]\),\!\(\*SubscriptBox[\(M\), \(1\)]\)},\[Ellipsis]} sets the rate \
\!\(\*SubscriptBox[\(dM\), \(i\)]\)[{y},{x}] of events that change the \
migration rate from \!\(\*SubscriptBox[\(M\), \(i - 1\)]\) to \
\!\(\*SubscriptBox[\(M\), \(i\)]\). There may be multiple events, specified \
by the list. \>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6488033528582287`*^9, 3.64880335456995*^9}, {
  3.648803395181395*^9, 
  3.648803534219543*^9}},ExpressionUUID->"25e03a16-53c7-4cbc-bef3-\
558fbc55fbd3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["ChangeCoalescence", "Subsubsection",
 CellChangeTimes->{{3.6488023321801167`*^9, 
  3.648802337555428*^9}},ExpressionUUID->"5607642b-b2a2-4bc0-9070-\
9781391c0d8c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChangeCoalescence", "::", "usage"}], "=", 
   "\"\<ChangeCoalescence is an option for MakeEqns[\[Psi][\[Ellipsis]]]. \
ChangeCoalescence\[Rule]{{\!\(\*SubscriptBox[\(d\[Lambda]\), \
\(1\)]\),\!\(\*SubscriptBox[\(\[Lambda]\), \(1\)]\)},\[Ellipsis]} sets the \
rate \!\(\*SubscriptBox[\(d\[Lambda]\), \(i\)]\)[{x}] of events that change \
the rate of coalescence from \!\(\*SubscriptBox[\(\[Lambda]\), \(i - 1\)]\) \
to \!\(\*SubscriptBox[\(\[Lambda]\), \(i\)]\). There may be multiple events, \
specified by the list. \>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6488033528582287`*^9, 3.64880335456995*^9}, {
  3.648803395181395*^9, 
  3.648803584200034*^9}},ExpressionUUID->"ff4ebd12-618e-442e-8379-\
bf7cdee7d6bd"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Functions used to implement the various processes", "Subsection",
 CellChangeTimes->{{3.6488025640463*^9, 3.648802586755975*^9}, 
   3.6490671820603228`*^9, 
   3.652594912299621*^9},ExpressionUUID->"a7e6d3f1-e227-42f6-96e3-\
82391a46b518"],

Cell[CellGroupData[{

Cell["MakeBottleneck", "Subsubsection",
 CellChangeTimes->{{3.648717914202203*^9, 3.6487179190959597`*^9}, {
  3.648783307747695*^9, 3.6487833091135483`*^9}, {3.64879923875948*^9, 
  3.648799242471918*^9}},ExpressionUUID->"2385a367-0622-410d-a317-\
3a8e61eab1c6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeBottleneck", "::", "usage"}], "=", 
   "\"\<MakeBottleneck[{B,b},{{{a},{b}},{{c}},{{d}}},{{x},{y},{z}}] generates \
a list of the possible configurations caused by a bottleneck, and their \
corresponding rates.  The output has the form \
{{{{{a}},{{c},{b}},{{d}}},B[{x}]f[b[{x}]]},\[Ellipsis]}.  Each element of the \
list gives the configuration of lineages and the rates. Bottlenecks occur at \
rate B[{y},{x}], and have strength 0<b[{x}]<1, defined as the probability \
that a pair of lineages in x will coalesce during the bottleneck.  Note that \
the rate of bottleneck events is scaled relative to 2N.  The probability of a \
bottleneck at a specific time can be found by taking the inverse Laplace \
transform, as with population splits. MakeBottleneck[{B,b},{{a},{b}},{{c}}] \
applies for a single deme; the output has the form {{{a}},B[]f[b[]]}. \
Topology\[Rule]\!\(\*
StyleBox[\"top\",
FontSlant->\"Italic\"]\) restricts to a specific topology. Results are sorted \
into standard order. \>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.648711965075757*^9, 3.648712317632676*^9}, {
   3.648712449119104*^9, 3.6487124538217363`*^9}, {3.648713781155295*^9, 
   3.648713782739266*^9}, {3.648713943762807*^9, 3.648714016163431*^9}, {
   3.6487143832230177`*^9, 3.6487144362494*^9}, {3.648716210363885*^9, 
   3.6487162720707903`*^9}, {3.648716304824067*^9, 3.648716352939293*^9}, {
   3.6487179292276793`*^9, 3.648718019376854*^9}, {3.648718050401978*^9, 
   3.648718065173601*^9}, {3.648719360126845*^9, 3.648719437729246*^9}, 
   3.648723451859879*^9, {3.648724126964121*^9, 3.648724129852192*^9}, {
   3.648778793622003*^9, 3.648778903961981*^9}, {3.648783316696418*^9, 
   3.648783324066588*^9}, {3.6487835985891542`*^9, 3.648783611023573*^9}, {
   3.648784125408094*^9, 3.648784169762084*^9}, {3.6487842068033533`*^9, 
   3.648784268025663*^9}, {3.6489081682637787`*^9, 3.6489082019252872`*^9}, 
   3.6489082548329477`*^9, {3.648953363679812*^9, 3.648953383545631*^9}, {
   3.648953430558915*^9, 3.6489534541375504`*^9}, {3.64895989525825*^9, 
   3.648959947318036*^9}, {3.649055905500123*^9, 
   3.649055912114917*^9}},ExpressionUUID->"1125bfe6-c8b3-456f-aa88-\
9884fedf0bb9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "MakeBottleneck", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"Topology", "\[Rule]", "All"}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.648712323217865*^9, 3.6487124315221453`*^9}, {
   3.648712854149412*^9, 3.648712906228436*^9}, {3.648712970453657*^9, 
   3.6487130578754797`*^9}, 3.648713100929508*^9, {3.648713178188078*^9, 
   3.648713184857809*^9}, {3.6487136173356543`*^9, 3.648713630436952*^9}, 
   3.648713785883741*^9, {3.648714069573851*^9, 3.648714164479802*^9}, {
   3.648714208885893*^9, 3.648714273543227*^9}, {3.648714309596192*^9, 
   3.648714314771818*^9}, {3.648714345497714*^9, 3.648714362776493*^9}, {
   3.648714395207748*^9, 3.6487144091442327`*^9}, {3.6487156518497677`*^9, 
   3.648715655745668*^9}, {3.64871628373491*^9, 3.648716291064543*^9}, {
   3.64871636821373*^9, 3.6487165060092707`*^9}, 3.6487165772675323`*^9, {
   3.648716631679757*^9, 3.6487166328209467`*^9}, 3.648717192104677*^9, 
   3.648717931973507*^9, {3.648723485129384*^9, 3.648723486577351*^9}, {
   3.648724110902463*^9, 3.648724135611265*^9}, {3.648725300091943*^9, 
   3.648725316462558*^9}, {3.64877881839712*^9, 3.648778837409709*^9}, 
   3.648778911062771*^9, {3.648778963748617*^9, 3.648779087838338*^9}, {
   3.648779120006361*^9, 3.648779156284692*^9}, {3.648780255827937*^9, 
   3.648780287795011*^9}, {3.648781444204153*^9, 3.648781512709565*^9}, 
   3.648783319232587*^9, {3.648784303294201*^9, 3.6487843532683783`*^9}, {
   3.648790182742812*^9, 3.648790228226532*^9}, {3.64879026593748*^9, 
   3.648790327490911*^9}, {3.64879055944718*^9, 3.648790564588488*^9}, {
   3.648790688190714*^9, 3.6487907078266153`*^9}, {3.648790830673255*^9, 
   3.648790950181322*^9}, {3.6489534731701393`*^9, 
   3.648953486314912*^9}},ExpressionUUID->"1f5adf99-f571-4c82-ab15-\
f2ae038a50fe"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeBottleneck", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"B_", ",", "b_"}], "}"}], ",", 
     RowBox[{"xl", ":", 
      RowBox[{"{", "___List", "}"}]}], ",", "opts___Rule"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tp", "=", 
       RowBox[{
        RowBox[{"Topology", "/.", 
         RowBox[{"{", "opts", "}"}]}], "/.", 
        RowBox[{"Options", "[", "MakeBottleneck", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         ",", 
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
          RowBox[{"B", "[", "]"}]}]}], "}"}], "&"}], "/@", 
      RowBox[{"BottleneckedLineages", "[", 
       RowBox[{"xl", ",", "b", ",", "tp"}], "]"}]}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.648712323217865*^9, 3.6487124315221453`*^9}, {
   3.648712854149412*^9, 3.648712906228436*^9}, {3.648712970453657*^9, 
   3.6487130578754797`*^9}, 3.648713100929508*^9, {3.648713178188078*^9, 
   3.648713184857809*^9}, {3.6487136173356543`*^9, 3.648713630436952*^9}, 
   3.648713785883741*^9, {3.648714069573851*^9, 3.648714164479802*^9}, {
   3.648714208885893*^9, 3.648714273543227*^9}, {3.648714309596192*^9, 
   3.648714314771818*^9}, {3.648714345497714*^9, 3.648714362776493*^9}, {
   3.648714395207748*^9, 3.6487144091442327`*^9}, {3.6487156518497677`*^9, 
   3.648715655745668*^9}, {3.64871628373491*^9, 3.648716291064543*^9}, {
   3.64871636821373*^9, 3.6487165060092707`*^9}, 3.6487165772675323`*^9, {
   3.648716631679757*^9, 3.6487166328209467`*^9}, 3.648717192104677*^9, 
   3.648717931973507*^9, {3.648723485129384*^9, 3.648723486577351*^9}, {
   3.648724110902463*^9, 3.648724135611265*^9}, {3.648725300091943*^9, 
   3.648725316462558*^9}, {3.64877881839712*^9, 3.648778837409709*^9}, 
   3.648778911062771*^9, {3.648778963748617*^9, 3.648779087838338*^9}, {
   3.648779120006361*^9, 3.648779156284692*^9}, {3.648780255827937*^9, 
   3.648780287795011*^9}, {3.648781444204153*^9, 3.648781512709565*^9}, 
   3.648783319232587*^9, {3.648784303294201*^9, 3.6487843532683783`*^9}, {
   3.648790182742812*^9, 3.648790228226532*^9}, {3.64879026593748*^9, 
   3.648790327490911*^9}, {3.64879055944718*^9, 3.648790564588488*^9}, {
   3.648790688190714*^9, 3.6487907078266153`*^9}, {3.648790830673255*^9, 
   3.648790950181322*^9}, {3.648959286609779*^9, 3.648959323317861*^9}, {
   3.648959829387162*^9, 3.648959839229848*^9}, {3.6489598801685133`*^9, 
   3.648959888377335*^9}, {3.6489601586489153`*^9, 3.648960192636162*^9}, {
   3.6489603720385838`*^9, 3.64896040966503*^9}, {3.648973450708137*^9, 
   3.648973451294551*^9}, 
   3.649055895495947*^9},ExpressionUUID->"f8a7b838-1c5e-4c84-a6c6-\
2ba93d622e8d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeBottleneck", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"B_", ",", "b_"}], "}"}], ",", 
     RowBox[{"xl", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "___List", "}"}], ".."}], "}"}]}], ",", 
     RowBox[{"dl", ":", 
      RowBox[{"{", "___List", "}"}]}], ",", "opts___Rule"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"nd", "=", 
        RowBox[{"Length", "[", "dl", "]"}]}], ",", 
       RowBox[{"tp", "=", 
        RowBox[{
         RowBox[{"Topology", "/.", 
          RowBox[{"{", "opts", "}"}]}], "/.", 
         RowBox[{"Options", "[", "MakeBottleneck", "]"}]}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", " ", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "xl", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
            "\[Equal]", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"xl", ",", 
              RowBox[{"B", "[", 
               RowBox[{
               "dl", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
               "]"}]}], "}"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ReplacePart", "[", 
                RowBox[{"xl", ",", 
                 RowBox[{"{", 
                  RowBox[{"i", "\[Rule]", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "}"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                RowBox[{"B", "[", 
                 RowBox[{
                 "dl", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
                  "]"}]}]}], "}"}], "&"}], "/@", 
            RowBox[{"BottleneckedLineages", "[", 
             RowBox[{
              RowBox[{
              "xl", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{"b", "[", 
               RowBox[{
               "dl", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
               "]"}], ",", "tp"}], "]"}]}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nd"}], "}"}]}], "]"}], ",", "1"}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.648712323217865*^9, 3.6487124315221453`*^9}, {
   3.648712854149412*^9, 3.648712906228436*^9}, {3.648712970453657*^9, 
   3.6487130578754797`*^9}, 3.648713100929508*^9, {3.648713178188078*^9, 
   3.648713184857809*^9}, {3.6487136173356543`*^9, 3.648713630436952*^9}, 
   3.648713785883741*^9, {3.648714069573851*^9, 3.648714164479802*^9}, {
   3.648714208885893*^9, 3.648714273543227*^9}, {3.648714309596192*^9, 
   3.648714314771818*^9}, {3.648714345497714*^9, 3.648714362776493*^9}, {
   3.648714395207748*^9, 3.6487144091442327`*^9}, {3.6487156518497677`*^9, 
   3.648715655745668*^9}, {3.64871628373491*^9, 3.648716291064543*^9}, {
   3.64871636821373*^9, 3.6487165060092707`*^9}, 3.6487165772675323`*^9, {
   3.648716631679757*^9, 3.6487166328209467`*^9}, 3.648717192104677*^9, 
   3.648717931973507*^9, {3.648723485129384*^9, 3.648723486577351*^9}, {
   3.648724110902463*^9, 3.648724135611265*^9}, {3.648725300091943*^9, 
   3.648725316462558*^9}, {3.64877881839712*^9, 3.648778837409709*^9}, 
   3.648778911062771*^9, {3.648778963748617*^9, 3.648779087838338*^9}, {
   3.648779120006361*^9, 3.648779156284692*^9}, {3.648780255827937*^9, 
   3.648780287795011*^9}, {3.648781444204153*^9, 3.648781512709565*^9}, 
   3.648783319232587*^9, {3.648784303294201*^9, 3.6487843532683783`*^9}, {
   3.648790182742812*^9, 3.648790228226532*^9}, {3.64879026593748*^9, 
   3.648790327490911*^9}, {3.64879055944718*^9, 3.648790564588488*^9}, {
   3.648790688190714*^9, 3.6487907078266153`*^9}, {3.648790830673255*^9, 
   3.648790950181322*^9}, {3.648959286609779*^9, 3.648959323317861*^9}, {
   3.648959988273478*^9, 3.6489600325396347`*^9}, {3.6489601273661203`*^9, 
   3.64896014345492*^9}, 
   3.649056252703436*^9},ExpressionUUID->"56ba8e01-60fc-48c2-969a-\
b7fc456c277c"],

Cell[BoxData[
 RowBox[{"BottleneckedLineages", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "a", "}"}], ",", 
     RowBox[{"{", "b", "}"}]}], "}"}], ",", 
   RowBox[{"b", "[", 
    RowBox[{"{", "x", "}"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.649057473386284*^9, 
  3.649057494626234*^9}},ExpressionUUID->"ba439269-4c19-4666-9240-\
785ca38b6c77"],

Cell[BoxData[
 RowBox[{"MakeBottleneck", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["B", "1"], ",", 
     SubscriptBox["b", "1"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "a", "}"}], ",", 
       RowBox[{"{", "b", "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "c", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "x", "}"}], ",", 
     RowBox[{"{", "y", "}"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.649057426630265*^9, 
  3.6490574406383343`*^9}},ExpressionUUID->"c2583a5b-472a-4def-b161-\
295225782597"],

Cell[TextData[{
 StyleBox["Example: ",
  FontWeight->"Bold"],
 "This lists the possible configurations before the bottleneck, and their \
associated probabilities:"
}], "Text",
 CellChangeTimes->{{3.648969229513233*^9, 
  3.648969284819544*^9}},ExpressionUUID->"379636ec-7686-4a36-a203-\
a459c073c22f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{
   RowBox[{"MakeBottleneck", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"B", ",", "b"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "a", "}"}], ",", 
       RowBox[{"{", "b", "}"}], ",", 
       RowBox[{"{", "c", "}"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"TableDepth", "\[Rule]", "2"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6489602026226463`*^9, 3.64896021092552*^9}, {
  3.648960553191712*^9, 
  3.648960593310351*^9}},ExpressionUUID->"4fa55ef0-4f0c-444b-b460-\
5e54ac5f52d9"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "a", "}"}], ",", 
       RowBox[{"{", "b", "}"}], ",", 
       RowBox[{"{", "c", "}"}]}], "}"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "-", "b"}], ")"}], "3"]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "c", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}]}], "}"}], 
     RowBox[{
      FractionBox["1", "3"], " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{"3", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", "b"}], ")"}]}], "2"], "-", 
        RowBox[{
         FractionBox["3", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", "b"}], ")"}], "3"]}]}], ")"}]}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "b", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "c"}], "}"}]}], "}"}], 
     RowBox[{
      FractionBox["1", "3"], " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{"3", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", "b"}], ")"}]}], "2"], "-", 
        RowBox[{
         FractionBox["3", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", "b"}], ")"}], "3"]}]}], ")"}]}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "a", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", "c"}], "}"}]}], "}"}], 
     RowBox[{
      FractionBox["1", "3"], " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{"3", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", "b"}], ")"}]}], "2"], "-", 
        RowBox[{
         FractionBox["3", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", "b"}], ")"}], "3"]}]}], ")"}]}]},
    {
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"a", ",", "b", ",", "c"}], "}"}], "}"}], 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{"3", " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", "b"}], ")"}]}], "2"], "+", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "b"}], ")"}], "3"]}]}]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$, TableDepth -> 2]]]], "Output",
 CellChangeTimes->{
  3.6489602111149797`*^9, {3.648960572139133*^9, 3.6489605938456793`*^9}, 
   3.648969162672803*^9},ExpressionUUID->"0f08b3b8-43ad-4c20-9a80-\
90099181c633"]
}, Open  ]],

Cell["This restricts to one topology:", "Text",
 CellChangeTimes->{{3.648969288842849*^9, 
  3.648969299106696*^9}},ExpressionUUID->"0c3c2463-3fbd-496f-bdc4-\
071f4ff1075e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{
   RowBox[{"MakeBottleneck", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"B", ",", "b"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "a", "}"}], ",", 
       RowBox[{"{", "b", "}"}], ",", 
       RowBox[{"{", "c", "}"}]}], "}"}], ",", 
     RowBox[{"Topology", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}], ",", "c"}], "}"}]}]}], "]"}], ",", 
   RowBox[{"TableDepth", "\[Rule]", "2"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6489602026226463`*^9, 3.64896021092552*^9}, {
  3.648960553191712*^9, 
  3.648960620675397*^9}},ExpressionUUID->"a8eb518b-2a29-42f6-ac53-\
b65d97808050"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "a", "}"}], ",", 
       RowBox[{"{", "b", "}"}], ",", 
       RowBox[{"{", "c", "}"}]}], "}"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "-", "b"}], ")"}], "3"]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "c", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}]}], "}"}], 
     RowBox[{
      FractionBox["1", "3"], " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{"3", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", "b"}], ")"}]}], "2"], "-", 
        RowBox[{
         FractionBox["3", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", "b"}], ")"}], "3"]}]}], ")"}]}]},
    {
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"a", ",", "b", ",", "c"}], "}"}], "}"}], 
     RowBox[{
      FractionBox["1", "3"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        FractionBox[
         RowBox[{"3", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", "b"}], ")"}]}], "2"], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", "b"}], ")"}], "3"]}]}], ")"}]}]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$, TableDepth -> 2]]]], "Output",
 CellChangeTimes->{3.648960621746379*^9, 
  3.6489691728733397`*^9},ExpressionUUID->"4a94a71c-d435-4461-98f6-\
aee3f01a79d7"]
}, Open  ]],

Cell[TextData[{
 StyleBox["Example: ",
  FontWeight->"Bold"],
 "This lists all the configurations that can be generated by various \
bottlenecks across three demes.  Usually, we will only be interested in one \
or a few bottlenecks; this is achieved later, by simplifying the equations by \
deleting unwanted ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"B", "'"}], "s"}], TraditionalForm]],ExpressionUUID->
  "1b676b47-238c-4cef-985d-2e384f122f9f"],
 ".  Generating the full equations takes negligible time and memory, so this \
is not expensive."
}], "Text",
 CellChangeTimes->{{3.648782633785327*^9, 3.6487826354486923`*^9}, {
  3.6487829483014183`*^9, 3.648782996470952*^9}, {3.648783061944872*^9, 
  3.6487831872056828`*^9}, {3.648784363407528*^9, 3.648784365278183*^9}, {
  3.648969309856687*^9, 
  3.6489693270330276`*^9}},ExpressionUUID->"43378933-dfdb-42bb-ba48-\
f6c3836b0e36"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{
   RowBox[{"MakeBottleneck", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"B", ",", "b"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "b", "}"}], ",", 
         RowBox[{"{", "c", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "d", "}"}], "}"}], ",", 
       RowBox[{"{", "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "x", "}"}], ",", 
       RowBox[{"{", "y", "}"}], ",", 
       RowBox[{"{", "z", "}"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"TableDepth", "\[Rule]", "2"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6487905763523693`*^9, 3.648790628401348*^9}, {
  3.648791308576571*^9, 
  3.6487913182255774`*^9}},ExpressionUUID->"e5d1c99c-f8c2-4e9d-8419-\
234cdb86efbe"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "b", "}"}], ",", 
         RowBox[{"{", "c", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "d", "}"}], "}"}], ",", 
       RowBox[{"{", "}"}]}], "}"}], 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"b", "[", 
          RowBox[{"{", "x", "}"}], "]"}]}], ")"}], "3"], " ", 
      RowBox[{"B", "[", 
       RowBox[{"{", "x", "}"}], "]"}]}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "c", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "d", "}"}], "}"}], ",", 
       RowBox[{"{", "}"}]}], "}"}], 
     RowBox[{
      FractionBox["1", "3"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         FractionBox["3", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"b", "[", 
            RowBox[{"{", "x", "}"}], "]"}]}], ")"}]}], "-", 
        RowBox[{
         FractionBox["3", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"b", "[", 
             RowBox[{"{", "x", "}"}], "]"}]}], ")"}], "3"]}]}], ")"}], " ", 
      RowBox[{"B", "[", 
       RowBox[{"{", "x", "}"}], "]"}]}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "b", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "c"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "d", "}"}], "}"}], ",", 
       RowBox[{"{", "}"}]}], "}"}], 
     RowBox[{
      FractionBox["1", "3"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         FractionBox["3", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"b", "[", 
            RowBox[{"{", "x", "}"}], "]"}]}], ")"}]}], "-", 
        RowBox[{
         FractionBox["3", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"b", "[", 
             RowBox[{"{", "x", "}"}], "]"}]}], ")"}], "3"]}]}], ")"}], " ", 
      RowBox[{"B", "[", 
       RowBox[{"{", "x", "}"}], "]"}]}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "c"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "d", "}"}], "}"}], ",", 
       RowBox[{"{", "}"}]}], "}"}], 
     RowBox[{
      FractionBox["1", "3"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         FractionBox["3", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"b", "[", 
            RowBox[{"{", "x", "}"}], "]"}]}], ")"}]}], "-", 
        RowBox[{
         FractionBox["3", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"b", "[", 
             RowBox[{"{", "x", "}"}], "]"}]}], ")"}], "3"]}]}], ")"}], " ", 
      RowBox[{"B", "[", 
       RowBox[{"{", "x", "}"}], "]"}]}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"a", ",", "b", ",", "c"}], "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "d", "}"}], "}"}], ",", 
       RowBox[{"{", "}"}]}], "}"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{
         FractionBox["3", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"b", "[", 
            RowBox[{"{", "x", "}"}], "]"}]}], ")"}]}], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"b", "[", 
             RowBox[{"{", "x", "}"}], "]"}]}], ")"}], "3"]}]}], ")"}], " ", 
      RowBox[{"B", "[", 
       RowBox[{"{", "x", "}"}], "]"}]}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "b", "}"}], ",", 
         RowBox[{"{", "c", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "d", "}"}], "}"}], ",", 
       RowBox[{"{", "}"}]}], "}"}], 
     RowBox[{"B", "[", 
      RowBox[{"{", "y", "}"}], "]"}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "b", "}"}], ",", 
         RowBox[{"{", "c", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "d", "}"}], "}"}], ",", 
       RowBox[{"{", "}"}]}], "}"}], 
     RowBox[{"B", "[", 
      RowBox[{"{", "z", "}"}], "]"}]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$, TableDepth -> 2]]]], "Output",
 CellChangeTimes->{{3.648790586094584*^9, 3.6487906286282463`*^9}, 
   3.648790898149948*^9, {3.648790928891411*^9, 3.648790954635434*^9}, 
   3.648791318936144*^9, 
   3.648969187586834*^9},ExpressionUUID->"900f068a-382b-45f1-926c-\
5d74cdf5aa4d"]
}, Open  ]],

Cell["\<\
This counts only events that are consistent with the given topology:\
\>", "Text",
 CellChangeTimes->{{3.648969792715454*^9, 
  3.6489698309838753`*^9}},ExpressionUUID->"282e5df0-4baa-477f-ac82-\
e4dc7f87371b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{
   RowBox[{"MakeBottleneck", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"B", ",", "b"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "b", "}"}], ",", 
         RowBox[{"{", "c", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "d", "}"}], "}"}], ",", 
       RowBox[{"{", "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "x", "}"}], ",", 
       RowBox[{"{", "y", "}"}], ",", 
       RowBox[{"{", "z", "}"}]}], "}"}], ",", 
     RowBox[{"Topology", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"c", ",", "d"}], "}"}]}], "}"}]}]}], "]"}], ",", 
   RowBox[{"TableDepth", "\[Rule]", "2"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6487905763523693`*^9, 3.648790628401348*^9}, {
  3.648791308576571*^9, 3.6487913182255774`*^9}, {3.648969199326887*^9, 
  3.648969211866556*^9}},ExpressionUUID->"de43f6bd-41d2-4a05-b34a-\
9474187a63ad"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "b", "}"}], ",", 
         RowBox[{"{", "c", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "d", "}"}], "}"}], ",", 
       RowBox[{"{", "}"}]}], "}"}], 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"b", "[", 
          RowBox[{"{", "x", "}"}], "]"}]}], ")"}], "3"], " ", 
      RowBox[{"B", "[", 
       RowBox[{"{", "x", "}"}], "]"}]}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "c", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "d", "}"}], "}"}], ",", 
       RowBox[{"{", "}"}]}], "}"}], 
     RowBox[{
      FractionBox["1", "3"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         FractionBox["3", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"b", "[", 
            RowBox[{"{", "x", "}"}], "]"}]}], ")"}]}], "-", 
        RowBox[{
         FractionBox["3", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"b", "[", 
             RowBox[{"{", "x", "}"}], "]"}]}], ")"}], "3"]}]}], ")"}], " ", 
      RowBox[{"B", "[", 
       RowBox[{"{", "x", "}"}], "]"}]}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "b", "}"}], ",", 
         RowBox[{"{", "c", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "d", "}"}], "}"}], ",", 
       RowBox[{"{", "}"}]}], "}"}], 
     RowBox[{"B", "[", 
      RowBox[{"{", "y", "}"}], "]"}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "b", "}"}], ",", 
         RowBox[{"{", "c", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "d", "}"}], "}"}], ",", 
       RowBox[{"{", "}"}]}], "}"}], 
     RowBox[{"B", "[", 
      RowBox[{"{", "z", "}"}], "]"}]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$, TableDepth -> 2]]]], "Output",
 CellChangeTimes->{
  3.648969212853901*^9},ExpressionUUID->"6222dcc8-a13e-4568-b8f8-\
eaa1bf5289fe"]
}, Open  ]],

Cell[TextData[{
 StyleBox["Note: ",
  FontWeight->"Bold"],
 "there is a rate associated even with events that do not alter the \
configuration of lineages, or affect empty demes (e.g. first and last entries \
above).  This is because bottlenecks occur only once, and so alter the GF \
even if they do not alter the configuration of lineages."
}], "Text",
 CellChangeTimes->{{3.648969347333029*^9, 3.648969354061413*^9}, {
  3.6489696656178217`*^9, 
  3.648969787796858*^9}},ExpressionUUID->"221b6dc2-d3d9-40ab-a3b3-\
8068fba1fc76"],

Cell[TextData[{
 StyleBox["Note: ",
  FontWeight->"Bold"],
 " \[NonBreakingSpace]There is some probability that the configuration of \
lineages before the event is the same as after (using \[OpenCurlyQuote]before\
\[CloseCurlyQuote] and \[OpenCurlyQuote]after\[CloseCurlyQuote] in the proper \
sense here). \[NonBreakingSpace]However, these events do need to be counted \
in the recursion.  The GF before is in fact different, because there is no \
longer the possibility of a bottleneck: this is altered by MakeEqns in the \
list of pending events.  In this example, results are given even for deme ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", "z", "}"}], TraditionalForm]],ExpressionUUID->
  "0535fd13-4bfd-4535-9e29-dc26e9981912"],
 ", which has no lineages.  However, lineages might migrate into it (looking \
back in time), so that it is important to track whether the bottleneck has \
already occurred there."
}], "Text",
 CellChangeTimes->{{3.648782496791954*^9, 3.648782582981698*^9}, 
   3.648782621802106*^9, {3.648783027236011*^9, 3.648783041515235*^9}, 
   3.648784111622707*^9, {3.648784291718012*^9, 3.648784293540917*^9}, {
   3.648791337192116*^9, 3.6487914029048157`*^9}, {3.651907503398057*^9, 
   3.651907508237715*^9}},ExpressionUUID->"dfab4f1b-8e39-4040-b86f-\
dd88531ad18c"],

Cell[TextData[{
 StyleBox["Note: ",
  FontWeight->"Bold"],
 " \[NonBreakingSpace]Restriction to a topology has to be done using an \
option, rather than an argument in the function, because otherwise there \
would be an ambiguity between the forms for one deme and multiple demes."
}], "Text",
 CellChangeTimes->{{3.648908408399805*^9, 3.64890842698976*^9}, {
  3.64895860765024*^9, 3.648958651283763*^9}, {3.648959264346942*^9, 
  3.648959278576827*^9}},ExpressionUUID->"2e0c8d98-9418-434f-9ec4-\
5d4ae80196ee"]
}, Open  ]],

Cell[CellGroupData[{

Cell["MakeAdmixture", "Subsubsection",
 CellChangeTimes->{{3.648717914202203*^9, 
  3.6487179190959597`*^9}},ExpressionUUID->"6f1dd9fb-4945-48dc-b29c-\
8d32d9872a5f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeAdmixture", "::", "usage"}], "=", 
   "\"\<MakeAdmixture[{A,a},{{{a},{b}},{{c}},{{d}}},{{x},{y},{z}}] generates \
a list of the possible configurations caused by admixture, and their \
corresponding rates.  The output has the form \
{{{{{a}},{{c},{b}},{{d}}},A[{y},{x}]f[a[{y},{x}]]},\[Ellipsis]}.  Each \
element of the list gives the configuration of lineages and the rates. \
Admixture A[{y},{x}] is from {y} to {x}.  Admixture events occur at rate \
A[{y},{x}], and have strength 0<a[{y},{x}]<1, defined as the probability that \
a lineage in x will have come from y.  Note that the rate of admixture events \
is scaled relative to 2N.  The probability of admixture at a specific time \
can be found by taking the inverse Laplace transform, as with population \
splits.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.648711965075757*^9, 3.648712317632676*^9}, {
   3.648712449119104*^9, 3.6487124538217363`*^9}, {3.648713781155295*^9, 
   3.648713782739266*^9}, {3.648713943762807*^9, 3.648714016163431*^9}, {
   3.6487143832230177`*^9, 3.6487144362494*^9}, {3.648716210363885*^9, 
   3.6487162720707903`*^9}, {3.648716304824067*^9, 3.648716352939293*^9}, {
   3.6487179292276793`*^9, 3.648718019376854*^9}, {3.648718050401978*^9, 
   3.648718065173601*^9}, {3.648719360126845*^9, 3.648719437729246*^9}, 
   3.648723451859879*^9, {3.648724126964121*^9, 3.648724129852192*^9}, {
   3.648778793622003*^9, 3.648778903961981*^9}, {3.648784073961207*^9, 
   3.6487841000006933`*^9}},ExpressionUUID->"c00e4666-d602-44f4-92ad-\
35280df039e2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeAdmixture", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"A_", ",", "a_"}], "}"}], ",", 
     RowBox[{"xl", ":", 
      RowBox[{"{", "___List", "}"}]}], ",", 
     RowBox[{"dl", ":", 
      RowBox[{"{", "___List", "}"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "j", ",", "k", ",", 
       RowBox[{"nd", "=", 
        RowBox[{"Length", "[", "dl", "]"}]}], ",", "nlj"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"DeleteCases", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", " ", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "\[Equal]", "j"}], ",", "0", ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"k", "=", 
                  RowBox[{"Length", "[", "#", "]"}]}], ";", 
                 RowBox[{"nlj", "=", 
                  RowBox[{"Length", "[", 
                   RowBox[{
                   "xl", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Sort", "[", 
                    RowBox[{"Sort", "/@", "#"}], "]"}], "&"}], "/@", 
                    RowBox[{"ReplacePart", "[", 
                    RowBox[{"xl", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"j", "\[Rule]", 
                    RowBox[{"TakeAway", "[", 
                    RowBox[{
                    RowBox[{
                    "xl", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], ",", "#"}], "]"}]}], ",", 
                    RowBox[{"i", "->", 
                    RowBox[{"Join", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    "xl", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], "]"}]}]}], "}"}]}], "]"}]}], 
                   ",", 
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"a", "[", 
                    RowBox[{
                    RowBox[{
                    "dl", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "dl", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}]}], "]"}], "k"], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"a", "[", 
                    RowBox[{
                    RowBox[{
                    "dl", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "dl", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ")"}], 
                    RowBox[{"nlj", "-", "k"}]], 
                    RowBox[{"A", "[", 
                    RowBox[{
                    RowBox[{
                    "dl", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "dl", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}]}], "]"}]}]}], "}"}]}], ")"}], 
               "&"}], "/@", 
              RowBox[{"Subsets", "[", 
               RowBox[{
               "xl", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
               "]"}]}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nd"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "nd"}], "}"}]}], "]"}], ",", "2"}], "]"}], ",", 
       "0"}], "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.651405396210828*^9},ExpressionUUID->"3e74101a-4587-4feb-9f56-\
e5f4c7fae8f4"],

Cell[TextData[{
 StyleBox["Example: ",
  FontWeight->"Bold"],
 "This lists all the configurations that can be generated by various \
admixture events.  Usually, we will only be interested in one or a few \
admixtures; this is achieved later, by simplifying the equations by deleting \
unwanted ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"A", "'"}], "s"}], TraditionalForm]],ExpressionUUID->
  "fe0ff6d6-2cb6-4657-b50a-52f3fe3f32bf"],
 ".  Generating the full equations takes negligible time and memory, so this \
is not expensive."
}], "Text",
 CellChangeTimes->{{3.648782633785327*^9, 3.6487826354486923`*^9}, {
  3.6487829483014183`*^9, 3.648782996470952*^9}, {3.648783061944872*^9, 
  3.6487831872056828`*^9}},ExpressionUUID->"e39d57c7-8ce2-446d-85cd-\
bdaec2990d4d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{
   RowBox[{"MakeAdmixture", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"A", ",", "a"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "b", "}"}], ",", 
         RowBox[{"{", "c", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "d", "}"}], "}"}], ",", 
       RowBox[{"{", "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "x", "}"}], ",", 
       RowBox[{"{", "y", "}"}], ",", 
       RowBox[{"{", "z", "}"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"TableDepth", "\[Rule]", "2"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.648724137612606*^9, 3.648724399084942*^9}, {
  3.648725497101365*^9, 3.6487254972288857`*^9}, {3.648780309580714*^9, 
  3.648780358027919*^9}},ExpressionUUID->"51e88353-c1b8-42ab-b587-\
1e7afbee6ec4"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "b", "}"}], ",", 
         RowBox[{"{", "c", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "d", "}"}], "}"}], ",", 
       RowBox[{"{", "}"}]}], "}"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"a", "[", 
         RowBox[{
          RowBox[{"{", "x", "}"}], ",", 
          RowBox[{"{", "y", "}"}]}], "]"}]}], ")"}], " ", 
      RowBox[{"A", "[", 
       RowBox[{
        RowBox[{"{", "x", "}"}], ",", 
        RowBox[{"{", "y", "}"}]}], "]"}]}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "b", "}"}], ",", 
         RowBox[{"{", "c", "}"}], ",", 
         RowBox[{"{", "d", "}"}]}], "}"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}]}], "}"}], 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{
        RowBox[{"{", "x", "}"}], ",", 
        RowBox[{"{", "y", "}"}]}], "]"}], " ", 
      RowBox[{"A", "[", 
       RowBox[{
        RowBox[{"{", "x", "}"}], ",", 
        RowBox[{"{", "y", "}"}]}], "]"}]}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "b", "}"}], ",", 
         RowBox[{"{", "c", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "d", "}"}], "}"}], ",", 
       RowBox[{"{", "}"}]}], "}"}], 
     RowBox[{"A", "[", 
      RowBox[{
       RowBox[{"{", "x", "}"}], ",", 
       RowBox[{"{", "z", "}"}]}], "]"}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "b", "}"}], ",", 
         RowBox[{"{", "c", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "d", "}"}], "}"}], ",", 
       RowBox[{"{", "}"}]}], "}"}], 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"a", "[", 
          RowBox[{
           RowBox[{"{", "y", "}"}], ",", 
           RowBox[{"{", "x", "}"}]}], "]"}]}], ")"}], "3"], " ", 
      RowBox[{"A", "[", 
       RowBox[{
        RowBox[{"{", "y", "}"}], ",", 
        RowBox[{"{", "x", "}"}]}], "]"}]}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "b", "}"}], ",", 
         RowBox[{"{", "c", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "d", "}"}]}], "}"}], ",", 
       RowBox[{"{", "}"}]}], "}"}], 
     RowBox[{"3", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"a", "[", 
          RowBox[{
           RowBox[{"{", "y", "}"}], ",", 
           RowBox[{"{", "x", "}"}]}], "]"}]}], ")"}], "2"], " ", 
      RowBox[{"a", "[", 
       RowBox[{
        RowBox[{"{", "y", "}"}], ",", 
        RowBox[{"{", "x", "}"}]}], "]"}], " ", 
      RowBox[{"A", "[", 
       RowBox[{
        RowBox[{"{", "y", "}"}], ",", 
        RowBox[{"{", "x", "}"}]}], "]"}]}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "c", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "b", "}"}], ",", 
         RowBox[{"{", "d", "}"}]}], "}"}], ",", 
       RowBox[{"{", "}"}]}], "}"}], 
     RowBox[{"3", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"a", "[", 
          RowBox[{
           RowBox[{"{", "y", "}"}], ",", 
           RowBox[{"{", "x", "}"}]}], "]"}]}], ")"}], "2"], " ", 
      RowBox[{"a", "[", 
       RowBox[{
        RowBox[{"{", "y", "}"}], ",", 
        RowBox[{"{", "x", "}"}]}], "]"}], " ", 
      RowBox[{"A", "[", 
       RowBox[{
        RowBox[{"{", "y", "}"}], ",", 
        RowBox[{"{", "x", "}"}]}], "]"}]}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "b", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "c", "}"}], ",", 
         RowBox[{"{", "d", "}"}]}], "}"}], ",", 
       RowBox[{"{", "}"}]}], "}"}], 
     RowBox[{"3", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"a", "[", 
          RowBox[{
           RowBox[{"{", "y", "}"}], ",", 
           RowBox[{"{", "x", "}"}]}], "]"}]}], ")"}], "2"], " ", 
      RowBox[{"a", "[", 
       RowBox[{
        RowBox[{"{", "y", "}"}], ",", 
        RowBox[{"{", "x", "}"}]}], "]"}], " ", 
      RowBox[{"A", "[", 
       RowBox[{
        RowBox[{"{", "y", "}"}], ",", 
        RowBox[{"{", "x", "}"}]}], "]"}]}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", "c", "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "b", "}"}], ",", 
         RowBox[{"{", "d", "}"}]}], "}"}], ",", 
       RowBox[{"{", "}"}]}], "}"}], 
     RowBox[{"3", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"a", "[", 
         RowBox[{
          RowBox[{"{", "y", "}"}], ",", 
          RowBox[{"{", "x", "}"}]}], "]"}]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", 
        RowBox[{
         RowBox[{"{", "y", "}"}], ",", 
         RowBox[{"{", "x", "}"}]}], "]"}], "2"], " ", 
      RowBox[{"A", "[", 
       RowBox[{
        RowBox[{"{", "y", "}"}], ",", 
        RowBox[{"{", "x", "}"}]}], "]"}]}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", "b", "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "c", "}"}], ",", 
         RowBox[{"{", "d", "}"}]}], "}"}], ",", 
       RowBox[{"{", "}"}]}], "}"}], 
     RowBox[{"3", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"a", "[", 
         RowBox[{
          RowBox[{"{", "y", "}"}], ",", 
          RowBox[{"{", "x", "}"}]}], "]"}]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", 
        RowBox[{
         RowBox[{"{", "y", "}"}], ",", 
         RowBox[{"{", "x", "}"}]}], "]"}], "2"], " ", 
      RowBox[{"A", "[", 
       RowBox[{
        RowBox[{"{", "y", "}"}], ",", 
        RowBox[{"{", "x", "}"}]}], "]"}]}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", "a", "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "b", "}"}], ",", 
         RowBox[{"{", "c", "}"}], ",", 
         RowBox[{"{", "d", "}"}]}], "}"}], ",", 
       RowBox[{"{", "}"}]}], "}"}], 
     RowBox[{"3", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"a", "[", 
         RowBox[{
          RowBox[{"{", "y", "}"}], ",", 
          RowBox[{"{", "x", "}"}]}], "]"}]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", 
        RowBox[{
         RowBox[{"{", "y", "}"}], ",", 
         RowBox[{"{", "x", "}"}]}], "]"}], "2"], " ", 
      RowBox[{"A", "[", 
       RowBox[{
        RowBox[{"{", "y", "}"}], ",", 
        RowBox[{"{", "x", "}"}]}], "]"}]}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "b", "}"}], ",", 
         RowBox[{"{", "c", "}"}], ",", 
         RowBox[{"{", "d", "}"}]}], "}"}], ",", 
       RowBox[{"{", "}"}]}], "}"}], 
     RowBox[{
      SuperscriptBox[
       RowBox[{"a", "[", 
        RowBox[{
         RowBox[{"{", "y", "}"}], ",", 
         RowBox[{"{", "x", "}"}]}], "]"}], "3"], " ", 
      RowBox[{"A", "[", 
       RowBox[{
        RowBox[{"{", "y", "}"}], ",", 
        RowBox[{"{", "x", "}"}]}], "]"}]}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "b", "}"}], ",", 
         RowBox[{"{", "c", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "d", "}"}], "}"}], ",", 
       RowBox[{"{", "}"}]}], "}"}], 
     RowBox[{"A", "[", 
      RowBox[{
       RowBox[{"{", "y", "}"}], ",", 
       RowBox[{"{", "z", "}"}]}], "]"}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "b", "}"}], ",", 
         RowBox[{"{", "c", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "d", "}"}], "}"}], ",", 
       RowBox[{"{", "}"}]}], "}"}], 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"a", "[", 
          RowBox[{
           RowBox[{"{", "z", "}"}], ",", 
           RowBox[{"{", "x", "}"}]}], "]"}]}], ")"}], "3"], " ", 
      RowBox[{"A", "[", 
       RowBox[{
        RowBox[{"{", "z", "}"}], ",", 
        RowBox[{"{", "x", "}"}]}], "]"}]}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "b", "}"}], ",", 
         RowBox[{"{", "c", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "d", "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "a", "}"}], "}"}]}], "}"}], 
     RowBox[{"3", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"a", "[", 
          RowBox[{
           RowBox[{"{", "z", "}"}], ",", 
           RowBox[{"{", "x", "}"}]}], "]"}]}], ")"}], "2"], " ", 
      RowBox[{"a", "[", 
       RowBox[{
        RowBox[{"{", "z", "}"}], ",", 
        RowBox[{"{", "x", "}"}]}], "]"}], " ", 
      RowBox[{"A", "[", 
       RowBox[{
        RowBox[{"{", "z", "}"}], ",", 
        RowBox[{"{", "x", "}"}]}], "]"}]}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "c", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "d", "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "b", "}"}], "}"}]}], "}"}], 
     RowBox[{"3", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"a", "[", 
          RowBox[{
           RowBox[{"{", "z", "}"}], ",", 
           RowBox[{"{", "x", "}"}]}], "]"}]}], ")"}], "2"], " ", 
      RowBox[{"a", "[", 
       RowBox[{
        RowBox[{"{", "z", "}"}], ",", 
        RowBox[{"{", "x", "}"}]}], "]"}], " ", 
      RowBox[{"A", "[", 
       RowBox[{
        RowBox[{"{", "z", "}"}], ",", 
        RowBox[{"{", "x", "}"}]}], "]"}]}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "b", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "d", "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "c", "}"}], "}"}]}], "}"}], 
     RowBox[{"3", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"a", "[", 
          RowBox[{
           RowBox[{"{", "z", "}"}], ",", 
           RowBox[{"{", "x", "}"}]}], "]"}]}], ")"}], "2"], " ", 
      RowBox[{"a", "[", 
       RowBox[{
        RowBox[{"{", "z", "}"}], ",", 
        RowBox[{"{", "x", "}"}]}], "]"}], " ", 
      RowBox[{"A", "[", 
       RowBox[{
        RowBox[{"{", "z", "}"}], ",", 
        RowBox[{"{", "x", "}"}]}], "]"}]}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", "c", "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "d", "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "b", "}"}]}], "}"}]}], "}"}], 
     RowBox[{"3", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"a", "[", 
         RowBox[{
          RowBox[{"{", "z", "}"}], ",", 
          RowBox[{"{", "x", "}"}]}], "]"}]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", 
        RowBox[{
         RowBox[{"{", "z", "}"}], ",", 
         RowBox[{"{", "x", "}"}]}], "]"}], "2"], " ", 
      RowBox[{"A", "[", 
       RowBox[{
        RowBox[{"{", "z", "}"}], ",", 
        RowBox[{"{", "x", "}"}]}], "]"}]}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", "b", "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "d", "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "c", "}"}]}], "}"}]}], "}"}], 
     RowBox[{"3", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"a", "[", 
         RowBox[{
          RowBox[{"{", "z", "}"}], ",", 
          RowBox[{"{", "x", "}"}]}], "]"}]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", 
        RowBox[{
         RowBox[{"{", "z", "}"}], ",", 
         RowBox[{"{", "x", "}"}]}], "]"}], "2"], " ", 
      RowBox[{"A", "[", 
       RowBox[{
        RowBox[{"{", "z", "}"}], ",", 
        RowBox[{"{", "x", "}"}]}], "]"}]}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", "a", "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "d", "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "b", "}"}], ",", 
         RowBox[{"{", "c", "}"}]}], "}"}]}], "}"}], 
     RowBox[{"3", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"a", "[", 
         RowBox[{
          RowBox[{"{", "z", "}"}], ",", 
          RowBox[{"{", "x", "}"}]}], "]"}]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", 
        RowBox[{
         RowBox[{"{", "z", "}"}], ",", 
         RowBox[{"{", "x", "}"}]}], "]"}], "2"], " ", 
      RowBox[{"A", "[", 
       RowBox[{
        RowBox[{"{", "z", "}"}], ",", 
        RowBox[{"{", "x", "}"}]}], "]"}]}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "d", "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "b", "}"}], ",", 
         RowBox[{"{", "c", "}"}]}], "}"}]}], "}"}], 
     RowBox[{
      SuperscriptBox[
       RowBox[{"a", "[", 
        RowBox[{
         RowBox[{"{", "z", "}"}], ",", 
         RowBox[{"{", "x", "}"}]}], "]"}], "3"], " ", 
      RowBox[{"A", "[", 
       RowBox[{
        RowBox[{"{", "z", "}"}], ",", 
        RowBox[{"{", "x", "}"}]}], "]"}]}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "b", "}"}], ",", 
         RowBox[{"{", "c", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "d", "}"}], "}"}], ",", 
       RowBox[{"{", "}"}]}], "}"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"a", "[", 
         RowBox[{
          RowBox[{"{", "z", "}"}], ",", 
          RowBox[{"{", "y", "}"}]}], "]"}]}], ")"}], " ", 
      RowBox[{"A", "[", 
       RowBox[{
        RowBox[{"{", "z", "}"}], ",", 
        RowBox[{"{", "y", "}"}]}], "]"}]}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "b", "}"}], ",", 
         RowBox[{"{", "c", "}"}]}], "}"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "d", "}"}], "}"}]}], "}"}], 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{
        RowBox[{"{", "z", "}"}], ",", 
        RowBox[{"{", "y", "}"}]}], "]"}], " ", 
      RowBox[{"A", "[", 
       RowBox[{
        RowBox[{"{", "z", "}"}], ",", 
        RowBox[{"{", "y", "}"}]}], "]"}]}]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$, TableDepth -> 2]]]], "Output",
 CellChangeTimes->{{3.64872414495382*^9, 3.648724245160613*^9}, {
   3.648724278299561*^9, 3.6487242992330513`*^9}, 3.648724400329349*^9, 
   3.648725497636217*^9, 3.64878032404758*^9, 3.648780362035969*^9, 
   3.648781530082424*^9},ExpressionUUID->"88587f28-ce64-4c53-9fb1-\
93b7cd21419b"]
}, Open  ]],

Cell[TextData[{
 StyleBox["Note: ",
  FontWeight->"Bold"],
 " \[NonBreakingSpace]There is some probability that the configuration of \
lineages before the event is the same as after (using \[OpenCurlyQuote]before\
\[CloseCurlyQuote] and \[OpenCurlyQuote]after\[CloseCurlyQuote] in the proper \
sense here). \[NonBreakingSpace]However, these events do need to be counted \
in the recursion.  The GF before is in fact different, because there is no \
longer the possibility of an admixture event: this is altered by MakeEqns in \
the list of pending events.\n"
}], "Text",
 CellChangeTimes->{{3.648782496791954*^9, 3.648782582981698*^9}, 
   3.648782621802106*^9, {3.648783027236011*^9, 
   3.648783041515235*^9}},ExpressionUUID->"63841bd5-2252-4042-a0d6-\
7c9ce8b0c5bc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["MakeMigration", "Subsubsection",
 CellChangeTimes->{{3.648716192880694*^9, 
  3.6487161958553953`*^9}},ExpressionUUID->"733c23f5-eb4b-4c4c-a264-\
4694ca43b640"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeMigration", "::", "usage"}], "=", 
   "\"\<MakeMigration[M,{{{a},{b}},{{c}},{{d}}},{{x},{y},{z}}] generates a \
list of the possible configurations caused by migration, and their \
corresponding rates.  The output has the form \
{{{{{a}},{{c},{b}},{{d}}},M[{y},{x}]},\[Ellipsis]}.  Each element of the list \
gives the configuration of lineages and the rates. Migration M[{y},{x}] is \
from {y} to {x}; M=4Nm, which introduces a factor of 1/2 to the scaled time. \
Results are sorted into standard order.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.648711965075757*^9, 3.648712317632676*^9}, {
  3.648712449119104*^9, 3.6487124538217363`*^9}, {3.648713781155295*^9, 
  3.648713782739266*^9}, {3.648713943762807*^9, 3.648714016163431*^9}, {
  3.6487143832230177`*^9, 3.6487144362494*^9}, {3.648716210363885*^9, 
  3.6487162720707903`*^9}, {3.648716304824067*^9, 3.648716352939293*^9}, {
  3.648784018147195*^9, 3.648784046142305*^9}, {3.64905598071439*^9, 
  3.649055990099214*^9}},ExpressionUUID->"13cd041e-0ad8-4b3c-ace4-\
c2de4e53e13d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeMigration", "[", 
    RowBox[{"M_", ",", 
     RowBox[{"xl", ":", 
      RowBox[{"{", "___List", "}"}]}], ",", 
     RowBox[{"dl", ":", 
      RowBox[{"{", "___List", "}"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "ii", ",", "j", ",", 
       RowBox[{"nd", "=", 
        RowBox[{"Length", "[", "dl", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"DeleteCases", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", " ", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "\[Equal]", "j"}], ",", "0", ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Sort", "[", 
                    RowBox[{"Sort", "/@", "#"}], "]"}], "&"}], "/@", 
                  RowBox[{"Insert", "[", 
                   RowBox[{
                    RowBox[{"Delete", "[", 
                    RowBox[{"xl", ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "ii"}], "}"}]}], "]"}], ",", 
                    RowBox[{"xl", "\[LeftDoubleBracket]", 
                    RowBox[{"j", ",", "ii"}], "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1"}], "}"}]}], "]"}]}], ",", 
                 RowBox[{
                  FractionBox["1", "2"], 
                  RowBox[{"M", "[", 
                   RowBox[{
                    RowBox[{
                    "dl", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "dl", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}]}], "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"ii", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{
                  "xl", "\[LeftDoubleBracket]", "j", 
                   "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}]}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nd"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "nd"}], "}"}]}], "]"}], ",", "2"}], "]"}], ",", 
       "0"}], "]"}]}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "sums", " ", "over", " ", "all", " ", "pairs", " ", "of", " ", 
       "demes"}], ",", " ", 
      RowBox[{
       RowBox[{
       "and", " ", "over", " ", "all", " ", "lineages", " ", "in", " ", "the",
         " ", "recipient", " ", "deme"}], ";", " ", 
       RowBox[{"transfers", " ", 
        RowBox[{"dl", "\[LeftDoubleBracket]", 
         RowBox[{"j", ",", "ii"}], "\[RightDoubleBracket]"}], " ", "into", 
        " ", "deme", " ", "i"}]}]}], " ", "*)"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.648712323217865*^9, 3.6487124315221453`*^9}, {
   3.648712854149412*^9, 3.648712906228436*^9}, {3.648712970453657*^9, 
   3.6487130578754797`*^9}, 3.648713100929508*^9, {3.648713178188078*^9, 
   3.648713184857809*^9}, {3.6487136173356543`*^9, 3.648713630436952*^9}, 
   3.648713785883741*^9, {3.648714069573851*^9, 3.648714164479802*^9}, {
   3.648714208885893*^9, 3.648714273543227*^9}, {3.648714309596192*^9, 
   3.648714314771818*^9}, {3.648714345497714*^9, 3.648714362776493*^9}, {
   3.648714395207748*^9, 3.6487144091442327`*^9}, {3.6487156518497677`*^9, 
   3.648715655745668*^9}, {3.64871628373491*^9, 3.648716291064543*^9}, {
   3.64871636821373*^9, 3.6487165060092707`*^9}, 3.6487165772675323`*^9, {
   3.648716631679757*^9, 3.6487166328209467`*^9}, 3.648717192104677*^9, {
   3.649055967405052*^9, 3.649055974008979*^9}, {3.649056816766432*^9, 
   3.649056840319614*^9}},ExpressionUUID->"b2b0d0da-3b40-44fe-ba96-\
40c9b319ff9b"],

Cell[TextData[{
 StyleBox["Example: ",
  FontWeight->"Bold"],
 "These are the eight configurations associated with migration of 4 lineages \
amongst 3 demes.  Note the factor of 1/2: ",
 Cell[BoxData[
  FormBox[
   RowBox[{
   "M", " ", "is", " ", "defined", " ", "as", " ", "4", "N", 
    "\[VeryThinSpace]", "m"}], TraditionalForm]],ExpressionUUID->
  "281f9823-cc86-441d-a8fb-9fda196bd2d4"],
 ":"
}], "Text",
 CellChangeTimes->{{3.648717084406433*^9, 3.6487171103237267`*^9}, {
  3.648717227497641*^9, 
  3.648717273598098*^9}},ExpressionUUID->"3580ddde-4d6e-46a1-a9a3-\
8e8f842c979d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{
   RowBox[{"MakeMigration", "[", 
    RowBox[{"M", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "b", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "c", "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "d", "}"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "x", "}"}], ",", 
       RowBox[{"{", "y", "}"}], ",", 
       RowBox[{"{", "z", "}"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"TableDepth", "->", "2"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.648716546836622*^9, 3.648716562769668*^9}, {
  3.648717113364461*^9, 3.648717145722344*^9}, {3.648717209708214*^9, 
  3.648717216522807*^9}},ExpressionUUID->"f1192e9c-79d3-492a-b08d-\
e6b99dc4592e"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "b", "}"}], ",", 
         RowBox[{"{", "c", "}"}]}], "}"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "d", "}"}], "}"}]}], "}"}], 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"M", "[", 
       RowBox[{
        RowBox[{"{", "x", "}"}], ",", 
        RowBox[{"{", "y", "}"}]}], "]"}]}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "b", "}"}], ",", 
         RowBox[{"{", "d", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "c", "}"}], "}"}], ",", 
       RowBox[{"{", "}"}]}], "}"}], 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"M", "[", 
       RowBox[{
        RowBox[{"{", "x", "}"}], ",", 
        RowBox[{"{", "z", "}"}]}], "]"}]}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", "b", "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "c", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "d", "}"}], "}"}]}], "}"}], 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"M", "[", 
       RowBox[{
        RowBox[{"{", "y", "}"}], ",", 
        RowBox[{"{", "x", "}"}]}], "]"}]}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", "a", "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "b", "}"}], ",", 
         RowBox[{"{", "c", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "d", "}"}], "}"}]}], "}"}], 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"M", "[", 
       RowBox[{
        RowBox[{"{", "y", "}"}], ",", 
        RowBox[{"{", "x", "}"}]}], "]"}]}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "b", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "c", "}"}], ",", 
         RowBox[{"{", "d", "}"}]}], "}"}], ",", 
       RowBox[{"{", "}"}]}], "}"}], 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"M", "[", 
       RowBox[{
        RowBox[{"{", "y", "}"}], ",", 
        RowBox[{"{", "z", "}"}]}], "]"}]}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", "b", "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "c", "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "d", "}"}]}], "}"}]}], "}"}], 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"M", "[", 
       RowBox[{
        RowBox[{"{", "z", "}"}], ",", 
        RowBox[{"{", "x", "}"}]}], "]"}]}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", "a", "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "c", "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "b", "}"}], ",", 
         RowBox[{"{", "d", "}"}]}], "}"}]}], "}"}], 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"M", "[", 
       RowBox[{
        RowBox[{"{", "z", "}"}], ",", 
        RowBox[{"{", "x", "}"}]}], "]"}]}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "b", "}"}]}], "}"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "c", "}"}], ",", 
         RowBox[{"{", "d", "}"}]}], "}"}]}], "}"}], 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"M", "[", 
       RowBox[{
        RowBox[{"{", "z", "}"}], ",", 
        RowBox[{"{", "y", "}"}]}], "]"}]}]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$, TableDepth -> 2]]]], "Output",
 CellChangeTimes->{{3.64871656338673*^9, 3.64871658030626*^9}, {
  3.648717118944867*^9, 3.648717146020801*^9}, {3.648717201157659*^9, 
  3.648717217076653*^9}},ExpressionUUID->"3021b68e-3746-4b75-bf9b-\
25d8482d6f02"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["MakeCoalescence", "Subsubsection",
 CellChangeTimes->{
  3.648712020827097*^9, {3.648713776056662*^9, 
   3.6487137777825003`*^9}},ExpressionUUID->"b36a117b-ffc0-424c-b66e-\
b4c6f27fe894"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeCoalescence", "::", "usage"}], "=", 
   "\"\<MakeCoalescence[\[Lambda],{{{a},{b}},{{c}},{{d}}},{{x},{y},{z}}] \
generates a list of the possible configurations caused by coalescence, and \
their corresponding rates.  The output has the form {{{{{a,b}},{{c}},{{d}}},\
\[Lambda][{x}]},\[Ellipsis]}.  Each element of the list gives  the \
configuration of lineages and the rates.  \
MakeCoalescence[\[Lambda],{{{a},{b}},{{c}},{{d}}},{{x},{y},{z}},{{a,b},{c,{d,\
e}}}] restricts to this topology. Results are sorted nto standard \
order.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.648711965075757*^9, 3.648712317632676*^9}, {
  3.648712449119104*^9, 3.6487124538217363`*^9}, {3.648713781155295*^9, 
  3.648713782739266*^9}, {3.648713943762807*^9, 3.648714016163431*^9}, {
  3.6487143832230177`*^9, 3.6487144362494*^9}, {3.648783855059773*^9, 
  3.6487839044595757`*^9}, {3.64905611598345*^9, 
  3.649056123830049*^9}},ExpressionUUID->"b03e8fe0-171e-4294-bfdb-\
b3583dc64077"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MakeCoalescence", "[", 
    RowBox[{"\[Lambda]_", ",", 
     RowBox[{"xl", ":", 
      RowBox[{"{", "___List", "}"}]}], ",", 
     RowBox[{"dl", ":", 
      RowBox[{"{", "___List", "}"}]}]}], "]"}], ":=", 
   RowBox[{"MakeCoalescence", "[", 
    RowBox[{"\[Lambda]", ",", "xl", ",", "dl", ",", "All"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeCoalescence", "[", 
    RowBox[{"\[Lambda]_", ",", 
     RowBox[{"xl", ":", 
      RowBox[{"{", "___List", "}"}]}], ",", 
     RowBox[{"dl", ":", 
      RowBox[{"{", "___List", "}"}]}], ",", 
     RowBox[{"tp", ":", 
      RowBox[{"(", 
       RowBox[{"_List", "|", "All"}], ")"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{"nd", "=", 
        RowBox[{"Length", "[", "dl", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Sort", "[", 
                 RowBox[{"Sort", "/@", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"ReplacePart", "[", 
                RowBox[{"xl", ",", 
                 RowBox[{"j", "\[Rule]", "#"}]}], "]"}]}], ",", 
              RowBox[{"\[Lambda]", "[", 
               RowBox[{
               "dl", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
               "]"}]}], "}"}], ")"}], "&"}], "/@", 
          RowBox[{"Mergers", "[", 
           RowBox[{
            RowBox[{
            "xl", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], ",",
             "tp"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "nd"}], "}"}]}], "]"}], ",", "1"}], "]"}]}], 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "sums", " ", "over", " ", "demes", " ", "and", " ", "over", " ", "all", 
       " ", "pairwise", " ", "coalescence", " ", "within", " ", "demes"}], 
      ";", " ", 
      RowBox[{
      "Sort", " ", "ensures", " ", "that", " ", "GF", " ", "with", " ", "the",
        " ", "same", " ", "set", " ", "of", " ", "lineages", " ", "within", 
       " ", "demes", " ", "are", " ", "treated", " ", "as", " ", 
       "equivalent"}]}], " ", "*)"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.648712323217865*^9, 3.6487124315221453`*^9}, {
   3.648712854149412*^9, 3.648712906228436*^9}, {3.648712970453657*^9, 
   3.6487130578754797`*^9}, 3.648713100929508*^9, {3.648713178188078*^9, 
   3.648713184857809*^9}, {3.6487136173356543`*^9, 3.648713630436952*^9}, 
   3.648713785883741*^9, {3.648714069573851*^9, 3.648714164479802*^9}, {
   3.648714208885893*^9, 3.648714273543227*^9}, {3.648714309596192*^9, 
   3.648714314771818*^9}, {3.648714345497714*^9, 3.648714362776493*^9}, {
   3.648714395207748*^9, 3.6487144091442327`*^9}, {3.6487156518497677`*^9, 
   3.648715655745668*^9}, {3.649056014169794*^9, 
   3.649056080687784*^9}},ExpressionUUID->"16ed5869-dcf7-43a0-a422-\
f3837b69cada"],

Cell[TextData[{
 StyleBox["Example: ",
  FontWeight->"Bold"],
 "This shows the four possible coalescences and their rates:"
}], "Text",
 CellChangeTimes->{{3.648714440288106*^9, 3.6487144568542957`*^9}, {
  3.6487155398016777`*^9, 
  3.648715540174205*^9}},ExpressionUUID->"1470887e-93af-4026-a3b9-\
774ae59129fa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MakeCoalescence", "[", 
  RowBox[{"\[Lambda]", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "a", "}"}], ",", 
       RowBox[{"{", "b", "}"}], ",", 
       RowBox[{"{", "c", "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "d", "}"}], ",", 
       RowBox[{"{", "e", "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "x", "}"}], ",", 
     RowBox[{"{", "y", "}"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.648714215479423*^9, 3.648714217829014*^9}, {
  3.648714275765814*^9, 3.648714320196529*^9}, {3.648714411569046*^9, 
  3.648714411687051*^9}},ExpressionUUID->"36c95429-68df-443b-b16d-\
dc0bbbade321"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "c", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "d", "}"}], ",", 
         RowBox[{"{", "e", "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"\[Lambda]", "[", 
      RowBox[{"{", "x", "}"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "b", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "c"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "d", "}"}], ",", 
         RowBox[{"{", "e", "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"\[Lambda]", "[", 
      RowBox[{"{", "x", "}"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "c"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "d", "}"}], ",", 
         RowBox[{"{", "e", "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"\[Lambda]", "[", 
      RowBox[{"{", "x", "}"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "b", "}"}], ",", 
         RowBox[{"{", "c", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"d", ",", "e"}], "}"}], "}"}]}], "}"}], ",", 
     RowBox[{"\[Lambda]", "[", 
      RowBox[{"{", "y", "}"}], "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.648714300549448*^9, 3.648714320571372*^9}, 
   3.648714365572991*^9, 
   3.6487144122010107`*^9},ExpressionUUID->"2ae9ff95-baa3-4300-8ef5-\
3fb3b966bd9e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"mc", "=", 
   RowBox[{"MakeCoalescence", "[", 
    RowBox[{"\[Lambda]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "b", "}"}], ",", 
         RowBox[{"{", "c", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "d", "}"}], ",", 
         RowBox[{"{", "e", "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "x", "}"}], ",", 
       RowBox[{"{", "y", "}"}]}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6487144775438337`*^9, 
  3.648714478646944*^9}},ExpressionUUID->"0e0642dd-2ab1-4976-9c2c-\
cb1eadc0fca0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
      RowBox[{"GF", "[", 
       RowBox[{"\[Omega]", ",", 
        RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        ",", "M", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "x", "}"}], ",", 
          RowBox[{"{", "y", "}"}]}], "}"}], ",", "\[CapitalLambda]"}], 
       "]"}]}], ")"}], "&"}], "/@", 
   RowBox[{"MakeCoalescence", "[", 
    RowBox[{"\[Lambda]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "b", "}"}], ",", 
         RowBox[{"{", "c", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "d", "}"}], ",", 
         RowBox[{"{", "e", "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "x", "}"}], ",", 
       RowBox[{"{", "y", "}"}]}], "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.648714494225277*^9, 
  3.648714526107567*^9}},ExpressionUUID->"f06f15a2-481b-4b0f-91a1-\
e4f7da0333ec"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GF", "[", 
    RowBox[{"\[Omega]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "c"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "d", "}"}], ",", 
         RowBox[{"{", "e", "}"}]}], "}"}]}], "}"}], ",", "M", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "x", "}"}], ",", 
       RowBox[{"{", "y", "}"}]}], "}"}], ",", "\[CapitalLambda]"}], "]"}], 
   " ", 
   RowBox[{"\[Lambda]", "[", 
    RowBox[{"{", "x", "}"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"GF", "[", 
    RowBox[{"\[Omega]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "b", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "c"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "d", "}"}], ",", 
         RowBox[{"{", "e", "}"}]}], "}"}]}], "}"}], ",", "M", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "x", "}"}], ",", 
       RowBox[{"{", "y", "}"}]}], "}"}], ",", "\[CapitalLambda]"}], "]"}], 
   " ", 
   RowBox[{"\[Lambda]", "[", 
    RowBox[{"{", "x", "}"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"GF", "[", 
    RowBox[{"\[Omega]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "c", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "d", "}"}], ",", 
         RowBox[{"{", "e", "}"}]}], "}"}]}], "}"}], ",", "M", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "x", "}"}], ",", 
       RowBox[{"{", "y", "}"}]}], "}"}], ",", "\[CapitalLambda]"}], "]"}], 
   " ", 
   RowBox[{"\[Lambda]", "[", 
    RowBox[{"{", "x", "}"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"GF", "[", 
    RowBox[{"\[Omega]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "b", "}"}], ",", 
         RowBox[{"{", "c", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"d", ",", "e"}], "}"}], "}"}]}], "}"}], ",", "M", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "x", "}"}], ",", 
       RowBox[{"{", "y", "}"}]}], "}"}], ",", "\[CapitalLambda]"}], "]"}], 
   " ", 
   RowBox[{"\[Lambda]", "[", 
    RowBox[{"{", "y", "}"}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.6487145127167997`*^9},ExpressionUUID->"45b121ee-73ad-47ba-b2d2-\
5fe7640640c7"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["MakeSplit", "Subsubsection",
 CellChangeTimes->{
  3.648712020827097*^9},ExpressionUUID->"df7dba8a-7673-453d-b630-\
35b6e47c80d8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeSplit", "::", "usage"}], "=", 
   "\"\<MakeSplit[\[CapitalLambda],{{{a},{b}},{{c}},{{d}}},{{x},{y},{z}}] \
generates a list of the possible configurations caused by population splits, \
and their corresponding rates.  The output has the form \
{{{{{a},{b}},{{c},{d}}},{{x},{y,z}},\[CapitalLambda][{{y},{z}}]},\[Ellipsis]}.\
  Each element of the list gives the configuration of lineages; the \
configuration of demes; and the rates. The length of the output list is the \
number of pairs of demes. \>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.648711965075757*^9, 3.648712317632676*^9}, {
  3.648712449119104*^9, 3.6487124538217363`*^9}, {3.64871401988346*^9, 
  3.6487140255876913`*^9}, {3.6487839306580467`*^9, 3.648784004105303*^9}, {
  3.648784052595886*^9, 
  3.648784053116414*^9}},ExpressionUUID->"4c7c8344-20b6-4227-ab0f-\
f94e435c191e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeSplit", "[", 
    RowBox[{"\[CapitalLambda]_", ",", 
     RowBox[{"xl", ":", 
      RowBox[{"{", "___List", "}"}]}], ",", 
     RowBox[{"dl", ":", 
      RowBox[{"{", "___List", "}"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "j", ",", 
       RowBox[{"nd", "=", 
        RowBox[{"Length", "[", "dl", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sort", "/@", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"Delete", "[", 
               RowBox[{"xl", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", "i", "}"}], ",", 
                  RowBox[{"{", "j", "}"}]}], "}"}]}], "]"}], ",", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{
                "xl", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
                ",", 
                RowBox[{
                "xl", "\[LeftDoubleBracket]", "j", 
                 "\[RightDoubleBracket]"}]}], "]"}]}], "]"}]}], ",", 
           RowBox[{"Sort", "/@", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"Delete", "[", 
               RowBox[{"dl", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", "i", "}"}], ",", 
                  RowBox[{"{", "j", "}"}]}], "}"}]}], "]"}], ",", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{
                "dl", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
                ",", 
                RowBox[{
                "dl", "\[LeftDoubleBracket]", "j", 
                 "\[RightDoubleBracket]"}]}], "]"}]}], "]"}]}], ",", 
           RowBox[{"\[CapitalLambda]", "[", 
            RowBox[{"dl", "\[LeftDoubleBracket]", 
             RowBox[{"{", 
              RowBox[{"i", ",", "j"}], "}"}], "\[RightDoubleBracket]"}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"nd", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"i", "+", "1"}], ",", "nd"}], "}"}]}], "]"}], ",", "1"}], 
      "]"}]}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "sums", " ", "over", " ", "all", " ", "pairs", " ", "of", " ", 
       "demes"}], ";", " ", 
      RowBox[{"merges", " ", "the", " ", "pair", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "i", "}"}], ",", 
         RowBox[{"{", "j", "}"}]}], "}"}], " ", "in", " ", "both", " ", "the",
        " ", "list", " ", "of", " ", "lineages", " ", "and", " ", "the", " ", 
       "list", " ", "of", " ", "demes"}]}], " ", "*)"}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.648712323217865*^9, 3.6487124315221453`*^9}, {
   3.648712854149412*^9, 3.648712906228436*^9}, {3.648712970453657*^9, 
   3.6487130578754797`*^9}, 3.648713100929508*^9, {3.648713178188078*^9, 
   3.648713184857809*^9}, {3.6487136173356543`*^9, 3.648713630436952*^9}, {
   3.648715681402055*^9, 
   3.648715685193078*^9}},ExpressionUUID->"37f07199-e06b-4c22-91d2-\
435f18a984ba"],

Cell[TextData[{
 StyleBox["Example: ",
  FontWeight->"Bold"],
 "This shows the three possible splits amongst three demes; columns give \
configuration of lineages, configuration of demes, and the rate:"
}], "Text",
 CellChangeTimes->{{3.6487132971439857`*^9, 
  3.648713361545335*^9}},ExpressionUUID->"7687bf0f-a177-4335-8dd5-\
06ba0329fcda"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{
   RowBox[{"MakeSplit", "[", 
    RowBox[{"\[CapitalLambda]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "b", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "c", "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "d", "}"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "x", "}"}], ",", 
       RowBox[{"{", "y", "}"}], ",", 
       RowBox[{"{", "z", "}"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"TableDepth", "\[Rule]", "2"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.648713064091305*^9, 3.6487130840251713`*^9}, {
  3.648713267939163*^9, 
  3.6487132767557983`*^9}},ExpressionUUID->"938d23c7-b25d-4992-b47f-\
9c7f5acd684a"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", "d", "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "b", "}"}], ",", 
         RowBox[{"{", "c", "}"}]}], "}"}]}], "}"}], 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "z", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}]}], "}"}], 
     RowBox[{"\[CapitalLambda]", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "x", "}"}], ",", 
        RowBox[{"{", "y", "}"}]}], "}"}], "]"}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", "c", "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "b", "}"}], ",", 
         RowBox[{"{", "d", "}"}]}], "}"}]}], "}"}], 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "y", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "z"}], "}"}]}], "}"}], 
     RowBox[{"\[CapitalLambda]", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "x", "}"}], ",", 
        RowBox[{"{", "z", "}"}]}], "}"}], "]"}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "b", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "c", "}"}], ",", 
         RowBox[{"{", "d", "}"}]}], "}"}]}], "}"}], 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "x", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", "z"}], "}"}]}], "}"}], 
     RowBox[{"\[CapitalLambda]", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "y", "}"}], ",", 
        RowBox[{"{", "z", "}"}]}], "}"}], "]"}]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$, TableDepth -> 2]]]], "Output",
 CellChangeTimes->{{3.64871308508318*^9, 3.648713102818569*^9}, 
   3.648713188308744*^9, 
   3.64871327748057*^9},ExpressionUUID->"c9bed43e-b37f-4461-a458-\
e552ed2b6305"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Effect of a bottleneck", "Subsubsection",
 CellChangeTimes->{{3.6486935173671417`*^9, 
  3.6486935228620987`*^9}},ExpressionUUID->"bfa69e9c-8e10-472c-ac60-\
6e822c9ee023"],

Cell[TextData[{
 "Suppose that a bottleneck occurs amongst ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "c1cc3aac-603d-4504-906b-9e0abafcc596"],
 " lineages that is equivalent to coalescence for scaled time ",
 Cell[BoxData[
  FormBox["T", TraditionalForm]],ExpressionUUID->
  "ba0332e1-d0b5-46c8-8f98-b1dc270ba945"],
 ".  The probability ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["P", 
    RowBox[{"k", ",", "n"}]], TraditionalForm]],ExpressionUUID->
  "4481dad6-054d-4ea9-8c83-fc61915bd640"],
 " that there will be ",
 Cell[BoxData[
  FormBox[
   RowBox[{"0", "\[LessEqual]", "k", "\[LessEqual]", 
    RowBox[{"n", "-", "1"}]}], TraditionalForm]],ExpressionUUID->
  "a42cff4d-639e-4c07-b856-a7505edb4534"],
 " coalescence events during this time can be found by taking the LT wrt T:"
}], "Text",
 CellChangeTimes->{{3.64869352681354*^9, 3.648693607238586*^9}, 
   3.648694090120161*^9, {3.648696594799601*^9, 
   3.6486966363409853`*^9}},ExpressionUUID->"55eac8c8-711a-46b8-9315-\
09197d84165c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["\[Phi]", 
    RowBox[{"k", ",", "n"}]], "\[Congruent]", 
   RowBox[{
    SubsuperscriptBox["\[Integral]", "0", "\[Infinity]"], 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[Omega]"}], "\[VeryThinSpace]", "T"}]], 
     SubscriptBox["P", 
      RowBox[{"k", ",", "n"}]], 
     RowBox[{"\[DifferentialD]", "T"}]}]}]}], " ", "=", 
  RowBox[{
   RowBox[{
    FractionBox[
     SubscriptBox["\[Lambda]", "n"], 
     RowBox[{
      SubscriptBox["\[Lambda]", "n"], "+", "\[Omega]"}]], 
    SubscriptBox["\[Phi]", 
     RowBox[{
      RowBox[{"k", "-", "1"}], ",", 
      RowBox[{"n", "-", "1"}]}]]}], "=", " ", 
   RowBox[{
    RowBox[{
     FractionBox["1", 
      RowBox[{
       SubscriptBox["\[Lambda]", 
        RowBox[{"n", "-", "k"}]], "+", "\[Omega]"}]], 
     RowBox[{
      SubsuperscriptBox["\[Product]", 
       RowBox[{"j", "=", "0"}], 
       RowBox[{"k", "-", "1"}]], 
      RowBox[{
       FractionBox[
        SubscriptBox["\[Lambda]", 
         RowBox[{"n", "-", "j"}]], 
        RowBox[{
         SubscriptBox["\[Lambda]", 
          RowBox[{"n", "-", "j"}]], "+", "\[Omega]"}]], "    ", 
       SubscriptBox["\[Lambda]", "n"]}]}]}], "=", 
    RowBox[{"n", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", "-", "1"}], ")"}], "/", 
      "2"}]}]}]}]}]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.6486966132456913`*^9, 3.648696654970543*^9}, {
  3.6486966855615473`*^9, 3.64869675760081*^9}, {3.6486991413295097`*^9, 
  3.648699162458639*^9}, {3.648699611818884*^9, 3.648699617169241*^9}, {
  3.648699687537587*^9, 
  3.648699689135375*^9}},ExpressionUUID->"01abee08-37cf-4568-9a8b-\
a715c9d79c77"],

Cell[TextData[{
 "Taking the inverse Laplace transform gives the distribution of the # of \
coalescence events as a sum over ",
 Cell[BoxData[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", 
     SubscriptBox["\[Lambda]", 
      RowBox[{"n", "-", "i"}]]}], "T"}]]],
  CellChangeTimes->{{3.6486966132456913`*^9, 3.648696654970543*^9}, {
   3.6486966855615473`*^9, 3.648696792288702*^9}, {3.648696850860896*^9, 
   3.648696904855421*^9}, {3.648697732085648*^9, 3.648697796747684*^9}},
  ExpressionUUID->"7fd958ba-805a-4f84-b445-7a0ee0c808e7"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{"0", "\[LessEqual]", "i", "\[LessEqual]", 
    RowBox[{"k", "-", "1"}]}], TraditionalForm]],ExpressionUUID->
  "4890225e-6b18-4727-acbd-6ce475d84c23"],
 ":"
}], "Text",
 CellChangeTimes->{{3.648696761055879*^9, 3.6486967771186333`*^9}, {
  3.648697827242819*^9, 
  3.648697875651726*^9}},ExpressionUUID->"ec86960f-d217-4f64-b7be-\
4753aa75ae8d"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["P", 
   RowBox[{"k", ",", "n"}]], " ", "=", " ", 
  RowBox[{
   SubsuperscriptBox["\[Sum]", 
    RowBox[{"i", "=", "0"}], "k"], 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", 
       SubscriptBox["\[Lambda]", 
        RowBox[{"n", "-", "i"}]]}], "T"}]], 
    RowBox[{
     SubsuperscriptBox["\[Product]", 
      RowBox[{
       RowBox[{"j", "=", "0"}], ",", 
       RowBox[{"j", "\[NotEqual]", "i"}]}], "k"], 
     RowBox[{
      FractionBox["1", 
       RowBox[{
        SubscriptBox["\[Lambda]", 
         RowBox[{"n", "-", "j"}]], "-", 
        SubscriptBox["\[Lambda]", 
         RowBox[{"n", "-", "i"}]]}]], " ", 
      RowBox[{
       SubsuperscriptBox["\[Product]", 
        RowBox[{"j", "=", "0"}], 
        RowBox[{"k", "-", "1"}]], 
       SubscriptBox["\[Lambda]", 
        RowBox[{"n", "-", "j"}]]}]}]}]}]}]}]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.6486966132456913`*^9, 3.648696654970543*^9}, {
  3.6486966855615473`*^9, 3.648696792288702*^9}, {3.648696850860896*^9, 
  3.648696904855421*^9}, {3.648697732085648*^9, 3.648697796747684*^9}, {
  3.648700616057273*^9, 3.6487006540982924`*^9}, {3.648700745939383*^9, 
  3.648700757227446*^9}, {3.648701403066716*^9, 3.6487014489433813`*^9}, {
  3.6487014902433357`*^9, 
  3.648701495063733*^9}},ExpressionUUID->"d71165b5-6124-4964-8a6e-\
bf638b84b568"],

Cell[TextData[{
 "For each coalescence, any pair of lineages are equally likely to coalesce.  \
The final outcome is a distribution over all possible partitions amongst the \
lineages.  It is more convenient to measure the strength of the bottleneck by \
the probability of pairwise coalescence, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "=", 
    RowBox[{"1", "-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", "T"}]]}]}], TraditionalForm]],ExpressionUUID->
  "0c4753ab-e038-44c9-8ee6-dd7f5bcc5996"],
 ". Then, the probabilities are polynomials in ",
 Cell[BoxData[
  FormBox["f", TraditionalForm]],ExpressionUUID->
  "b3fe5f7e-f95d-40fd-99b2-43865079ea86"],
 "."
}], "Text",
 CellChangeTimes->{{3.648697884986964*^9, 3.648698048237961*^9}, 
   3.6519075241812677`*^9},ExpressionUUID->"74cb6099-5218-4fe6-9685-\
9bf8ce88ca30"]
}, Closed]],

Cell[CellGroupData[{

Cell["BottleneckedLineages", "Subsubsection",
 CellChangeTimes->{
  3.648706327393297*^9},ExpressionUUID->"2b83c85f-c9df-46fa-a658-\
b9376c12ea46"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BottleneckedLineages", "::", "usage"}], "=", 
   "\"\<BottleneckedLineages[{{a},{b},{c}},f] gives the probabilities of all \
possible configurations before a bottleneck that causes pairwise coalescence \
with probability f. The output has the form \
{{{a},{b},{c}},\!\(\*SubscriptBox[\(p\), \(1\)]\)},\[Ellipsis],{{a,b,c,d}},\!\
\(\*SubscriptBox[\(p\), \(n\)]\)}}.  \
BottleneckedLineages[{{a},{b},{c}},f,{{a,b},c}] restricts to a particular \
topology. Results are sorted into standard order.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.648706157241461*^9, 3.648706366130693*^9}, {
  3.64905585245538*^9, 
  3.649055864434066*^9}},ExpressionUUID->"a785977a-aa1f-48c2-aa95-\
61a009a7507b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BottleneckedLineages", "[", 
    RowBox[{
     RowBox[{"xl", ":", 
      RowBox[{"{", "___List", "}"}]}], ",", "f_"}], "]"}], ":=", 
   RowBox[{"BottleneckedLineages", "[", 
    RowBox[{"xl", ",", "f", ",", "All"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BottleneckedLineages", "[", 
    RowBox[{
     RowBox[{"xl", ":", 
      RowBox[{"{", "___List", "}"}]}], ",", "f_", ",", 
     RowBox[{"tp", ":", 
      RowBox[{"(", 
       RowBox[{"_List", "|", "All"}], ")"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "xl", "]"}]}], ",", "pr"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"pr", "=", 
           RowBox[{
            RowBox[{"probCoal", "[", 
             RowBox[{"k", ",", "n", ",", "f"}], "]"}], "/", 
            RowBox[{"Length", "[", 
             RowBox[{"Mergers", "[", 
              RowBox[{"k", ",", "xl"}], "]"}], "]"}]}]}], ";", 
          RowBox[{
           RowBox[{"Tally", "[", 
            RowBox[{"Mergers", "[", 
             RowBox[{"k", ",", "xl", ",", "tp"}], "]"}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"s_List", ",", "i_Integer"}], "}"}], "\[RuleDelayed]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Sort", "[", 
                RowBox[{"Sort", "/@", "s"}], "]"}], ",", 
               RowBox[{"(", 
                RowBox[{"i", " ", "pr"}], ")"}]}], "}"}]}], "}"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "0", ",", 
           RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ",", "1"}], "]"}]}], 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.648706328771905*^9, 3.648706491808621*^9}, {
  3.648706546337701*^9, 3.6487065556322527`*^9}, {3.6489610920516653`*^9, 
  3.6489611043056*^9}, {3.648963263211719*^9, 3.6489632775251093`*^9}, {
  3.6490558310910997`*^9, 3.649055844293057*^9}, {3.649056192977111*^9, 
  3.649056196823852*^9}, {3.649057678841083*^9, 
  3.649057681391438*^9}},ExpressionUUID->"8b828670-2c61-4843-a9b5-\
0a65f8c69a07"],

Cell[TextData[{
 StyleBox["Example: ",
  FontWeight->"Bold"],
 "This gives the probability of all possible configurations of 4 lineages \
before a bottleneck that causes a reduction in pairwise diversity of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "=", "0.2"}], TraditionalForm]],ExpressionUUID->
  "4781a1c2-43a6-4513-9d97-8a88fcb5706c"],
 ".  The pro ability of no coalescence is ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", "f"}], ")"}], "6"], "="}], TraditionalForm]],
  ExpressionUUID->"aaa0c5c8-33f4-4cbd-b181-ab0ede076f99"],
 "0.262144,and of complete coalescence is 0.0196."
}], "Text",
 CellChangeTimes->{{3.648706585207855*^9, 3.648706697925786*^9}, 
   3.651907529221405*^9},ExpressionUUID->"a6e11cb6-4fde-408b-850e-\
c10f443b36c4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{
   RowBox[{"BottleneckedLineages", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "a", "}"}], ",", 
       RowBox[{"{", "b", "}"}], ",", 
       RowBox[{"{", "c", "}"}], ",", 
       RowBox[{"{", "d", "}"}]}], "}"}], ",", "0.2"}], "]"}], ",", 
   RowBox[{"TableDepth", "\[Rule]", "2"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.648706500623891*^9, 3.6487065336895*^9}, {
  3.648706564393128*^9, 3.648706567512878*^9}, {3.648960925408223*^9, 
  3.648960934111961*^9}},ExpressionUUID->"9a33599e-5d82-4c7b-bb6f-\
6e8bc9bbc4b6"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "a", "}"}], ",", 
       RowBox[{"{", "b", "}"}], ",", 
       RowBox[{"{", "c", "}"}], ",", 
       RowBox[{"{", "d", "}"}]}], "}"}], "0.2621440000000001`"},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "c", "}"}], ",", 
       RowBox[{"{", "d", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}]}], "}"}], "0.0832853333333333`"},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "b", "}"}], ",", 
       RowBox[{"{", "d", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "c"}], "}"}]}], "}"}], "0.0832853333333333`"},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "b", "}"}], ",", 
       RowBox[{"{", "c", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "d"}], "}"}]}], "}"}], "0.0832853333333333`"},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "a", "}"}], ",", 
       RowBox[{"{", "d", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", "c"}], "}"}]}], "}"}], "0.0832853333333333`"},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "a", "}"}], ",", 
       RowBox[{"{", "c", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", "d"}], "}"}]}], "}"}], "0.0832853333333333`"},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "a", "}"}], ",", 
       RowBox[{"{", "b", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", "d"}], "}"}]}], "}"}], "0.0832853333333333`"},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", "d"}], "}"}]}], "}"}], "0.02428586666666669`"},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "d", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], "}"}], 
     "0.03642880000000004`"},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "c", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b", ",", "d"}], "}"}]}], "}"}], 
     "0.03642880000000004`"},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "c"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", "d"}], "}"}]}], "}"}], "0.02428586666666669`"},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "b", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "c", ",", "d"}], "}"}]}], "}"}], 
     "0.03642880000000004`"},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "d"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", "c"}], "}"}]}], "}"}], "0.02428586666666669`"},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "a", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", "c", ",", "d"}], "}"}]}], "}"}], 
     "0.03642880000000004`"},
    {
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], "}"}], 
     "0.019571199999999678`"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$, TableDepth -> 2]]]], "Output",
 CellChangeTimes->{{3.648706508949648*^9, 3.648706568570035*^9}, 
   3.648960935039641*^9, 
   3.648961110568536*^9},ExpressionUUID->"cb8ce1c5-92d1-4fcf-ab6f-\
ec21cc81a1e1"]
}, Open  ]],

Cell["\<\
These are the probabilities if we restrict to a particular topology.  Only \
sequences of coalesence that are consistent with this topology are counted:\
\>", "Text",
 CellChangeTimes->{{3.648961010790277*^9, 3.648961024836774*^9}, {
  3.648969093679001*^9, 
  3.648969138193758*^9}},ExpressionUUID->"e074cde3-c1dc-40f6-9451-\
c2cac6ac1ef9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{
   RowBox[{"BottleneckedLineages", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "a", "}"}], ",", 
       RowBox[{"{", "b", "}"}], ",", 
       RowBox[{"{", "c", "}"}], ",", 
       RowBox[{"{", "d", "}"}]}], "}"}], ",", "0.2", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", "d"}], "}"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"TableDepth", "\[Rule]", "2"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.648706500623891*^9, 3.6487065336895*^9}, {
  3.648706564393128*^9, 3.648706567512878*^9}, {3.648960925408223*^9, 
  3.648960968275622*^9}},ExpressionUUID->"6357dab6-90c8-4593-9752-\
0665fcd32aad"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "a", "}"}], ",", 
       RowBox[{"{", "b", "}"}], ",", 
       RowBox[{"{", "c", "}"}], ",", 
       RowBox[{"{", "d", "}"}]}], "}"}], "0.2621440000000001`"},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "c", "}"}], ",", 
       RowBox[{"{", "d", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}]}], "}"}], "0.0832853333333333`"},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "a", "}"}], ",", 
       RowBox[{"{", "b", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", "d"}], "}"}]}], "}"}], "0.0832853333333333`"},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", "d"}], "}"}]}], "}"}], "0.02428586666666669`"},
    {
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], "}"}], 
     "0.002174577777777742`"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$, TableDepth -> 2]]]], "Output",
 CellChangeTimes->{3.648960969546886*^9, 3.648961112912903*^9, 
  3.6489690635907516`*^9},ExpressionUUID->"28ca282e-d770-4ac0-becd-\
f4893b88d5e5"]
}, Open  ]],

Cell[TextData[{
 StyleBox["Note: ",
  FontWeight->"Bold"],
 "Restricting to a specific topology is not straightforward. To take the \
simplest example, with three lineages, these are the probabilities associated \
with the three possible topologies:"
}], "Text",
 CellChangeTimes->{{3.648967796559865*^9, 3.648967823852929*^9}, {
   3.6489678806628942`*^9, 3.648967914276472*^9}, {3.648968032058723*^9, 
   3.648968068902426*^9}, 
   3.651907542989201*^9},ExpressionUUID->"39eea5c1-14ec-4c32-8ebc-\
8566555aaa2a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"BottleneckedLineages", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "b", "}"}], ",", 
         RowBox[{"{", "c", "}"}]}], "}"}], ",", "0.2", ",", "#"}], "]"}], 
     "&"}], "/@", 
    RowBox[{"Topologies", "[", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c"}], "}"}], "]"}]}], ",", 
   RowBox[{"TableDepth", "\[Rule]", "2"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.648706500623891*^9, 3.6487065336895*^9}, {
   3.648706564393128*^9, 3.648706567512878*^9}, {3.648960925408223*^9, 
   3.648960968275622*^9}, 3.64896122385144*^9, {3.648967939248672*^9, 
   3.648967967603786*^9}, {3.648968153932261*^9, 
   3.648968171785964*^9}},ExpressionUUID->"b2c1750a-5fe5-41ad-abda-\
041c38899ba7"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "b", "}"}], ",", 
         RowBox[{"{", "c", "}"}]}], "}"}], ",", "0.5120000000000001`"}], 
      "}"}], 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "c"}], "}"}]}], "}"}], ",", 
       "0.14399999999999996`"}], "}"}], 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"a", ",", "b", ",", "c"}], "}"}], "}"}], ",", 
       "0.01866666666666661`"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "b", "}"}], ",", 
         RowBox[{"{", "c", "}"}]}], "}"}], ",", "0.5120000000000001`"}], 
      "}"}], 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "b", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "c"}], "}"}]}], "}"}], ",", 
       "0.14399999999999996`"}], "}"}], 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"a", ",", "b", ",", "c"}], "}"}], "}"}], ",", 
       "0.01866666666666661`"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "b", "}"}], ",", 
         RowBox[{"{", "c", "}"}]}], "}"}], ",", "0.5120000000000001`"}], 
      "}"}], 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "c", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}]}], "}"}], ",", 
       "0.14399999999999996`"}], "}"}], 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"a", ",", "b", ",", "c"}], "}"}], "}"}], ",", 
       "0.01866666666666661`"}], "}"}]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$, TableDepth -> 2]]]], "Output",
 CellChangeTimes->{{3.648967958166439*^9, 3.6489679678636503`*^9}, {
  3.648968154487947*^9, 
  3.6489681720844603`*^9}},ExpressionUUID->"88e69b19-dac9-4f80-b438-\
3e289fce5b58"]
}, Open  ]],

Cell[TextData[{
 "These probabilities do not sum to 1, either row-by-row or in aggregate.  \
However, that is as it should be: we just require that the total probability, \
for each complete path to coalescence,  sums to 1.  If no coalescence occurs \
in the bottleneck (probability 0.512 here), then future coalescence will be \
divided equally across topologies.  With one or two coalescence events, there \
is only one possible future path to complete coalescence. Therefore, the \
total probability associated with each of the three possible topologies will \
be ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"0.512", "*", 
      RowBox[{"1", "/", "3"}]}], " ", "+", " ", "0.144", " ", "+", " ", 
     "0.18667"}], " ", "=", 
    FractionBox["1", "3"]}], TraditionalForm]],ExpressionUUID->
  "87ae3154-8e99-45f7-a344-a197852a7791"],
 "."
}], "Text",
 CellChangeTimes->{{3.6489680740864277`*^9, 3.648968112506052*^9}, {
  3.648968179116486*^9, 3.648968439061254*^9}, {3.648968535834024*^9, 
  3.648968538297615*^9}},ExpressionUUID->"9d49fd19-9fd2-45bc-b8e8-\
91b0814af3eb"]
}, Closed]],

Cell[CellGroupData[{

Cell["probCoalLT", "Subsubsection",
 CellChangeTimes->{
  3.64869821302173*^9},ExpressionUUID->"f3483288-e2c9-45b2-8931-c6a2d6b5707b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"probCoalLT", "::", "usage"}], "=", 
   "\"\<probCoalLT[k,n,\[Omega]] gives the LT of the probability that there \
will be k coalescence events amongst n lineages during time T\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.648698053586424*^9, 
  3.648698145662121*^9}},ExpressionUUID->"9e6d8480-79eb-41f4-b8a4-\
b21ade637d23"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"probCoalLT", "[", 
    RowBox[{"k_Integer", ",", "n_Integer", ",", "\[Omega]_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "j", "}"}], ",", 
     RowBox[{
      FractionBox["2", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "-", "k"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"n", "-", "k", "-", "1"}], ")"}]}], "+", 
        RowBox[{"2", "\[Omega]"}]}]], 
      RowBox[{
       SubsuperscriptBox["\[Product]", 
        RowBox[{"j", "=", "0"}], 
        RowBox[{"k", "-", "1"}]], 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "-", "j"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"n", "-", "j", "-", "1"}], ")"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", "j"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"n", "-", "j", "-", "1"}], ")"}]}], "+", 
         RowBox[{"2", "\[Omega]"}]}]]}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.64869815023932*^9, 3.6486982074492683`*^9}, 
   3.648698735981826*^9, {3.648699703236556*^9, 
   3.64869973190941*^9}},ExpressionUUID->"3f35a1b2-65db-4842-b6e9-\
0f2a40941887"],

Cell["The total probability sums to 1, which has LT 1/\[Omega]:", "Text",
 CellChangeTimes->{{3.6487007847017937`*^9, 
  3.6487007958198967`*^9}},ExpressionUUID->"25b8b44f-636c-4a19-8fc3-\
f93fa94eba02"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{"probCoalLT", "[", 
     RowBox[{"k", ",", "5", ",", "\[Omega]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", "0", ",", "4"}], "}"}]}], "]"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.648698602249242*^9, 
  3.648698612576832*^9}},ExpressionUUID->"c85b7c71-365f-44a2-8adb-\
27375fa910ab"],

Cell[BoxData[
 FractionBox["1", "\[Omega]"]], "Output",
 CellChangeTimes->{
  3.6486986130452843`*^9, 3.648698740630521*^9, {3.648699712109318*^9, 
   3.6486997342622147`*^9}},ExpressionUUID->"c06af14f-9c11-47f6-b586-\
b77b8664dd19"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["probCoal", "Subsubsection",
 CellChangeTimes->{{3.64869821302173*^9, 
  3.648698227536043*^9}},ExpressionUUID->"08786181-4242-4ad7-9acf-\
88603dee9623"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"probCoal", "::", "usage"}], "=", 
   "\"\<probCoal[k,n,f] gives the probability that there will be k \
coalescence events amongst n lineages during a bottleneck that causes \
pairwise coalescence with probability f=1-exp(-T).\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.648698053586424*^9, 3.648698145662121*^9}, {
  3.6486982297451277`*^9, 
  3.648698271195671*^9}},ExpressionUUID->"7a7ede01-6d7b-4d58-9426-\
a666d837420b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"probCoal", "[", 
    RowBox[{"k_Integer", ",", "n_Integer", ",", "f_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "j"}], "}"}], ",", 
     RowBox[{
      SubsuperscriptBox["\[Sum]", 
       RowBox[{"i", "=", "0"}], "k"], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "f"}], ")"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "-", "i"}], ")"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", "i", "-", "1"}], ")"}], "/", "2"}]}]], 
       RowBox[{"(", 
        RowBox[{
         SubsuperscriptBox["\[Product]", 
          RowBox[{"j", "=", "0"}], "k"], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", "\[Equal]", "j"}], ",", "1", ",", 
           FractionBox["1", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"n", "-", "j"}], ")"}], 
              RowBox[{"(", 
               RowBox[{"n", "-", "j", "-", "1"}], ")"}]}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"n", "-", "i"}], ")"}], 
              RowBox[{"(", 
               RowBox[{"n", "-", "i", "-", "1"}], ")"}]}]}]]}], "]"}]}], 
        ")"}], 
       RowBox[{"(", 
        RowBox[{
         SubsuperscriptBox["\[Product]", 
          RowBox[{"j", "=", "0"}], 
          RowBox[{"k", "-", "1"}]], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", "j"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"n", "-", "j", "-", "1"}], ")"}]}]}], ")"}]}]}]}], "]"}]}],
   ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.64869815023932*^9, 3.6486982074492683`*^9}, {
   3.648698277544126*^9, 3.648698407689117*^9}, 3.6486984622696753`*^9, 
   3.648699882579957*^9, {3.648699916683022*^9, 3.648699950027298*^9}, {
   3.648700011039879*^9, 3.648700011437874*^9}, {3.6487000998834143`*^9, 
   3.648700100149832*^9}, {3.648700194672557*^9, 3.648700206789878*^9}, {
   3.6487002908150463`*^9, 3.648700304397667*^9}, {3.648700528246642*^9, 
   3.648700580595756*^9}, {3.648700671556082*^9, 3.648700727234659*^9}, {
   3.6487015100518723`*^9, 
   3.648701551724917*^9}},ExpressionUUID->"024a09d3-9a3e-421c-8bfa-\
ff99f5d3dfb4"],

Cell["These functions are consistent:", "Text",
 CellChangeTimes->{{3.648700799907193*^9, 
  3.648700806306775*^9}},ExpressionUUID->"29aea5ee-0dd1-45d0-8c1f-\
4c0b2170c570"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Expand", "/@", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"InverseLaplaceTransform", "[", 
     RowBox[{
      RowBox[{"probCoalLT", "[", 
       RowBox[{"3", ",", "5", ",", "\[Omega]"}], "]"}], ",", "\[Omega]", ",", 
      "T"}], "]"}], ",", 
    RowBox[{"probCoal", "[", 
     RowBox[{"3", ",", "5", ",", 
      RowBox[{"1", "-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", "T"}]]}]}], "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.648698416208304*^9, 
  3.6486985525865507`*^9}},ExpressionUUID->"302844b2-b90e-4e4f-b7cf-\
9880df224375"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["5", "7"]}], " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "10"}], " ", "T"}]]}], "+", 
    RowBox[{"3", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "6"}], " ", "T"}]]}], "-", 
    FractionBox[
     RowBox[{"30", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "3"}], " ", "T"}]]}], "7"], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", "T"}]]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["5", "7"]}], " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "10"}], " ", "T"}]]}], "+", 
    RowBox[{"3", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "6"}], " ", "T"}]]}], "-", 
    FractionBox[
     RowBox[{"30", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "3"}], " ", "T"}]]}], "7"], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", "T"}]]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6486984238950872`*^9, 3.6486984373792877`*^9}, {
   3.648698474836495*^9, 3.6486985530622807`*^9}, 3.648699738517605*^9, 
   3.64869988641261*^9, {3.6486999257584543`*^9, 3.648699952583002*^9}, 
   3.648700022478807*^9, 3.6487001037990303`*^9, 3.648700209711454*^9, 
   3.648700295583798*^9, 3.648700587924878*^9, {3.648700690895706*^9, 
   3.648700729317971*^9}, 3.6487007758849688`*^9, 
   3.648701555345325*^9},ExpressionUUID->"0293559f-75bb-4cbb-8047-\
402089e3fe24"]
}, Open  ]],

Cell["The probability sums to 1:", "Text",
 CellChangeTimes->{{3.648701586043065*^9, 
  3.648701590282949*^9}},ExpressionUUID->"faf86b82-4e0b-4565-87e9-\
88005a19fef7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{"probCoal", "[", 
     RowBox[{"k", ",", "5", ",", "f"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", "0", ",", "4"}], "}"}]}], "]"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.64870081440549*^9, 3.648700835641448*^9}, {
  3.648700867190695*^9, 3.648700875790759*^9}, {3.648701579961762*^9, 
  3.648701583284295*^9}},ExpressionUUID->"c9665215-9b6a-4762-86ec-\
df49e928fd03"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{
  3.6487008367644873`*^9, {3.6487008676191387`*^9, 3.64870087620508*^9}, 
   3.6487015836834087`*^9},ExpressionUUID->"8cf21b09-987b-4d8a-bc6a-\
a12760b88389"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Making and solving equations for the GF: MakeEqns, MakeAllEqns, MakeSolvedGF\
\>", "Subsection",
 CellChangeTimes->{{3.648386373913299*^9, 3.6483863890168533`*^9}, {
   3.648802359857026*^9, 3.6488023875347433`*^9}, {3.648802633081193*^9, 
   3.648802648250288*^9}, 3.649333542704196*^9, 
   3.6525949180840883`*^9},ExpressionUUID->"f9841e23-5c30-4dda-a7c3-\
3e1b0ca39524"],

Cell[CellGroupData[{

Cell["MakeEqns", "Subsubsection",
 CellChangeTimes->{{3.5800243136350203`*^9, 3.5800243178992443`*^9}, 
   3.635316770700755*^9, 3.6490671719122763`*^9, 
   3.6493335410880404`*^9},ExpressionUUID->"62207c9a-1fcf-4fe9-9c97-\
d1d4c5e5a0f4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeEqns", "::", "usage"}], "=", 
   "\"\<MakeEqns[\[Psi][\[Omega],{{{a},{b}},{{c}}},{{x},{y},\[Ellipsis]},\!\(\*
StyleBox[\"opts\",
FontSlant->\"Italic\"]\)]] gives the recursion for the IM model. Coalesence\
\[Rule]\[Lambda] sets the rate of coalescence in deme {x} to \[Lambda][{x}], \
scaled relative to 2N.  MakeEqns[\[Psi][\[Omega],{{{a},{b}},{{c}}},{{x},{y},\
\[Ellipsis]}\!\(\*
StyleBox[\",\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"opts\",
FontSlant->\"Italic\"]\)],\!\(\*
StyleBox[\"topology\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"]\",
FontSlant->\"Italic\"]\) restricts to terms consistent with a particular \
topology.  Migration->M sets the rate of migration to M[{x},{y}] (forwards in \
time); M=4Nm.  Splits\[Rule]\[CapitalLambda] sets the rate of splits of the \
population {{x},{y}} into two populations {x} and {y} (forwards in time) to \
\[CapitalLambda][{{x},{y}}].  Note that M=4Nm, whereas \[CapitalLambda]=2N\
\[Lambda]. Admixture\[Rule]{{\!\(\*SubscriptBox[\(A\), \
\(1\)]\),\!\(\*SubscriptBox[\(a\), \(1\)]\)},\[Ellipsis]} sets the rate \
\!\(\*SubscriptBox[\(A\), \(i\)]\)[{y},{x}] of admixture events where there \
is a probability \!\(\*SubscriptBox[\(a\), \(i\)]\)[{y},{x}] that a lineage \
in {x} came from {y} (looking back in time). There may be multiple events, \
specified by the list. Similarly, \
Bottlenecks\[Rule]{{\!\(\*SubscriptBox[\(B\), \(1\)]\),\!\(\*SubscriptBox[\(b\
\), \(1\)]\)},\[Ellipsis]} specifies one or more bottlenecks, with rates \!\(\
\*SubscriptBox[\(B\), \(i\)]\)[{x}] and probability of pairwise coalescence \
\!\(\*SubscriptBox[\(b\), \(i\)]\)[{x}]. \
ChangeCoalescence\[Rule]{{\!\(\*SubscriptBox[\(d\[Lambda]\), \
\(1\)]\),\!\(\*SubscriptBox[\(\[Lambda]\), \(1\)]\)},\[Ellipsis]} sets the \
rate of events when the rate of coalescence changes from \
\!\(\*SubscriptBox[\(\[Lambda]\), \(i - 1\)]\)[{x}] to \!\(\*SubscriptBox[\(\
\[Lambda]\), \(i\)]\)[{x}], and \
ChangeMigration\[Rule]{{\!\(\*SubscriptBox[\(dM\), \
\(1\)]\),\!\(\*SubscriptBox[\(M\), \(1\)]\)},\[Ellipsis]} does the same for \
changes in migration rate.   MakeEqns[\[Psi][\[Omega],{{a},{b},{c}},\!\(\*
StyleBox[\"opts\",
FontSlant->\"Italic\"]\)]] gives the recursion that produce the GF \
\[Psi][{{a},{b},{c}}] for a single deme; it can also be restricted to a \
particular topology. Only the options Coalescence, ChangeCoalescence and \
Bottlenecksapply when there is a single deme.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.497629915230047*^9, 3.497629937826552*^9}, {
   3.4976299715556097`*^9, 3.4976300002856693`*^9}, {3.4976314832831306`*^9, 
   3.497631483541554*^9}, {3.4976318525913553`*^9, 3.49763185456774*^9}, {
   3.497632351711234*^9, 3.497632383439411*^9}, {3.498187415590383*^9, 
   3.498187415637122*^9}, {3.627881660084319*^9, 3.627881674477385*^9}, {
   3.6278819675306463`*^9, 3.627881988444644*^9}, {3.635238219889872*^9, 
   3.635238285639118*^9}, 3.635238343424089*^9, {3.635238374369809*^9, 
   3.635238376777821*^9}, {3.635313183358533*^9, 3.635313184925727*^9}, {
   3.63531678033641*^9, 3.635316781705367*^9}, {3.6354061482665653`*^9, 
   3.635406182677664*^9}, {3.635406737790051*^9, 3.635406803061761*^9}, {
   3.6354068990209103`*^9, 3.635406901348206*^9}, {3.6486262525026503`*^9, 
   3.648626331018236*^9}, {3.64879941891805*^9, 3.648799539324835*^9}, {
   3.648799581665966*^9, 3.648799691398391*^9}, {3.648801695511958*^9, 
   3.648801827064864*^9}, {3.648801865730854*^9, 3.6488020500822563`*^9}, {
   3.64880210122921*^9, 3.648802125531103*^9}, {3.648802674679535*^9, 
   3.648802814482525*^9}, {3.648803288343375*^9, 3.648803291900627*^9}, {
   3.6488044890071497`*^9, 3.6488044904800987`*^9}, {3.6488895831483727`*^9, 
   3.648889592090459*^9}, 
   3.648979050099019*^9},ExpressionUUID->"562aa119-1ee4-4942-b432-\
bd6ad206b3b4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "MakeEqns", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Coalescence", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"1", "&"}], ")"}]}], ",", 
     RowBox[{"Migration", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"0", "&"}], ")"}]}], ",", 
     RowBox[{"Splits", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"0", "&"}], ")"}]}], ",", 
     RowBox[{"Admixture", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"Bottlenecks", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"ChangeMigration", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"ChangeCoalescence", "\[Rule]", 
      RowBox[{"{", "}"}]}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4518159913405237`*^9, 3.4518160543109493`*^9}, {
   3.451816084824759*^9, 3.451816085343013*^9}, {3.451816198429022*^9, 
   3.451816209393592*^9}, {3.4518168024238453`*^9, 3.4518168307262173`*^9}, 
   3.451816862041689*^9, {3.451821840411628*^9, 3.451821875315342*^9}, {
   3.497627603748337*^9, 3.497627605314517*^9}, {3.497627666679673*^9, 
   3.497627679021369*^9}, {3.4976297537649307`*^9, 3.49762977502563*^9}, {
   3.497631373992587*^9, 3.497631378492118*^9}, {3.497631918209988*^9, 
   3.497631935311631*^9}, {3.497632280534531*^9, 3.49763228123324*^9}, {
   3.497632325816998*^9, 3.497632326052711*^9}, 3.4976337522143908`*^9, {
   3.5079752010503683`*^9, 3.5079752376266193`*^9}, {3.550477996920599*^9, 
   3.5504780075922728`*^9}, {3.550478086446879*^9, 3.550478143829822*^9}, {
   3.5504781863729763`*^9, 3.550478187404554*^9}, {3.635239834268675*^9, 
   3.635239836742868*^9}, {3.635239877861697*^9, 3.635239881724243*^9}, {
   3.6353126277849483`*^9, 3.635312628175696*^9}, {3.635313736095487*^9, 
   3.635313852854196*^9}, {3.635406095499138*^9, 3.635406123248563*^9}, {
   3.6354062328130093`*^9, 3.6354062586134987`*^9}, {3.6488146754511538`*^9, 
   3.648814699763324*^9}, {3.648814836085121*^9, 3.648814847830405*^9}, {
   3.648814881608336*^9, 3.648814963305421*^9}, {3.6488150161644583`*^9, 
   3.648815047201336*^9}, {3.648872333296805*^9, 3.648872341959145*^9}, {
   3.648882091493219*^9, 3.648882140116662*^9}, {3.648889461066227*^9, 
   3.648889484118081*^9}},ExpressionUUID->"a7d10949-1fe6-4eb8-9827-\
d83287197889"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"single", " ", "deme", " ", "case"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"MakeEqns", "[", 
      RowBox[{"GF_", "[", 
       RowBox[{"\[Omega]_", ",", 
        RowBox[{"xl", ":", 
         RowBox[{"{", "___List", "}"}]}], ",", "opts___Rule"}], "]"}], "]"}], 
     ":=", 
     RowBox[{"MakeEqns", "[", 
      RowBox[{
       RowBox[{"GF", "[", 
        RowBox[{"\[Omega]", ",", "xl", ",", "opts"}], "]"}], ",", "All"}], 
      "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"MakeEqns", "[", 
      RowBox[{
       RowBox[{"GF_", "[", 
        RowBox[{"\[Omega]_", ",", 
         RowBox[{"xl", ":", 
          RowBox[{"{", "_List", "}"}]}], ",", "opts___Rule"}], "]"}], ",", 
       RowBox[{"tp", ":", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", "___", "}"}], "|", "All"}], ")"}]}]}], "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"GF", "[", 
        RowBox[{"\[Omega]", ",", 
         RowBox[{"Sort", "[", 
          RowBox[{"Sort", "/@", "xl"}], "]"}], ",", "opts"}], "]"}], 
       "\[Equal]", "1"}], ")"}]}], ";"}], 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"a", " ", "single", " ", "lineage", " ", "has", " ", "GF"}], "=",
      "1"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MakeEqns", "[", 
      RowBox[{
       RowBox[{"GF_", "[", 
        RowBox[{"\[Omega]_", ",", 
         RowBox[{"xl", ":", 
          RowBox[{"{", "___List", "}"}]}], ",", "opts___Rule"}], "]"}], ",", 
       RowBox[{"tp", ":", 
        RowBox[{"(", 
         RowBox[{"_List", "|", "All"}], ")"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ropts", "=", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"ReduceOpts", "[", 
            RowBox[{"{", "opts", "}"}], "]"}]}]}], ",", 
         RowBox[{"(*", " ", 
          RowBox[{
          "reduce", " ", "the", " ", "options", " ", "to", " ", "a", " ", 
           "standard", " ", "form"}], " ", "*)"}], "\[IndentingNewLine]", 
         "roptsB", ",", "roptsC", ",", "Bf", ",", "d\[Lambda]f", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\[Lambda]", "=", 
          RowBox[{
           RowBox[{"Coalescence", "/.", 
            RowBox[{"{", "opts", "}"}]}], "/.", 
           RowBox[{"Options", "[", "MakeEqns", "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"d\[Lambda]\[Lambda]", "=", 
          RowBox[{
           RowBox[{"ChangeCoalescence", "/.", 
            RowBox[{"{", "opts", "}"}]}], "/.", 
           RowBox[{"Options", "[", "MakeEqns", "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Bb", "=", 
          RowBox[{
           RowBox[{"Bottlenecks", "/.", 
            RowBox[{"{", "opts", "}"}]}], "/.", 
           RowBox[{"Options", "[", "MakeEqns", "]"}]}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Bf", "=", 
         RowBox[{"!", 
          RowBox[{"(", 
           RowBox[{"Bb", "\[Equal]", 
            RowBox[{"{", "}"}]}], ")"}]}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{"Bf", ",", 
          RowBox[{"roptsB", "=", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"DropEventsList", "[", 
             RowBox[{
              RowBox[{"{", "opts", "}"}], ",", "Bottlenecks"}], "]"}]}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"d\[Lambda]f", "=", 
         RowBox[{"!", 
          RowBox[{"(", 
           RowBox[{"d\[Lambda]\[Lambda]", "\[Equal]", 
            RowBox[{"{", "}"}]}], ")"}]}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{"d\[Lambda]f", ",", 
          RowBox[{"roptsC", "=", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"ChangeEventsList", "[", 
             RowBox[{
              RowBox[{"{", "opts", "}"}], ",", "ChangeCoalescence", ",", 
              RowBox[{"d\[Lambda]\[Lambda]", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], 
             "]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"GF", "[", 
          RowBox[{"\[Omega]", ",", 
           RowBox[{"Sort", "[", 
            RowBox[{"Sort", "/@", "xl"}], "]"}], ",", "ropts"}], "]"}], "==", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Lambda]", "[", "]"}], 
             RowBox[{"Total", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"GF", "[", 
                  RowBox[{"\[Omega]", ",", 
                   RowBox[{"Sort", "[", 
                    RowBox[{"Sort", "/@", "#"}], "]"}], ",", "ropts"}], "]"}],
                  ")"}], "&"}], "/@", 
               RowBox[{"Mergers", "[", 
                RowBox[{"xl", ",", "tp"}], "]"}]}], "]"}]}], 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "sums", " ", "over", " ", "all", " ", "pairwise", " ", 
               "coalescence"}], ";", " ", 
              RowBox[{
              "Sort", " ", "ensures", " ", "that", " ", "GF", " ", "with", 
               " ", "the", " ", "same", " ", "set", " ", "of", " ", 
               "lineages", " ", "are", " ", "treated", " ", "as", " ", 
               "equivalent"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
            RowBox[{"If", "[", 
             RowBox[{"Bf", ",", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                   RowBox[{"GF", "[", 
                    RowBox[{"\[Omega]", ",", 
                    RowBox[{"Sort", "[", 
                    RowBox[{"Sort", "/@", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", "roptsB"}], 
                    "]"}]}], ")"}], "&"}], "/@", 
                RowBox[{"MakeBottleneck", "[", 
                 RowBox[{
                  RowBox[{
                  "Bb", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], ",", "xl", ",", 
                  RowBox[{"Topology", "->", "tp"}]}], "]"}]}], "]"}], ",", 
              "0"}], "]"}], "\[IndentingNewLine]", "+", 
            RowBox[{"If", "[", 
             RowBox[{"d\[Lambda]f", ",", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"d\[Lambda]\[Lambda]", "\[LeftDoubleBracket]", 
                  RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "[", 
                 "]"}], 
                RowBox[{"GF", "[", 
                 RowBox[{"\[Omega]", ",", 
                  RowBox[{"Sort", "[", 
                   RowBox[{"Sort", "/@", "xl"}], "]"}], ",", "roptsC"}], 
                 "]"}]}], ")"}], ",", "0"}], "]"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"TotalRate", "[", 
             RowBox[{"xl", ",", "opts"}], "]"}], "+", 
            RowBox[{"Total", "[", 
             RowBox[{"\[Omega]", "/@", "xl"}], "]"}]}], ")"}]}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.451816960167666*^9, 3.451817050240202*^9}, {
   3.45181714243539*^9, 3.4518171461452208`*^9}, {3.4518187466752768`*^9, 
   3.451818787808736*^9}, {3.451818824659154*^9, 3.451818849226192*^9}, 
   3.451818884748993*^9, {3.4518189180553837`*^9, 3.451819012021847*^9}, {
   3.451819143168688*^9, 3.451819150880939*^9}, {3.4518210991423388`*^9, 
   3.451821258416922*^9}, {3.4518213079642477`*^9, 3.451821321786923*^9}, {
   3.4518213546874723`*^9, 3.451821416215108*^9}, {3.4518218883581676`*^9, 
   3.451821943897955*^9}, {3.4518219790066347`*^9, 3.451822082036336*^9}, {
   3.4518221431423607`*^9, 3.4518221493494387`*^9}, {3.4518224198949203`*^9, 
   3.451822426850383*^9}, 3.451823922232139*^9, {3.497627708522984*^9, 
   3.497627714208576*^9}, {3.497629960318728*^9, 3.497629961769705*^9}, {
   3.4976300105835257`*^9, 3.4976300122941008`*^9}, {3.497631535852659*^9, 
   3.497631539724635*^9}, {3.4976316132548857`*^9, 3.49763173375063*^9}, {
   3.497631766717923*^9, 3.497631791553844*^9}, {3.497632388374365*^9, 
   3.497632425686479*^9}, {3.497632468043236*^9, 3.497632604377015*^9}, {
   3.49763279067314*^9, 3.497632907781207*^9}, {3.497633721132181*^9, 
   3.497633723163425*^9}, {3.497633894974736*^9, 3.497633919308717*^9}, 
   3.498187415708362*^9, {3.5079753906485577`*^9, 3.5079753960409*^9}, 
   3.520534936602488*^9, {3.547371586666751*^9, 3.5473715888174763`*^9}, 
   3.547372017388856*^9, {3.547372498225038*^9, 3.547372535010606*^9}, {
   3.547372597241585*^9, 3.5473726621880608`*^9}, {3.5473732939116287`*^9, 
   3.547373295967802*^9}, 3.547453907119947*^9, {3.5474539403466587`*^9, 
   3.547453977929442*^9}, {3.547454037024377*^9, 3.54745406683953*^9}, {
   3.547454100928892*^9, 3.5474541014791327`*^9}, {3.547454169213201*^9, 
   3.5474541695436583`*^9}, {3.547540810896763*^9, 3.5475408341023903`*^9}, {
   3.5479614262061787`*^9, 3.547961432688324*^9}, {3.547961524841865*^9, 
   3.547961560723612*^9}, 3.547963676119136*^9, {3.548057751954565*^9, 
   3.5480577535290747`*^9}, {3.548057792097124*^9, 3.548057793296136*^9}, 
   3.548064849202746*^9, {3.548065014850788*^9, 3.548065016744721*^9}, {
   3.548065223049041*^9, 3.5480652233442698`*^9}, {3.601688686815626*^9, 
   3.6016886902138147`*^9}, {3.635313347076123*^9, 3.635313384092897*^9}, {
   3.635313870372386*^9, 3.6353140231962433`*^9}, {3.635314246764865*^9, 
   3.635314510049032*^9}, {3.63531456286863*^9, 3.6353146015744553`*^9}, 
   3.635314775867803*^9, {3.635314826871448*^9, 3.635314829751347*^9}, {
   3.6353148728175898`*^9, 3.6353148951696863`*^9}, {3.635314944302905*^9, 
   3.63531495326219*^9}, {3.635315054893272*^9, 3.635315088264377*^9}, 
   3.63531557406141*^9, 3.635316784898512*^9, {3.635406201379333*^9, 
   3.635406201697303*^9}, {3.6354062814228277`*^9, 3.635406389570315*^9}, {
   3.635406437353829*^9, 3.6354064636019907`*^9}, {3.6354065731508827`*^9, 
   3.63540666021354*^9}, {3.635406696055833*^9, 3.63540670030409*^9}, 
   3.6354069620178328`*^9, {3.6354075711207733`*^9, 3.6354075956668787`*^9}, {
   3.635408715899027*^9, 3.635408732588005*^9}, 3.63542676217176*^9, {
   3.648803611647718*^9, 3.648803672000259*^9}, {3.6488143971464653`*^9, 
   3.648814479224689*^9}, {3.6488895106580153`*^9, 3.648889511721079*^9}, {
   3.648889548196286*^9, 3.648889569841671*^9}, {3.648889628830139*^9, 
   3.64888965105892*^9}, {3.648897983093604*^9, 3.6488979835014877`*^9}, {
   3.648898018841053*^9, 3.648898048021646*^9}, {3.648898098025817*^9, 
   3.648898100457901*^9}, {3.648898137980304*^9, 3.6488981774513493`*^9}, {
   3.648898209022278*^9, 3.648898210342835*^9}, {3.648898487548233*^9, 
   3.6488985208173532`*^9}, {3.648906503950555*^9, 3.648906541568314*^9}, {
   3.648907423469431*^9, 3.6489074713299217`*^9}, {3.648973056026634*^9, 
   3.6489730607621403`*^9}, {3.648973179190241*^9, 3.648973189168178*^9}, {
   3.648973316243835*^9, 3.648973373709095*^9}, {3.6489734099810953`*^9, 
   3.6489734202085047`*^9}, {3.648973476500774*^9, 3.648973536962454*^9}, {
   3.64897366546728*^9, 3.6489738596165943`*^9}, 3.648973907638173*^9, {
   3.648974434339327*^9, 3.648974516102736*^9}, {3.648974822774806*^9, 
   3.64897490273664*^9}, {3.648980167647995*^9, 3.648980167999284*^9}, {
   3.648980205420464*^9, 3.648980234668194*^9}, {3.648980267231489*^9, 
   3.648980286489197*^9}, {3.648980326962191*^9, 3.648980346019079*^9}, 
   3.648980748625906*^9, {3.648980820486652*^9, 3.648980862901823*^9}, {
   3.648982636448224*^9, 3.648982637142192*^9}, {3.648982670772695*^9, 
   3.648982672402755*^9}, {3.648982765522936*^9, 3.6489827721606817`*^9}, {
   3.648982825293049*^9, 3.648982829011791*^9}, {3.648982862537094*^9, 
   3.648982871618294*^9}, {3.6489829146042433`*^9, 3.648982930904728*^9}, {
   3.6490509436401176`*^9, 3.649050962009869*^9}, 3.6490512453389997`*^9, {
   3.6490524919224987`*^9, 3.649052496449624*^9}, 
   3.6848429934068623`*^9},ExpressionUUID->"49a8f2d2-7b6c-4fd5-b5cd-\
1afe51be7348"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"multiple", " ", "deme", " ", "case"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"MakeEqns", "[", 
      RowBox[{"GF_", "[", 
       RowBox[{"\[Omega]_", ",", 
        RowBox[{"xl", ":", 
         RowBox[{"{", "___List", "}"}]}], ",", "dl_List", ",", 
        "opts___Rule"}], "]"}], "]"}], ":=", 
     RowBox[{"MakeEqns", "[", 
      RowBox[{
       RowBox[{"GF", "[", 
        RowBox[{"\[Omega]", ",", "xl", ",", "dl", ",", "opts"}], "]"}], ",", 
       "All"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MakeEqns", "[", 
      RowBox[{
       RowBox[{"GF_", "[", 
        RowBox[{"\[Omega]_", ",", 
         RowBox[{"xl", ":", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"{", "}"}], "..."}], ",", 
            RowBox[{"{", "_List", "}"}], ",", 
            RowBox[{
             RowBox[{"{", "}"}], "..."}]}], "}"}]}], ",", "dl_List", ",", 
         "opts___Rule"}], "]"}], ",", 
       RowBox[{"tp", ":", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", "___", "}"}], "|", "All"}], ")"}]}]}], "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"GF", "[", 
        RowBox[{"\[Omega]", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Sort", "[", 
            RowBox[{"Sort", "/@", "#"}], "]"}], "&"}], "/@", "xl"}], ",", 
         "dl", ",", "opts"}], "]"}], "\[Equal]", "1"}], ")"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MakeEqns", "[", 
      RowBox[{
       RowBox[{"GF_", "[", 
        RowBox[{"\[Omega]_", ",", 
         RowBox[{"xl", ":", 
          RowBox[{"{", "___List", "}"}]}], ",", "dl_List", ",", 
         "opts___Rule"}], "]"}], ",", 
       RowBox[{"tp", ":", 
        RowBox[{"(", 
         RowBox[{"_List", "|", "All"}], ")"}]}]}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"lvs", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"xl", ",", "1"}], "]"}]}], 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"set", " ", "of", " ", "leaves"}], ",", " ", 
           RowBox[{"across", " ", "all", " ", "demes"}]}], " ", "*)"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"nd", "=", 
          RowBox[{"Length", "[", "dl", "]"}]}], " ", 
         RowBox[{"(*", " ", 
          RowBox[{"#", " ", "of", " ", "demes"}], " ", "*)"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ropts", "=", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"ReduceOpts", "[", 
            RowBox[{"{", "opts", "}"}], "]"}]}]}], ",", 
         RowBox[{"(*", " ", 
          RowBox[{
          "reduce", " ", "the", " ", "options", " ", "to", " ", "a", " ", 
           "standard", " ", "form"}], " ", "*)"}], "\[IndentingNewLine]", 
         "roptsB", ",", "roptsC", ",", "roptsA", ",", "roptsM", ",", "Bf", 
         ",", "d\[Lambda]f", ",", "Mf", ",", "dMf", ",", "Af", ",", 
         "\[CapitalLambda]f", ",", "\[IndentingNewLine]", 
         RowBox[{"\[Lambda]", "=", 
          RowBox[{
           RowBox[{"Coalescence", "/.", 
            RowBox[{"{", "opts", "}"}]}], "/.", 
           RowBox[{"Options", "[", "MakeEqns", "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"M", "=", 
          RowBox[{
           RowBox[{"Migration", "/.", 
            RowBox[{"{", "opts", "}"}]}], "/.", 
           RowBox[{"Options", "[", "MakeEqns", "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\[CapitalLambda]", "=", 
          RowBox[{
           RowBox[{"Splits", "/.", 
            RowBox[{"{", "opts", "}"}]}], "/.", 
           RowBox[{"Options", "[", "MakeEqns", "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Aa", "=", 
          RowBox[{
           RowBox[{"Admixture", "/.", 
            RowBox[{"{", "opts", "}"}]}], "/.", 
           RowBox[{"Options", "[", "MakeEqns", "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"dmm", "=", 
          RowBox[{
           RowBox[{"ChangeMigration", "/.", 
            RowBox[{"{", "opts", "}"}]}], "/.", 
           RowBox[{"Options", "[", "MakeEqns", "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"d\[Lambda]\[Lambda]", "=", 
          RowBox[{
           RowBox[{"ChangeCoalescence", "/.", 
            RowBox[{"{", "opts", "}"}]}], "/.", 
           RowBox[{"Options", "[", "MakeEqns", "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Bb", "=", 
          RowBox[{
           RowBox[{"Bottlenecks", "/.", 
            RowBox[{"{", "opts", "}"}]}], "/.", 
           RowBox[{"Options", "[", "MakeEqns", "]"}]}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Af", "=", 
         RowBox[{"!", 
          RowBox[{"(", 
           RowBox[{"Aa", "\[Equal]", 
            RowBox[{"{", "}"}]}], ")"}]}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{"Af", ",", 
          RowBox[{"roptsA", "=", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"DropEventsList", "[", 
             RowBox[{
              RowBox[{"{", "opts", "}"}], ",", "Admixture"}], "]"}]}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Bf", "=", 
         RowBox[{"!", 
          RowBox[{"(", 
           RowBox[{"Bb", "\[Equal]", 
            RowBox[{"{", "}"}]}], ")"}]}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{"Bf", ",", 
          RowBox[{"roptsB", "=", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"DropEventsList", "[", 
             RowBox[{
              RowBox[{"{", "opts", "}"}], ",", "Bottlenecks"}], "]"}]}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"dMf", "=", 
         RowBox[{"!", 
          RowBox[{"(", 
           RowBox[{"dmm", "\[Equal]", 
            RowBox[{"{", "}"}]}], ")"}]}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{"dMf", ",", 
          RowBox[{"roptsM", "=", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"ChangeEventsList", "[", 
             RowBox[{
              RowBox[{"{", "opts", "}"}], ",", "ChangeMigration", ",", 
              RowBox[{"dmm", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], 
             "]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"d\[Lambda]f", "=", 
         RowBox[{"!", 
          RowBox[{"(", 
           RowBox[{"d\[Lambda]\[Lambda]", "\[Equal]", 
            RowBox[{"{", "}"}]}], ")"}]}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{"d\[Lambda]f", ",", 
          RowBox[{"roptsC", "=", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"ChangeEventsList", "[", 
             RowBox[{
              RowBox[{"{", "opts", "}"}], ",", "ChangeCoalescence", ",", 
              RowBox[{"d\[Lambda]\[Lambda]", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], 
             "]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"GF", "[", 
          RowBox[{"\[Omega]", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Sort", "[", 
              RowBox[{"Sort", "/@", "#"}], "]"}], "&"}], "/@", "xl"}], ",", 
           "dl", ",", "ropts"}], "]"}], "==", 
         RowBox[{
          FractionBox["1", 
           RowBox[{
            RowBox[{"TotalRate", "[", 
             RowBox[{"xl", ",", "dl", ",", "opts"}], "]"}], "+", 
            RowBox[{"Total", "[", 
             RowBox[{"\[Omega]", "/@", "lvs"}], "]"}]}]], 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Total", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                 RowBox[{"GF", "[", 
                  RowBox[{"\[Omega]", ",", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "dl", ",", "ropts"}], 
                  "]"}]}], ")"}], "&"}], "/@", 
              RowBox[{"MakeCoalescence", "[", 
               RowBox[{"\[Lambda]", ",", "xl", ",", "dl", ",", "tp"}], 
               "]"}]}], "]"}], "\[IndentingNewLine]", "+", 
            RowBox[{"Total", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
                 RowBox[{"GF", "[", 
                  RowBox[{"\[Omega]", ",", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", "ropts"}], "]"}]}], ")"}],
                "&"}], "/@", 
              RowBox[{"MakeSplit", "[", 
               RowBox[{"\[CapitalLambda]", ",", "xl", ",", "dl"}], "]"}]}], 
             "]"}], "\[IndentingNewLine]", "+", 
            RowBox[{"Total", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                 RowBox[{"GF", "[", 
                  RowBox[{"\[Omega]", ",", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "dl", ",", "ropts"}], 
                  "]"}]}], ")"}], "&"}], "/@", 
              RowBox[{"MakeMigration", "[", 
               RowBox[{"M", ",", "xl", ",", "dl"}], "]"}]}], "]"}], 
            "\[IndentingNewLine]", "+", 
            RowBox[{"If", "[", 
             RowBox[{"Af", ",", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                   RowBox[{"GF", "[", 
                    RowBox[{"\[Omega]", ",", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "dl", ",", "roptsA"}], 
                    "]"}]}], ")"}], "&"}], "/@", 
                RowBox[{"MakeAdmixture", "[", 
                 RowBox[{
                  RowBox[{
                  "Aa", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], ",", "xl", ",", "dl"}], "]"}]}],
                "]"}], ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
            RowBox[{"If", "[", 
             RowBox[{"Bf", ",", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                   RowBox[{"GF", "[", 
                    RowBox[{"\[Omega]", ",", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "dl", ",", "roptsB"}], 
                    "]"}]}], ")"}], "&"}], "/@", 
                RowBox[{"MakeBottleneck", "[", 
                 RowBox[{
                  RowBox[{
                  "Bb", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], ",", "xl", ",", "dl", ",", 
                  RowBox[{"Topology", "->", "tp"}]}], "]"}]}], "]"}], ",", 
              "0"}], "]"}], "\[IndentingNewLine]", "+", 
            RowBox[{"If", "[", 
             RowBox[{"d\[Lambda]f", ",", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"d\[Lambda]\[Lambda]", "\[LeftDoubleBracket]", 
                  RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "[", 
                 "]"}], 
                RowBox[{"GF", "[", 
                 RowBox[{"\[Omega]", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Sort", "[", 
                    RowBox[{"Sort", "/@", "#"}], "]"}], "&"}], "/@", "xl"}], 
                  ",", "roptsC"}], "]"}]}], ")"}], ",", "0"}], "]"}], 
            "\[IndentingNewLine]", "+", 
            RowBox[{"If", "[", 
             RowBox[{"dMf", ",", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"dmm", "\[LeftDoubleBracket]", 
                  RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "[", 
                 "]"}], 
                RowBox[{"GF", "[", 
                 RowBox[{"\[Omega]", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Sort", "[", 
                    RowBox[{"Sort", "/@", "#"}], "]"}], "&"}], "/@", "xl"}], 
                  ",", "roptsM"}], "]"}]}], ")"}], ",", "0"}], "]"}]}], 
           ")"}]}]}]}]}], "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.451816960167666*^9, 3.451817050240202*^9}, {
   3.45181714243539*^9, 3.4518171461452208`*^9}, {3.4518187466752768`*^9, 
   3.451818787808736*^9}, {3.451818824659154*^9, 3.451818849226192*^9}, 
   3.451818884748993*^9, {3.4518189180553837`*^9, 3.451819012021847*^9}, {
   3.451819143168688*^9, 3.451819150880939*^9}, {3.4518210991423388`*^9, 
   3.451821258416922*^9}, {3.4518213079642477`*^9, 3.451821321786923*^9}, {
   3.4518213546874723`*^9, 3.451821416215108*^9}, {3.4518218883581676`*^9, 
   3.451821943897955*^9}, {3.4518219790066347`*^9, 3.451822082036336*^9}, {
   3.4518221431423607`*^9, 3.4518221493494387`*^9}, {3.4518224198949203`*^9, 
   3.451822426850383*^9}, 3.451823922232139*^9, {3.497627708522984*^9, 
   3.497627714208576*^9}, {3.497629960318728*^9, 3.497629961769705*^9}, {
   3.4976300105835257`*^9, 3.4976300122941008`*^9}, {3.497631535852659*^9, 
   3.497631539724635*^9}, {3.4976316132548857`*^9, 3.49763173375063*^9}, {
   3.497631766717923*^9, 3.497631791553844*^9}, {3.497632388374365*^9, 
   3.497632425686479*^9}, {3.497632468043236*^9, 3.497632604377015*^9}, {
   3.49763279067314*^9, 3.497632907781207*^9}, {3.497633721132181*^9, 
   3.497633723163425*^9}, {3.497633894974736*^9, 3.497633919308717*^9}, 
   3.498187415708362*^9, {3.5079753906485577`*^9, 3.5079753960409*^9}, 
   3.520534936602488*^9, {3.547371586666751*^9, 3.5473715888174763`*^9}, 
   3.547372017388856*^9, {3.547372498225038*^9, 3.547372535010606*^9}, {
   3.547372597241585*^9, 3.5473726621880608`*^9}, {3.5473732939116287`*^9, 
   3.547373295967802*^9}, 3.547453907119947*^9, {3.5474539403466587`*^9, 
   3.547453977929442*^9}, {3.547454037024377*^9, 3.54745406683953*^9}, {
   3.547454100928892*^9, 3.5474541014791327`*^9}, {3.547454169213201*^9, 
   3.5474541695436583`*^9}, {3.547540810896763*^9, 3.5475408341023903`*^9}, {
   3.5479614262061787`*^9, 3.547961432688324*^9}, {3.547961524841865*^9, 
   3.547961560723612*^9}, 3.547963676119136*^9, {3.548057751954565*^9, 
   3.5480577535290747`*^9}, {3.548057792097124*^9, 3.548057793296136*^9}, 
   3.548064849202746*^9, {3.548065014850788*^9, 3.548065016744721*^9}, {
   3.548065223049041*^9, 3.5480652233442698`*^9}, {3.601688686815626*^9, 
   3.6016886902138147`*^9}, {3.635313347076123*^9, 3.635313384092897*^9}, {
   3.635313870372386*^9, 3.6353140231962433`*^9}, {3.635314246764865*^9, 
   3.635314510049032*^9}, {3.63531456286863*^9, 3.6353146015744553`*^9}, 
   3.635314775867803*^9, {3.635314826871448*^9, 3.635314829751347*^9}, {
   3.6353148728175898`*^9, 3.6353148951696863`*^9}, {3.635314944302905*^9, 
   3.63531495326219*^9}, {3.635315054893272*^9, 3.635315088264377*^9}, 
   3.63531557406141*^9, 3.635316784898512*^9, 3.635407555178866*^9, {
   3.6354087506465397`*^9, 3.635408792103134*^9}, 3.635424959660157*^9, {
   3.635426781971744*^9, 3.635426834047311*^9}, {3.635426944423079*^9, 
   3.635426948261766*^9}, {3.635429809069646*^9, 3.635429819217437*^9}, {
   3.6487136966775846`*^9, 3.648713715439601*^9}, {3.648714535414028*^9, 
   3.648714562882339*^9}, {3.6487145983291616`*^9, 3.648714716588379*^9}, {
   3.648715569520338*^9, 3.648715675242133*^9}, {3.648715818236817*^9, 
   3.6487158479285183`*^9}, 3.648715878981086*^9, {3.6487160150759907`*^9, 
   3.64871607978974*^9}, {3.648716407627832*^9, 3.64871640959284*^9}, {
   3.648716645751671*^9, 3.648716710496024*^9}, {3.6488036780644007`*^9, 
   3.648803678873352*^9}, {3.64889831086203*^9, 3.648898427154048*^9}, {
   3.648898575053117*^9, 3.648898633023259*^9}, {3.64890649114491*^9, 
   3.648906498557529*^9}, {3.6489730717812977`*^9, 3.64897307543417*^9}, {
   3.649051219732581*^9, 3.649051241110189*^9}, {3.649051415674005*^9, 
   3.64905151098785*^9}, {3.649051800698453*^9, 3.649051892469887*^9}, {
   3.649051959696748*^9, 3.649051972585473*^9}, 3.6490520049969063`*^9, {
   3.6490520540304527`*^9, 3.649052103133794*^9}, {3.649052216348934*^9, 
   3.6490522401519957`*^9}, {3.649052285298996*^9, 3.649052313703025*^9}, {
   3.649052455486948*^9, 3.649052469492489*^9}, 3.6490554784824657`*^9, {
   3.649055590646158*^9, 3.64905562178625*^9}, {3.649056899829022*^9, 
   3.649056921065394*^9}, {3.649058835905959*^9, 3.649058836416654*^9}, {
   3.6492319247713757`*^9, 3.649231932592957*^9}, {3.649232387522644*^9, 
   3.649232391737132*^9}, {3.649232443722843*^9, 3.6492324444926367`*^9}, {
   3.651400206376705*^9, 3.651400209584502*^9}, {3.651400248027824*^9, 
   3.651400251203451*^9}, {3.651468334288227*^9, 
   3.6514683367124434`*^9}},ExpressionUUID->"62de9448-b1a6-4c1e-ba69-\
807b956fc678"],

Cell[TextData[{
 StyleBox["Note:",
  FontWeight->"Bold"],
 " Sort[Sort/@xl] sorts lineages in a single deme into standard order.  For \
multiple demes, Sort[Sort/@#]&/@xl should be used: it is important to retain \
the order of demes.  This is done inside MakeCoalescence etc. "
}], "Text",
 CellChangeTimes->{{3.649055400843975*^9, 3.6490554651710033`*^9}, {
  3.6490555548445168`*^9, 3.649055567329484*^9}, {3.6490568755990067`*^9, 
  3.649056887972692*^9}},ExpressionUUID->"608cd069-9f99-42ff-a311-\
68686588e081"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Sort", "[", 
    RowBox[{"Sort", "/@", "#"}], "]"}], "&"}], "/@", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "c"}], "}"}], ",", 
      RowBox[{"{", "d", "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "b", "}"}], ",", 
      RowBox[{"{", "a", "}"}]}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.649055487933322*^9, 
  3.649055540951283*^9}},ExpressionUUID->"65264c3c-53cb-42f3-b662-\
f6e55bcf6940"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "d", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", "x"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "a", "}"}], ",", 
     RowBox[{"{", "b", "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6490555212649612`*^9, 
  3.6490555417509193`*^9}},ExpressionUUID->"01e6238f-0c49-4146-bb2e-\
35d605644445"]
}, Open  ]],

Cell[TextData[{
 StyleBox["Example: ",
  FontWeight->"Bold"],
 "For a single demes, there can be coalescence, bottlenecks, and/or a change \
in rate of coalescence.  The default is coalescence at rate 1:"
}], "Text",
 CellChangeTimes->{{3.649049386470231*^9, 
  3.6490494558082113`*^9}},ExpressionUUID->"2287873f-9710-49c5-89f1-\
ceab135086da"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MakeEqns", "[", 
  RowBox[{"\[Psi]", "[", 
   RowBox[{"\[Omega]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "a", "}"}], ",", 
      RowBox[{"{", "b", "}"}], ",", 
      RowBox[{"{", "c", "}"}]}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6490494154498568`*^9, 
  3.649049415585327*^9}},ExpressionUUID->"f5b18150-099d-4161-bf2e-\
bec136584367"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Psi]", "[", 
   RowBox[{"\[Omega]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "a", "}"}], ",", 
      RowBox[{"{", "b", "}"}], ",", 
      RowBox[{"{", "c", "}"}]}], "}"}]}], "]"}], "\[Equal]", 
  FractionBox[
   RowBox[{
    RowBox[{"\[Psi]", "[", 
     RowBox[{"\[Omega]", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "a", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"b", ",", "c"}], "}"}]}], "}"}]}], "]"}], "+", 
    RowBox[{"\[Psi]", "[", 
     RowBox[{"\[Omega]", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "b", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"a", ",", "c"}], "}"}]}], "}"}]}], "]"}], "+", 
    RowBox[{"\[Psi]", "[", 
     RowBox[{"\[Omega]", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "c", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}]}], "}"}]}], "]"}]}], 
   RowBox[{"3", "+", 
    RowBox[{"\[Omega]", "[", 
     RowBox[{"{", "a", "}"}], "]"}], "+", 
    RowBox[{"\[Omega]", "[", 
     RowBox[{"{", "b", "}"}], "]"}], "+", 
    RowBox[{"\[Omega]", "[", 
     RowBox[{"{", "c", "}"}], "]"}]}]]}]], "Output",
 CellChangeTimes->{
  3.6490494162872458`*^9},ExpressionUUID->"392054f6-8450-4b05-bbea-\
9699ac6e26ae"]
}, Open  ]],

Cell["\<\
The initial rate of coalescence can be specified, and there can be one or \
more changes in he rate of coalescence: \
\>", "Text",
 CellChangeTimes->{{3.649049508707662*^9, 3.649049516978237*^9}, {
  3.649049560806993*^9, 3.649049612611928*^9}, {3.6490496808988247`*^9, 
  3.649049702119895*^9}},ExpressionUUID->"959202bd-5713-4199-8a88-\
a3e774c7bb43"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MakeEqns", "[", 
  RowBox[{"\[Psi]", "[", 
   RowBox[{"\[Omega]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "a", "}"}], ",", 
      RowBox[{"{", "b", "}"}], ",", 
      RowBox[{"{", "c", "}"}]}], "}"}], ",", 
    RowBox[{"Coalescence", "\[Rule]", 
     SubscriptBox["\[Lambda]", "0"]}], ",", 
    RowBox[{"ChangeCoalescence", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["d\[Lambda]", "1"], ",", 
         SubscriptBox["\[Lambda]", "1"]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["d\[Lambda]", "2"], ",", 
         SubscriptBox["\[Lambda]", "2"]}], "}"}]}], "}"}]}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.648974291757496*^9, 3.6489743354050417`*^9}, {
  3.648974372678856*^9, 3.64897437299559*^9}, {3.64897452234317*^9, 
  3.6489745351302547`*^9}, {3.648974622382596*^9, 3.648974622726705*^9}, {
  3.6489746629362707`*^9, 3.648974696327221*^9}, {3.6489803526036777`*^9, 
  3.6489803608180656`*^9}},ExpressionUUID->"7d2d1f48-e593-40ec-85cf-\
57ebd08c6d08"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Psi]", "[", 
   RowBox[{"\[Omega]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "a", "}"}], ",", 
      RowBox[{"{", "b", "}"}], ",", 
      RowBox[{"{", "c", "}"}]}], "}"}], ",", 
    RowBox[{"ChangeCoalescence", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["d\[Lambda]", "1"], ",", 
         SubscriptBox["\[Lambda]", "1"]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["d\[Lambda]", "2"], ",", 
         SubscriptBox["\[Lambda]", "2"]}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Coalescence", "\[Rule]", 
     SubscriptBox["\[Lambda]", "0"]}]}], "]"}], "\[Equal]", 
  RowBox[{
   FractionBox["1", 
    RowBox[{
     RowBox[{"\[Omega]", "[", 
      RowBox[{"{", "a", "}"}], "]"}], "+", 
     RowBox[{"\[Omega]", "[", 
      RowBox[{"{", "b", "}"}], "]"}], "+", 
     RowBox[{"\[Omega]", "[", 
      RowBox[{"{", "c", "}"}], "]"}], "+", 
     RowBox[{
      SubscriptBox["d\[Lambda]", "1"], "[", "]"}], "+", 
     RowBox[{"3", " ", 
      RowBox[{
       SubscriptBox["\[Lambda]", "0"], "[", "]"}]}]}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Psi]", "[", 
       RowBox[{"\[Omega]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "a", "}"}], ",", 
          RowBox[{"{", "b", "}"}], ",", 
          RowBox[{"{", "c", "}"}]}], "}"}], ",", 
        RowBox[{"ChangeCoalescence", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["d\[Lambda]", "2"], ",", 
            SubscriptBox["\[Lambda]", "2"]}], "}"}], "}"}]}], ",", 
        RowBox[{"Coalescence", "\[Rule]", 
         SubscriptBox["\[Lambda]", "1"]}]}], "]"}], " ", 
      RowBox[{
       SubscriptBox["d\[Lambda]", "1"], "[", "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Psi]", "[", 
         RowBox[{"\[Omega]", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "a", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"b", ",", "c"}], "}"}]}], "}"}], ",", 
          RowBox[{"ChangeCoalescence", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["d\[Lambda]", "1"], ",", 
               SubscriptBox["\[Lambda]", "1"]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["d\[Lambda]", "2"], ",", 
               SubscriptBox["\[Lambda]", "2"]}], "}"}]}], "}"}]}], ",", 
          RowBox[{"Coalescence", "\[Rule]", 
           SubscriptBox["\[Lambda]", "0"]}]}], "]"}], "+", 
        RowBox[{"\[Psi]", "[", 
         RowBox[{"\[Omega]", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "b", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "c"}], "}"}]}], "}"}], ",", 
          RowBox[{"ChangeCoalescence", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["d\[Lambda]", "1"], ",", 
               SubscriptBox["\[Lambda]", "1"]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["d\[Lambda]", "2"], ",", 
               SubscriptBox["\[Lambda]", "2"]}], "}"}]}], "}"}]}], ",", 
          RowBox[{"Coalescence", "\[Rule]", 
           SubscriptBox["\[Lambda]", "0"]}]}], "]"}], "+", 
        RowBox[{"\[Psi]", "[", 
         RowBox[{"\[Omega]", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "c", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "b"}], "}"}]}], "}"}], ",", 
          RowBox[{"ChangeCoalescence", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["d\[Lambda]", "1"], ",", 
               SubscriptBox["\[Lambda]", "1"]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["d\[Lambda]", "2"], ",", 
               SubscriptBox["\[Lambda]", "2"]}], "}"}]}], "}"}]}], ",", 
          RowBox[{"Coalescence", "\[Rule]", 
           SubscriptBox["\[Lambda]", "0"]}]}], "]"}]}], ")"}], " ", 
      RowBox[{
       SubscriptBox["\[Lambda]", "0"], "[", "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.648974315728095*^9, 3.6489743364019547`*^9}, {
   3.64897437043439*^9, 3.6489743736568336`*^9}, {3.6489745189465437`*^9, 
   3.6489745355729847`*^9}, 3.6489745886752357`*^9, 3.64897462320787*^9, 
   3.648974696957321*^9, 3.64897483595924*^9, 3.648974866495718*^9, 
   3.64897490621696*^9, 3.6489790727751637`*^9, 3.648980130228109*^9, 
   3.6489802890908537`*^9, {3.648980348151773*^9, 3.6489803623476143`*^9}, 
   3.6489823556017227`*^9, 
   3.648983748006577*^9},ExpressionUUID->"213b337e-7393-4118-a106-\
e1d49ff3b66c"]
}, Open  ]],

Cell["\<\
There can be one or more bottlenecks; before the bottleneck, all \
configurations are possible:\
\>", "Text",
 CellChangeTimes->{{3.649049713208329*^9, 3.6490497375573378`*^9}, 
   3.649050995799087*^9},ExpressionUUID->"e81a5993-aa46-48b2-923b-\
71d2180c2657"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MakeEqns", "[", 
  RowBox[{"\[Psi]", "[", 
   RowBox[{"\[Omega]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "a", "}"}], ",", 
      RowBox[{"{", "b", "}"}], ",", 
      RowBox[{"{", "c", "}"}]}], "}"}], ",", 
    RowBox[{"Bottlenecks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["B", "1"], ",", 
         SubscriptBox["b", "1"]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["B", "2"], ",", 
         SubscriptBox["b", "2"]}], "}"}]}], "}"}]}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.648974291757496*^9, 3.6489743354050417`*^9}, {
  3.648974372678856*^9, 3.64897437299559*^9}, {3.64897452234317*^9, 
  3.6489745351302547`*^9}, {3.648974622382596*^9, 3.648974622726705*^9}, {
  3.6489746629362707`*^9, 3.648974696327221*^9}, {3.6489803526036777`*^9, 
  3.6489803608180656`*^9}, {3.648982399772685*^9, 3.6489824245309887`*^9}, {
  3.64898256270922*^9, 
  3.648982566802286*^9}},ExpressionUUID->"1600d4b5-2537-4074-bda9-\
3cc0bc02d110"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Psi]", "[", 
   RowBox[{"\[Omega]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "a", "}"}], ",", 
      RowBox[{"{", "b", "}"}], ",", 
      RowBox[{"{", "c", "}"}]}], "}"}], ",", 
    RowBox[{"Bottlenecks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["B", "1"], ",", 
         SubscriptBox["b", "1"]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["B", "2"], ",", 
         SubscriptBox["b", "2"]}], "}"}]}], "}"}]}]}], "]"}], "\[Equal]", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"3", "+", 
     RowBox[{"\[Omega]", "[", 
      RowBox[{"{", "a", "}"}], "]"}], "+", 
     RowBox[{"\[Omega]", "[", 
      RowBox[{"{", "b", "}"}], "]"}], "+", 
     RowBox[{"\[Omega]", "[", 
      RowBox[{"{", "c", "}"}], "]"}], "+", 
     RowBox[{
      SubscriptBox["B", "1"], "[", "]"}]}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[Psi]", "[", 
      RowBox[{"\[Omega]", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "c"}], "}"}]}], "}"}], ",", 
       RowBox[{"Bottlenecks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["B", "1"], ",", 
            SubscriptBox["b", "1"]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["B", "2"], ",", 
            SubscriptBox["b", "2"]}], "}"}]}], "}"}]}]}], "]"}], "+", 
     RowBox[{"\[Psi]", "[", 
      RowBox[{"\[Omega]", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "b", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "c"}], "}"}]}], "}"}], ",", 
       RowBox[{"Bottlenecks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["B", "1"], ",", 
            SubscriptBox["b", "1"]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["B", "2"], ",", 
            SubscriptBox["b", "2"]}], "}"}]}], "}"}]}]}], "]"}], "+", 
     RowBox[{"\[Psi]", "[", 
      RowBox[{"\[Omega]", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "c", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}]}], "}"}], ",", 
       RowBox[{"Bottlenecks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["B", "1"], ",", 
            SubscriptBox["b", "1"]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["B", "2"], ",", 
            SubscriptBox["b", "2"]}], "}"}]}], "}"}]}]}], "]"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{
         FractionBox["3", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           SubscriptBox["b", "1"]}], ")"}]}], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", 
            SubscriptBox["b", "1"]}], ")"}], "3"]}]}], ")"}], " ", 
      RowBox[{"\[Psi]", "[", 
       RowBox[{"\[Omega]", ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b", ",", "c"}], "}"}], "}"}], ",", 
        RowBox[{"Bottlenecks", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["B", "2"], ",", 
            SubscriptBox["b", "2"]}], "}"}], "}"}]}]}], "]"}], " ", 
      RowBox[{
       SubscriptBox["B", "1"], "[", "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "3"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         FractionBox["3", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           SubscriptBox["b", "1"]}], ")"}]}], "-", 
        RowBox[{
         FractionBox["3", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", 
            SubscriptBox["b", "1"]}], ")"}], "3"]}]}], ")"}], " ", 
      RowBox[{"\[Psi]", "[", 
       RowBox[{"\[Omega]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "a", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"b", ",", "c"}], "}"}]}], "}"}], ",", 
        RowBox[{"Bottlenecks", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["B", "2"], ",", 
            SubscriptBox["b", "2"]}], "}"}], "}"}]}]}], "]"}], " ", 
      RowBox[{
       SubscriptBox["B", "1"], "[", "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "3"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         FractionBox["3", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           SubscriptBox["b", "1"]}], ")"}]}], "-", 
        RowBox[{
         FractionBox["3", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", 
            SubscriptBox["b", "1"]}], ")"}], "3"]}]}], ")"}], " ", 
      RowBox[{"\[Psi]", "[", 
       RowBox[{"\[Omega]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "b", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "c"}], "}"}]}], "}"}], ",", 
        RowBox[{"Bottlenecks", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["B", "2"], ",", 
            SubscriptBox["b", "2"]}], "}"}], "}"}]}]}], "]"}], " ", 
      RowBox[{
       SubscriptBox["B", "1"], "[", "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "3"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         FractionBox["3", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           SubscriptBox["b", "1"]}], ")"}]}], "-", 
        RowBox[{
         FractionBox["3", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", 
            SubscriptBox["b", "1"]}], ")"}], "3"]}]}], ")"}], " ", 
      RowBox[{"\[Psi]", "[", 
       RowBox[{"\[Omega]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "c", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "b"}], "}"}]}], "}"}], ",", 
        RowBox[{"Bottlenecks", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["B", "2"], ",", 
            SubscriptBox["b", "2"]}], "}"}], "}"}]}]}], "]"}], " ", 
      RowBox[{
       SubscriptBox["B", "1"], "[", "]"}]}], "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["b", "1"]}], ")"}], "3"], " ", 
      RowBox[{"\[Psi]", "[", 
       RowBox[{"\[Omega]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "a", "}"}], ",", 
          RowBox[{"{", "b", "}"}], ",", 
          RowBox[{"{", "c", "}"}]}], "}"}], ",", 
        RowBox[{"Bottlenecks", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["B", "2"], ",", 
            SubscriptBox["b", "2"]}], "}"}], "}"}]}]}], "]"}], " ", 
      RowBox[{
       SubscriptBox["B", "1"], "[", "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.648983774248562*^9, 3.648984348678587*^9, 
  3.649050991795464*^9},ExpressionUUID->"d812b2cc-ed47-468b-bbe7-\
16f6ae846b1f"]
}, Open  ]],

Cell[TextData[{
 "There can be a change in the rate of coalescence - in this example from the \
default ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Lambda]", "0"], "=", "1"}], TraditionalForm]],
  ExpressionUUID->"6173368d-eac3-4795-a145-9d14edd7a36c"],
 " to ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Lambda]", "1"], TraditionalForm]],ExpressionUUID->
  "35c2b377-92fb-40d8-9df1-58b10c3c2126"],
 ":"
}], "Text",
 CellChangeTimes->{{3.6490511588082438`*^9, 
  3.649051188380335*^9}},ExpressionUUID->"2a5a4030-4b70-4710-ab3d-\
43b8554f9985"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MakeEqns", "[", 
  RowBox[{"\[Psi]", "[", 
   RowBox[{"\[Omega]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "a", "}"}], ",", 
      RowBox[{"{", "b", "}"}], ",", 
      RowBox[{"{", "c", "}"}]}], "}"}], ",", 
    RowBox[{"ChangeCoalescence", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["d\[Lambda]", "1"], ",", 
         SubscriptBox["\[Lambda]", "1"]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["d\[Lambda]", "2"], ",", 
         SubscriptBox["\[Lambda]", "2"]}], "}"}]}], "}"}]}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.648974291757496*^9, 3.6489743354050417`*^9}, {
  3.648974372678856*^9, 3.64897437299559*^9}, {3.64897452234317*^9, 
  3.6489745351302547`*^9}, {3.648974622382596*^9, 3.648974622726705*^9}, {
  3.6489746629362707`*^9, 3.648974696327221*^9}, {3.6489803526036777`*^9, 
  3.6489803608180656`*^9}, {3.648982399772685*^9, 3.6489824245309887`*^9}, {
  3.64898256270922*^9, 3.648982566802286*^9}, {3.6490511027432003`*^9, 
  3.649051132858749*^9}},ExpressionUUID->"ff1061a1-1f54-4dc4-859f-\
064524a26f41"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Psi]", "[", 
   RowBox[{"\[Omega]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "a", "}"}], ",", 
      RowBox[{"{", "b", "}"}], ",", 
      RowBox[{"{", "c", "}"}]}], "}"}], ",", 
    RowBox[{"ChangeCoalescence", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["d\[Lambda]", "1"], ",", 
         SubscriptBox["\[Lambda]", "1"]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["d\[Lambda]", "2"], ",", 
         SubscriptBox["\[Lambda]", "2"]}], "}"}]}], "}"}]}]}], "]"}], 
  "\[Equal]", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"3", "+", 
     RowBox[{"\[Omega]", "[", 
      RowBox[{"{", "a", "}"}], "]"}], "+", 
     RowBox[{"\[Omega]", "[", 
      RowBox[{"{", "b", "}"}], "]"}], "+", 
     RowBox[{"\[Omega]", "[", 
      RowBox[{"{", "c", "}"}], "]"}], "+", 
     RowBox[{
      SubscriptBox["d\[Lambda]", "1"], "[", "]"}]}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[Psi]", "[", 
      RowBox[{"\[Omega]", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "c"}], "}"}]}], "}"}], ",", 
       RowBox[{"ChangeCoalescence", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["d\[Lambda]", "1"], ",", 
            SubscriptBox["\[Lambda]", "1"]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["d\[Lambda]", "2"], ",", 
            SubscriptBox["\[Lambda]", "2"]}], "}"}]}], "}"}]}]}], "]"}], "+", 
     RowBox[{"\[Psi]", "[", 
      RowBox[{"\[Omega]", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "b", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "c"}], "}"}]}], "}"}], ",", 
       RowBox[{"ChangeCoalescence", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["d\[Lambda]", "1"], ",", 
            SubscriptBox["\[Lambda]", "1"]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["d\[Lambda]", "2"], ",", 
            SubscriptBox["\[Lambda]", "2"]}], "}"}]}], "}"}]}]}], "]"}], "+", 
     RowBox[{"\[Psi]", "[", 
      RowBox[{"\[Omega]", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "c", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}]}], "}"}], ",", 
       RowBox[{"ChangeCoalescence", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["d\[Lambda]", "1"], ",", 
            SubscriptBox["\[Lambda]", "1"]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["d\[Lambda]", "2"], ",", 
            SubscriptBox["\[Lambda]", "2"]}], "}"}]}], "}"}]}]}], "]"}], "+", 
     RowBox[{
      RowBox[{"\[Psi]", "[", 
       RowBox[{"\[Omega]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "a", "}"}], ",", 
          RowBox[{"{", "b", "}"}], ",", 
          RowBox[{"{", "c", "}"}]}], "}"}], ",", 
        RowBox[{"ChangeCoalescence", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["d\[Lambda]", "2"], ",", 
            SubscriptBox["\[Lambda]", "2"]}], "}"}], "}"}]}], ",", 
        RowBox[{"Coalescence", "\[Rule]", 
         SubscriptBox["\[Lambda]", "1"]}]}], "]"}], " ", 
      RowBox[{
       SubscriptBox["d\[Lambda]", "1"], "[", "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.649051134252225*^9},ExpressionUUID->"905110ef-234d-4fd4-9c14-\
cadffe1dd3f5"]
}, Open  ]],

Cell[TextData[{
 StyleBox["Note:",
  FontWeight->"Bold"],
 " The parameter is written as ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Lambda]", "0"], "[", " ", "]"}], TraditionalForm]],
  ExpressionUUID->"f96d0731-94d5-498f-adb2-49246478cd60"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["B", "1"], "[", "]"}], TraditionalForm]],ExpressionUUID->
  "ab223726-dfad-4809-864c-bf2fb24954f0"],
 ", etc, to be consistent with the multideme case, where it is a function of \
the deme, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Lambda]", "0"], "[", 
    RowBox[{"{", "x", "}"}], "]"}], TraditionalForm]],ExpressionUUID->
  "778659ec-ceac-4ac0-8832-3b1dd43fd1ea"],
 ", say."
}], "Text",
 CellChangeTimes->{{3.649049508707662*^9, 3.649049516978237*^9}, {
  3.649049560806993*^9, 3.649049643013905*^9}, {3.64905103273278*^9, 
  3.6490510466508408`*^9}},ExpressionUUID->"44930104-2430-4318-b011-\
e2cd9fac8682"],

Cell[TextData[{
 StyleBox["Example: ",
  FontWeight->"Bold"],
 "For multiple demes, there can be coalescence, migration, bottlenecks, \
admixture events, and/or a change in rate of coalescence or migration.  The \
default is coalescence at rate 1.  Note that the lineages are all are sorted \
into standard order, so that equivalent \[Psi][] are treated properly:"
}], "Text",
 CellChangeTimes->{{3.649049386470231*^9, 3.6490494558082113`*^9}, {
  3.6490510631379232`*^9, 3.649051095637596*^9}, {3.649052517568903*^9, 
  3.649052531269652*^9}, {3.6490570562703037`*^9, 
  3.6490570882346573`*^9}},ExpressionUUID->"6e077b25-9ae8-40d2-a0d0-\
381798cde3bb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MakeEqns", "[", 
  RowBox[{"\[Psi]", "[", 
   RowBox[{"\[Omega]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"e", ",", "d"}], "}"}], ",", 
        RowBox[{"{", "c", "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "b", "}"}], ",", 
        RowBox[{"{", "a", "}"}]}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "x", "}"}], ",", 
      RowBox[{"{", "y", "}"}]}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.649052350102442*^9, 3.6490523803332167`*^9}, 
   3.6490570410116158`*^9},ExpressionUUID->"dd968676-0050-4b0e-8daa-\
8d25a7998c67"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Psi]", "[", 
   RowBox[{"\[Omega]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "c", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"d", ",", "e"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "a", "}"}], ",", 
        RowBox[{"{", "b", "}"}]}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "x", "}"}], ",", 
      RowBox[{"{", "y", "}"}]}], "}"}]}], "]"}], "\[Equal]", 
  FractionBox[
   RowBox[{
    RowBox[{"\[Psi]", "[", 
     RowBox[{"\[Omega]", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"c", ",", "d", ",", "e"}], "}"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "a", "}"}], ",", 
          RowBox[{"{", "b", "}"}]}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "x", "}"}], ",", 
        RowBox[{"{", "y", "}"}]}], "}"}]}], "]"}], "+", 
    RowBox[{"\[Psi]", "[", 
     RowBox[{"\[Omega]", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "c", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"d", ",", "e"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "x", "}"}], ",", 
        RowBox[{"{", "y", "}"}]}], "}"}]}], "]"}]}], 
   RowBox[{"2", "+", 
    RowBox[{"\[Omega]", "[", 
     RowBox[{"{", "a", "}"}], "]"}], "+", 
    RowBox[{"\[Omega]", "[", 
     RowBox[{"{", "b", "}"}], "]"}], "+", 
    RowBox[{"\[Omega]", "[", 
     RowBox[{"{", "c", "}"}], "]"}], "+", 
    RowBox[{"\[Omega]", "[", 
     RowBox[{"{", 
      RowBox[{"e", ",", "d"}], "}"}], "]"}]}]]}]], "Output",
 CellChangeTimes->{3.64905238261905*^9, 3.649052512667837*^9, 
  3.649056938205158*^9, 
  3.6490570416395073`*^9},ExpressionUUID->"699d7ff8-b7ad-4da3-8233-\
d0d0e3e0aab4"]
}, Open  ]],

Cell[TextData[{
 "Coalescence rates can be changed from ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Lambda]", "0"], TraditionalForm]],ExpressionUUID->
  "4a1fb3e4-ff49-4831-a50d-37ff83940626"],
 " to ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Lambda]", "1"], TraditionalForm]],ExpressionUUID->
  "da108085-dca1-4e75-a4c2-f1ebae4460c2"],
 "; a further change from ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Lambda]", "1"], TraditionalForm]],ExpressionUUID->
  "ec6fe1e4-e987-44cb-b214-f2146a99168c"],
 " to ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Lambda]", "2"], TraditionalForm]],ExpressionUUID->
  "6eebc111-b56f-48fe-8a76-08583db149f3"],
 " is pending:"
}], "Text",
 CellChangeTimes->{{3.6490571209334593`*^9, 3.649057128046545*^9}, {
  3.649057214439046*^9, 
  3.6490572354042063`*^9}},ExpressionUUID->"3f3d2b7f-3b82-4b15-b5a0-\
97596013a9e2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MakeEqns", "[", 
  RowBox[{"\[Psi]", "[", 
   RowBox[{"\[Omega]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "a", "}"}], ",", 
        RowBox[{"{", "b", "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", "c", "}"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "x", "}"}], ",", 
      RowBox[{"{", "y", "}"}]}], "}"}], ",", 
    RowBox[{"Coalescence", "\[Rule]", 
     SubscriptBox["\[Lambda]", "0"]}], ",", 
    RowBox[{"ChangeCoalescence", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["d\[Lambda]", "1"], ",", 
         SubscriptBox["\[Lambda]", "1"]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["d\[Lambda]", "2"], ",", 
         SubscriptBox["\[Lambda]", "2"]}], "}"}]}], "}"}]}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.649052350102442*^9, 3.649052410901507*^9}, {
  3.6490569496717577`*^9, 3.649056979905785*^9}, {3.6490570994311647`*^9, 
  3.649057105615209*^9}, {3.649057150414481*^9, 
  3.64905716610019*^9}},ExpressionUUID->"df28291c-3142-47e3-8752-\
29c8191a066c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Psi]", "[", 
   RowBox[{"\[Omega]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "a", "}"}], ",", 
        RowBox[{"{", "b", "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", "c", "}"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "x", "}"}], ",", 
      RowBox[{"{", "y", "}"}]}], "}"}], ",", 
    RowBox[{"ChangeCoalescence", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["d\[Lambda]", "1"], ",", 
         SubscriptBox["\[Lambda]", "1"]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["d\[Lambda]", "2"], ",", 
         SubscriptBox["\[Lambda]", "2"]}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Coalescence", "\[Rule]", 
     SubscriptBox["\[Lambda]", "0"]}]}], "]"}], "\[Equal]", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Psi]", "[", 
       RowBox[{"\[Omega]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "a", "}"}], ",", 
            RowBox[{"{", "b", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", "c", "}"}], "}"}]}], "}"}], ",", 
        RowBox[{"ChangeCoalescence", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["d\[Lambda]", "2"], ",", 
            SubscriptBox["\[Lambda]", "2"]}], "}"}], "}"}]}], ",", 
        RowBox[{"Coalescence", "\[Rule]", 
         SubscriptBox["\[Lambda]", "1"]}]}], "]"}], " ", 
      RowBox[{
       SubscriptBox["d\[Lambda]", "1"], "[", "]"}]}], "+", 
     RowBox[{
      RowBox[{"\[Psi]", "[", 
       RowBox[{"\[Omega]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"a", ",", "b"}], "}"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", "c", "}"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "x", "}"}], ",", 
          RowBox[{"{", "y", "}"}]}], "}"}], ",", 
        RowBox[{"ChangeCoalescence", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             SubscriptBox["d\[Lambda]", "1"], ",", 
             SubscriptBox["\[Lambda]", "1"]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             SubscriptBox["d\[Lambda]", "2"], ",", 
             SubscriptBox["\[Lambda]", "2"]}], "}"}]}], "}"}]}], ",", 
        RowBox[{"Coalescence", "\[Rule]", 
         SubscriptBox["\[Lambda]", "0"]}]}], "]"}], " ", 
      RowBox[{
       SubscriptBox["\[Lambda]", "0"], "[", 
       RowBox[{"{", "x", "}"}], "]"}]}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[Omega]", "[", 
      RowBox[{"{", "a", "}"}], "]"}], "+", 
     RowBox[{"\[Omega]", "[", 
      RowBox[{"{", "b", "}"}], "]"}], "+", 
     RowBox[{"\[Omega]", "[", 
      RowBox[{"{", "c", "}"}], "]"}], "+", 
     RowBox[{
      SubscriptBox["d\[Lambda]", "1"], "[", 
      RowBox[{"{", "x", "}"}], "]"}], "+", 
     RowBox[{
      SubscriptBox["d\[Lambda]", "1"], "[", 
      RowBox[{"{", "y", "}"}], "]"}], "+", 
     RowBox[{
      SubscriptBox["\[Lambda]", "0"], "[", 
      RowBox[{"{", "x", "}"}], "]"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.649052411839149*^9, {3.649056941634409*^9, 3.6490569805444*^9}, 
   3.649057107290964*^9, {3.649057171802552*^9, 
   3.649057181209435*^9}},ExpressionUUID->"7417dd22-badb-4bff-975e-\
844b13f62e66"]
}, Open  ]],

Cell[TextData[{
 "This implements migration ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["M", "0"], TraditionalForm]],ExpressionUUID->
  "84b8404e-b6d9-41cf-bfa2-bc1c3b9ecd3a"],
 ", and a change in migration rate from ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["M", "0"], TraditionalForm]],ExpressionUUID->
  "b944d123-32c5-4a1a-8e81-7c3c8d57f51a"],
 " to ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["M", "1"], TraditionalForm]],ExpressionUUID->
  "31163ba7-2423-4548-a622-30b999b92369"],
 ":"
}], "Text",
 CellChangeTimes->{{3.649057302958396*^9, 
  3.649057333002097*^9}},ExpressionUUID->"0bbb89ec-a431-41fa-a104-\
6d6e571798d3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MakeEqns", "[", 
  RowBox[{"\[Psi]", "[", 
   RowBox[{"\[Omega]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "a", "}"}], ",", 
        RowBox[{"{", "b", "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", "c", "}"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "x", "}"}], ",", 
      RowBox[{"{", "y", "}"}]}], "}"}], ",", 
    RowBox[{"Migration", "\[Rule]", 
     SubscriptBox["M", "0"]}], ",", 
    RowBox[{"ChangeMigration", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["dM", "1"], ",", 
        SubscriptBox["M", "1"]}], "}"}], "}"}]}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.649052350102442*^9, 3.649052410901507*^9}, {
  3.6490569496717577`*^9, 3.649056979905785*^9}, {3.6490570994311647`*^9, 
  3.6490571468534527`*^9}, {3.649057240222068*^9, 
  3.6490572527378063`*^9}},ExpressionUUID->"f5fe1e4f-0647-40e7-961c-\
d3c60b2cd4ca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Psi]", "[", 
   RowBox[{"\[Omega]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "a", "}"}], ",", 
        RowBox[{"{", "b", "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", "c", "}"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "x", "}"}], ",", 
      RowBox[{"{", "y", "}"}]}], "}"}], ",", 
    RowBox[{"ChangeMigration", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["dM", "1"], ",", 
        SubscriptBox["M", "1"]}], "}"}], "}"}]}], ",", 
    RowBox[{"Migration", "\[Rule]", 
     SubscriptBox["M", "0"]}]}], "]"}], "\[Equal]", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[Psi]", "[", 
      RowBox[{"\[Omega]", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"a", ",", "b"}], "}"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "c", "}"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "x", "}"}], ",", 
         RowBox[{"{", "y", "}"}]}], "}"}], ",", 
       RowBox[{"ChangeMigration", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["dM", "1"], ",", 
           SubscriptBox["M", "1"]}], "}"}], "}"}]}], ",", 
       RowBox[{"Migration", "\[Rule]", 
        SubscriptBox["M", "0"]}]}], "]"}], "+", 
     RowBox[{
      RowBox[{"\[Psi]", "[", 
       RowBox[{"\[Omega]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "a", "}"}], ",", 
            RowBox[{"{", "b", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", "c", "}"}], "}"}]}], "}"}], ",", 
        RowBox[{"Migration", "\[Rule]", 
         SubscriptBox["M", "1"]}]}], "]"}], " ", 
      RowBox[{
       SubscriptBox["dM", "1"], "[", "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"\[Psi]", "[", 
       RowBox[{"\[Omega]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "a", "}"}], ",", 
            RowBox[{"{", "b", "}"}], ",", 
            RowBox[{"{", "c", "}"}]}], "}"}], ",", 
          RowBox[{"{", "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "x", "}"}], ",", 
          RowBox[{"{", "y", "}"}]}], "}"}], ",", 
        RowBox[{"ChangeMigration", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["dM", "1"], ",", 
            SubscriptBox["M", "1"]}], "}"}], "}"}]}], ",", 
        RowBox[{"Migration", "\[Rule]", 
         SubscriptBox["M", "0"]}]}], "]"}], " ", 
      RowBox[{
       SubscriptBox["M", "0"], "[", 
       RowBox[{
        RowBox[{"{", "x", "}"}], ",", 
        RowBox[{"{", "y", "}"}]}], "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"\[Psi]", "[", 
       RowBox[{"\[Omega]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", "a", "}"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "b", "}"}], ",", 
            RowBox[{"{", "c", "}"}]}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "x", "}"}], ",", 
          RowBox[{"{", "y", "}"}]}], "}"}], ",", 
        RowBox[{"ChangeMigration", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["dM", "1"], ",", 
            SubscriptBox["M", "1"]}], "}"}], "}"}]}], ",", 
        RowBox[{"Migration", "\[Rule]", 
         SubscriptBox["M", "0"]}]}], "]"}], " ", 
      RowBox[{
       SubscriptBox["M", "0"], "[", 
       RowBox[{
        RowBox[{"{", "y", "}"}], ",", 
        RowBox[{"{", "x", "}"}]}], "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"\[Psi]", "[", 
       RowBox[{"\[Omega]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", "b", "}"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "a", "}"}], ",", 
            RowBox[{"{", "c", "}"}]}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "x", "}"}], ",", 
          RowBox[{"{", "y", "}"}]}], "}"}], ",", 
        RowBox[{"ChangeMigration", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["dM", "1"], ",", 
            SubscriptBox["M", "1"]}], "}"}], "}"}]}], ",", 
        RowBox[{"Migration", "\[Rule]", 
         SubscriptBox["M", "0"]}]}], "]"}], " ", 
      RowBox[{
       SubscriptBox["M", "0"], "[", 
       RowBox[{
        RowBox[{"{", "y", "}"}], ",", 
        RowBox[{"{", "x", "}"}]}], "]"}]}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"\[Omega]", "[", 
      RowBox[{"{", "a", "}"}], "]"}], "+", 
     RowBox[{"\[Omega]", "[", 
      RowBox[{"{", "b", "}"}], "]"}], "+", 
     RowBox[{"\[Omega]", "[", 
      RowBox[{"{", "c", "}"}], "]"}], "+", 
     RowBox[{
      SubscriptBox["dM", "1"], "[", 
      RowBox[{
       RowBox[{"{", "x", "}"}], ",", 
       RowBox[{"{", "y", "}"}]}], "]"}], "+", 
     RowBox[{
      SubscriptBox["dM", "1"], "[", 
      RowBox[{
       RowBox[{"{", "y", "}"}], ",", 
       RowBox[{"{", "x", "}"}]}], "]"}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["M", "0"], "[", 
         RowBox[{
          RowBox[{"{", "x", "}"}], ",", 
          RowBox[{"{", "y", "}"}]}], "]"}], "+", 
        RowBox[{"2", " ", 
         RowBox[{
          SubscriptBox["M", "0"], "[", 
          RowBox[{
           RowBox[{"{", "y", "}"}], ",", 
           RowBox[{"{", "x", "}"}]}], "]"}]}]}], ")"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.649057253147326*^9},ExpressionUUID->"ade4fff7-5d73-4a60-a423-\
af3d38399729"]
}, Open  ]],

Cell[TextData[{
 "This implements a split of the population ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], "}"}], TraditionalForm]],ExpressionUUID->
  "5f6d95bb-9a23-4650-915f-01887273d863"],
 " into ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"{", "y", "}"}]}], TraditionalForm]],ExpressionUUID->
  "9d312f38-2f27-4591-925b-88f35384cc6b"],
 ", at rate ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[CapitalLambda]", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "x", "}"}], ",", 
       RowBox[{"{", "y", "}"}]}], "}"}], "]"}], ":"}], TraditionalForm]],
  ExpressionUUID->"55b62ffb-1039-4cf2-8f60-9d365731b800"]
}], "Text",
 CellChangeTimes->{{3.6490591371765013`*^9, 
  3.649059180335054*^9}},ExpressionUUID->"4dd04d66-589f-461c-9db0-\
b67f592c3cb9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MakeEqns", "[", 
  RowBox[{"\[Psi]", "[", 
   RowBox[{"\[Omega]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "a", "}"}], ",", 
        RowBox[{"{", "b", "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", "c", "}"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "x", "}"}], ",", 
      RowBox[{"{", "y", "}"}]}], "}"}], ",", 
    RowBox[{"Splits", "\[Rule]", "\[CapitalLambda]"}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.649052350102442*^9, 3.649052410901507*^9}, {
  3.6490569496717577`*^9, 3.649056979905785*^9}, {3.6490570994311647`*^9, 
  3.6490571468534527`*^9}, {3.649057240222068*^9, 3.6490572527378063`*^9}, {
  3.64905904680439*^9, 3.649059055175941*^9}, {3.64905909264003*^9, 
  3.6490591303462257`*^9}},ExpressionUUID->"a0d8ff2e-9335-429b-94e6-\
2af3aad3b116"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Psi]", "[", 
   RowBox[{"\[Omega]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "a", "}"}], ",", 
        RowBox[{"{", "b", "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", "c", "}"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "x", "}"}], ",", 
      RowBox[{"{", "y", "}"}]}], "}"}], ",", 
    RowBox[{"Splits", "\[Rule]", "\[CapitalLambda]"}]}], "]"}], "\[Equal]", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"\[CapitalLambda]", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "x", "}"}], ",", 
         RowBox[{"{", "y", "}"}]}], "}"}], "]"}], " ", 
      RowBox[{"\[Psi]", "[", 
       RowBox[{"\[Omega]", ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "a", "}"}], ",", 
           RowBox[{"{", "b", "}"}], ",", 
           RowBox[{"{", "c", "}"}]}], "}"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], "}"}], ",", 
        RowBox[{"Splits", "\[Rule]", "\[CapitalLambda]"}]}], "]"}]}], "+", 
     RowBox[{"\[Psi]", "[", 
      RowBox[{"\[Omega]", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"a", ",", "b"}], "}"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "c", "}"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "x", "}"}], ",", 
         RowBox[{"{", "y", "}"}]}], "}"}], ",", 
       RowBox[{"Splits", "\[Rule]", "\[CapitalLambda]"}]}], "]"}]}], ")"}], 
   "/", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"\[CapitalLambda]", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "x", "}"}], ",", 
        RowBox[{"{", "y", "}"}]}], "}"}], "]"}], "+", 
     RowBox[{"\[Omega]", "[", 
      RowBox[{"{", "a", "}"}], "]"}], "+", 
     RowBox[{"\[Omega]", "[", 
      RowBox[{"{", "b", "}"}], "]"}], "+", 
     RowBox[{"\[Omega]", "[", 
      RowBox[{"{", "c", "}"}], "]"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.649059057201682*^9, {3.6490590991041117`*^9, 
   3.649059132623736*^9}},ExpressionUUID->"19ba0b81-ac6a-4b5c-b64d-\
438db066ffa3"]
}, Open  ]],

Cell[TextData[{
 "This implements bottlenecks in each of the demes.  Note that there can be a \
bottleneck in the second deme ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", "y", "}"}], TraditionalForm]],ExpressionUUID->
  "af62e7b5-7cd0-49f0-b981-e70154d65852"],
 ", even though it can cause no coalescence\[CloseCurlyDoubleQuote]"
}], "Text",
 CellChangeTimes->{{3.649058597891755*^9, 3.6490586175624113`*^9}, {
  3.649058683580227*^9, 
  3.649058701385537*^9}},ExpressionUUID->"dfe90ad1-3aee-4ca4-a7cb-\
6928a08ee6b7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MakeEqns", "[", 
  RowBox[{"\[Psi]", "[", 
   RowBox[{"\[Omega]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "a", "}"}], ",", 
        RowBox[{"{", "b", "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", "c", "}"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "x", "}"}], ",", 
      RowBox[{"{", "y", "}"}]}], "}"}], ",", 
    RowBox[{"Bottlenecks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["B", "1"], ",", 
        SubscriptBox["b", "1"]}], "}"}], "}"}]}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.649052350102442*^9, 3.649052410901507*^9}, {
  3.6490569496717577`*^9, 3.649056979905785*^9}, {3.6490570994311647`*^9, 
  3.6490571468534527`*^9}, {3.649057240222068*^9, 3.6490572527378063`*^9}, {
  3.6490573391007833`*^9, 
  3.649057360713109*^9}},ExpressionUUID->"0241e1fb-2c6e-49ec-ad85-\
9a595c98da34"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Psi]", "[", 
   RowBox[{"\[Omega]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "a", "}"}], ",", 
        RowBox[{"{", "b", "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", "c", "}"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "x", "}"}], ",", 
      RowBox[{"{", "y", "}"}]}], "}"}], ",", 
    RowBox[{"Bottlenecks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["B", "1"], ",", 
        SubscriptBox["b", "1"]}], "}"}], "}"}]}]}], "]"}], "\[Equal]", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[Psi]", "[", 
      RowBox[{"\[Omega]", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"a", ",", "b"}], "}"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "c", "}"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "x", "}"}], ",", 
         RowBox[{"{", "y", "}"}]}], "}"}], ",", 
       RowBox[{"Bottlenecks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["B", "1"], ",", 
           SubscriptBox["b", "1"]}], "}"}], "}"}]}]}], "]"}], "+", 
     RowBox[{
      RowBox[{"\[Psi]", "[", 
       RowBox[{"\[Omega]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "a", "}"}], ",", 
            RowBox[{"{", "b", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", "c", "}"}], "}"}]}], "}"}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{
         SubscriptBox["b", "1"], "[", 
         RowBox[{"{", "x", "}"}], "]"}]}], ")"}], " ", 
      RowBox[{
       SubscriptBox["B", "1"], "[", 
       RowBox[{"{", "x", "}"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"\[Psi]", "[", 
       RowBox[{"\[Omega]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"a", ",", "b"}], "}"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", "c", "}"}], "}"}]}], "}"}]}], "]"}], " ", 
      RowBox[{
       SubscriptBox["b", "1"], "[", 
       RowBox[{"{", "x", "}"}], "]"}], " ", 
      RowBox[{
       SubscriptBox["B", "1"], "[", 
       RowBox[{"{", "x", "}"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"\[Psi]", "[", 
       RowBox[{"\[Omega]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "a", "}"}], ",", 
            RowBox[{"{", "b", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", "c", "}"}], "}"}]}], "}"}]}], "]"}], " ", 
      RowBox[{
       SubscriptBox["B", "1"], "[", 
       RowBox[{"{", "y", "}"}], "]"}]}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"\[Omega]", "[", 
      RowBox[{"{", "a", "}"}], "]"}], "+", 
     RowBox[{"\[Omega]", "[", 
      RowBox[{"{", "b", "}"}], "]"}], "+", 
     RowBox[{"\[Omega]", "[", 
      RowBox[{"{", "c", "}"}], "]"}], "+", 
     RowBox[{
      SubscriptBox["B", "1"], "[", 
      RowBox[{"{", "x", "}"}], "]"}], "+", 
     RowBox[{
      SubscriptBox["B", "1"], "[", 
      RowBox[{"{", "y", "}"}], "]"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.649057362713327*^9, 
  3.649057734902438*^9},ExpressionUUID->"29478ea4-4e81-4ef3-9603-\
422e1c097acf"]
}, Open  ]],

Cell["This implements admixture in either direction:", "Text",
 CellChangeTimes->{{3.649058852644576*^9, 
  3.649058882145588*^9}},ExpressionUUID->"a44cb23a-30f3-4fed-9e9e-\
e3192660efc5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MakeEqns", "[", 
  RowBox[{"\[Psi]", "[", 
   RowBox[{"\[Omega]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "a", "}"}], ",", 
        RowBox[{"{", "b", "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", "c", "}"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "x", "}"}], ",", 
      RowBox[{"{", "y", "}"}]}], "}"}], ",", 
    RowBox[{"Admixture", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["A", "1"], ",", 
        SubscriptBox["a", "1"]}], "}"}], "}"}]}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.649052350102442*^9, 3.649052410901507*^9}, {
  3.6490569496717577`*^9, 3.649056979905785*^9}, {3.6490570994311647`*^9, 
  3.6490571468534527`*^9}, {3.649057240222068*^9, 3.6490572527378063`*^9}, {
  3.6490573391007833`*^9, 
  3.649057379454557*^9}},ExpressionUUID->"d7fa24c8-1369-4e47-9dda-\
c5f1241504a9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Psi]", "[", 
   RowBox[{"\[Omega]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "a", "}"}], ",", 
        RowBox[{"{", "b", "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", "c", "}"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "x", "}"}], ",", 
      RowBox[{"{", "y", "}"}]}], "}"}], ",", 
    RowBox[{"Admixture", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["A", "1"], ",", 
        SubscriptBox["a", "1"]}], "}"}], "}"}]}]}], "]"}], "\[Equal]", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[Psi]", "[", 
      RowBox[{"\[Omega]", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"a", ",", "b"}], "}"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "c", "}"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "x", "}"}], ",", 
         RowBox[{"{", "y", "}"}]}], "}"}], ",", 
       RowBox[{"Admixture", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["A", "1"], ",", 
           SubscriptBox["a", "1"]}], "}"}], "}"}]}]}], "]"}], "+", 
     RowBox[{
      RowBox[{"\[Psi]", "[", 
       RowBox[{"\[Omega]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "a", "}"}], ",", 
            RowBox[{"{", "b", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", "c", "}"}], "}"}]}], "}"}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{
         SubscriptBox["a", "1"], "[", 
         RowBox[{
          RowBox[{"{", "x", "}"}], ",", 
          RowBox[{"{", "y", "}"}]}], "]"}]}], ")"}], " ", 
      RowBox[{
       SubscriptBox["A", "1"], "[", 
       RowBox[{
        RowBox[{"{", "x", "}"}], ",", 
        RowBox[{"{", "y", "}"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"\[Psi]", "[", 
       RowBox[{"\[Omega]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "a", "}"}], ",", 
            RowBox[{"{", "b", "}"}], ",", 
            RowBox[{"{", "c", "}"}]}], "}"}], ",", 
          RowBox[{"{", "}"}]}], "}"}]}], "]"}], " ", 
      RowBox[{
       SubscriptBox["a", "1"], "[", 
       RowBox[{
        RowBox[{"{", "x", "}"}], ",", 
        RowBox[{"{", "y", "}"}]}], "]"}], " ", 
      RowBox[{
       SubscriptBox["A", "1"], "[", 
       RowBox[{
        RowBox[{"{", "x", "}"}], ",", 
        RowBox[{"{", "y", "}"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"\[Psi]", "[", 
       RowBox[{"\[Omega]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "a", "}"}], ",", 
            RowBox[{"{", "b", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", "c", "}"}], "}"}]}], "}"}]}], "]"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{
          SubscriptBox["a", "1"], "[", 
          RowBox[{
           RowBox[{"{", "y", "}"}], ",", 
           RowBox[{"{", "x", "}"}]}], "]"}]}], ")"}], "2"], " ", 
      RowBox[{
       SubscriptBox["A", "1"], "[", 
       RowBox[{
        RowBox[{"{", "y", "}"}], ",", 
        RowBox[{"{", "x", "}"}]}], "]"}]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"\[Psi]", "[", 
       RowBox[{"\[Omega]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", "a", "}"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "b", "}"}], ",", 
            RowBox[{"{", "c", "}"}]}], "}"}]}], "}"}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{
         SubscriptBox["a", "1"], "[", 
         RowBox[{
          RowBox[{"{", "y", "}"}], ",", 
          RowBox[{"{", "x", "}"}]}], "]"}]}], ")"}], " ", 
      RowBox[{
       SubscriptBox["a", "1"], "[", 
       RowBox[{
        RowBox[{"{", "y", "}"}], ",", 
        RowBox[{"{", "x", "}"}]}], "]"}], " ", 
      RowBox[{
       SubscriptBox["A", "1"], "[", 
       RowBox[{
        RowBox[{"{", "y", "}"}], ",", 
        RowBox[{"{", "x", "}"}]}], "]"}]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"\[Psi]", "[", 
       RowBox[{"\[Omega]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", "b", "}"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "a", "}"}], ",", 
            RowBox[{"{", "c", "}"}]}], "}"}]}], "}"}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{
         SubscriptBox["a", "1"], "[", 
         RowBox[{
          RowBox[{"{", "y", "}"}], ",", 
          RowBox[{"{", "x", "}"}]}], "]"}]}], ")"}], " ", 
      RowBox[{
       SubscriptBox["a", "1"], "[", 
       RowBox[{
        RowBox[{"{", "y", "}"}], ",", 
        RowBox[{"{", "x", "}"}]}], "]"}], " ", 
      RowBox[{
       SubscriptBox["A", "1"], "[", 
       RowBox[{
        RowBox[{"{", "y", "}"}], ",", 
        RowBox[{"{", "x", "}"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"\[Psi]", "[", 
       RowBox[{"\[Omega]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "a", "}"}], ",", 
            RowBox[{"{", "b", "}"}], ",", 
            RowBox[{"{", "c", "}"}]}], "}"}]}], "}"}]}], "]"}], " ", 
      SuperscriptBox[
       RowBox[{
        SubscriptBox["a", "1"], "[", 
        RowBox[{
         RowBox[{"{", "y", "}"}], ",", 
         RowBox[{"{", "x", "}"}]}], "]"}], "2"], " ", 
      RowBox[{
       SubscriptBox["A", "1"], "[", 
       RowBox[{
        RowBox[{"{", "y", "}"}], ",", 
        RowBox[{"{", "x", "}"}]}], "]"}]}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"\[Omega]", "[", 
      RowBox[{"{", "a", "}"}], "]"}], "+", 
     RowBox[{"\[Omega]", "[", 
      RowBox[{"{", "b", "}"}], "]"}], "+", 
     RowBox[{"\[Omega]", "[", 
      RowBox[{"{", "c", "}"}], "]"}], "+", 
     RowBox[{
      SubscriptBox["A", "1"], "[", 
      RowBox[{
       RowBox[{"{", "x", "}"}], ",", 
       RowBox[{"{", "y", "}"}]}], "]"}], "+", 
     RowBox[{
      SubscriptBox["A", "1"], "[", 
      RowBox[{
       RowBox[{"{", "y", "}"}], ",", 
       RowBox[{"{", "x", "}"}]}], "]"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.649057379865183*^9, 3.6490587075423813`*^9, 
  3.64905884580867*^9},ExpressionUUID->"7771521c-2363-4280-b5b2-b12265c9720c"]
}, Open  ]],

Cell[TextData[{
 StyleBox["Note: ",
  FontWeight->"Bold"],
 "MakeEqns[] gives the basic recursion for the GF.  The simple version, for a \
single population, allows coalescence rate to be varied through time, using \
Coalescence\[Rule]\[Lambda] and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"ChangeCoalescence", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["d\[Lambda]", "1"], ",", 
        SubscriptBox["\[Lambda]", "1"]}], "}"}], ",", "\[Ellipsis]"}], 
     "}"}]}], TraditionalForm]],ExpressionUUID->
  "a65456b3-9547-4398-81df-87ce2ed37558"],
 ".  The spatial version can include a variety of processes: coalescence, \
migration, population splits, admixture events, bottlenecks, and abrupt \
changes in coalescence or migration rates.  "
}], "Text",
 CellChangeTimes->{{3.648642554614747*^9, 3.648642556205818*^9}, {
  3.648642670132204*^9, 3.6486428912428102`*^9}, {3.648642929974938*^9, 
  3.648642943118696*^9}, {3.648642978989007*^9, 3.648643050645103*^9}, {
  3.648804531982133*^9, 
  3.648804618869053*^9}},ExpressionUUID->"d1e5810c-e2e4-4806-b5fb-\
26ca30ca52d9"],

Cell[TextData[{
 StyleBox["Summary: ",
  FontWeight->"Bold"],
 "These are the processes included in the spatial version of MakeEqns[]:"
}], "Text",
 CellChangeTimes->{{3.648643245205336*^9, 3.648643270707073*^9}, {
  3.6486438084464273`*^9, 
  3.6486438304366083`*^9}},ExpressionUUID->"9a0797ce-973f-42d4-8e4f-\
9f8eefaa6c9a"],

Cell[TextData[Cell[BoxData[
 FormBox[GridBox[{
    {"process", "notation", "option", "default"},
    {"coalescence", 
     RowBox[{"\[Lambda]", "[", 
      RowBox[{"{", "x", "}"}], "]"}], 
     RowBox[{"Coalescence", "\[Rule]", "\[Lambda]"}], 
     RowBox[{"1", "&"}]},
    {"migration", 
     RowBox[{"M", "[", 
      RowBox[{
       RowBox[{"{", "x", "}"}], ",", 
       RowBox[{"{", "y", "}"}]}], "]"}], 
     RowBox[{"Migration", "\[Rule]", "M"}], 
     RowBox[{"0", "&"}]},
    {"splits", 
     RowBox[{"\[CapitalLambda]", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "x", "}"}], ",", 
        RowBox[{"{", "y", "}"}]}], "}"}], "]"}], 
     RowBox[{"Splits", "\[Rule]", "\[CapitalLambda]"}], 
     RowBox[{"0", "&"}]},
    {"admixture", 
     RowBox[{"A", "[", 
      RowBox[{
       RowBox[{"{", "x", "}"}], ",", 
       RowBox[{"{", "y", "}"}]}], "]"}], 
     RowBox[{"Admixture", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["A", "1"], ",", 
          SubscriptBox["a", "1"]}], "}"}], ",", "\[Ellipsis]"}], "}"}]}], 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0", "&"}], ",", 
       RowBox[{"0", "&"}]}], "}"}]},
    {"bottleneck", 
     RowBox[{"B", "[", 
      RowBox[{"{", "x", "}"}], "]"}], 
     RowBox[{"Bottleneck", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["B", "1"], ",", 
          SubscriptBox["b", "1"]}], "}"}], ",", "\[Ellipsis]"}], "}"}]}], 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0", "&"}], ",", 
       RowBox[{"0", "&"}]}], "}"}]},
    {
     RowBox[{"change", " ", "in", " ", "M"}], 
     RowBox[{"dM", "[", 
      RowBox[{
       RowBox[{"{", "x", "}"}], ",", 
       RowBox[{"{", "y", "}"}]}], "]"}], 
     RowBox[{"ChangeMigration", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["dM", "1"], ",", 
          SubscriptBox["M", "1"]}], "}"}], ",", "\[Ellipsis]"}], "}"}]}], 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0", "&"}], ",", 
       RowBox[{"0", "&"}]}], "}"}]},
    {
     RowBox[{"change", " ", "in", " ", "\[Lambda]"}], 
     RowBox[{"d\[Lambda]", "[", 
      RowBox[{
       RowBox[{"{", "x", "}"}], ",", 
       RowBox[{"{", "y", "}"}]}], "]"}], 
     RowBox[{"ChangeCoalescence", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["d\[Lambda]", "1"], ",", 
          SubscriptBox["\[Lambda]", "1"]}], "}"}], ",", "\[Ellipsis]"}], 
       "}"}]}], 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0", "&"}], ",", 
       RowBox[{"0", "&"}]}], "}"}]}
   }], TraditionalForm]],ExpressionUUID->"f54d65dc-fd4a-4081-a9a5-\
3a671e5938e6"]], "Text",
 CellChangeTimes->{{3.648643840834661*^9, 3.648643856602839*^9}, {
  3.6486439009453707`*^9, 3.6486440325962543`*^9}, {3.648644065384864*^9, 
  3.6486441962543592`*^9}, {3.6487832658315153`*^9, 3.6487832682325497`*^9}, {
  3.648791537707163*^9, 3.648791611220862*^9}, {3.64879488380352*^9, 
  3.648794951506854*^9}, {3.648797319678693*^9, 3.648797326846237*^9}, {
  3.6488147213291273`*^9, 3.648814751194265*^9}, {3.64887243045646*^9, 
  3.6488724350476847`*^9}},ExpressionUUID->"53f5c150-7f56-46bc-b740-\
038d6e3f0687"],

Cell[TextData[{
 StyleBox["Note: ",
  FontWeight->"Bold"],
 "The last four processes represent discrete events: admixture, bottlenecks, \
a change in M, or a change in \[Lambda].  There can be a sequence of such \
events. For example, tracing back in time, an admixture event ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["A", "1"], "[", 
    RowBox[{
     RowBox[{"{", "x", "}"}], ",", 
     RowBox[{"{", "y", "}"}]}], "]"}], TraditionalForm]],ExpressionUUID->
  "63ecbf4c-c634-4f80-8ea7-e0efbad64c42"],
 " occurs at an exponentially distributed rate, and has intensity ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["a", "i"], TraditionalForm]],ExpressionUUID->
  "ddaf6332-3078-4a39-84dd-1aeddc69014a"],
 "[{x},{y}]. Once it has occurred, event ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox["A", "2"], "[", 
       RowBox[{
        RowBox[{"{", "x", "}"}], ",", 
        RowBox[{"{", "y", "}"}]}], "]"}], ",", 
      RowBox[{
       SubscriptBox["a", "2"], "[", 
       RowBox[{
        RowBox[{"{", "x", "}"}], ",", 
        RowBox[{"{", "y", "}"}]}], "]"}]}], "}"}], " "}], TraditionalForm]],
  ExpressionUUID->"8557acba-7883-4331-9647-bb520a9e195d"],
 "occurs in the same way, until the list supplied has been exhausted, or the \
deme ceases to exist.  The list of symbols associated with each event is the \
same for all pairs of demes, so that the maximum # of events is necessarily \
the same.  The events that are actually included in the model can be chosen \
at a later stage, for example by applying rules in MakeAllEqns."
}], "Text",
 CellChangeTimes->{{3.6486442159325047`*^9, 3.648644238338476*^9}, {
  3.648783274181018*^9, 3.648783296915162*^9}, {3.6487949564335413`*^9, 
  3.648795003837022*^9}, {3.648795075414515*^9, 3.6487951176346407`*^9}, {
  3.6487954297225018`*^9, 3.648795529484709*^9}, {3.648795562217553*^9, 
  3.648795582447554*^9}, {3.6487971107132053`*^9, 3.648797237444147*^9}, {
  3.648804654017584*^9, 
  3.648804655130363*^9}},ExpressionUUID->"765dcc97-c4f8-4cb1-84dc-\
ef6f594fdfc1"],

Cell[TextData[{
 StyleBox["Note: ",
  FontWeight->"Bold"],
 "The options to change the rates of coalescence or migration \
(ChangeCoalescence, ChangeMigration) do not directly alter the configuration \
of lineages. Rather, these events change the current ",
 StyleBox["rates",
  FontSlant->"Italic"],
 " of those processes. For example, with the options ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Coalescence", "\[Rule]", 
     SubscriptBox["\[Lambda]", "0"]}], ",", 
    RowBox[{"ChangeCoalescence", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["d\[Lambda]", "1"], ",", 
       SubscriptBox["\[Lambda]", "1"]}], "}"}]}]}], TraditionalForm]],
  ExpressionUUID->"5ce8a465-7459-4086-a93b-3009efeee637"],
 ", the rate of coalescence in deme ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", "x", "}"}], TraditionalForm]],ExpressionUUID->
  "b836ca40-96bc-407c-aff8-f374cb8e78da"],
 " is initially ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Lambda]", "0"], "[", 
    RowBox[{"{", "x", "}"}], "]"}], TraditionalForm]],ExpressionUUID->
  "fd99ba22-7109-4243-8210-4fec048e0a7d"],
 "; events occur at rate ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["d\[Lambda]", "1"], " "}], TraditionalForm]],ExpressionUUID->
  "3ba0aa39-0e3c-4ca6-a88f-e1c58d5375b2"],
 "that change the rate to ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Lambda]", "1"], "[", 
    RowBox[{"{", "x", "}"}], "]"}], TraditionalForm]],ExpressionUUID->
  "1acc7cba-4bc4-4f71-91e3-918b70e0d2f3"],
 ".  Events may occur in other demes in a similar way. By taking the inverse \
Laplace transform of the GF ",
 StyleBox["divided by ",
  FontSlant->"Italic"],
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Lambda]", "i"], TraditionalForm]],ExpressionUUID->
  "a80bda1d-b92e-4d42-b672-c8480890b5de"],
 ", the probability associated with an event at a specific time can be found."
}], "Text",
 CellChangeTimes->{{3.648797243258491*^9, 3.6487972777514887`*^9}, {
  3.648797334205982*^9, 3.648797414042733*^9}, {3.648797503548894*^9, 
  3.648797550686119*^9}, {3.64879916919349*^9, 3.648799393481184*^9}, {
  3.6488046477798*^9, 
  3.6488046489388247`*^9}},ExpressionUUID->"72ffb8ba-a692-4f55-8a0f-\
e0d459d64416"],

Cell[TextData[{
 StyleBox["Note: ",
  FontWeight->"Bold"],
 "The parameters for the various processes are specified by a series of \
options.  These must be associated with the GF, because they may be changed \
by the recursions.  However, the topology is associated with MakeEqns[]."
}], "Text",
 CellChangeTimes->{{3.648804626275895*^9, 3.6488046273881817`*^9}, {
  3.648804664051318*^9, 3.6488047543198557`*^9}, {3.648804926010502*^9, 
  3.648804951862026*^9}},ExpressionUUID->"040c9753-6e52-4964-a077-\
954649ff3a09"],

Cell[TextData[{
 StyleBox["Note: ",
  FontWeight->"Bold"],
 "A potential problem here is that there may be multiple equivalent versions \
of the GF: for example, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Psi]", "[", 
    RowBox[{"\[Omega]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", 
         RowBox[{"{", "b", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "c", "}"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "x", "}"}], ",", 
       RowBox[{"{", "y", "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Migration", "\[Rule]", "M"}], ",", 
       RowBox[{"Splits", "\[Rule]", "\[CapitalLambda]"}]}], "}"}]}], "]"}], 
   TraditionalForm]],ExpressionUUID->"3b4f2ae2-52db-4383-9301-adb704091fa4"],
 " is equivalent to \
\[Psi][\[Omega],{{{a},{b}},{{c}}},{{x},{y}},{Splits\[Rule]\[CapitalLambda],\
Migration\[Rule]M}].  Therefore, the option rules are sorted in the new \
configuration.  It is also necessary to remove default rules, such as \
Bottleneck\[Rule]{}, again so as to ensure that equivalent GF are treated as \
such."
}], "Text",
 CellChangeTimes->{{3.648643082188175*^9, 3.6486432373983793`*^9}, {
  3.648792599730813*^9, 3.648792603423555*^9}, {3.648795016979704*^9, 
  3.648795066583255*^9}},ExpressionUUID->"13fc2569-8d7f-4e56-980b-\
209873307ef0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Checking MakeEqns", "Subsubsection",
 CellChangeTimes->{{3.635321781519639*^9, 3.635321787134482*^9}, 
   3.649067174117804*^9, 
   3.6493335394958363`*^9},ExpressionUUID->"e030c2a5-d574-4b8f-8af8-\
55342a9f08bd"],

Cell[TextData[{
 "An example with 3 demes, and {2,1 ,2} lineages in each, has 3 split terms ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[CapitalLambda]", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "x", "}"}], ",", 
        RowBox[{"{", "z", "}"}]}], "}"}], "]"}], "\[Ellipsis]"}], ")"}], 
   TraditionalForm]],ExpressionUUID->"ea64f88f-0242-4b05-8204-7c0cd3698c43"],
 ", 2 coalescence terms ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[Lambda]", "[", 
      RowBox[{"{", "x", "}"}], "]"}], "\[Ellipsis]"}], ")"}], 
   TraditionalForm]],ExpressionUUID->"93a43009-b5df-4cc3-b17c-18b0be26132b"],
 ", and 2\[Times](2+1+2)=10 migration terms ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{"M", "[", 
      RowBox[{
       RowBox[{"{", "x", "}"}], ",", 
       RowBox[{"{", "z", "}"}]}], "]"}], "\[Ellipsis]"}], ")"}], 
   TraditionalForm]],ExpressionUUID->"4d971fd0-6b33-4f12-acdd-f28c9a324c42"],
 ".  The rule at the end is applied just to make the output more readable, \
since each \[Psi][] has a rather long form:"
}], "Text",
 CellChangeTimes->{{3.635315193773837*^9, 3.635315200541546*^9}, {
  3.635316537390389*^9, 3.6353165828559523`*^9}, {3.63531665314202*^9, 
  3.635316670821232*^9}, {3.649060036276622*^9, 3.64906008017836*^9}, {
  3.649060124963649*^9, 3.649060134501281*^9}, {3.6490603631990213`*^9, 
  3.649060403010923*^9}},ExpressionUUID->"4ceadc21-729a-4e70-8767-\
d23d0b360d8b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"eqs", "=", 
   RowBox[{"MakeEqns", "[", 
    RowBox[{"\[Psi]", "[", 
     RowBox[{"\[Omega]", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "a", "}"}], ",", 
          RowBox[{"{", "b", "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", "c", "}"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "d", "}"}], ",", 
          RowBox[{"{", "e", "}"}]}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "x", "}"}], ",", 
        RowBox[{"{", "y", "}"}], ",", 
        RowBox[{"{", "z", "}"}]}], "}"}], ",", 
      RowBox[{"Splits", "\[Rule]", "\[CapitalLambda]"}], ",", 
      RowBox[{"Migration", "\[Rule]", "M"}], ",", 
      RowBox[{"Coalescence", "\[Rule]", "\[Lambda]"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"eqs", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Psi]", "[", 
     RowBox[{"\[Omega]", ",", "x_List", ",", "d_List", ",", 
      RowBox[{"Coalescence", "\[Rule]", "\[Lambda]"}], ",", 
      RowBox[{"Migration", "\[Rule]", "M"}], ",", 
      RowBox[{"Splits", "\[Rule]", "\[CapitalLambda]"}]}], "]"}], "\[Rule]", 
    RowBox[{"\[Psi]", "[", 
     RowBox[{
     "\[Omega]", ",", "x", ",", "d", ",", "\[Lambda]M\[CapitalLambda]"}], 
     "]"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.635315096347519*^9, 3.635315151290503*^9}, {
   3.635315653870429*^9, 3.635315654702711*^9}, 3.635321797138319*^9, {
   3.649058916241872*^9, 3.64905900088804*^9}, {3.649059261385243*^9, 
   3.6490592627675962`*^9}},ExpressionUUID->"915a15d6-861d-4430-bae6-\
f4b5b4a3a99a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Psi]", "[", 
   RowBox[{"\[Omega]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "a", "}"}], ",", 
        RowBox[{"{", "b", "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", "c", "}"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "d", "}"}], ",", 
        RowBox[{"{", "e", "}"}]}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "x", "}"}], ",", 
      RowBox[{"{", "y", "}"}], ",", 
      RowBox[{"{", "z", "}"}]}], "}"}], ",", "\[Lambda]M\[CapitalLambda]"}], 
   "]"}], "\[Equal]", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"\[CapitalLambda]", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "x", "}"}], ",", 
         RowBox[{"{", "z", "}"}]}], "}"}], "]"}], " ", 
      RowBox[{"\[Psi]", "[", 
       RowBox[{"\[Omega]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", "c", "}"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "a", "}"}], ",", 
            RowBox[{"{", "b", "}"}], ",", 
            RowBox[{"{", "d", "}"}], ",", 
            RowBox[{"{", "e", "}"}]}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "y", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "z"}], "}"}]}], "}"}], ",", 
        "\[Lambda]M\[CapitalLambda]"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"\[CapitalLambda]", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "y", "}"}], ",", 
         RowBox[{"{", "z", "}"}]}], "}"}], "]"}], " ", 
      RowBox[{"\[Psi]", "[", 
       RowBox[{"\[Omega]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "a", "}"}], ",", 
            RowBox[{"{", "b", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "c", "}"}], ",", 
            RowBox[{"{", "d", "}"}], ",", 
            RowBox[{"{", "e", "}"}]}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "x", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", "z"}], "}"}]}], "}"}], ",", 
        "\[Lambda]M\[CapitalLambda]"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"\[CapitalLambda]", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "x", "}"}], ",", 
         RowBox[{"{", "y", "}"}]}], "}"}], "]"}], " ", 
      RowBox[{"\[Psi]", "[", 
       RowBox[{"\[Omega]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "d", "}"}], ",", 
            RowBox[{"{", "e", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "a", "}"}], ",", 
            RowBox[{"{", "b", "}"}], ",", 
            RowBox[{"{", "c", "}"}]}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "z", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}]}], "}"}], ",", 
        "\[Lambda]M\[CapitalLambda]"}], "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"M", "[", 
       RowBox[{
        RowBox[{"{", "z", "}"}], ",", 
        RowBox[{"{", "x", "}"}]}], "]"}], " ", 
      RowBox[{"\[Psi]", "[", 
       RowBox[{"\[Omega]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", "a", "}"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", "c", "}"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "b", "}"}], ",", 
            RowBox[{"{", "d", "}"}], ",", 
            RowBox[{"{", "e", "}"}]}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "x", "}"}], ",", 
          RowBox[{"{", "y", "}"}], ",", 
          RowBox[{"{", "z", "}"}]}], "}"}], ",", 
        "\[Lambda]M\[CapitalLambda]"}], "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"M", "[", 
       RowBox[{
        RowBox[{"{", "y", "}"}], ",", 
        RowBox[{"{", "x", "}"}]}], "]"}], " ", 
      RowBox[{"\[Psi]", "[", 
       RowBox[{"\[Omega]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", "a", "}"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "b", "}"}], ",", 
            RowBox[{"{", "c", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "d", "}"}], ",", 
            RowBox[{"{", "e", "}"}]}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "x", "}"}], ",", 
          RowBox[{"{", "y", "}"}], ",", 
          RowBox[{"{", "z", "}"}]}], "}"}], ",", 
        "\[Lambda]M\[CapitalLambda]"}], "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"M", "[", 
       RowBox[{
        RowBox[{"{", "z", "}"}], ",", 
        RowBox[{"{", "x", "}"}]}], "]"}], " ", 
      RowBox[{"\[Psi]", "[", 
       RowBox[{"\[Omega]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", "b", "}"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", "c", "}"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "a", "}"}], ",", 
            RowBox[{"{", "d", "}"}], ",", 
            RowBox[{"{", "e", "}"}]}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "x", "}"}], ",", 
          RowBox[{"{", "y", "}"}], ",", 
          RowBox[{"{", "z", "}"}]}], "}"}], ",", 
        "\[Lambda]M\[CapitalLambda]"}], "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"M", "[", 
       RowBox[{
        RowBox[{"{", "y", "}"}], ",", 
        RowBox[{"{", "x", "}"}]}], "]"}], " ", 
      RowBox[{"\[Psi]", "[", 
       RowBox[{"\[Omega]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", "b", "}"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "a", "}"}], ",", 
            RowBox[{"{", "c", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "d", "}"}], ",", 
            RowBox[{"{", "e", "}"}]}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "x", "}"}], ",", 
          RowBox[{"{", "y", "}"}], ",", 
          RowBox[{"{", "z", "}"}]}], "}"}], ",", 
        "\[Lambda]M\[CapitalLambda]"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"\[Lambda]", "[", 
       RowBox[{"{", "x", "}"}], "]"}], " ", 
      RowBox[{"\[Psi]", "[", 
       RowBox[{"\[Omega]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"a", ",", "b"}], "}"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", "c", "}"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "d", "}"}], ",", 
            RowBox[{"{", "e", "}"}]}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "x", "}"}], ",", 
          RowBox[{"{", "y", "}"}], ",", 
          RowBox[{"{", "z", "}"}]}], "}"}], ",", 
        "\[Lambda]M\[CapitalLambda]"}], "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"M", "[", 
       RowBox[{
        RowBox[{"{", "z", "}"}], ",", 
        RowBox[{"{", "y", "}"}]}], "]"}], " ", 
      RowBox[{"\[Psi]", "[", 
       RowBox[{"\[Omega]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "a", "}"}], ",", 
            RowBox[{"{", "b", "}"}]}], "}"}], ",", 
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "c", "}"}], ",", 
            RowBox[{"{", "d", "}"}], ",", 
            RowBox[{"{", "e", "}"}]}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "x", "}"}], ",", 
          RowBox[{"{", "y", "}"}], ",", 
          RowBox[{"{", "z", "}"}]}], "}"}], ",", 
        "\[Lambda]M\[CapitalLambda]"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"\[Lambda]", "[", 
       RowBox[{"{", "z", "}"}], "]"}], " ", 
      RowBox[{"\[Psi]", "[", 
       RowBox[{"\[Omega]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "a", "}"}], ",", 
            RowBox[{"{", "b", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", "c", "}"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"d", ",", "e"}], "}"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "x", "}"}], ",", 
          RowBox[{"{", "y", "}"}], ",", 
          RowBox[{"{", "z", "}"}]}], "}"}], ",", 
        "\[Lambda]M\[CapitalLambda]"}], "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"M", "[", 
       RowBox[{
        RowBox[{"{", "y", "}"}], ",", 
        RowBox[{"{", "z", "}"}]}], "]"}], " ", 
      RowBox[{"\[Psi]", "[", 
       RowBox[{"\[Omega]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "a", "}"}], ",", 
            RowBox[{"{", "b", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "c", "}"}], ",", 
            RowBox[{"{", "d", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", "e", "}"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "x", "}"}], ",", 
          RowBox[{"{", "y", "}"}], ",", 
          RowBox[{"{", "z", "}"}]}], "}"}], ",", 
        "\[Lambda]M\[CapitalLambda]"}], "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"M", "[", 
       RowBox[{
        RowBox[{"{", "y", "}"}], ",", 
        RowBox[{"{", "z", "}"}]}], "]"}], " ", 
      RowBox[{"\[Psi]", "[", 
       RowBox[{"\[Omega]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "a", "}"}], ",", 
            RowBox[{"{", "b", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "c", "}"}], ",", 
            RowBox[{"{", "e", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", "d", "}"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "x", "}"}], ",", 
          RowBox[{"{", "y", "}"}], ",", 
          RowBox[{"{", "z", "}"}]}], "}"}], ",", 
        "\[Lambda]M\[CapitalLambda]"}], "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"M", "[", 
       RowBox[{
        RowBox[{"{", "x", "}"}], ",", 
        RowBox[{"{", "y", "}"}]}], "]"}], " ", 
      RowBox[{"\[Psi]", "[", 
       RowBox[{"\[Omega]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "a", "}"}], ",", 
            RowBox[{"{", "b", "}"}], ",", 
            RowBox[{"{", "c", "}"}]}], "}"}], ",", 
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "d", "}"}], ",", 
            RowBox[{"{", "e", "}"}]}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "x", "}"}], ",", 
          RowBox[{"{", "y", "}"}], ",", 
          RowBox[{"{", "z", "}"}]}], "}"}], ",", 
        "\[Lambda]M\[CapitalLambda]"}], "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"M", "[", 
       RowBox[{
        RowBox[{"{", "x", "}"}], ",", 
        RowBox[{"{", "z", "}"}]}], "]"}], " ", 
      RowBox[{"\[Psi]", "[", 
       RowBox[{"\[Omega]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "a", "}"}], ",", 
            RowBox[{"{", "b", "}"}], ",", 
            RowBox[{"{", "d", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", "c", "}"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", "e", "}"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "x", "}"}], ",", 
          RowBox[{"{", "y", "}"}], ",", 
          RowBox[{"{", "z", "}"}]}], "}"}], ",", 
        "\[Lambda]M\[CapitalLambda]"}], "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"M", "[", 
       RowBox[{
        RowBox[{"{", "x", "}"}], ",", 
        RowBox[{"{", "z", "}"}]}], "]"}], " ", 
      RowBox[{"\[Psi]", "[", 
       RowBox[{"\[Omega]", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "a", "}"}], ",", 
            RowBox[{"{", "b", "}"}], ",", 
            RowBox[{"{", "e", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", "c", "}"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", "d", "}"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "x", "}"}], ",", 
          RowBox[{"{", "y", "}"}], ",", 
          RowBox[{"{", "z", "}"}]}], "}"}], ",", 
        "\[Lambda]M\[CapitalLambda]"}], "]"}]}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"M", "[", 
         RowBox[{
          RowBox[{"{", "x", "}"}], ",", 
          RowBox[{"{", "y", "}"}]}], "]"}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"M", "[", 
          RowBox[{
           RowBox[{"{", "x", "}"}], ",", 
           RowBox[{"{", "z", "}"}]}], "]"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"M", "[", 
          RowBox[{
           RowBox[{"{", "y", "}"}], ",", 
           RowBox[{"{", "x", "}"}]}], "]"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"M", "[", 
          RowBox[{
           RowBox[{"{", "y", "}"}], ",", 
           RowBox[{"{", "z", "}"}]}], "]"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"M", "[", 
          RowBox[{
           RowBox[{"{", "z", "}"}], ",", 
           RowBox[{"{", "x", "}"}]}], "]"}]}], "+", 
        RowBox[{"M", "[", 
         RowBox[{
          RowBox[{"{", "z", "}"}], ",", 
          RowBox[{"{", "y", "}"}]}], "]"}]}], ")"}]}], "+", 
     RowBox[{"\[Lambda]", "[", 
      RowBox[{"{", "x", "}"}], "]"}], "+", 
     RowBox[{"\[Lambda]", "[", 
      RowBox[{"{", "z", "}"}], "]"}], "+", 
     RowBox[{"\[CapitalLambda]", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "x", "}"}], ",", 
        RowBox[{"{", "y", "}"}]}], "}"}], "]"}], "+", 
     RowBox[{"\[CapitalLambda]", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "x", "}"}], ",", 
        RowBox[{"{", "z", "}"}]}], "}"}], "]"}], "+", 
     RowBox[{"\[CapitalLambda]", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "y", "}"}], ",", 
        RowBox[{"{", "z", "}"}]}], "}"}], "]"}], "+", 
     RowBox[{"\[Omega]", "[", 
      RowBox[{"{", "a", "}"}], "]"}], "+", 
     RowBox[{"\[Omega]", "[", 
      RowBox[{"{", "b", "}"}], "]"}], "+", 
     RowBox[{"\[Omega]", "[", 
      RowBox[{"{", "c", "}"}], "]"}], "+", 
     RowBox[{"\[Omega]", "[", 
      RowBox[{"{", "d", "}"}], "]"}], "+", 
     RowBox[{"\[Omega]", "[", 
      RowBox[{"{", "e", "}"}], "]"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.6353151515590277`*^9, 3.6353155789588327`*^9, {3.6353156279787607`*^9, 
   3.635315655010929*^9}, 3.635321797500358*^9, 3.6476880892926617`*^9, 
   3.649058939714262*^9, 3.6490590013139677`*^9, 
   3.6490592631736383`*^9},ExpressionUUID->"6bd6f7e1-67b7-47e4-b865-\
3b18f9910cb9"]
}, Open  ]],

Cell["\<\
Fortunately, the total probability sums to 1 (that is, if \[Omega]\[Rule]0, \
then all \[Psi]\[Rule]1):\
\>", "Text",
 CellChangeTimes->{{3.6353164697136517`*^9, 
  3.635316513067956*^9}},ExpressionUUID->"5541413f-eb70-4b53-a6d4-\
8a0c72b35db7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"aa", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"eqs", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Psi]", "[", "__", "]"}], "\[Rule]", "1"}], ",", 
      RowBox[{
       RowBox[{"\[Omega]", "[", "_", "]"}], "\[Rule]", "0"}]}], "}"}]}], "//",
    "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.635315613601922*^9, 3.635315673999442*^9}, {
  3.6353157086839447`*^9, 
  3.635315743283731*^9}},ExpressionUUID->"da9ba172-33fc-4b5b-99fe-\
14f0e0e58e5d"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.635315623351412*^9, 3.635315642820241*^9}, 
   3.6353156745628643`*^9, 3.6353157092918262`*^9, 3.635315743961508*^9, 
   3.635321801678117*^9, 3.647688089364994*^9, 
   3.649060143415868*^9},ExpressionUUID->"68fadf14-7f2c-4ff8-ae65-\
52831488531d"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["MakeAllEqns", "Subsubsection",
 CellChangeTimes->{{3.498187385149158*^9, 3.4981873884762363`*^9}, 
   3.635316773267459*^9, 3.6490671765654783`*^9, 
   3.6493335384081173`*^9},ExpressionUUID->"10809c65-9764-4623-8794-\
c90584244ad9"],

Cell[TextData[{
 "Suppose we start with the configuration ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Psi]", "[", 
    RowBox[{"\[Omega]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", "a", "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "b", "}"}], ",", 
         RowBox[{"{", "c", "}"}]}], "}"}]}], "}"}]}], "]"}], 
   TraditionalForm]],ExpressionUUID->"2be898fd-6da3-4b54-af97-1126d2e917e2"],
 ". MakeEqns[\[Ellipsis]] generates the recursion for this, which will \
involve other generating functions. Applying GetVars[eqns] finds all the \
configurations that are involved, and makeEqns /@ GetVars[eqns] lists all the \
recursions needed to determine these. Using FixedPoint[], we continue until \
the list of recursions does not increase any more. "
}], "Text",
 CellChangeTimes->{{3.498187032653685*^9, 3.498187033812985*^9}, {
   3.498187090785688*^9, 3.498187298634305*^9}, {3.49818736159305*^9, 
   3.498187375565166*^9}, {3.4981874085874033`*^9, 3.498187416839514*^9}, {
   3.4992596924184837`*^9, 3.499259709036313*^9}, {3.499259781938209*^9, 
   3.4992597986135674`*^9}, {3.5116791457649117`*^9, 3.511679146022395*^9}, 
   3.6353167981988487`*^9, {3.64906044125705*^9, 
   3.649060455056324*^9}},ExpressionUUID->"4d2c6bc1-0e96-47be-81b6-\
9fc6dcd647b4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeAllEqns", "::", "usage"}], "=", 
   "\"\<MakeAllEqns[\[Psi][\[Omega],{{{a}},{{b},{c}}},{{x},{y}},opts]] gives \
the full set of recursions needed to find this GF. \
MakeAllEqns[\[Psi][\[Omega],{{{a}},{{b},{c}}},{{x},{y}},opts],rules] applies \
a list of rules to the equations.  \
MakeAllEqns[\[Psi][\[Omega],{{{a}},{{b},{c}}},{{x},{y}},opts],rules,topology] \
only considers one topology. \
MakeAllEqns[\[Psi][\[Omega],{{a},{b},{c}},opts],rules,topology] etc applies \
to a single deme.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.498187428816465*^9, 3.4981874828483677`*^9}, {
  3.6353168003043337`*^9, 3.635316802042631*^9}, {3.635321938807742*^9, 
  3.635321939004787*^9}, {3.6353227185883837`*^9, 3.635322743164501*^9}, {
  3.635408830016429*^9, 3.63540891525285*^9}, {3.6483863182099447`*^9, 
  3.648386319504196*^9}, {3.649060468820368*^9, 
  3.649060503874858*^9}},ExpressionUUID->"a212c021-53ae-4856-9f90-\
5a2873699853"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MakeAllEqns", "[", 
    RowBox[{"GF_", "[", 
     RowBox[{"\[Omega]_", ",", "xl_List", ",", "opts___Rule"}], "]"}], "]"}], 
   ":=", 
   RowBox[{"MakeAllEqns", "[", 
    RowBox[{
     RowBox[{"GF", "[", 
      RowBox[{"\[Omega]", ",", "xl", ",", "opts"}], "]"}], ",", 
     RowBox[{"{", "}"}], ",", "All"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeAllEqns", "[", 
    RowBox[{
     RowBox[{"GF_", "[", 
      RowBox[{"\[Omega]_", ",", "xl_List", ",", "opts___Rule"}], "]"}], ",", 
     RowBox[{"rls", ":", 
      RowBox[{"{", "___Rule", "}"}]}]}], "]"}], ":=", 
   RowBox[{"MakeAllEqns", "[", 
    RowBox[{
     RowBox[{"GF", "[", 
      RowBox[{"\[Omega]", ",", "xl", ",", "opts"}], "]"}], ",", "rls", ",", 
     "All"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeAllEqns", "[", 
    RowBox[{
     RowBox[{"GF_", "[", 
      RowBox[{"\[Omega]_", ",", "xl_List", ",", "opts___Rule"}], "]"}], ",", 
     RowBox[{"rls", ":", 
      RowBox[{"{", "___Rule", "}"}]}], ",", 
     RowBox[{"tp", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", "___", "}"}], "|", "All"}], ")"}]}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"ReduceEqns", "[", 
    RowBox[{
     RowBox[{"FixedPoint", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"MakeEqns", "[", 
              RowBox[{"#", ",", "tp"}], "]"}], "&"}], "/@", 
            RowBox[{"GetVars", "[", 
             RowBox[{"#", ",", "GF"}], "]"}]}], ")"}], "/.", "rls"}], ")"}], 
        "&"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"MakeEqns", "[", 
          RowBox[{
           RowBox[{"GF", "[", 
            RowBox[{"\[Omega]", ",", "xl", ",", "opts"}], "]"}], ",", "tp"}], 
          "]"}], "/.", "rls"}], "}"}]}], "]"}], ",", "GF"}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"29589014-8c8e-4d20-a187-14895c7aad3f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MakeAllEqns", "[", 
    RowBox[{"GF_", "[", 
     RowBox[{
     "\[Omega]_", ",", "xl_List", ",", "dl_List", ",", "opts___Rule"}], "]"}],
     "]"}], ":=", 
   RowBox[{"MakeAllEqns", "[", 
    RowBox[{
     RowBox[{"GF", "[", 
      RowBox[{"\[Omega]", ",", "xl", ",", "dl", ",", "opts"}], "]"}], ",", 
     RowBox[{"{", "}"}], ",", "All"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeAllEqns", "[", 
    RowBox[{
     RowBox[{"GF_", "[", 
      RowBox[{
      "\[Omega]_", ",", "xl_List", ",", "dl_List", ",", "opts___Rule"}], 
      "]"}], ",", 
     RowBox[{"rls", ":", 
      RowBox[{"{", "___Rule", "}"}]}]}], "]"}], ":=", 
   RowBox[{"MakeAllEqns", "[", 
    RowBox[{
     RowBox[{"GF", "[", 
      RowBox[{"\[Omega]", ",", "xl", ",", "dl", ",", "opts"}], "]"}], ",", 
     "rls", ",", "All"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeAllEqns", "[", 
    RowBox[{
     RowBox[{"GF_", "[", 
      RowBox[{
      "\[Omega]_", ",", "xl_List", ",", "dl_List", ",", "opts___Rule"}], 
      "]"}], ",", 
     RowBox[{"rls", ":", 
      RowBox[{"{", "___Rule", "}"}]}], ",", 
     RowBox[{"tp", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", "___", "}"}], "|", "All"}], ")"}]}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"ReduceEqns", "[", 
    RowBox[{
     RowBox[{"FixedPoint", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"MakeEqns", "[", 
              RowBox[{"#", ",", "tp"}], "]"}], "&"}], "/@", 
            RowBox[{"GetVarsDemes", "[", 
             RowBox[{"#", ",", "GF"}], "]"}]}], ")"}], "/.", "rls"}], ")"}], 
        "&"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"MakeEqns", "[", 
          RowBox[{
           RowBox[{"GF", "[", 
            RowBox[{"\[Omega]", ",", "xl", ",", "dl", ",", "opts"}], "]"}], 
           ",", "tp"}], "]"}], "/.", "rls"}], "}"}]}], "]"}], ",", "GF"}], 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.498187539461673*^9, 3.498187590410594*^9}, {
   3.6353168033374653`*^9, 3.635316808464278*^9}, 3.6353168696525793`*^9, 
   3.635316965971485*^9, {3.6353172097132187`*^9, 3.635317210407734*^9}, {
   3.63532110496778*^9, 3.6353211056795597`*^9}, {3.6353227501091127`*^9, 
   3.635322854707119*^9}, {3.635408926269693*^9, 3.6354090252354794`*^9}, 
   3.635425318056829*^9, {3.635425612346662*^9, 3.635425612994616*^9}, {
   3.649060617871482*^9, 3.6490606256715384`*^9}, {3.649061194345245*^9, 
   3.649061274859367*^9}},ExpressionUUID->"c66cee82-2155-4b3c-9d75-\
fc338fcaaad6"],

Cell["\<\
ReduceEqns may not be needed here: MakeEqns should automatically set the GF \
for a single lineage to 1. ReduceEqns does also delete redundant equations, \
but these should not actually arise.\
\>", "Text",
 CellChangeTimes->{{3.6354299882227793`*^9, 3.635430048265788*^9}, {
  3.635430086403417*^9, 3.6354301114457912`*^9}, {3.6407882475207987`*^9, 
  3.64078824892842*^9}, {3.6487109500587587`*^9, 
  3.6487109668717613`*^9}},ExpressionUUID->"4bdf4f9e-ede4-4bfb-b09b-\
f6b38cfe3eb9"]
}, Closed]],

Cell[CellGroupData[{

Cell["MakeSolvedGF", "Subsubsection",
 CellChangeTimes->{{3.498187385149158*^9, 3.4981873884762363`*^9}, 
   3.635316773267459*^9, {3.6473444788584547`*^9, 3.647344482802264*^9}, {
   3.649315438820726*^9, 
   3.649315444932164*^9}},ExpressionUUID->"7e4316e5-bc1a-406e-9328-\
acbd16f20786"],

Cell[TextData[{
 StyleBox["Note: ",
  FontWeight->"Bold"],
 "I included the list of equivalences explicitly. ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"MakeDemesUniform", "[", 
     RowBox[{"xl", ",", "dl"}], "]"}], " "}], TraditionalForm]],
  ExpressionUUID->"16f3985f-4036-46d9-8e7a-f50efd43333a"],
 "will generate this list if the demes are used to define equivalence."
}], "Text",
 CellChangeTimes->{{3.649334481540822*^9, 3.6493344980349216`*^9}, {
  3.649334579864172*^9, 
  3.649334598036175*^9}},ExpressionUUID->"556d66d5-3551-4468-9a83-\
60284451d928"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeSolvedGF", "::", "usage"}], "=", 
   "\"\<MakeSolvedGF[\[Psi][\[Omega],\!\(\*
StyleBox[\"{\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"{\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"{\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"a\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"}\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\",\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"{\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"b\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"}\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"}\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\",\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"{\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"{\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"c\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"}\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\",\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"{\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"}\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"}\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"}\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\",\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"{\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"{\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"x\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"}\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\",\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"{\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"y\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"}\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"}\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\",\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"opts\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"]\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\",\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"{\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"{\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"{\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"A\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"}\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\",\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"{\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"A\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"}\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"}\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\",\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"{\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"{\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"B\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"}\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\",\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"{\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"B\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"}\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"}\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"}\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\",\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"rules\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"]\",
FontSlant->\"Italic\"]\) returns the full, solved GF as a sum over \
equivalence classes (here, A, B). It works out the equivalence classes for a \
sample, conditions on random class representatives, and solves the list of \
conditioned GFs. All leaves must initially be distinct; their equivalence is \
defined by the second argument. If this list is replaced by All, then all \
leaves are treated as distinct.\!\(\*
StyleBox[\(\\\ \*
StyleBox[\" \",
FontSlant->\"Italic\"]\)]\)MakeSolvedGF[\[Psi][\[Omega],\!\(\*
StyleBox[\"{\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"{\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"a\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"}\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\",\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"{\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"b\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"}\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"}\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\",\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"opts\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"]\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\",\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"{\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"{\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"A\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"}\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\",\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"{\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"A\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"}\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"}\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\",\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"rules\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"]\",
FontSlant->\"Italic\"]\) applies to a single deme.  \>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.497629915230047*^9, 3.497629937826552*^9}, {
   3.4976299715556097`*^9, 3.4976300002856693`*^9}, {3.4976314832831306`*^9, 
   3.497631483541554*^9}, {3.4976318525913553`*^9, 3.49763185456774*^9}, {
   3.497632351711234*^9, 3.497632383439411*^9}, {3.498187415590383*^9, 
   3.498187415637122*^9}, {3.627881660084319*^9, 3.627881674477385*^9}, {
   3.6278819675306463`*^9, 3.627881988444644*^9}, {3.635238219889872*^9, 
   3.635238285639118*^9}, 3.635238343424089*^9, {3.635238374369809*^9, 
   3.635238376777821*^9}, {3.635313183358533*^9, 3.635313184925727*^9}, {
   3.63531678033641*^9, 3.635316781705367*^9}, {3.6354061482665653`*^9, 
   3.635406182677664*^9}, {3.635406737790051*^9, 3.635406803061761*^9}, {
   3.6354068990209103`*^9, 3.635406901348206*^9}, {3.646732582496767*^9, 
   3.6467326667198677`*^9}, {3.646733105906588*^9, 3.646733174208756*^9}, {
   3.646733206939097*^9, 3.6467332263944263`*^9}, {3.646735109874125*^9, 
   3.6467351524713717`*^9}, {3.648386465867729*^9, 3.6483864669787083`*^9}, {
   3.649129791479686*^9, 3.6491297923750896`*^9}, {3.6493154412141027`*^9, 
   3.649315441365773*^9}, 3.649316399896674*^9, {3.649333027141407*^9, 
   3.649333072218401*^9}, {3.649333119247897*^9, 3.649333140402068*^9}, {
   3.649333181447644*^9, 3.6493331830237627`*^9}, {3.649333213191101*^9, 
   3.649333292256605*^9}, {3.649334441147729*^9, 3.649334472370925*^9}, {
   3.649334552274576*^9, 3.649334569139179*^9}, {3.64933818509558*^9, 
   3.649338244407196*^9}, {3.649338398361223*^9, 3.649338529720517*^9}, 
   3.6493398863258133`*^9, {3.6506108216617203`*^9, 
   3.650610824772944*^9}},ExpressionUUID->"0f4b66a7-8240-462d-9d56-\
270f3793195b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeSolvedGF", "::", "incompatible"}], "=", 
   "\"\<The list of lineages `1` does not have the same form as the list of \
equivalent lineages `2`\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.497629915230047*^9, 3.497629937826552*^9}, {
   3.4976299715556097`*^9, 3.4976300002856693`*^9}, {3.4976314832831306`*^9, 
   3.497631483541554*^9}, {3.4976318525913553`*^9, 3.49763185456774*^9}, {
   3.497632351711234*^9, 3.497632383439411*^9}, {3.498187415590383*^9, 
   3.498187415637122*^9}, {3.627881660084319*^9, 3.627881674477385*^9}, {
   3.6278819675306463`*^9, 3.627881988444644*^9}, {3.635238219889872*^9, 
   3.635238285639118*^9}, 3.635238343424089*^9, {3.635238374369809*^9, 
   3.635238376777821*^9}, {3.635313183358533*^9, 3.635313184925727*^9}, {
   3.63531678033641*^9, 3.635316781705367*^9}, {3.6354061482665653`*^9, 
   3.635406182677664*^9}, {3.635406737790051*^9, 3.635406803061761*^9}, {
   3.6354068990209103`*^9, 3.635406901348206*^9}, {3.646732582496767*^9, 
   3.6467326667198677`*^9}, {3.646733105906588*^9, 3.646733174208756*^9}, {
   3.646733206939097*^9, 3.6467332263944263`*^9}, {3.646735109874125*^9, 
   3.6467351524713717`*^9}, {3.648386465867729*^9, 3.6483864669787083`*^9}, {
   3.649129791479686*^9, 3.6491297923750896`*^9}, {3.6493154412141027`*^9, 
   3.649315441365773*^9}, 3.649316399896674*^9, {3.649333027141407*^9, 
   3.649333072218401*^9}, {3.649333119247897*^9, 3.649333140402068*^9}, {
   3.649333181447644*^9, 3.6493331830237627`*^9}, {3.649333213191101*^9, 
   3.649333292256605*^9}, {3.649334441147729*^9, 3.649334472370925*^9}, {
   3.649334552274576*^9, 3.649334569139179*^9}, {3.649334736839446*^9, 
   3.649334771512265*^9}},ExpressionUUID->"044b78b0-607c-4dd1-bc36-\
85a4b4ed5f20"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MakeSolvedGF", "[", 
    RowBox[{
     RowBox[{"GF_", "[", 
      RowBox[{"\[Omega]_", ",", "lvs_List", ",", "opts___Rule"}], "]"}], ",", 
     "All", ",", "rlz_List"}], "]"}], ":=", 
   RowBox[{"MakeSolvedGF", "[", 
    RowBox[{
     RowBox[{"GF", "[", 
      RowBox[{"\[Omega]", ",", "lvs", ",", "opts"}], "]"}], ",", "lvs", ",", 
     "rlz"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeSolvedGF", "[", 
    RowBox[{
     RowBox[{"GF_", "[", 
      RowBox[{"\[Omega]_", ",", "lvs_List", ",", "opts___Rule"}], "]"}], ",", 
     RowBox[{"lvsEC", ":", 
      RowBox[{"(", 
       RowBox[{"_List", "|", "All"}], ")"}]}]}], "]"}], ":=", 
   RowBox[{"MakeSolvedGF", "[", 
    RowBox[{
     RowBox[{"GF", "[", 
      RowBox[{"\[Omega]", ",", "lvs", ",", "opts"}], "]"}], ",", "lvsEC", ",", 
     RowBox[{"{", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MakeSolvedGF", "[", 
   RowBox[{
    RowBox[{"GF_", "[", 
     RowBox[{"\[Omega]_", ",", "lvs_List", ",", "opts___Rule"}], "]"}], ",", 
    RowBox[{"lvsEC", ":", 
     RowBox[{"(", 
      RowBox[{"_List", "|", "All"}], ")"}]}], ",", "rlz_List"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "top", ",", "topEC", ",", "ruls", ",", "topECReps", ",", "ECgf", ",", 
      "ECgfSol"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Length", "[", "lvs", "]"}], "\[Equal]", 
          RowBox[{"Length", "[", "lvsEC", "]"}]}], ")"}]}], ",", 
       RowBox[{"Message", "[", 
        RowBox[{
         RowBox[{"MakeSolvedGF", "::", "incompatible"}], ",", "lvs", ",", 
         "lvsEC"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"top", "=", 
      RowBox[{"Topologies", "[", "lvs", "]"}]}], ";", 
     RowBox[{"topEC", "=", 
      RowBox[{"Topologies", "[", "lvsEC", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ruls", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           ":>", 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         ")"}], "&"}], "/@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"lvs", ",", "lvsEC"}], "}"}], "//", "Thread"}], ")"}]}]}], 
     ";", 
     RowBox[{"(*", " ", 
      RowBox[{
      "replace", " ", "leaves", " ", "by", " ", "equivalent", " ", "labels"}],
       " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"topECReps", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"top", "/.", "ruls"}], ",", "#"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "&"}], "/@",
         "topEC"}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
      "position", " ", "of", " ", "the", " ", "first", " ", "representative", 
       " ", "of", " ", "each", " ", "topology"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"ECgf", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"MakeAllEqns", "[", 
         RowBox[{
          RowBox[{"GF", "[", 
           RowBox[{"\[Omega]", ",", "lvs", ",", "opts"}], "]"}], ",", "rlz", 
          ",", "#"}], "]"}], "&"}], "/@", 
       RowBox[{
       "top", "\[LeftDoubleBracket]", "topECReps", 
        "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ECgfSol", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{"#", ",", 
           RowBox[{"GetVars", "[", 
            RowBox[{"#", ",", "GF"}], "]"}]}], "]"}], "\[LeftDoubleBracket]", 
         "1", "\[RightDoubleBracket]"}], "&"}], "/@", "ECgf"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"NumberInClass", "[", "lvsEC", "]"}], "*", 
      RowBox[{"(", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"GF", "[", 
          RowBox[{"\[Omega]", ",", "lvs", ",", "opts"}], "]"}], "/.", 
         "ECgfSol"}], ")"}], ")"}]}]}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.451816960167666*^9, 3.451817050240202*^9}, {
   3.45181714243539*^9, 3.4518171461452208`*^9}, {3.4518187466752768`*^9, 
   3.451818787808736*^9}, {3.451818824659154*^9, 3.451818849226192*^9}, 
   3.451818884748993*^9, {3.4518189180553837`*^9, 3.451819012021847*^9}, {
   3.451819143168688*^9, 3.451819150880939*^9}, {3.4518210991423388`*^9, 
   3.451821258416922*^9}, {3.4518213079642477`*^9, 3.451821321786923*^9}, {
   3.4518213546874723`*^9, 3.451821416215108*^9}, {3.4518218883581676`*^9, 
   3.451821943897955*^9}, {3.4518219790066347`*^9, 3.451822082036336*^9}, {
   3.4518221431423607`*^9, 3.4518221493494387`*^9}, {3.4518224198949203`*^9, 
   3.451822426850383*^9}, 3.451823922232139*^9, {3.497627708522984*^9, 
   3.497627714208576*^9}, {3.497629960318728*^9, 3.497629961769705*^9}, {
   3.4976300105835257`*^9, 3.4976300122941008`*^9}, {3.497631535852659*^9, 
   3.497631539724635*^9}, {3.4976316132548857`*^9, 3.49763173375063*^9}, {
   3.497631766717923*^9, 3.497631791553844*^9}, {3.497632388374365*^9, 
   3.497632425686479*^9}, {3.497632468043236*^9, 3.497632604377015*^9}, {
   3.49763279067314*^9, 3.497632907781207*^9}, {3.497633721132181*^9, 
   3.497633723163425*^9}, {3.497633894974736*^9, 3.497633919308717*^9}, 
   3.498187415708362*^9, {3.5079753906485577`*^9, 3.5079753960409*^9}, 
   3.520534936602488*^9, {3.547371586666751*^9, 3.5473715888174763`*^9}, 
   3.547372017388856*^9, {3.547372498225038*^9, 3.547372535010606*^9}, {
   3.547372597241585*^9, 3.5473726621880608`*^9}, {3.5473732939116287`*^9, 
   3.547373295967802*^9}, 3.547453907119947*^9, {3.5474539403466587`*^9, 
   3.547453977929442*^9}, {3.547454037024377*^9, 3.54745406683953*^9}, {
   3.547454100928892*^9, 3.5474541014791327`*^9}, {3.547454169213201*^9, 
   3.5474541695436583`*^9}, {3.547540810896763*^9, 3.5475408341023903`*^9}, {
   3.5479614262061787`*^9, 3.547961432688324*^9}, {3.547961524841865*^9, 
   3.547961560723612*^9}, 3.547963676119136*^9, {3.548057751954565*^9, 
   3.5480577535290747`*^9}, {3.548057792097124*^9, 3.548057793296136*^9}, 
   3.548064849202746*^9, {3.548065014850788*^9, 3.548065016744721*^9}, {
   3.548065223049041*^9, 3.5480652233442698`*^9}, {3.601688686815626*^9, 
   3.6016886902138147`*^9}, {3.635313347076123*^9, 3.635313384092897*^9}, {
   3.635313870372386*^9, 3.6353140231962433`*^9}, {3.635314246764865*^9, 
   3.635314510049032*^9}, {3.63531456286863*^9, 3.6353146015744553`*^9}, 
   3.635314775867803*^9, {3.635314826871448*^9, 3.635314829751347*^9}, {
   3.6353148728175898`*^9, 3.6353148951696863`*^9}, {3.635314944302905*^9, 
   3.63531495326219*^9}, {3.635315054893272*^9, 3.635315088264377*^9}, 
   3.63531557406141*^9, 3.635316784898512*^9, 3.635407555178866*^9, {
   3.6354087506465397`*^9, 3.635408792103134*^9}, 3.635424959660157*^9, {
   3.635426781971744*^9, 3.635426834047311*^9}, {3.635426944423079*^9, 
   3.635426948261766*^9}, {3.635429809069646*^9, 3.635429819217437*^9}, {
   3.646732693919096*^9, 3.646732796387494*^9}, {3.6467329081902723`*^9, 
   3.6467329176494904`*^9}, {3.646733003601136*^9, 3.646733013416247*^9}, {
   3.646733239260191*^9, 3.646733315451604*^9}, {3.646733370839017*^9, 
   3.646733485621591*^9}, {3.646733561662198*^9, 3.646733563869298*^9}, {
   3.646733605943124*^9, 3.6467336714455843`*^9}, {3.646733708839992*^9, 
   3.6467337217489147`*^9}, {3.646733780030664*^9, 3.646733837926641*^9}, {
   3.6467338694224*^9, 3.6467340665620117`*^9}, {3.646734098753525*^9, 
   3.646734111049109*^9}, {3.646734158327067*^9, 3.6467342482436333`*^9}, {
   3.646734281658836*^9, 3.646734330036312*^9}, {3.646734379607007*^9, 
   3.646734421398151*^9}, {3.646734454947784*^9, 3.646734474427589*^9}, {
   3.64673457925498*^9, 3.646734726503028*^9}, {3.6467347706368017`*^9, 
   3.6467348858061113`*^9}, {3.646734925316516*^9, 3.646734999894594*^9}, {
   3.646735178070747*^9, 3.646735208382098*^9}, {3.6467362355353193`*^9, 
   3.646736237014102*^9}, {3.6467362908252687`*^9, 3.646736299214354*^9}, {
   3.646736439727088*^9, 3.646736465106903*^9}, 3.6467365039720573`*^9, {
   3.64673660790161*^9, 3.646736627718302*^9}, {3.646736673718677*^9, 
   3.646736687383292*^9}, {3.646736753649122*^9, 3.646736768188779*^9}, {
   3.64673682016638*^9, 3.646736857642342*^9}, {3.6467386083272343`*^9, 
   3.646738651945302*^9}, {3.646738995087596*^9, 3.646739013846874*^9}, {
   3.646739380957753*^9, 3.646739393767201*^9}, {3.646739443740378*^9, 
   3.646739447363907*^9}, 3.646739481372284*^9, {3.646739765352557*^9, 
   3.646739781748486*^9}, {3.646739820227429*^9, 3.646739820923299*^9}, {
   3.646740047158516*^9, 3.646740051719736*^9}, {3.6467402632650146`*^9, 
   3.646740332760104*^9}, {3.646740442457312*^9, 3.646740526113325*^9}, {
   3.646740569863904*^9, 3.646740669510229*^9}, 3.64674095380877*^9, {
   3.646741044917697*^9, 3.646741069663206*^9}, {3.646742097022683*^9, 
   3.646742115205935*^9}, {3.646742188846766*^9, 3.6467422373532763`*^9}, {
   3.646742307350527*^9, 3.646742346581048*^9}, {3.646742629653378*^9, 
   3.64674263064552*^9}, {3.649066704087986*^9, 3.649066706820067*^9}, 
   3.6491298054432583`*^9, {3.649315428377437*^9, 3.649315436399914*^9}, {
   3.6493163207562437`*^9, 3.649316323658396*^9}, {3.6493164011218367`*^9, 
   3.649316525700169*^9}, {3.649316598130993*^9, 3.649316598483657*^9}, {
   3.649319109076301*^9, 3.649319131308188*^9}, {3.649319226537841*^9, 
   3.649319234510696*^9}, {3.649319324449437*^9, 3.649319337007332*^9}, 
   3.649319376935663*^9, {3.6493195479433823`*^9, 3.6493196374715023`*^9}, {
   3.649319762258515*^9, 3.649319770361925*^9}, 3.6493198424995003`*^9, {
   3.649319964819509*^9, 3.649320000246168*^9}, 3.649328062526535*^9, {
   3.649328194184071*^9, 3.649328204606982*^9}, 3.649328328538948*^9, {
   3.649328396427835*^9, 3.649328425060886*^9}, {3.6493284885474377`*^9, 
   3.649328518694968*^9}, {3.649328620994904*^9, 3.649328632668692*^9}, {
   3.649333346323551*^9, 3.64933348815945*^9}, {3.6493345329974747`*^9, 
   3.649334537811551*^9}, {3.649334680428153*^9, 3.649334723511816*^9}, {
   3.6493347792111483`*^9, 3.649334828271048*^9}, {3.6493348932924957`*^9, 
   3.649335035544908*^9}, {3.649335090739871*^9, 3.649335120162743*^9}, {
   3.649338170604487*^9, 3.649338174243112*^9}, {3.649338271811844*^9, 
   3.64933829310572*^9}, {3.649338377854961*^9, 3.649338390506151*^9}, {
   3.649338537504196*^9, 3.64933856120557*^9}, {3.649338606352491*^9, 
   3.649338624264659*^9}, {3.649338701279771*^9, 3.649338720065261*^9}, {
   3.649339544870348*^9, 3.6493395463825493`*^9}, 3.649339609342392*^9, {
   3.649339666978792*^9, 3.649339675588251*^9}, {3.649339726264864*^9, 
   3.649339785999303*^9}, 
   3.649339871127014*^9},ExpressionUUID->"f8d2a1fb-e1f3-4fac-a104-\
aec85d439b34"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MakeSolvedGF", "[", 
    RowBox[{
     RowBox[{"GF_", "[", 
      RowBox[{
      "\[Omega]_", ",", "xl_List", ",", "dl_List", ",", "opts___Rule"}], 
      "]"}], ",", "All", ",", "rlz_"}], "]"}], ":=", 
   RowBox[{"MakeSolvedGF", "[", 
    RowBox[{
     RowBox[{"GF", "[", 
      RowBox[{"\[Omega]", ",", "xl", ",", "dl", ",", "opts"}], "]"}], ",", 
     "xl", ",", "rlz"}], "]"}]}], ";", 
  RowBox[{
   RowBox[{"MakeSolvedGF", "[", 
    RowBox[{
     RowBox[{"GF_", "[", 
      RowBox[{
      "\[Omega]_", ",", "xl_List", ",", "dl_List", ",", "opts___Rule"}], 
      "]"}], ",", 
     RowBox[{"el", ":", 
      RowBox[{"(", 
       RowBox[{"_List", "|", "All"}], ")"}]}]}], "]"}], ":=", 
   RowBox[{"MakeSolvedGF", "[", 
    RowBox[{
     RowBox[{"GF", "[", 
      RowBox[{"\[Omega]", ",", "xl", ",", "dl", ",", "opts"}], "]"}], ",", 
     "el", ",", 
     RowBox[{"{", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MakeSolvedGF", "[", 
   RowBox[{
    RowBox[{"GF_", "[", 
     RowBox[{
     "\[Omega]_", ",", "xl_List", ",", "dl_List", ",", "opts___Rule"}], "]"}],
     ",", 
    RowBox[{"el", ":", 
     RowBox[{"(", 
      RowBox[{"_List", "|", "All"}], ")"}]}], ",", "rlz_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"lvs", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"xl", ",", "1"}], "]"}]}], " ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"set", " ", "of", " ", "leaves"}], ",", " ", 
        RowBox[{"across", " ", "all", " ", "demes"}]}], " ", "*)"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"lvsEC", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"el", ",", "1"}], "]"}]}], ",", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"set", " ", "of", " ", "leaves"}], ",", " ", 
        RowBox[{"representing", " ", "equivalence"}]}], "*)"}], 
      "\[IndentingNewLine]", "top", ",", "topEC", ",", "ruls", ",", 
      "topECReps", ",", "ECgf", ",", "ECgfSol"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Length", "/@", "xl"}], ")"}], "\[Equal]", 
          RowBox[{"(", 
           RowBox[{"Length", "/@", "el"}], ")"}]}], ")"}]}], ",", 
       RowBox[{"Message", "[", 
        RowBox[{
         RowBox[{"MakeSolvedGF", "::", "incompatible"}], ",", "xl", ",", 
         "el"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"top", "=", 
      RowBox[{"Topologies", "[", "lvs", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"topEC", "=", 
      RowBox[{"Topologies", "[", "lvsEC", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ruls", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "\[Rule]", 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         ")"}], "&"}], "/@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"lvs", ",", "lvsEC"}], "}"}], "//", "Thread"}], ")"}]}]}], 
     ";", 
     RowBox[{"(*", " ", 
      RowBox[{
      "replace", " ", "leaves", " ", "by", " ", "equivalent", " ", "labels"}],
       " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"topECReps", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"top", "/.", "ruls"}], ",", "#"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "&"}], "/@",
         "topEC"}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
      "position", " ", "of", " ", "the", " ", "first", " ", "representative", 
       " ", "of", " ", "each", " ", "topology"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"ECgf", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"MakeAllEqns", "[", 
         RowBox[{
          RowBox[{"GF", "[", 
           RowBox[{"\[Omega]", ",", "xl", ",", "dl", ",", "opts"}], "]"}], 
          ",", "rlz", ",", "#"}], "]"}], "&"}], "/@", 
       RowBox[{
       "top", "\[LeftDoubleBracket]", "topECReps", 
        "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ECgfSol", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{"#", ",", 
           RowBox[{"GetVarsDemes", "[", 
            RowBox[{"#", ",", "GF"}], "]"}]}], "]"}], "\[LeftDoubleBracket]", 
         "1", "\[RightDoubleBracket]"}], "&"}], "/@", "ECgf"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"NumberInClass", "[", "lvsEC", "]"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"GF", "[", 
         RowBox[{"\[Omega]", ",", "xl", ",", "dl", ",", "opts"}], "]"}], "/.",
         "ECgfSol"}], ")"}]}]}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.451816960167666*^9, 3.451817050240202*^9}, {
   3.45181714243539*^9, 3.4518171461452208`*^9}, {3.4518187466752768`*^9, 
   3.451818787808736*^9}, {3.451818824659154*^9, 3.451818849226192*^9}, 
   3.451818884748993*^9, {3.4518189180553837`*^9, 3.451819012021847*^9}, {
   3.451819143168688*^9, 3.451819150880939*^9}, {3.4518210991423388`*^9, 
   3.451821258416922*^9}, {3.4518213079642477`*^9, 3.451821321786923*^9}, {
   3.4518213546874723`*^9, 3.451821416215108*^9}, {3.4518218883581676`*^9, 
   3.451821943897955*^9}, {3.4518219790066347`*^9, 3.451822082036336*^9}, {
   3.4518221431423607`*^9, 3.4518221493494387`*^9}, {3.4518224198949203`*^9, 
   3.451822426850383*^9}, 3.451823922232139*^9, {3.497627708522984*^9, 
   3.497627714208576*^9}, {3.497629960318728*^9, 3.497629961769705*^9}, {
   3.4976300105835257`*^9, 3.4976300122941008`*^9}, {3.497631535852659*^9, 
   3.497631539724635*^9}, {3.4976316132548857`*^9, 3.49763173375063*^9}, {
   3.497631766717923*^9, 3.497631791553844*^9}, {3.497632388374365*^9, 
   3.497632425686479*^9}, {3.497632468043236*^9, 3.497632604377015*^9}, {
   3.49763279067314*^9, 3.497632907781207*^9}, {3.497633721132181*^9, 
   3.497633723163425*^9}, {3.497633894974736*^9, 3.497633919308717*^9}, 
   3.498187415708362*^9, {3.5079753906485577`*^9, 3.5079753960409*^9}, 
   3.520534936602488*^9, {3.547371586666751*^9, 3.5473715888174763`*^9}, 
   3.547372017388856*^9, {3.547372498225038*^9, 3.547372535010606*^9}, {
   3.547372597241585*^9, 3.5473726621880608`*^9}, {3.5473732939116287`*^9, 
   3.547373295967802*^9}, 3.547453907119947*^9, {3.5474539403466587`*^9, 
   3.547453977929442*^9}, {3.547454037024377*^9, 3.54745406683953*^9}, {
   3.547454100928892*^9, 3.5474541014791327`*^9}, {3.547454169213201*^9, 
   3.5474541695436583`*^9}, {3.547540810896763*^9, 3.5475408341023903`*^9}, {
   3.5479614262061787`*^9, 3.547961432688324*^9}, {3.547961524841865*^9, 
   3.547961560723612*^9}, 3.547963676119136*^9, {3.548057751954565*^9, 
   3.5480577535290747`*^9}, {3.548057792097124*^9, 3.548057793296136*^9}, 
   3.548064849202746*^9, {3.548065014850788*^9, 3.548065016744721*^9}, {
   3.548065223049041*^9, 3.5480652233442698`*^9}, {3.601688686815626*^9, 
   3.6016886902138147`*^9}, {3.635313347076123*^9, 3.635313384092897*^9}, {
   3.635313870372386*^9, 3.6353140231962433`*^9}, {3.635314246764865*^9, 
   3.635314510049032*^9}, {3.63531456286863*^9, 3.6353146015744553`*^9}, 
   3.635314775867803*^9, {3.635314826871448*^9, 3.635314829751347*^9}, {
   3.6353148728175898`*^9, 3.6353148951696863`*^9}, {3.635314944302905*^9, 
   3.63531495326219*^9}, {3.635315054893272*^9, 3.635315088264377*^9}, 
   3.63531557406141*^9, 3.635316784898512*^9, 3.635407555178866*^9, {
   3.6354087506465397`*^9, 3.635408792103134*^9}, 3.635424959660157*^9, {
   3.635426781971744*^9, 3.635426834047311*^9}, {3.635426944423079*^9, 
   3.635426948261766*^9}, {3.635429809069646*^9, 3.635429819217437*^9}, {
   3.646732693919096*^9, 3.646732796387494*^9}, {3.6467329081902723`*^9, 
   3.6467329176494904`*^9}, {3.646733003601136*^9, 3.646733013416247*^9}, {
   3.646733239260191*^9, 3.646733315451604*^9}, {3.646733370839017*^9, 
   3.646733485621591*^9}, {3.646733561662198*^9, 3.646733563869298*^9}, {
   3.646733605943124*^9, 3.6467336714455843`*^9}, {3.646733708839992*^9, 
   3.6467337217489147`*^9}, {3.646733780030664*^9, 3.646733837926641*^9}, {
   3.6467338694224*^9, 3.6467340665620117`*^9}, {3.646734098753525*^9, 
   3.646734111049109*^9}, {3.646734158327067*^9, 3.6467342482436333`*^9}, {
   3.646734281658836*^9, 3.646734330036312*^9}, {3.646734379607007*^9, 
   3.646734421398151*^9}, {3.646734454947784*^9, 3.646734474427589*^9}, {
   3.64673457925498*^9, 3.646734726503028*^9}, {3.6467347706368017`*^9, 
   3.6467348858061113`*^9}, {3.646734925316516*^9, 3.646734999894594*^9}, {
   3.646735178070747*^9, 3.646735208382098*^9}, {3.6467362355353193`*^9, 
   3.646736237014102*^9}, {3.6467362908252687`*^9, 3.646736299214354*^9}, {
   3.646736439727088*^9, 3.646736465106903*^9}, 3.6467365039720573`*^9, {
   3.64673660790161*^9, 3.646736627718302*^9}, {3.646736673718677*^9, 
   3.646736687383292*^9}, {3.646736753649122*^9, 3.646736768188779*^9}, {
   3.64673682016638*^9, 3.646736857642342*^9}, {3.6467386083272343`*^9, 
   3.646738651945302*^9}, {3.646738995087596*^9, 3.646739013846874*^9}, {
   3.646739380957753*^9, 3.646739393767201*^9}, {3.646739443740378*^9, 
   3.646739447363907*^9}, 3.646739481372284*^9, {3.646739765352557*^9, 
   3.646739781748486*^9}, {3.646739820227429*^9, 3.646739820923299*^9}, {
   3.646740047158516*^9, 3.646740051719736*^9}, {3.6467402632650146`*^9, 
   3.646740332760104*^9}, {3.646740442457312*^9, 3.646740526113325*^9}, {
   3.646740569863904*^9, 3.646740669510229*^9}, 3.64674095380877*^9, {
   3.646741044917697*^9, 3.646741069663206*^9}, {3.646742097022683*^9, 
   3.646742115205935*^9}, {3.646742188846766*^9, 3.6467422373532763`*^9}, {
   3.646742307350527*^9, 3.646742346581048*^9}, {3.646742629653378*^9, 
   3.64674263064552*^9}, {3.649066704087986*^9, 3.649066706820067*^9}, 
   3.6491298054432583`*^9, {3.649315428377437*^9, 3.649315436399914*^9}, {
   3.6493163207562437`*^9, 3.649316323658396*^9}, {3.6493164011218367`*^9, 
   3.649316525700169*^9}, {3.649316598130993*^9, 3.649316598483657*^9}, {
   3.649319109076301*^9, 3.649319131308188*^9}, {3.649319226537841*^9, 
   3.649319234510696*^9}, {3.649319324449437*^9, 3.649319337007332*^9}, 
   3.649319376935663*^9, {3.6493195479433823`*^9, 3.6493196374715023`*^9}, {
   3.649319762258515*^9, 3.649319770361925*^9}, 3.6493198424995003`*^9, {
   3.649319964819509*^9, 3.649320000246168*^9}, 3.649328062526535*^9, {
   3.649328194184071*^9, 3.649328204606982*^9}, 3.649328328538948*^9, {
   3.649328396427835*^9, 3.649328425060886*^9}, {3.6493284885474377`*^9, 
   3.649328518694968*^9}, {3.649328620994904*^9, 3.649328632668692*^9}, {
   3.649333346323551*^9, 3.64933348815945*^9}, {3.6493345329974747`*^9, 
   3.649334537811551*^9}, {3.649334680428153*^9, 3.649334723511816*^9}, {
   3.6493347792111483`*^9, 3.649334828271048*^9}, {3.649334979475737*^9, 
   3.649335001915497*^9}, {3.649338303579327*^9, 3.649338324480835*^9}, {
   3.649338570900839*^9, 3.649338594187169*^9}, {3.6493386428817873`*^9, 
   3.6493386538372393`*^9}, {3.649338729144355*^9, 3.6493387313943167`*^9}, 
   3.649339550999908*^9, {3.649339659621249*^9, 3.6493396626766043`*^9}, 
   3.6493398746284533`*^9, 
   3.650611028446063*^9},ExpressionUUID->"da6069a1-0cae-4199-b3f3-\
ad23b5f57116"]
}, Open  ]],

Cell[CellGroupData[{

Cell["EquivalenceRules", "Subsubsection",
 CellChangeTimes->{{3.649339894740513*^9, 
  3.64933990751245*^9}},ExpressionUUID->"68721e2a-9e93-4098-8f3d-\
1484ab893b5b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EquivalenceRules", "::", "usage"}], "=", 
   "\"\<EquivalenceRules[{{a},{b}},{{X},{X}}] yields the rules \
{{a}->{X},{b}->{X},{a,b}->{X,X}}. \>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6493399284217043`*^9, 
  3.649339989921105*^9}},ExpressionUUID->"32eef98a-4afb-4bae-8aca-\
8b4717f5f773"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EquivalenceRules", "::", "incompatible"}], "=", 
   "\"\<The list of lineages `1` does not have the same form as the list of \
equivalent lineages `2`\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.497629915230047*^9, 3.497629937826552*^9}, {
   3.4976299715556097`*^9, 3.4976300002856693`*^9}, {3.4976314832831306`*^9, 
   3.497631483541554*^9}, {3.4976318525913553`*^9, 3.49763185456774*^9}, {
   3.497632351711234*^9, 3.497632383439411*^9}, {3.498187415590383*^9, 
   3.498187415637122*^9}, {3.627881660084319*^9, 3.627881674477385*^9}, {
   3.6278819675306463`*^9, 3.627881988444644*^9}, {3.635238219889872*^9, 
   3.635238285639118*^9}, 3.635238343424089*^9, {3.635238374369809*^9, 
   3.635238376777821*^9}, {3.635313183358533*^9, 3.635313184925727*^9}, {
   3.63531678033641*^9, 3.635316781705367*^9}, {3.6354061482665653`*^9, 
   3.635406182677664*^9}, {3.635406737790051*^9, 3.635406803061761*^9}, {
   3.6354068990209103`*^9, 3.635406901348206*^9}, {3.646732582496767*^9, 
   3.6467326667198677`*^9}, {3.646733105906588*^9, 3.646733174208756*^9}, {
   3.646733206939097*^9, 3.6467332263944263`*^9}, {3.646735109874125*^9, 
   3.6467351524713717`*^9}, {3.648386465867729*^9, 3.6483864669787083`*^9}, {
   3.649129791479686*^9, 3.6491297923750896`*^9}, {3.6493154412141027`*^9, 
   3.649315441365773*^9}, 3.649316399896674*^9, {3.649333027141407*^9, 
   3.649333072218401*^9}, {3.649333119247897*^9, 3.649333140402068*^9}, {
   3.649333181447644*^9, 3.6493331830237627`*^9}, {3.649333213191101*^9, 
   3.649333292256605*^9}, {3.649334441147729*^9, 3.649334472370925*^9}, {
   3.649334552274576*^9, 3.649334569139179*^9}, {3.649334736839446*^9, 
   3.649334771512265*^9}, 
   3.649339918713505*^9},ExpressionUUID->"9e671b1e-4e51-44b9-9a47-\
2e5ec93462ba"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EquivalenceRules", "[", 
    RowBox[{
     RowBox[{"lvs", ":", 
      RowBox[{"{", "___List", "}"}]}], ",", 
     RowBox[{"lvsEC", ":", 
      RowBox[{"{", "___List", "}"}]}]}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"#1", "\[Rule]", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Flatten", "/@", 
        RowBox[{"Subsets", "[", 
         RowBox[{"lvs", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"Length", "[", "lvs", "]"}]}], "}"}]}], "]"}]}], ",", 
       RowBox[{"Flatten", "/@", 
        RowBox[{"Subsets", "[", 
         RowBox[{"lvsEC", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"Length", "[", "lvsEC", "]"}]}], "}"}]}], "]"}]}]}], 
      "}"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.649339994009576*^9, 3.64934008439114*^9}, {
  3.649340128439397*^9, 3.649340155421941*^9}, {3.649340365035941*^9, 
  3.649340366747305*^9}},ExpressionUUID->"fc065f7f-f303-4c0e-84e2-\
5a122c9428d3"]
}, Closed]],

Cell[CellGroupData[{

Cell["ReduceEqns", "Subsubsection",
 CellChangeTimes->{{3.45182333275708*^9, 3.451823333787324*^9}, {
   3.498097710951953*^9, 3.498097713598304*^9}, 3.635316873702126*^9, 
   3.649128875598577*^9, 
   3.6493335366730757`*^9},ExpressionUUID->"7a50a36e-b050-4543-b1c1-\
53aa2ffc1f3d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ReduceEqns", "::", "usage"}], "=", 
   "\"\<ReduceEqns[{eqn,\[Ellipsis]},\[Psi]] replaces the GF for a single \
gene by 1 and eliminates redundant equations.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.497632920580324*^9, 3.4976329291921988`*^9}, {
   3.4976329854931927`*^9, 3.497633037474268*^9}, 3.498097194985917*^9, {
   3.498097545833837*^9, 3.4980975850214443`*^9}, {3.498097718071681*^9, 
   3.498097801010139*^9}, {3.635316878398436*^9, 3.6353168829262733`*^9}, {
   3.635321077546567*^9, 
   3.635321079829623*^9}},ExpressionUUID->"e579f094-6c2a-4537-a867-\
e9d459df4431"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ReduceEqns", "[", 
    RowBox[{
     RowBox[{"eqs", ":", 
      RowBox[{"{", "___Equal", "}"}]}], ",", "GF_"}], "]"}], ":=", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{"eqs", "/.", 
      RowBox[{
       RowBox[{"GF", "[", 
        RowBox[{"_", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "}"}], "..."}], ",", 
           RowBox[{"{", "_List", "}"}], ",", 
           RowBox[{
            RowBox[{"{", "}"}], "..."}]}], "}"}], ",", "_List", ",", 
         "___Rule"}], "]"}], "\[Rule]", "1"}]}], ",", 
     RowBox[{
      RowBox[{"1", "\[Equal]", "_"}], "|", "False", "|", "True"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.451822657243087*^9, 3.451822746008271*^9}, {
   3.4518228511200027`*^9, 3.4518228552555523`*^9}, {3.4518231233008337`*^9, 
   3.451823126122283*^9}, {3.451825055953274*^9, 3.451825060693722*^9}, {
   3.4976329661543083`*^9, 3.497632970343267*^9}, {3.498097632822756*^9, 
   3.498097662204915*^9}, {3.4980977611769943`*^9, 3.4980977782604713`*^9}, {
   3.498097826290257*^9, 3.498097854344633*^9}, 3.635316879750511*^9, {
   3.6353210862304373`*^9, 3.635321087224128*^9}, {3.635504476039925*^9, 
   3.6355044770798798`*^9}, {3.649061820045849*^9, 
   3.649061827037753*^9}},ExpressionUUID->"8567fb9f-bddd-471a-b015-\
f6b4431bff81"]
}, Closed]],

Cell[CellGroupData[{

Cell["SortEqns", "Subsubsection",
 CellChangeTimes->{{3.498187385149158*^9, 3.4981873884762363`*^9}, 
   3.635316773267459*^9, {3.6473444788584547`*^9, 3.647344482802264*^9}, {
   3.649315438820726*^9, 3.649315444932164*^9}, {3.6506207175638027`*^9, 
   3.6506207197473793`*^9}, 3.650620777107499*^9, 
   3.650622594357181*^9},ExpressionUUID->"bb12cf6e-ae27-4d84-a641-\
40224df81f1f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SortEqns", "::", "usage"}], "=", "\"\<SortEqns[list\!\(\*
StyleBox[\",\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"\[Omega]\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"]\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"groups\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"a\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"list\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"of\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"GF\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"equations\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"into\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"sets\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"with\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"identical\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"\[Omega]\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"terms\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\".\",
FontSlant->\"Italic\"]\)\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.497629915230047*^9, 3.497629937826552*^9}, {
   3.4976299715556097`*^9, 3.4976300002856693`*^9}, {3.4976314832831306`*^9, 
   3.497631483541554*^9}, {3.4976318525913553`*^9, 3.49763185456774*^9}, {
   3.497632351711234*^9, 3.497632383439411*^9}, {3.498187415590383*^9, 
   3.498187415637122*^9}, {3.627881660084319*^9, 3.627881674477385*^9}, {
   3.6278819675306463`*^9, 3.627881988444644*^9}, {3.635238219889872*^9, 
   3.635238285639118*^9}, 3.635238343424089*^9, {3.635238374369809*^9, 
   3.635238376777821*^9}, {3.635313183358533*^9, 3.635313184925727*^9}, {
   3.63531678033641*^9, 3.635316781705367*^9}, {3.6354061482665653`*^9, 
   3.635406182677664*^9}, {3.635406737790051*^9, 3.635406803061761*^9}, {
   3.6354068990209103`*^9, 3.635406901348206*^9}, {3.646732582496767*^9, 
   3.6467326667198677`*^9}, {3.646733105906588*^9, 3.646733174208756*^9}, {
   3.646733206939097*^9, 3.6467332263944263`*^9}, {3.646735109874125*^9, 
   3.6467351524713717`*^9}, {3.648386465867729*^9, 3.6483864669787083`*^9}, {
   3.649129791479686*^9, 3.6491297923750896`*^9}, {3.6493154412141027`*^9, 
   3.649315441365773*^9}, 3.649316399896674*^9, {3.649333027141407*^9, 
   3.649333072218401*^9}, {3.649333119247897*^9, 3.649333140402068*^9}, {
   3.649333181447644*^9, 3.6493331830237627`*^9}, {3.649333213191101*^9, 
   3.649333292256605*^9}, {3.649334441147729*^9, 3.649334472370925*^9}, {
   3.649334552274576*^9, 3.649334569139179*^9}, {3.64933818509558*^9, 
   3.649338244407196*^9}, {3.649338398361223*^9, 3.649338529720517*^9}, 
   3.6493398863258133`*^9, {3.6506108216617203`*^9, 3.650610824772944*^9}, 
   3.650620723411137*^9, {3.650620775777813*^9, 3.6506208567923813`*^9}, {
   3.650620934313287*^9, 3.65062102417698*^9}, {3.650621572450124*^9, 
   3.650621572833385*^9}, {3.65062259333082*^9, 
   3.6506226059135237`*^9}},ExpressionUUID->"c1562e3d-6942-4c7c-825c-\
b386133b2d80"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SortEqns", "[", 
   RowBox[{"l_", ",", "\[Omega]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Omega]list", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"GetConfigsGF", "[", 
          RowBox[{"#", ",", "\[Omega]"}], "]"}], "&"}], "/@", "l"}]}], ",", 
      "\[Omega]listEC", ",", "pos"}], "}"}], ",", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Omega]listEC", "=", 
      RowBox[{"Union", "[", "\[Omega]list", "]"}]}], ";", 
     RowBox[{"pos", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"\[Omega]list", ",", " ", "#"}], "]"}], "&"}], "/@", " ", 
       "\[Omega]listEC"}]}], ";", 
     RowBox[{
      RowBox[{
       RowBox[{"l", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}], 
       "&"}], "/@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Flatten", "[", "#", "]"}], "&"}], "/@", "pos"}], 
       ")"}]}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.451816960167666*^9, 3.451817050240202*^9}, {
   3.45181714243539*^9, 3.4518171461452208`*^9}, {3.4518187466752768`*^9, 
   3.451818787808736*^9}, {3.451818824659154*^9, 3.451818849226192*^9}, 
   3.451818884748993*^9, {3.4518189180553837`*^9, 3.451819012021847*^9}, {
   3.451819143168688*^9, 3.451819150880939*^9}, {3.4518210991423388`*^9, 
   3.451821258416922*^9}, {3.4518213079642477`*^9, 3.451821321786923*^9}, {
   3.4518213546874723`*^9, 3.451821416215108*^9}, {3.4518218883581676`*^9, 
   3.451821943897955*^9}, {3.4518219790066347`*^9, 3.451822082036336*^9}, {
   3.4518221431423607`*^9, 3.4518221493494387`*^9}, {3.4518224198949203`*^9, 
   3.451822426850383*^9}, 3.451823922232139*^9, {3.497627708522984*^9, 
   3.497627714208576*^9}, {3.497629960318728*^9, 3.497629961769705*^9}, {
   3.4976300105835257`*^9, 3.4976300122941008`*^9}, {3.497631535852659*^9, 
   3.497631539724635*^9}, {3.4976316132548857`*^9, 3.49763173375063*^9}, {
   3.497631766717923*^9, 3.497631791553844*^9}, {3.497632388374365*^9, 
   3.497632425686479*^9}, {3.497632468043236*^9, 3.497632604377015*^9}, {
   3.49763279067314*^9, 3.497632907781207*^9}, {3.497633721132181*^9, 
   3.497633723163425*^9}, {3.497633894974736*^9, 3.497633919308717*^9}, 
   3.498187415708362*^9, {3.5079753906485577`*^9, 3.5079753960409*^9}, 
   3.520534936602488*^9, {3.547371586666751*^9, 3.5473715888174763`*^9}, 
   3.547372017388856*^9, {3.547372498225038*^9, 3.547372535010606*^9}, {
   3.547372597241585*^9, 3.5473726621880608`*^9}, {3.5473732939116287`*^9, 
   3.547373295967802*^9}, 3.547453907119947*^9, {3.5474539403466587`*^9, 
   3.547453977929442*^9}, {3.547454037024377*^9, 3.54745406683953*^9}, {
   3.547454100928892*^9, 3.5474541014791327`*^9}, {3.547454169213201*^9, 
   3.5474541695436583`*^9}, {3.547540810896763*^9, 3.5475408341023903`*^9}, {
   3.5479614262061787`*^9, 3.547961432688324*^9}, {3.547961524841865*^9, 
   3.547961560723612*^9}, 3.547963676119136*^9, {3.548057751954565*^9, 
   3.5480577535290747`*^9}, {3.548057792097124*^9, 3.548057793296136*^9}, 
   3.548064849202746*^9, {3.548065014850788*^9, 3.548065016744721*^9}, {
   3.548065223049041*^9, 3.5480652233442698`*^9}, {3.601688686815626*^9, 
   3.6016886902138147`*^9}, {3.635313347076123*^9, 3.635313384092897*^9}, {
   3.635313870372386*^9, 3.6353140231962433`*^9}, {3.635314246764865*^9, 
   3.635314510049032*^9}, {3.63531456286863*^9, 3.6353146015744553`*^9}, 
   3.635314775867803*^9, {3.635314826871448*^9, 3.635314829751347*^9}, {
   3.6353148728175898`*^9, 3.6353148951696863`*^9}, {3.635314944302905*^9, 
   3.63531495326219*^9}, {3.635315054893272*^9, 3.635315088264377*^9}, 
   3.63531557406141*^9, 3.635316784898512*^9, 3.635407555178866*^9, {
   3.6354087506465397`*^9, 3.635408792103134*^9}, 3.635424959660157*^9, {
   3.635426781971744*^9, 3.635426834047311*^9}, {3.635426944423079*^9, 
   3.635426948261766*^9}, {3.635429809069646*^9, 3.635429819217437*^9}, {
   3.646732693919096*^9, 3.646732796387494*^9}, {3.6467329081902723`*^9, 
   3.6467329176494904`*^9}, {3.646733003601136*^9, 3.646733013416247*^9}, {
   3.646733239260191*^9, 3.646733315451604*^9}, {3.646733370839017*^9, 
   3.646733485621591*^9}, {3.646733561662198*^9, 3.646733563869298*^9}, {
   3.646733605943124*^9, 3.6467336714455843`*^9}, {3.646733708839992*^9, 
   3.6467337217489147`*^9}, {3.646733780030664*^9, 3.646733837926641*^9}, {
   3.6467338694224*^9, 3.6467340665620117`*^9}, {3.646734098753525*^9, 
   3.646734111049109*^9}, {3.646734158327067*^9, 3.6467342482436333`*^9}, {
   3.646734281658836*^9, 3.646734330036312*^9}, {3.646734379607007*^9, 
   3.646734421398151*^9}, {3.646734454947784*^9, 3.646734474427589*^9}, {
   3.64673457925498*^9, 3.646734726503028*^9}, {3.6467347706368017`*^9, 
   3.6467348858061113`*^9}, {3.646734925316516*^9, 3.646734999894594*^9}, {
   3.646735178070747*^9, 3.646735208382098*^9}, {3.6467362355353193`*^9, 
   3.646736237014102*^9}, {3.6467362908252687`*^9, 3.646736299214354*^9}, {
   3.646736439727088*^9, 3.646736465106903*^9}, 3.6467365039720573`*^9, {
   3.64673660790161*^9, 3.646736627718302*^9}, {3.646736673718677*^9, 
   3.646736687383292*^9}, {3.646736753649122*^9, 3.646736768188779*^9}, {
   3.64673682016638*^9, 3.646736857642342*^9}, {3.6467386083272343`*^9, 
   3.646738651945302*^9}, {3.646738995087596*^9, 3.646739013846874*^9}, {
   3.646739380957753*^9, 3.646739393767201*^9}, {3.646739443740378*^9, 
   3.646739447363907*^9}, 3.646739481372284*^9, {3.646739765352557*^9, 
   3.646739781748486*^9}, {3.646739820227429*^9, 3.646739820923299*^9}, {
   3.646740047158516*^9, 3.646740051719736*^9}, {3.6467402632650146`*^9, 
   3.646740332760104*^9}, {3.646740442457312*^9, 3.646740526113325*^9}, {
   3.646740569863904*^9, 3.646740669510229*^9}, 3.64674095380877*^9, {
   3.646741044917697*^9, 3.646741069663206*^9}, {3.646742097022683*^9, 
   3.646742115205935*^9}, {3.646742188846766*^9, 3.6467422373532763`*^9}, {
   3.646742307350527*^9, 3.646742346581048*^9}, {3.646742629653378*^9, 
   3.64674263064552*^9}, {3.649066704087986*^9, 3.649066706820067*^9}, 
   3.6491298054432583`*^9, {3.649315428377437*^9, 3.649315436399914*^9}, {
   3.6493163207562437`*^9, 3.649316323658396*^9}, {3.6493164011218367`*^9, 
   3.649316525700169*^9}, {3.649316598130993*^9, 3.649316598483657*^9}, {
   3.649319109076301*^9, 3.649319131308188*^9}, {3.649319226537841*^9, 
   3.649319234510696*^9}, {3.649319324449437*^9, 3.649319337007332*^9}, 
   3.649319376935663*^9, {3.6493195479433823`*^9, 3.6493196374715023`*^9}, {
   3.649319762258515*^9, 3.649319770361925*^9}, 3.6493198424995003`*^9, {
   3.649319964819509*^9, 3.649320000246168*^9}, 3.649328062526535*^9, {
   3.649328194184071*^9, 3.649328204606982*^9}, 3.649328328538948*^9, {
   3.649328396427835*^9, 3.649328425060886*^9}, {3.6493284885474377`*^9, 
   3.649328518694968*^9}, {3.649328620994904*^9, 3.649328632668692*^9}, {
   3.649333346323551*^9, 3.64933348815945*^9}, {3.6493345329974747`*^9, 
   3.649334537811551*^9}, {3.649334680428153*^9, 3.649334723511816*^9}, {
   3.6493347792111483`*^9, 3.649334828271048*^9}, {3.6493348932924957`*^9, 
   3.649335035544908*^9}, {3.649335090739871*^9, 3.649335120162743*^9}, {
   3.649338170604487*^9, 3.649338174243112*^9}, {3.649338271811844*^9, 
   3.64933829310572*^9}, {3.649338377854961*^9, 3.649338390506151*^9}, {
   3.649338537504196*^9, 3.64933856120557*^9}, {3.649338606352491*^9, 
   3.649338624264659*^9}, {3.649338701279771*^9, 3.649338720065261*^9}, {
   3.649339544870348*^9, 3.6493395463825493`*^9}, 3.649339609342392*^9, {
   3.649339666978792*^9, 3.649339675588251*^9}, {3.649339726264864*^9, 
   3.649339785999303*^9}, 3.649339871127014*^9, {3.650620726387591*^9, 
   3.650620765205126*^9}, {3.6506208766386433`*^9, 3.650620905893985*^9}, {
   3.650621037036635*^9, 3.6506211070326366`*^9}, {3.6506213909213543`*^9, 
   3.650621490898395*^9}, {3.6506219319547997`*^9, 3.650622192572093*^9}, {
   3.6506222238050137`*^9, 3.650622231729703*^9}, {3.650622316029565*^9, 
   3.6506223169146633`*^9}},ExpressionUUID->"f952f8e4-9ed4-455c-978b-\
17d3a51b9ea3"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Setting up tables of probabilities: subsidiary functions and notes\
\>", "Subsection",
 CellChangeTimes->{{3.6483865353974*^9, 3.6483865464991837`*^9}, 
   3.649226337523493*^9, {3.6493085810919447`*^9, 3.649308619448715*^9}, 
   3.652594924634941*^9},ExpressionUUID->"03e82bf8-1ab6-4f7a-a017-\
be45778d0f38"],

Cell[CellGroupData[{

Cell["From intervals to ordered branches", "Subsubsection",
 CellChangeTimes->{{3.5509798178596563`*^9, 3.550979828370846*^9}, {
   3.55097991447048*^9, 3.5509799287236567`*^9}, {3.550993009519678*^9, 
   3.550993011423283*^9}, {3.653131831157552*^9, 3.653131843093655*^9}, 
   3.653132528077277*^9},ExpressionUUID->"c4b4fcad-c870-4950-816c-\
6a28d6834f06"],

Cell[TextData[{
 "Any tree shape contains at least one further symmetry : there is at least \
one node which connects to two leaves. Because the branches descending from \
that node have the same length by definition, we can combine mutations (and \
hence \[Omega] terms) falling on them. E.g. for a triplet genealogy with \
topology (a, (b, c)) , we can combine mutations on branch b and c. The joint \
probability of seeing a configuration with ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", "b"], TraditionalForm]],ExpressionUUID->
  "952be8af-1590-4084-80ec-d772b35f9895"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", "c"], TraditionalForm]],ExpressionUUID->
  "fa6c503b-0f3f-4a2a-aee3-2525fcc6b511"],
 " mutations can be retrieved from ",
 Cell[BoxData[
  FormBox[
   RowBox[{"P", "[", 
    RowBox[{
     SubscriptBox["k", "b"], "+", 
     SubscriptBox["k", "c"]}], "]"}], TraditionalForm]],ExpressionUUID->
  "ecd03a11-e933-49f6-a363-d4219b67427b"],
 "  by multiplying with the binomial probability:"
}], "Text",
 CellChangeTimes->{{3.6530325004910727`*^9, 3.653032511991094*^9}, 
   3.653032562065723*^9, {3.653131844847487*^9, 3.65313187723777*^9}, 
   3.653132266350026*^9},ExpressionUUID->"c000fddd-6b57-4871-89d0-\
1cf895874b56"],

Cell[TextData[Cell[BoxData[
 RowBox[{
  RowBox[{"P", "[", 
   RowBox[{
    SubscriptBox["k", 
     RowBox[{"b", ","}]], 
    SubscriptBox["k", "c"]}], "]"}], "=", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox["1", "2"], ")"}], 
    RowBox[{
     SubscriptBox["k", "b"], "+", 
     SubscriptBox["k", "c"]}]], 
   RowBox[{"(", GridBox[{
      {
       RowBox[{
        SubscriptBox["k", "b"], "+", 
        SubscriptBox["k", "c"]}]},
      {
       SubscriptBox["k", "b"]}
     }], ")"}], 
   RowBox[{"P", "[", 
    RowBox[{
     SubscriptBox["k", "b"], "+", 
     SubscriptBox["k", "c"]}], "]"}]}]}]], "DisplayFormulaNumbered",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQnWC/1O9ryStHiZ6TYPqq8OIgEP3NsDsWRG+x3Z0E
opU0v6eA1b0tzAPRcR/n5oNoqdkPOkH0ig6Z6SD6VP262SD6VY3JXBBdtoxt
IYh+lj1jNYjWY/HZCKLtj/3eAqJvXvDaBaK9TNR3g2iGK6mHwOatmH8SRF+3
33oZRG+IyL0KosWbNj4G0fOij74C0Rf33/sIolP8Yv+B3bfV3/YbyP0yM0NB
9LbyslYQ3cF3EEwfuyUxGUTf4a2aBqKXnimaC6LnSDfOB9GWPZs2gugsYflN
IDqCqSbtB4juWZAOol90NrT9BNJ3xaU7QTQf++z7f4H0un2HwHSHD1fEbPPX
jreeWGSAaACFkc0d
  "],ExpressionUUID->"4227dd6b-265b-49a5-88d7-491fd0abc54a"]], "Text",
 CellChangeTimes->{{3.6530325004910727`*^9, 3.653032511991094*^9}, 
   3.653032562065723*^9, {3.653131844847487*^9, 3.65313187723777*^9}, 
   3.653132571477297*^9},ExpressionUUID->"2a15aed1-766a-4c2f-a21f-\
404a81aab9cf"],

Cell[TextData[{
 "Given an ordered topology, this combinatoric argument extends to all nodes, \
because the GF only depends on the intervals between successive coalescence \
events and the number of branches involved in each. We have previoulsy made \
use of this in implementing likelihood calculations for triplet samples \
(Lohse et al. 2011, SI). In general, for each genealogy there are n-1 \
coalescence intervals but 2(n-1) branches, so for large ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "87d1613c-5976-4a33-b518-13ebe30fbc74"],
 ", tabulating probabilities of mutational configurations in terms of \
intervals ",
 Cell[BoxData[
  FormBox[
   RowBox[{"P", "[", 
    SubscriptBox["k", "int"]}], TraditionalForm]],ExpressionUUID->
  "1247629c-da30-4640-bc04-1a45479fbc29"],
 "] rather than branches ",
 Cell[BoxData[
  FormBox[
   RowBox[{"P", "[", 
    StyleBox["k",
     FontVariations->{"Underline"->True}], 
    StyleBox["]",
     FontVariations->{"Underline"->True}]}], TraditionalForm]],
  ExpressionUUID->"832b711a-20f0-416b-b256-c42d41a2d3d7"],
 " halves the dimensionality of the table of mutational configurations. \
Obtaining ",
 Cell[BoxData[
  FormBox[
   RowBox[{"P", "[", 
    StyleBox["k",
     FontVariations->{"Underline"->True}], 
    StyleBox["]",
     FontVariations->{"Underline"->True}]}], TraditionalForm]],
  ExpressionUUID->"36a4acb9-9db9-4d70-bda9-55f3d854b949"],
 "  from  ",
 Cell[BoxData[
  FormBox[
   RowBox[{"P", "[", 
    SubscriptBox["k", "int"]}], TraditionalForm]],ExpressionUUID->
  "0d6d95e2-b057-4f95-9b18-6d52978c7aa7"],
 "]  is simple in principle: each assignment of mutations in an interval onto \
the branches present during that interval is given by a multinomial \
distribution. For the whole genealogy we have a product of multinomial \
distributions (one per interval) and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"P", "[", 
    StyleBox["k",
     FontVariations->{"Underline"->True}], 
    StyleBox["]",
     FontVariations->{"Underline"->True}]}], TraditionalForm]],
  ExpressionUUID->"1c325ac9-f685-4e8e-aee4-ad2fd5b0e1ac"],
 "  is a sum over all ways of assigning mutations from intervals onto \
branches."
}], "Text",
 CellChangeTimes->{{3.550979931781638*^9, 3.5509800635507307`*^9}, {
   3.550980211298513*^9, 3.550980321102194*^9}, {3.550980591967304*^9, 
   3.550980631652258*^9}, {3.5509929302263727`*^9, 3.550993005111854*^9}, {
   3.5509934283576317`*^9, 3.55099343852558*^9}, {3.5510708358324003`*^9, 
   3.551070882013876*^9}, 3.5510709433494387`*^9, {3.551070986985834*^9, 
   3.551071177116859*^9}, {3.551071260078147*^9, 3.551071432257061*^9}, {
   3.5510715115603323`*^9, 3.551071617039762*^9}, {3.551411336309458*^9, 
   3.5514114522470503`*^9}, {3.551431445232217*^9, 3.551431462082508*^9}, {
   3.5521041407024317`*^9, 3.552104147292528*^9}, {3.5521041795399647`*^9, 
   3.5521042069814796`*^9}, {3.653131921060515*^9, 3.653132013685498*^9}, {
   3.6531320584342823`*^9, 3.653132080913966*^9}, {3.653132127058585*^9, 
   3.6531322145340776`*^9}},ExpressionUUID->"ece8de39-b3b7-4500-bff5-\
b2406edd52e9"],

Cell[TextData[{
 "As a concrete example, consider a genealogy of n=4 leaves (a, b, c, d) with \
a ladder-topology ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", ",", "b"}], ")"}], ",", "c"}], ")"}], ",", "d"}], ")"}], 
   TraditionalForm]],ExpressionUUID->"a7301343-c1e0-4b7d-b3a0-607218e44ba0"],
 ". We have: "
}], "Text",
 CellChangeTimes->{{3.550981170576988*^9, 3.550981191736184*^9}, {
  3.550981315263453*^9, 3.550981318511368*^9}, {3.550981722555183*^9, 
  3.550981774961944*^9}, {3.55107089879676*^9, 3.5510709213641777`*^9}, {
  3.551431495321416*^9, 3.551431497080948*^9}, {3.55210423389251*^9, 
  3.5521042424760427`*^9}, {3.6531325423651953`*^9, 
  3.653132564029035*^9}},ExpressionUUID->"8e263dba-7dca-41eb-b46c-\
4c61bf74914a"],

Cell[BoxData[
 RowBox[{
  UnderoverscriptBox["\[Sum]", 
   RowBox[{" ", 
    RowBox[{
     SubscriptBox["j", "c3"], "=", "0"}]}], 
   SubscriptBox["k", "c"]], 
  RowBox[{
   UnderoverscriptBox["\[Sum]", 
    RowBox[{" ", 
     RowBox[{
      SubscriptBox["j", "d2"], "=", "0"}]}], 
    SubscriptBox["k", "d"]], 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{" ", 
      RowBox[{
       SubscriptBox["j", "d3"], "=", "0"}]}], 
     RowBox[{
      SubscriptBox["k", "d"], "-", 
      SubscriptBox["j", "d2"]}]], 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "4"], ")"}], 
      RowBox[{
       SubscriptBox["k", "a"], "+", 
       SubscriptBox["k", "b"], "+", 
       SubscriptBox["k", "c"], "+", 
       SubscriptBox["k", "d"], "-", 
       SubscriptBox["j", "c3"], "-", 
       SubscriptBox["j", "d3"], "-", 
       SubscriptBox["j", "d2"]}]], 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "3"], ")"}], 
      RowBox[{
       SubscriptBox["k", "ab"], "+", 
       SubscriptBox["j", "c3"], "+", 
       SubscriptBox["j", "d3"]}]], 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "2"], ")"}], 
      RowBox[{
       SubscriptBox["k", "abc"], "+", 
       SubscriptBox["j", "d2"]}]], 
     RowBox[{"(", GridBox[{
        {
         RowBox[{
          SubscriptBox["k", "a"], "+", 
          SubscriptBox["k", "b"], "+", 
          SubscriptBox["k", "c"], "+", 
          SubscriptBox["k", "d"], "-", 
          SubscriptBox["j", "c3"], "-", 
          SubscriptBox["j", "d3"], "-", 
          SubscriptBox["j", "d2"]}]},
        {
         RowBox[{
          SubscriptBox["k", "s"], ",", 
          RowBox[{
           SubscriptBox["k", "c"], "-", 
           SubscriptBox["j", "c3"]}]}]}
       }], ")"}], 
     RowBox[{"(", GridBox[{
        {
         RowBox[{
          SubscriptBox["k", "ab"], "+", 
          SubscriptBox["j", "c3"], "+", 
          SubscriptBox["j", "d3"]}]},
        {
         RowBox[{
          SubscriptBox["k", "ab"], ",", 
          SubscriptBox["j", "c3"]}]}
       }], ")"}], 
     RowBox[{"(", GridBox[{
        {
         RowBox[{
          SubscriptBox["k", "abc"], "+", 
          SubscriptBox["j", "d2"]}]},
        {
         SubscriptBox["j", "d2"]}
       }], ")"}], 
     RowBox[{"P", "[", 
      RowBox[{
       SubscriptBox["k", "4"], ",", 
       SubscriptBox["k", "3"], ",", 
       SubscriptBox["k", "2"]}], "]"}]}]}]}]}]], "DisplayFormulaNumbered",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQnWC/1O9ryStHiZ6TYPqq8OIgEP3NsDsWRG+x3Z0E
opU0v6eA1b0tzAPRcR/n5oNoqdkPOkH0ig6Z6SD6VP262SD6VY3JXBBdtoxt
IYh+lj1jNYjWY/HZCKLtj/3eAqJvXvDaBaK9TNR3g2iGK6mHwOatmH8SRF+3
33oZRG+IyL0KosWbNj4G0fOij74C0Rf33/sIolP8Yv+B3bfV3/YbyP0yM0NB
9LbyslYQ3cF3EEwfuyUxGUTf4a2aBqKXnimaC6LnSDfOB9GWPZs2gugsYflN
IDqCqSbtB4juWZAOol90NrT9BNJ3xaU7QTQf++z7f4H0un2HwDQA7grFjA==

  "],ExpressionUUID->"cc20af6b-9fb4-4e9e-9eb0-bbdbf143f93a"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  SubscriptBox["k", "i"]],
  CellChangeTimes->{{3.550980725163986*^9, 3.5509807262983513`*^9}, {
   3.550980757096171*^9, 3.5509808443498487`*^9}, {3.550980885851282*^9, 
   3.550980903723771*^9}, {3.550980979560192*^9, 3.550980988935714*^9}, {
   3.5509811990189333`*^9, 3.5509813048916817`*^9}, {3.5509813414530993`*^9, 
   3.5509813536402483`*^9}, {3.55098138420782*^9, 3.550981468763171*^9}, {
   3.55098151437551*^9, 3.55098154386795*^9}, {3.550981586337994*^9, 
   3.550981593225133*^9}, {3.550981651182129*^9, 3.550981708989338*^9}, {
   3.550981789664043*^9, 3.550981803417076*^9}, {3.55098191754713*^9, 
   3.5509819741674337`*^9}, {3.550982030960915*^9, 3.550982130915819*^9}, {
   3.550982634490856*^9, 3.5509828287847853`*^9}, {3.550983211702113*^9, 
   3.550983214033024*^9}, {3.5509833207767057`*^9, 3.550983347814192*^9}, {
   3.550983403587481*^9, 3.5509834200346203`*^9}},ExpressionUUID->
  "b1804a52-1ced-4140-9355-c74a06e73430"],
 " denotes the number of mutations in interval i. We need two subscripts for \
the j\[CloseCurlyQuote]s corresponding to the branch and the interval in \
which a mutation happens, i.e.  ",
 Cell[BoxData[
  SubscriptBox["j", 
   RowBox[{"c", ",", "3"}]]],
  CellChangeTimes->{{3.550980725163986*^9, 3.5509807262983513`*^9}, {
   3.550980757096171*^9, 3.5509808443498487`*^9}, {3.550980885851282*^9, 
   3.550980903723771*^9}, {3.550980979560192*^9, 3.550980988935714*^9}, {
   3.5509811990189333`*^9, 3.5509813048916817`*^9}, {3.5509813414530993`*^9, 
   3.5509813536402483`*^9}, {3.55098138420782*^9, 3.550981468763171*^9}, {
   3.55098151437551*^9, 3.55098154386795*^9}, {3.550981586337994*^9, 
   3.550981593225133*^9}, {3.550981651182129*^9, 3.550981708989338*^9}, {
   3.550981789664043*^9, 3.550981803417076*^9}, {3.55098191754713*^9, 
   3.5509819741674337`*^9}, {3.550982030960915*^9, 3.550982130915819*^9}, {
   3.550982634490856*^9, 3.5509828287847853`*^9}, {3.550983211702113*^9, 
   3.550983214033024*^9}, {3.5509833207767057`*^9, 3.550983347814192*^9}, {
   3.550983403587481*^9, 3.5509834200346203`*^9}, {3.550983565579617*^9, 
   3.55098356897112*^9}},ExpressionUUID->
  "df7f0df7-3d1a-4368-b83c-00510956c24c"],
 " is the number of mutations that occur on branch c in interval 3, the \
number of mutations on branch c that fall in interval 4 is ",
 Cell[BoxData[
  SubscriptBox["k", "c"]],
  CellChangeTimes->{{3.550980725163986*^9, 3.5509807262983513`*^9}, {
   3.550980757096171*^9, 3.5509808443498487`*^9}, {3.550980885851282*^9, 
   3.550980903723771*^9}, {3.550980979560192*^9, 3.550980988935714*^9}, {
   3.5509811990189333`*^9, 3.5509813048916817`*^9}, {3.5509813414530993`*^9, 
   3.5509813536402483`*^9}, {3.55098138420782*^9, 3.550981468763171*^9}, {
   3.55098151437551*^9, 3.55098154386795*^9}, {3.550981586337994*^9, 
   3.550981593225133*^9}, {3.550981651182129*^9, 3.550981708989338*^9}, {
   3.550981789664043*^9, 3.550981803417076*^9}, {3.55098191754713*^9, 
   3.5509819741674337`*^9}, {3.550982030960915*^9, 3.550982130915819*^9}, {
   3.550982634490856*^9, 3.5509828287847853`*^9}, {3.550983211702113*^9, 
   3.550983214033024*^9}, {3.5509833207767057`*^9, 3.550983347814192*^9}, {
   3.550983403587481*^9, 3.5509834200346203`*^9}, {3.550983565579617*^9, 
   3.55098356897112*^9}},ExpressionUUID->
  "12acd160-a9d8-4537-9657-06a6e7076e17"],
 "-",
 Cell[BoxData[
  SubscriptBox["j", 
   RowBox[{"c", ",", "3"}]]],
  CellChangeTimes->{{3.550980725163986*^9, 3.5509807262983513`*^9}, {
   3.550980757096171*^9, 3.5509808443498487`*^9}, {3.550980885851282*^9, 
   3.550980903723771*^9}, {3.550980979560192*^9, 3.550980988935714*^9}, {
   3.5509811990189333`*^9, 3.5509813048916817`*^9}, {3.5509813414530993`*^9, 
   3.5509813536402483`*^9}, {3.55098138420782*^9, 3.550981468763171*^9}, {
   3.55098151437551*^9, 3.55098154386795*^9}, {3.550981586337994*^9, 
   3.550981593225133*^9}, {3.550981651182129*^9, 3.550981708989338*^9}, {
   3.550981789664043*^9, 3.550981803417076*^9}, {3.55098191754713*^9, 
   3.5509819741674337`*^9}, {3.550982030960915*^9, 3.550982130915819*^9}, {
   3.550982634490856*^9, 3.5509828287847853`*^9}, {3.550983211702113*^9, 
   3.550983214033024*^9}, {3.5509833207767057`*^9, 3.550983347814192*^9}, {
   3.550983403587481*^9, 3.5509834200346203`*^9}, {3.550983565579617*^9, 
   3.55098356897112*^9}},ExpressionUUID->
  "4a7adfaa-3ed3-47d5-a7c6-af1427386f97"],
 " \n\nThe relationship between the ",
 Cell[BoxData[
  SubscriptBox["k", "i"]],
  CellChangeTimes->{{3.550980725163986*^9, 3.5509807262983513`*^9}, {
   3.550980757096171*^9, 3.5509808443498487`*^9}, {3.550980885851282*^9, 
   3.550980903723771*^9}, {3.550980979560192*^9, 3.550980988935714*^9}, {
   3.5509811990189333`*^9, 3.5509813048916817`*^9}, {3.5509813414530993`*^9, 
   3.5509813536402483`*^9}, {3.55098138420782*^9, 3.550981468763171*^9}, {
   3.55098151437551*^9, 3.55098154386795*^9}, {3.550981586337994*^9, 
   3.550981593225133*^9}, {3.550981651182129*^9, 3.550981708989338*^9}, {
   3.550981789664043*^9, 3.550981803417076*^9}, {3.55098191754713*^9, 
   3.5509819741674337`*^9}, {3.550982030960915*^9, 3.550982130915819*^9}, {
   3.550982634490856*^9, 3.5509828287847853`*^9}, {3.550983211702113*^9, 
   3.550983214033024*^9}, {3.5509833207767057`*^9, 3.550983347814192*^9}, {
   3.550983403587481*^9, 3.5509834200346203`*^9}},ExpressionUUID->
  "ed6dc570-4e88-4686-aede-ddd7d6e05a22"],
 " and ",
 Cell[BoxData[
  SubscriptBox["k", "branches"]],
  CellChangeTimes->{{3.550980725163986*^9, 3.5509807262983513`*^9}, {
   3.550980757096171*^9, 3.5509808443498487`*^9}, {3.550980885851282*^9, 
   3.550980903723771*^9}, {3.550980979560192*^9, 3.550980988935714*^9}, {
   3.5509811990189333`*^9, 3.5509813048916817`*^9}, {3.5509813414530993`*^9, 
   3.5509813536402483`*^9}, {3.55098138420782*^9, 3.550981468763171*^9}, {
   3.55098151437551*^9, 3.55098154386795*^9}, {3.550981586337994*^9, 
   3.550981593225133*^9}, {3.550981651182129*^9, 3.550981708989338*^9}, {
   3.550981789664043*^9, 3.550981803417076*^9}, {3.55098191754713*^9, 
   3.5509819741674337`*^9}, {3.550982030960915*^9, 3.550982130915819*^9}, {
   3.550982634490856*^9, 3.5509828287847853`*^9}, {3.550983211702113*^9, 
   3.550983214033024*^9}, {3.5509833207767057`*^9, 3.550983347814192*^9}, {
   3.550983403587481*^9, 3.5509834200346203`*^9}},ExpressionUUID->
  "c1e43345-3c16-4284-90f7-cf9e962b588d"],
 " is given by the topology. For the above topology we have; ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox["k", "4"], "=", " ", 
   RowBox[{
    SubscriptBox["k", "a"], "+", 
    SubscriptBox["k", "b"], "+", 
    SubscriptBox["k", "c"], "-", 
    SubscriptBox["j", "c3"], "+", 
    SubscriptBox["k", "d"], "-", 
    SubscriptBox["j", "d3"], "-", 
    SubscriptBox["j", "d2"]}]}]],
  CellChangeTimes->{{3.550980725163986*^9, 3.5509807262983513`*^9}, {
   3.550980757096171*^9, 3.5509808443498487`*^9}, {3.550980885851282*^9, 
   3.550980903723771*^9}, {3.550980979560192*^9, 3.550980988935714*^9}, {
   3.5509811990189333`*^9, 3.5509813048916817`*^9}, {3.5509813414530993`*^9, 
   3.5509813536402483`*^9}, {3.55098138420782*^9, 3.550981468763171*^9}, {
   3.55098151437551*^9, 3.55098154386795*^9}, {3.550981586337994*^9, 
   3.550981593225133*^9}, {3.550981651182129*^9, 3.550981708989338*^9}, {
   3.550981789664043*^9, 3.550981803417076*^9}, {3.55098191754713*^9, 
   3.5509819741674337`*^9}, {3.550982030960915*^9, 3.550982130915819*^9}, {
   3.550982634490856*^9, 3.5509828287847853`*^9}, {3.550983211702113*^9, 
   3.550983214033024*^9}, {3.5509833207767057`*^9, 3.550983347814192*^9}, {
   3.550983403587481*^9, 3.5509834200346203`*^9}},ExpressionUUID->
  "c5e2d539-3c55-4d50-a747-e388359b5f18"],
 ", ",
 Cell[BoxData[
  SubscriptBox["k", "3"]],
  CellChangeTimes->{{3.550980725163986*^9, 3.5509807262983513`*^9}, {
   3.550980757096171*^9, 3.5509808443498487`*^9}, {3.550980885851282*^9, 
   3.550980903723771*^9}, {3.550980979560192*^9, 3.550980988935714*^9}, {
   3.5509811990189333`*^9, 3.5509813048916817`*^9}, {3.5509813414530993`*^9, 
   3.5509813536402483`*^9}, {3.55098138420782*^9, 3.550981468763171*^9}, {
   3.55098151437551*^9, 3.55098154386795*^9}, {3.550981586337994*^9, 
   3.550981593225133*^9}, {3.550981651182129*^9, 3.550981708989338*^9}, {
   3.550981789664043*^9, 3.550981803417076*^9}, {3.55098191754713*^9, 
   3.5509819741674337`*^9}, {3.550982030960915*^9, 3.550982130915819*^9}, {
   3.550982634490856*^9, 3.5509828287847853`*^9}, {3.550983211702113*^9, 
   3.550983214033024*^9}, {3.5509833207767057`*^9, 3.550983347814192*^9}, {
   3.550983403587481*^9, 3.5509834200346203`*^9}},ExpressionUUID->
  "dbf2ae50-f80f-466a-91cc-e518602a3b3c"],
 "= ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox["k", "ab"], "+", 
   SubscriptBox["j", "c3"], "+", 
   SubscriptBox["j", "d3"]}]],
  CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQnWC/1O9ryStHiZ6TYPqq8OIgEP3NsDsWRG+x3Z0E
opU0v6eA1b0tzAPRcR/n5oNoqdkPOkH0ig6Z6SD6VP262SD6VY3JXBBdtoxt
IYh+lj1jNYjWY/HZCKLtj/3eAqJvXvDaBaK9TNR3g2iGK6mHwOatmH8SRF+3
33oZRG+IyL0KosWbNj4G0fOij74C0Rf33/sIolP8Yv+B3bfV3/YbyP0yM0NB
9LbyslYQ3cF3EEwfuyUxGUTf4a2aBqKXnimaC6LnSDfOB9GWPZs2gugsYflN
IDqCqSbtB4juWZAOogFoUbJ3
   "],ExpressionUUID->"d6ac3762-814d-471f-b462-49edd563a898"],
 " and ",
 Cell[BoxData[
  SubscriptBox["k", "2"]],
  CellChangeTimes->{{3.550980725163986*^9, 3.5509807262983513`*^9}, {
   3.550980757096171*^9, 3.5509808443498487`*^9}, {3.550980885851282*^9, 
   3.550980903723771*^9}, {3.550980979560192*^9, 3.550980988935714*^9}, {
   3.5509811990189333`*^9, 3.5509813048916817`*^9}, {3.5509813414530993`*^9, 
   3.5509813536402483`*^9}, {3.55098138420782*^9, 3.550981468763171*^9}, {
   3.55098151437551*^9, 3.55098154386795*^9}, {3.550981586337994*^9, 
   3.550981593225133*^9}, {3.550981651182129*^9, 3.550981708989338*^9}, {
   3.550981789664043*^9, 3.550981803417076*^9}, {3.55098191754713*^9, 
   3.5509819741674337`*^9}, {3.550982030960915*^9, 3.550982130915819*^9}, {
   3.550982634490856*^9, 3.5509828287847853`*^9}, {3.550983211702113*^9, 
   3.550983214033024*^9}, {3.5509833207767057`*^9, 3.550983347814192*^9}, {
   3.550983403587481*^9, 3.5509834200346203`*^9}},ExpressionUUID->
  "6f36d584-9db4-4124-856f-7814d8df2552"],
 "= ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox["k", "abc"], "+", 
   SubscriptBox["j", "d2"]}]],
  CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQnWC/1O9ryStHiZ6TYPqq8OIgEP3NsDsWRG+x3Z0E
opU0v6eA1b0tzAPRcR/n5oNoqdkPOkH0ig6Z6SD6VP262SD6VY3JXBBdtoxt
IYh+lj1jNYjWY/HZCKLtj/3eAqJvXvDaBaK9TNR3g2iGK6mHwOatmH8SRF+3
33oZRG+IyL0KosWbNj4G0fOij74C0Rf33/sIolP8Yv+B3bfV3/YbyP0yM0NB
9LbyslYQ3cF3EEwfuyUxGUTf4a2aBqKXnimaC6LnSDfOB9GWPZs2gugsYflN
IDqCqSbtB4juWZAOogFoUbJ3
   "],ExpressionUUID->"eac68931-8b2e-4745-a043-750a50c06bab"],
 ".  Each way of distributing a fixed number of mutations on the branches \
into intervals is given by a product of multinomial distributions (one per \
interval). The total probability of a specific mutational configuration \
(defined in terms of branches) is a sum over all such possibilities. "
}], "Text",
 CellChangeTimes->{{3.550983607547283*^9, 3.550983624667441*^9}, {
   3.550984529060692*^9, 3.550984533012368*^9}, {3.550985994927849*^9, 
   3.550986027195447*^9}, {3.550986083397896*^9, 3.55098623490609*^9}, {
   3.5509862922831*^9, 3.55098655023265*^9}, {3.550986585655089*^9, 
   3.5509866299654713`*^9}, {3.550986669715303*^9, 3.5509868263925743`*^9}, {
   3.550986886666335*^9, 3.5509870055909443`*^9}, {3.550987082273451*^9, 
   3.550987184116617*^9}, {3.550987220810915*^9, 3.55098740035198*^9}, {
   3.550987458670753*^9, 3.550987525166636*^9}, {3.550987797216383*^9, 
   3.5509878260993567`*^9}, {3.55098786466153*^9, 3.550987931529977*^9}, {
   3.550988163666479*^9, 3.5509881799503937`*^9}, {3.550992466399535*^9, 
   3.550992504462594*^9}, {3.550992807940981*^9, 3.550992820832363*^9}, {
   3.5509931137891273`*^9, 3.550993118693103*^9}, {3.550993276403817*^9, 
   3.550993336100412*^9}, {3.550993367811688*^9, 3.550993387670401*^9}, {
   3.551431560208293*^9, 3.551431567605373*^9}, 
   3.6530328612060328`*^9},ExpressionUUID->"19dc37ce-18c8-46d6-9192-\
9e6df9a19a9e"],

Cell[TextData[{
 "In principle, this logic extends to arbitrary samples and topologies. \
However, there are two reasons why this does not seem promising. Firstly, we \
are assuming a ranked/ordered topology. In order to find probabilities for an \
unranked topology, we would need to sum over all orderings of internal nodes. \
Secondly, one can show that converting mutational configurations defined in \
terms of intervals into branches is wasteful compared to directly tabulating \
mutational configurations defined in terms of branches: Suppose that we \
wanted to find all configurations involving up to ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", "m"], TraditionalForm]],ExpressionUUID->
  "4d396cc5-7560-48dc-b824-2b6fbe4594c1"],
 " on each branch, we would need to allow for up to ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", "m"], TraditionalForm]],ExpressionUUID->
  "89999926-57eb-41d7-b887-6776cf3cf083"],
 "n mutations during the first coalescence interval, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["k", "m"], "(", 
    RowBox[{"n", "-", "1"}], ")"}], TraditionalForm]],ExpressionUUID->
  "10338785-7782-43d6-bf86-b8931fb0939b"],
 " during the second, and so on. Including configurations with no mutations, \
there are a total of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"n", "!"}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["k", "m"], "+", "1"}], ")"}], 
     RowBox[{"(", 
      RowBox[{"n", "+", "1"}], ")"}]]}], TraditionalForm]],ExpressionUUID->
  "2f5a32c4-1110-41ab-8022-8eee82e09c96"],
 " mutational configurations. If we compare this to the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["k", "m"], "+", "1"}], ")"}], 
    RowBox[{"2", 
     RowBox[{"(", 
      RowBox[{"n", "-", "1"}], ")"}]}]], TraditionalForm]],ExpressionUUID->
  "fef44607-85ee-44b3-b272-9fda4edcf3a9"],
 " configurations defined directly in terms of branches, it is clear that \
computing mutational configurations via internode intervals only gives a \
substantial saving for rather large ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", "m"], TraditionalForm]],ExpressionUUID->
  "d3a54b7c-9946-4d36-824f-ad97df1d933a"],
 " which are unrealistic in practice."
}], "Text",
 CellChangeTimes->{{3.6531323030739603`*^9, 
  3.653132509192973*^9}},ExpressionUUID->"665d8535-407f-446d-8f16-\
682e466b9470"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bra", "=", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"km", "+", "1"}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "n"}], "-", "2"}], ")"}]]}], ";", 
  RowBox[{"int", "=", 
   RowBox[{
    RowBox[{"n", "!"}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"km", "+", "1"}], ")"}], 
     RowBox[{"(", 
      RowBox[{"n", "-", "1"}], ")"}]]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6223612600815687`*^9, 3.622361293469915*^9}, {
  3.6223613831954*^9, 3.622361398296294*^9}, {3.622361456454176*^9, 
  3.6223614609334717`*^9}, {3.622361535364461*^9, 
  3.622361549142776*^9}},ExpressionUUID->"a90f1c07-bc7e-4db0-ac73-\
0ebf7a329f64"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"Drop", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"n", ",", 
           RowBox[{"(", 
            RowBox[{"int", "/", "bra"}], ")"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "3", ",", "10"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"km", ",", "3", ",", "6"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"-", "2"}], "}"}]}], "]"}], ",", " ", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<n\>\"", ",", "\"\<interval/branches\>\""}], "}"}]}], ",", 
   RowBox[{"PlotMarkers", "->", 
    RowBox[{"{", 
     RowBox[{"Automatic", ",", "Large"}], "}"}]}], ",", " ", 
   RowBox[{"Joined", "->", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.622361552513927*^9, 3.622361620903439*^9}, {
  3.6223617488081703`*^9, 3.622361759596301*^9}, {3.622361794995818*^9, 
  3.6223618003836327`*^9}, {3.622361833632271*^9, 3.622361943919969*^9}, {
  3.622362001312841*^9, 3.622362033448749*^9}, {3.622362063803232*^9, 
  3.622362147659061*^9}, {3.622362383143878*^9, 3.622362412620995*^9}, {
  3.622362496663742*^9, 3.622362505911826*^9}, {3.622362703184539*^9, 
  3.622362713962304*^9}},ExpressionUUID->"eb243e28-cc4e-494f-82fe-\
c61c91a91a5e"],

Cell[BoxData[
 GraphicsBox[{{}, {{{}, {}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6], 
      LineBox[{{3., 0.375}, {4., 0.375}, {5., 0.46875}, {6., 0.703125}, {7., 
       1.23046875}, {8., 2.4609375}, {8.169305584008884, 
       2.9817505758085794`}}]}, 
     {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6], 
      LineBox[{{3., 0.24}, {4., 0.192}, {5., 0.192}, {6., 0.2304}, {7., 
       0.32256}, {8., 0.516096}, {9., 0.9289728}, {10., 1.8579456}}]}, 
     {RGBColor[0.560181, 0.691569, 0.194885], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6], 
      LineBox[{{3., 0.12244897959183673`}, {4., 0.06997084548104957}, {5., 
       0.04997917534360683}, {6., 0.042839293151662995`}, {7., 
       0.042839293151662995`}, {8., 0.04895919217332914}, {9., 
       0.06294753279428032}, {10., 0.08992504684897189}}]}}, {
     {RGBColor[0.368417, 0.506779, 0.709798], AbsolutePointSize[6], 
      AbsoluteThickness[1.6], GeometricTransformationBox[InsetBox[
        StyleBox["\<\"\[FilledCircle]\"\>",
         StripOnInput->False,
         FontSize->Large], {0., 0.}], {{{3., 0.375}}, {{4., 0.375}}, {{5., 
       0.46875}}, {{6., 0.703125}}, {{7., 1.23046875}}, {{8., 2.4609375}}, {{
       8.169305584008884, 2.9817505758085794`}}}]}, 
     {RGBColor[0.880722, 0.611041, 0.142051], AbsolutePointSize[6], 
      AbsoluteThickness[1.6], GeometricTransformationBox[InsetBox[
        StyleBox["\<\"\[FilledSquare]\"\>",
         StripOnInput->False,
         FontSize->Large], {0., 0.}], {{{3., 0.24}}, {{4., 0.192}}, {{5., 
       0.192}}, {{6., 0.2304}}, {{7., 0.32256}}, {{8., 0.516096}}, {{9., 
       0.9289728}}, {{10., 1.8579456}}}]}, 
     {RGBColor[0.560181, 0.691569, 0.194885], AbsolutePointSize[6], 
      AbsoluteThickness[1.6], GeometricTransformationBox[InsetBox[
        StyleBox["\<\"\[FilledDiamond]\"\>",
         StripOnInput->False,
         FontSize->Large], {0., 0.}], {{{3., 0.12244897959183673`}}, {{4., 
       0.06997084548104957}}, {{5., 0.04997917534360683}}, {{6., 
       0.042839293151662995`}}, {{7., 0.042839293151662995`}}, {{8., 
       0.04895919217332914}}, {{9., 0.06294753279428032}}, {{10., 
       0.08992504684897189}}}]}, {}}}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox["\"n\"", TraditionalForm], 
    FormBox["\"interval/branches\"", TraditionalForm]},
  AxesOrigin->{2.890625, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->{406., Automatic},
  Method->{},
  PlotRange->{{3., 10.}, {0, 2.9817505758085794`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.6223615842167397`*^9, 3.622361621343503*^9, 3.622361760396117*^9, 
   3.622361849048726*^9, {3.622361911653021*^9, 3.622361945131153*^9}, 
   3.6223620342364798`*^9, {3.6223620747858562`*^9, 3.6223621489542847`*^9}, {
   3.62236239191851*^9, 3.622362413816524*^9}, 3.622362506887327*^9, {
   3.622362704555518*^9, 3.6223627149851933`*^9}, 
   3.653133009200509*^9},ExpressionUUID->"7ba37ba4-dba1-4065-8d90-\
9dc5c56166d7"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Timing for probK", "Subsubsection",
 CellChangeTimes->{{3.649242519593422*^9, 
  3.649242524146039*^9}},ExpressionUUID->"a0a8df80-dc21-443b-9629-\
6f14e9336732"],

Cell[TextData[{
 "In this example, calculating numerical values using a series expansion is \
much faster than direct differentiation with probK.  However, direct \
differentiation is ",
 StyleBox["slower",
  FontSlant->"Italic"],
 " for algebraic values.  "
}], "Text",
 CellChangeTimes->{{3.649242527526486*^9, 
  3.6492426018332787`*^9}},ExpressionUUID->"adf2e1e4-68db-41e8-a40a-\
5fd1a7f0caf4"],

Cell[TextData[{
 StyleBox["Note: ",
  FontWeight->"Bold"],
 "The example gf, sl, is calculated in the first single-deme example below "
}], "Text",
 CellChangeTimes->{{3.649305495271203*^9, 
  3.649305528091773*^9}},ExpressionUUID->"b3fd2e72-aabb-48f0-93b6-\
4d02554ce06c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sl", "\[LeftDoubleBracket]", "1", 
  "\[RightDoubleBracket]"}]], "Input",
 CellChangeTimes->{{3.649240137549481*^9, 
  3.649240143707954*^9}},ExpressionUUID->"cdef0339-1314-402a-ba2c-\
1d8cfa56e817"],

Cell[BoxData[
 RowBox[{"1", "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"6", "+", 
      RowBox[{"\[Omega]", "[", 
       RowBox[{"{", "a", "}"}], "]"}], "+", 
      RowBox[{"\[Omega]", "[", 
       RowBox[{"{", "b", "}"}], "]"}], "+", 
      RowBox[{"\[Omega]", "[", 
       RowBox[{"{", "c", "}"}], "]"}], "+", 
      RowBox[{"\[Omega]", "[", 
       RowBox[{"{", "d", "}"}], "]"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"3", "+", 
      RowBox[{"\[Omega]", "[", 
       RowBox[{"{", "a", "}"}], "]"}], "+", 
      RowBox[{"\[Omega]", "[", 
       RowBox[{"{", "b", "}"}], "]"}], "+", 
      RowBox[{"\[Omega]", "[", 
       RowBox[{"{", 
        RowBox[{"c", ",", "d"}], "}"}], "]"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"\[Omega]", "[", 
       RowBox[{"{", "a", "}"}], "]"}], "+", 
      RowBox[{"\[Omega]", "[", 
       RowBox[{"{", 
        RowBox[{"b", ",", "c", ",", "d"}], "}"}], "]"}]}], ")"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{
  3.6492401443400393`*^9},ExpressionUUID->"6272fd32-a093-4b61-868a-\
daa918b5b8a7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"tbl", "=", 
    RowBox[{"Array", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"probK", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"MapThread", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"#2", "\[Equal]", 
                 RowBox[{"#3", "+", "1"}]}], ",", "Null", ",", 
                RowBox[{"{", 
                 RowBox[{"#1", ",", "#2"}], "}"}]}], "]"}], "&"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"configs", ",", 
               RowBox[{"{", "##", "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "3", ",", "3", ",", "3", ",", "3", ",", "3", ",", "3"}], 
                "}"}]}], "}"}]}], "]"}], ",", "Null"}], "]"}], ",", 
         RowBox[{"sl", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          ",", "\[Omega]", ",", "0.2"}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5"}], "}"}],
       ",", "0"}], "]"}]}], ";"}], "]"}]], "Input",
 CellChangeTimes->{{3.649240191976247*^9, 3.649240247663558*^9}, {
  3.6492408947801657`*^9, 3.64924089518085*^9}, {3.649241020613311*^9, 
  3.649241057112928*^9}},ExpressionUUID->"15e72907-ef98-4388-bb44-\
52b0527417ef"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "3.61533000000000015461409930139780044556`6.578747858240182", ",", "Null"}],
   "}"}]], "Output",
 CellChangeTimes->{{3.649240234251664*^9, 3.64924024869447*^9}, 
   3.649240896967073*^9, 3.649241031096122*^9, 
   3.649241062567011*^9},ExpressionUUID->"bfcad04c-5177-4b90-a5e2-\
af8cabcf5c41"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"cl", "=", 
    RowBox[{
     RowBox[{"Array", "[", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", "0.1", ")"}], 
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{"{", "##", "}"}], "]"}], "-", "1"}]], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "4", ",", "4", ",", "4", ",", "4", ",", "4"}], 
        "}"}], ",", "0"}], "]"}], 
     RowBox[{"CoefficientList", "[", 
      RowBox[{
       RowBox[{"Series", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
          "sl", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Omega]", "[", "x_List", "]"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"0.1", "-", 
              RowBox[{"\[Delta]", "[", "x", "]"}]}], ")"}]}], "}"}]}], ",", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\[Delta]", "[", "#", "]"}], ",", "0", ",", "3"}], 
              "}"}], "&"}], "/@", "configs"}], ")"}]}]}], "]"}], ",", 
       RowBox[{"\[Delta]", "/@", "configs"}]}], "]"}]}]}], ";"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.649240253112721*^9, 3.6492404218569393`*^9}, {
   3.649240688033681*^9, 3.649240700933341*^9}, 3.6492407489598103`*^9, {
   3.649240862571354*^9, 3.649240904623439*^9}, {3.6492410248961277`*^9, 
   3.6492410280274057`*^9}, {3.649241080174904*^9, 
   3.649241151417899*^9}},ExpressionUUID->"aa987f8f-0e12-4471-ac5c-\
7bf3018a7d39"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.44946900000000000741096073397784493864`5.673299656972439", ",", "Null"}],
   "}"}]], "Output",
 CellChangeTimes->{
  3.649241028736421*^9, {3.6492411236901817`*^9, 
   3.649241152907168*^9}},ExpressionUUID->"47698cd0-04f7-4207-9aec-\
618638d00611"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"tbl", "=", 
    RowBox[{"Array", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"probK", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"MapThread", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"#2", "\[Equal]", 
                 RowBox[{"#3", "+", "1"}]}], ",", "Null", ",", 
                RowBox[{"{", 
                 RowBox[{"#1", ",", "#2"}], "}"}]}], "]"}], "&"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"configs", ",", 
               RowBox[{"{", "##", "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "3", ",", "3", ",", "3", ",", "3", ",", "3", ",", "3"}], 
                "}"}]}], "}"}]}], "]"}], ",", "Null"}], "]"}], ",", 
         RowBox[{"sl", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          ",", "\[Omega]", ",", "\[Theta]"}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5"}], "}"}],
       ",", "0"}], "]"}]}], ";"}], "]"}]], "Input",
 CellChangeTimes->{{3.649240191976247*^9, 3.649240247663558*^9}, {
  3.6492408947801657`*^9, 3.64924089518085*^9}, {3.649241020613311*^9, 
  3.649241057112928*^9}, {3.6492411850907516`*^9, 
  3.649241185612295*^9}},ExpressionUUID->"c89e43cf-68b4-4de3-8e40-\
d3c3251d3446"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "4.95011199999999984555643095518462359905`6.715214938563031", ",", "Null"}],
   "}"}]], "Output",
 CellChangeTimes->{{3.649240234251664*^9, 3.64924024869447*^9}, 
   3.649240896967073*^9, 3.649241031096122*^9, 3.649241062567011*^9, 
   3.649241191703661*^9},ExpressionUUID->"5d7e1c76-d4df-485f-bf7f-\
d96eaa58144c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"cl", "=", 
    RowBox[{
     RowBox[{"Array", "[", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"\[Theta]", "/", "2"}], ")"}], 
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{"{", "##", "}"}], "]"}], "-", "1"}]], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "4", ",", "4", ",", "4", ",", "4", ",", "4"}], 
        "}"}], ",", "0"}], "]"}], 
     RowBox[{"CoefficientList", "[", 
      RowBox[{
       RowBox[{"Series", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
          "sl", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Omega]", "[", "x_List", "]"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{
              FractionBox["\[Theta]", "2"], "-", 
              RowBox[{"\[Delta]", "[", "x", "]"}]}], ")"}]}], "}"}]}], ",", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\[Delta]", "[", "#", "]"}], ",", "0", ",", "3"}], 
              "}"}], "&"}], "/@", "configs"}], ")"}]}]}], "]"}], ",", 
       RowBox[{"\[Delta]", "/@", "configs"}]}], "]"}]}]}], ";"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.649240253112721*^9, 3.6492404218569393`*^9}, {
   3.649240688033681*^9, 3.649240700933341*^9}, 3.6492407489598103`*^9, {
   3.649240862571354*^9, 3.649240904623439*^9}, {3.6492410248961277`*^9, 
   3.6492410280274057`*^9}, {3.649241080174904*^9, 3.649241151417899*^9}, {
   3.649241190596212*^9, 
   3.649241195419508*^9}},ExpressionUUID->"4e68d238-6457-4f2e-a3f4-\
d16c0cff5f7c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "11.75333400000000061424998420989140868187`7.090760991157098", ",", 
   "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.649241028736421*^9, {3.6492411236901817`*^9, 3.649241152907168*^9}, 
   3.6492412084248343`*^9},ExpressionUUID->"8dac5d31-1ac3-4d04-85f5-\
23e0b64fcdf2"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Beyond infinite-sites: the Jukes-Cantor model", "Subsubsection",
 CellChangeTimes->{{3.64861825717293*^9, 3.6486182607886333`*^9}, {
   3.648620732971575*^9, 3.648620755050089*^9}, 3.649128923922728*^9, 
   3.649226333827487*^9},ExpressionUUID->"9a29e350-f1c8-4b01-9ef8-\
c95f58f7b076"],

Cell["\<\
The notebook assumes infinite-sites mutation.  With deep coalescence events \
and high mutation rates, back-mutation needs to be considered. Probabilities \
can still be derived from the GF, but the number of mutational configurations \
becomes very large, unless some further simplification is made.\
\>", "Text",
 CellChangeTimes->{{3.6486182689564247`*^9, 3.648618342598068*^9}, {
   3.648619587048483*^9, 3.648619631268684*^9}, {3.648619661898074*^9, 
   3.648619747555073*^9}, 
   3.651907647829417*^9},ExpressionUUID->"3b8b278b-7755-4aaa-b45a-\
62c2b1b274ce"],

Cell[TextData[{
 "The probability of seeing ",
 Cell[BoxData[
  FormBox["j", TraditionalForm]],ExpressionUUID->
  "39a25c0f-6636-4eb8-9596-a1fdc91b328d"],
 " differences with ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "82b9eff0-4ada-4cb0-a7a8-2147f16f2697"],
 " sites is (Eq. 2 of Lohse et al. 2011): "
}], "Text",
 CellChangeTimes->{{3.6486182689564247`*^9, 3.648618342598068*^9}, {
  3.648619587048483*^9, 3.648619631268684*^9}, {3.648619661898074*^9, 
  3.648619685880252*^9}},ExpressionUUID->"e0216508-7db9-4228-8fd8-\
d8ec90c13490"],

Cell[BoxData[
 RowBox[{
  RowBox[{"P", "[", "j", "]"}], "=", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["3", "4"], ")"}], "n"], 
    RowBox[{"(", GridBox[{
       {"n"},
       {"j"}
      }], ")"}], 
    RowBox[{
     SubsuperscriptBox["\[Sum]", 
      RowBox[{"k", "=", "0"}], "j"], 
     RowBox[{
      SubsuperscriptBox["\[Sum]", 
       RowBox[{"a", "=", "k"}], 
       RowBox[{"n", "-", "j", "+", "k"}]], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "k"], 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox["1", "3"], ")"}], 
        RowBox[{"n", "-", "j", "-", "a", "+", "k"}]], 
       RowBox[{"(", GridBox[{
          {"j"},
          {"k"}
         }], ")"}], 
       RowBox[{"(", GridBox[{
          {
           RowBox[{"n", "-", "j"}]},
          {
           RowBox[{"a", "-", "k"}]}
         }], ")"}], 
       RowBox[{"\[Psi]", "[", 
        RowBox[{"\[Mu]", "\[VeryThinSpace]", "a"}], "]"}]}]}]}]}], "=", " ", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["3", "4"], ")"}], "n"], 
    RowBox[{"(", GridBox[{
       {"n"},
       {"j"}
      }], ")"}], 
    RowBox[{
     SubsuperscriptBox["\[Sum]", 
      RowBox[{"a", "=", "0"}], "n"], 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "9"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"a", "+", "j", "-", "n"}], ")"}]], 
      RowBox[{"(", GridBox[{
         {"j"},
         {
          RowBox[{"n", "-", "a", "-", "j"}]}
        }], ")"}], 
      RowBox[{"(", GridBox[{
         {
          RowBox[{
           RowBox[{"2", "a"}], "+", "j", "-", "n"}]},
         {
          RowBox[{"n", "-", "j"}]}
        }], ")"}], 
      RowBox[{"\[Psi]", "[", 
       RowBox[{"\[Mu]", "\[VeryThinSpace]", "a"}], 
       "]"}]}]}]}]}]}]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.648618330496389*^9, 3.648618484459811*^9}, {
  3.648618528946761*^9, 
  3.648618619436891*^9}},ExpressionUUID->"b21699b6-cab9-4c03-a204-\
437386eea53f"],

Cell["\<\
This calculation would be much faster than the infinite-sites version, since \
it involves a sum, rather than derivatives.  However, it would not be easy to \
calculate the full probability with multiple branches, since one would need \
to allow for multiple states - for example, the probability of seeing four \
different states on four leaves. It is not obvious whether mutational \
configurations could be simplified enough to allow them to be counted.\
\>", "Text",
 CellChangeTimes->{{3.648618654949235*^9, 3.648618764131982*^9}, {
   3.648618826406287*^9, 3.6486189463172407`*^9}, {3.648618994649066*^9, 
   3.648619106783971*^9}, {3.648619752370363*^9, 3.648619756114526*^9}, {
   3.64862020431209*^9, 3.648620206759297*^9}, 
   3.651907657853465*^9},ExpressionUUID->"8e219450-8f71-4bda-ab14-\
7ed9b3d0d633"]
}, Closed]],

Cell[CellGroupData[{

Cell["MakePT1", "Subsubsection",
 CellChangeTimes->{
  3.6493043394933167`*^9},ExpressionUUID->"f85ff6dd-9855-4db2-84ee-\
41830937466c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakePT1", "::", "usage"}], "=", 
   "\"\<MakePT1[GF,\[Omega],\[Theta],{{a},{b}},{\!\(\*SubscriptBox[\(k\), \
\(m, a\)]\),\!\(\*SubscriptBox[\(k\), \(m, b\)]\)}] uses a series expansion \
to make a table of mutation numbers {0,\!\(\*SubscriptBox[\(\[Ellipsis]k\), \
\(m\)]\)} for each listed branch. MakePT1[GF,\[Omega],\[Theta],{{a},\
\[Ellipsis]},{{a},{b},\[Ellipsis]},{\!\(\*SubscriptBox[\(k\), \(m, \
a\)]\),\!\(\*SubscriptBox[\(k\), \(m, b\)]\)}] makes a sub-table that sums \
over the branches in the first list, by setting those \[Omega] to 0.  This \
sub-table is embedded in the larger table with dimension \
{0\!\(\*SubscriptBox[\(\[Ellipsis]k\), \(m, a\)]\)+1,0\!\(\*SubscriptBox[\(\
\[Ellipsis]k\), \(m, b\)]\)+1,}, where the last element represents the \
residual probability. \>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.649304343160091*^9, 3.6493044562698507`*^9}, {
   3.649304640093506*^9, 3.649304759548972*^9}, 
   3.649304795000257*^9},ExpressionUUID->"934d12da-fbf8-4b84-880c-\
2bc329e1e974"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakePT1", "[", 
    RowBox[{
    "gf_", ",", "\[Omega]_", ",", "\[Theta]_", ",", "sl_List", ",", 
     "km_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[Delta]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Array", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"\[Theta]", "/", "2"}], ")"}], 
          RowBox[{"Total", "[", 
           RowBox[{"{", "##", "}"}], "]"}]], "&"}], ",", 
        RowBox[{"km", "+", "1"}], ",", "0"}], "]"}], 
      RowBox[{"PadRight", "[", 
       RowBox[{
        RowBox[{"CoefficientList", "[", 
         RowBox[{
          RowBox[{"Series", "[", 
           RowBox[{
            RowBox[{"gf", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\[Omega]", "[", "x_List", "]"}], "\[RuleDelayed]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"\[Theta]", "/", "2"}], ")"}], "-", 
                 RowBox[{"\[Delta]", "[", "x", "]"}]}], ")"}]}], "}"}]}], ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"MapThread", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Delta]", "[", "#1", "]"}], ",", "0", ",", "#2"}],
                  "}"}], "&"}], ",", 
               RowBox[{"{", 
                RowBox[{"sl", ",", "km"}], "}"}]}], "]"}]}]}], "]"}], ",", 
          RowBox[{"\[Delta]", "/@", "sl"}]}], "]"}], ",", 
        RowBox[{"km", "+", "1"}]}], "]"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.649245557205155*^9, 3.649245570313909*^9}, {
   3.649245722662271*^9, 3.6492458007946253`*^9}, {3.649245939039455*^9, 
   3.649246021247053*^9}, {3.6492460758950863`*^9, 3.649246103288458*^9}, {
   3.649246299194265*^9, 3.649246305522414*^9}, {3.649246357060514*^9, 
   3.6492463579434853`*^9}, {3.649246914269793*^9, 3.649246914412924*^9}, 
   3.649300655660739*^9, 
   3.6493025282487183`*^9},ExpressionUUID->"7c1c533f-dc4f-47fd-b4ac-\
22eb8b70a146"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakePT1", "[", 
    RowBox[{
    "gf_", ",", "\[Omega]_", ",", "\[Theta]_", ",", "zl_List", ",", "fl_List",
      ",", "km_List"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ss", "=", 
        RowBox[{"TakeAway", "[", 
         RowBox[{"fl", ",", "zl"}], "]"}]}], ",", 
       RowBox[{"rls", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Omega]", "[", "#", "]"}], "\[RuleDelayed]", "0"}], 
           ")"}], "&"}], "/@", "zl"}]}], ",", "pos"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"pos", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"fl", ",", "#"}], "]"}], "&"}], "/@", "ss"}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"EmbedTable", "[", 
       RowBox[{
        RowBox[{"MakePT1", "[", 
         RowBox[{
          RowBox[{"gf", "/.", "rls"}], ",", "\[Omega]", ",", "\[Theta]", ",", 
          "ss", ",", 
          RowBox[{
          "km", "\[LeftDoubleBracket]", "pos", "\[RightDoubleBracket]"}]}], 
         "]"}], ",", "pos", ",", 
        RowBox[{"km", "+", "2"}], ",", 
        RowBox[{"km", "+", "2"}]}], "]"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.649246162734664*^9, 3.64924626740001*^9}, 
   3.649246764397257*^9, {3.649247150439991*^9, 3.649247151058002*^9}, {
   3.649300694001318*^9, 3.649300855188396*^9}, {3.649300887561898*^9, 
   3.649300916928362*^9}, 3.6493009832417173`*^9, {3.649301381940215*^9, 
   3.6493013867190313`*^9}, {3.649302535232532*^9, 3.64930254102322*^9}, {
   3.6493060724964037`*^9, 
   3.649306072563548*^9}},ExpressionUUID->"498aaa8d-74d7-48d4-968c-\
e87859e2475b"]
}, Closed]],

Cell[CellGroupData[{

Cell["MakePT", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{3.6493043394933167`*^9, 
  3.649304465012147*^9},ExpressionUUID->"e4d137ab-56a7-4316-b1b8-\
724365a90720"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakePT", "::", "usage"}], "=", 
   "\"\<MakePT[GF,\[Omega],\[Theta],{{a},{b},\[Ellipsis]},{\!\(\*SubscriptBox[\
\(k\), \(m, a\)]\),\!\(\*SubscriptBox[\(k\), \(m, b\)]\)}] uses a series \
expansion to make a table of mutation numbers {0,\!\(\*SubscriptBox[\(\
\[Ellipsis]k\), \(m\)]\)} for each listed branch, and adds the residual \
probability to the last element in each row. Thus, each row runs from 0,\
\[Ellipsis],\!\(\*SubscriptBox[\(k\), \(m\)]\)+1. Uses adjustTable to set the \
last element to the residual probability. Note: This appears no faster than \
direct differentiation, imlemented as the default in MakeProbTable.\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.649304343160091*^9, 3.6493046368934603`*^9}, {
  3.649304766336707*^9, 3.649304785123111*^9}, {3.64930728815874*^9, 
  3.649307319850832*^9}, {3.649307426074091*^9, 
  3.6493074433433847`*^9}},ExpressionUUID->"bcf86b9c-25a2-450a-9dbe-\
6bc0d0fef1d3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MakePT", "[", 
    RowBox[{
    "gf_", ",", "\[Omega]_", ",", "\[Theta]_", ",", "fl_List", ",", 
     "km_Integer"}], "]"}], ":=", 
   RowBox[{"MakePT", "[", 
    RowBox[{"gf", ",", "\[Omega]", ",", "\[Theta]", ",", "fl", ",", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"km", ",", 
       RowBox[{"Length", "[", "fl", "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakePT", "[", 
    RowBox[{
    "gf_", ",", "\[Omega]_", ",", "\[Theta]_", ",", "fl_List", ",", 
     "km_List"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"mt", ",", 
       RowBox[{"nc", "=", 
        RowBox[{"Length", "[", "fl", "]"}]}], ",", "tot", ",", 
       RowBox[{"rls", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Omega]", "[", "#", "]"}], "\[RuleDelayed]", "0"}], 
           ")"}], "&"}], "/@", "fl"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tot", "=", 
       RowBox[{"gf", "/.", "rls"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"mt", "=", 
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"MakePT1", "[", 
           RowBox[{
           "gf", ",", "\[Omega]", ",", "\[Theta]", ",", "#", ",", "fl", ",", 
            "km"}], "]"}], "&"}], "/@", 
         RowBox[{"Subsets", "[", 
          RowBox[{"fl", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"nc", "-", "1"}]}], "}"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"adjustTable", "[", 
       RowBox[{
        RowBox[{"ReplacePart", "[", 
         RowBox[{"mt", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"km", "+", "2"}], ")"}], "\[Rule]", "tot"}]}], "]"}], ",",
         "nc"}], "]"}]}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.649302470356821*^9, 3.649302511108407*^9}, {
  3.64930257103445*^9, 3.649302706764896*^9}, {3.649302737588236*^9, 
  3.649302789494708*^9}, {3.6493050446793833`*^9, 
  3.649305081271824*^9}},ExpressionUUID->"eba6b25b-28eb-43bf-8712-\
7cec3a733716"],

Cell["\<\
To implement an efficient method:
\t- For a given set of \[Omega], a subset will be zero, and the remainder \
will be used to make a series expansion
\t- This set is embedded into a SparseArray with the full dimension
\t- The full table is built up accordingly\
\>", "Text",
 CellChangeTimes->{{3.649244846103862*^9, 3.649244976372389*^9}, 
   3.6492451120309067`*^9, 
   3.64930488275212*^9},ExpressionUUID->"94e069c0-dc6a-4292-8655-\
861bab784f71"],

Cell[TextData[{
 "To be flexible, I need to define an arbitrary list of branches that are \
distinguished, and that are the \[Omega] in the ",
 StyleBox["full ",
  FontSlant->"Italic"],
 "GF.  The list of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", "m"], TraditionalForm]],ExpressionUUID->
  "77380899-0087-44ef-b334-768d8e1cc414"],
 " must correspond to this list.  Any particular GF depends on a subset of \
these branches.  On this subset, I define sets of zeros; the remainder are \
used to make a full coefficient list.  This has to be slotted into the \
correct position in the full table.  However, because adjustTable is needed, \
it is best to first build the subtable, and then the full table. "
}], "Text",
 CellChangeTimes->{{3.649245116806553*^9, 3.6492452077606487`*^9}, {
   3.6492452794804792`*^9, 3.649245386225833*^9}, 
   3.651907667557967*^9},ExpressionUUID->"02a6a7e4-7682-4e6a-9cce-\
5e3900c61a1f"],

Cell[TextData[{
 StyleBox["Note: ",
  FontWeight->"Bold"],
 "The next section shows that this method does not seem any faster than \
direct differentiation, "
}], "Text",
 CellChangeTimes->{{3.6493074667413054`*^9, 
  3.649307496433075*^9}},ExpressionUUID->"5f0fef75-f46b-45d8-832f-\
6f44a54d2430"]
}, Closed]],

Cell[CellGroupData[{

Cell["EmbedTable", "Subsubsection",
 CellChangeTimes->{{3.649212375686616*^9, 3.6492123828197927`*^9}, {
  3.649299496831627*^9, 
  3.649299499336636*^9}},ExpressionUUID->"44a76455-4240-461e-80ca-\
7f4904df1d10"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EmbedTable", "::", "usage"}], "=", 
   "\"\<EmbedTable[{{\[Ellipsis]},\[Ellipsis]},{\!\(\*SubscriptBox[\(i\), \(1\
\)]\),\[Ellipsis]},{\!\(\*SubscriptBox[\(j\), \
\(1\)]\),\[Ellipsis]},{\!\(\*SubscriptBox[\(d\), \(1\)]\),\[Ellipsis]}] \
embeds the given table in a larger SparseArray with dimensions \
{\!\(\*SubscriptBox[\(d\), \(1\)]\),\[Ellipsis]}. {\!\(\*SubscriptBox[\(i\), \
\(1\)]\),\[Ellipsis]} lists the positions of the table dimensions in the \
larger SparseArray, and {\!\(\*SubscriptBox[\(j\), \(1\)]\),\[Ellipsis]} \
lists the positions of the remaining dimensions.  For convenience, j has the \
same length as d, but the dimensions replaced by the embedded table are \
disregarded. \
EmbedTable[{{\[Ellipsis]},\[Ellipsis]},{\!\(\*SubscriptBox[\(i\), \(1\)]\),\
\[Ellipsis]},1,{\!\(\*SubscriptBox[\(d\), \(1\)]\),\[Ellipsis]}] uses the \
default position 1 for all dimensions.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6492123867628527`*^9, 3.649212409727695*^9}, {
  3.649212477061368*^9, 3.6492125911224947`*^9}, {3.64921267814808*^9, 
  3.649212683715139*^9}, {3.6492127912423153`*^9, 3.6492128441767*^9}, {
  3.6492154884641647`*^9, 3.649215543613553*^9}, {3.649295368263571*^9, 
  3.6492954340982113`*^9}, {3.649295666028533*^9, 3.649295898093977*^9}, {
  3.649295965720372*^9, 3.649295969159875*^9}, {3.6492995121160593`*^9, 
  3.6492995283662252`*^9}},ExpressionUUID->"1dd34a72-a578-4a67-8253-\
de54b89553ee"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"EmbedTable", "[", 
    RowBox[{"tbl_List", ",", 
     RowBox[{"i", ":", 
      RowBox[{"{", "___Integer", "}"}]}], ",", "j_Integer", ",", 
     RowBox[{"d", ":", 
      RowBox[{"{", "__Integer", "}"}]}]}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"EmbedTable", "[", 
    RowBox[{"tbl", ",", "i", ",", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"j", ",", 
       RowBox[{"Length", "[", "d", "]"}]}], "]"}], ",", "d"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EmbedTable", "[", 
    RowBox[{"tbl_List", ",", 
     RowBox[{"i", ":", 
      RowBox[{"{", "___Integer", "}"}]}], ",", 
     RowBox[{"j", ":", 
      RowBox[{"{", "___Integer", "}"}]}], ",", 
     RowBox[{"d", ":", 
      RowBox[{"{", "__Integer", "}"}]}]}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xx", ",", "pl"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xx", "=", 
       RowBox[{"IntegerSets", "[", 
        RowBox[{"Dimensions", "[", "tbl", "]"}], "]"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "all", " ", "the", " ", "entries", " ", "that", " ", "will", " ", 
         "be", " ", "tabulated"}], ";", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "\[Ellipsis]"}], "}"}], "\[Ellipsis]", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["d", "1"], ",", 
           SubscriptBox["d", "2"], ",", "\[Ellipsis]"}], "}"}]}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"pl", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ReplacePart", "[", 
           RowBox[{"j", ",", 
            RowBox[{"MapThread", "[", 
             RowBox[{"Rule", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "#"}], "}"}]}], "]"}]}], "]"}], ")"}], "&"}],
         "/@", "xx"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{
       "lists", " ", "all", " ", "the", " ", "assignments", " ", "that", " ", 
        "will", " ", "be", " ", "used", " ", "to", " ", "build", " ", "the", 
        " ", "array"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"SparseArray", "[", 
       RowBox[{
        RowBox[{"pl", "\[Rule]", 
         RowBox[{"Flatten", "[", "tbl", "]"}]}], ",", "d"}], "]"}]}]}], 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "builds", " ", "a", " ", "SparseArray", " ", "with", " ", "higher", " ", 
      "dimension", " ", "d", " ", "than", " ", "the", " ", "original", " ", 
      "table"}], " ", "*)"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.649212392568575*^9, 3.64921239257065*^9}, {
   3.649212638590116*^9, 3.649212771294773*^9}, {3.6492128475608673`*^9, 
   3.649212926442412*^9}, {3.649212967039535*^9, 3.649212982759201*^9}, {
   3.649215762383939*^9, 3.6492157874992027`*^9}, {3.6492158532715893`*^9, 
   3.649215895730167*^9}, {3.649221458513599*^9, 3.649221458807961*^9}, {
   3.649247254364833*^9, 3.649247280230542*^9}, 3.6492474523425703`*^9, {
   3.649247526609167*^9, 3.649247556941296*^9}, {3.649295899388235*^9, 
   3.649295952507518*^9}, {3.649296337029293*^9, 3.649296379163351*^9}, 
   3.649296409234223*^9, 3.6492965072951717`*^9, {3.649296611994483*^9, 
   3.6492966158175993`*^9}, {3.649296937501575*^9, 3.649296963780735*^9}, {
   3.6492971486301823`*^9, 3.649297169072904*^9}, {3.6492972225806837`*^9, 
   3.649297227978567*^9}, {3.6492975455528593`*^9, 3.6492975483476677`*^9}, {
   3.649297677869442*^9, 3.649297683630636*^9}, {3.649299545505512*^9, 
   3.6492995825627613`*^9}},ExpressionUUID->"0554d48e-f830-4a1e-be74-\
79e25d304e0a"],

Cell[TextData[{
 StyleBox["Example: ",
  FontWeight->"Bold"],
 "The 2\[Times]3 table is embedded in a 3\[Times]4\[Times]3 SparseArray, \
using dimensions {1,3}, and inserting into position 2 of the remaining \
dimensions:"
}], "Text",
 CellChangeTimes->{{3.649215959721881*^9, 3.6492159619465227`*^9}, {
   3.649217195060066*^9, 3.649217303570533*^9}, 3.649297730959187*^9, {
   3.649297783803265*^9, 
   3.649297877195767*^9}},ExpressionUUID->"8a99e8d4-61f5-424e-99d9-\
2f04b3c0799b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"EmbedTable", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "b", ",", "bb"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"c", ",", "d", ",", "dd"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "2", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"3", ",", "4", ",", "3"}], "}"}]}], "]"}], "//", 
  "Normal"}]], "Input",
 CellChangeTimes->{{3.649296972956545*^9, 3.649297016152676*^9}, {
   3.649297419214364*^9, 3.649297468408143*^9}, 3.649297560280476*^9, {
   3.6492976492850113`*^9, 3.649297653521824*^9}, {3.649297816956196*^9, 
   3.64929782354628*^9}},ExpressionUUID->"91565fa6-e5d5-427c-8e98-\
52610362e4c8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "bb"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", "d", ",", "dd"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.649297016704064*^9, 3.649297233870961*^9, {3.649297425928911*^9, 
   3.6492974689213057`*^9}, {3.6492975609231777`*^9, 3.6492975693919373`*^9}, 
   3.649297654148027*^9, {3.649297817326782*^9, 
   3.649297824006606*^9}},ExpressionUUID->"a39ed7cf-f04d-49e1-bdda-\
c0526ad854b0"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["IntegerSets", "Subsubsection",
 CellChangeTimes->{{3.649215020154895*^9, 
  3.6492150239392757`*^9}},ExpressionUUID->"b4bf1bda-069d-4676-b1be-\
60d282ad2659"],

Cell[TextData[{
 "This is actually just a flattened ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Array", "[", 
    RowBox[{"List", ",", "k"}], "]"}], TraditionalForm]],ExpressionUUID->
  "1158b3b0-98ba-4ece-9fd3-61b72c177be0"]
}], "Text",
 CellChangeTimes->{{3.649296295392354*^9, 3.649296309780356*^9}, {
   3.649297189160522*^9, 3.649297191121367*^9}, 
   3.6506305238693*^9},ExpressionUUID->"aee69680-0622-4c48-8a15-45b44fb6cc7c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"IntegerSets", "::", "usage"}], "=", 
   "\"\<IntegerSets[{\!\(\*SubscriptBox[\(k\), \
\(1\)]\),\!\(\*SubscriptBox[\(k\), \(2\)]\),\[Ellipsis]}] makes a flat list \
of all combinations of integers {\!\(\*SubscriptBox[\(i\), \
\(1\)]\),\!\(\*SubscriptBox[\(i\), \(2\)]\),\[Ellipsis]} for 1\[LessEqual]i\
\[LessEqual]k.   \>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.649215029875051*^9, 3.649215128524508*^9}, {
  3.6492962872975883`*^9, 3.649296287475922*^9}, {3.649297197388928*^9, 
  3.649297200042532*^9}},ExpressionUUID->"328f8b9a-8545-449f-a1a0-\
1fb247e0647c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"IntegerSets", "[", 
    RowBox[{"k", ":", 
     RowBox[{"{", "__Integer", "}"}]}], "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Array", "[", 
      RowBox[{"List", ",", "k"}], "]"}], ",", 
     RowBox[{
      RowBox[{"Length", "[", "k", "]"}], "-", "1"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.649215138922161*^9, 3.6492151567106543`*^9}, {
  3.649215223391485*^9, 3.649215243691839*^9}, {3.649215314315557*^9, 
  3.649215326342205*^9}, {3.6492962744488297`*^9, 3.6492962825031013`*^9}, {
  3.649297204088854*^9, 
  3.649297210760614*^9}},ExpressionUUID->"d886e4a1-721f-42e8-9adc-\
3284fb236712"]
}, Closed]],

Cell[CellGroupData[{

Cell["MakeProbTableOnce", "Subsubsection",
 CellChangeTimes->{
  3.649167154091372*^9},ExpressionUUID->"e69a2f90-18c0-4b04-8428-\
b5eca8b958d2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeProbTableOnce", "::", "usage"}], "=", 
   "\"\<MakeProbTableOnce[{{\[Psi],\[Ellipsis]},\[Ellipsis]},\[Omega][{a,b}],\
\[Theta],\!\(\*SubscriptBox[\(k\), \(max\)]\)] is used by MakeProbTable[] to \
construct a table of probabilities of all mutational configurations.  It \
takes a GF, or a GF that has already been differentiated to give a partial \
table, and constructs a series expansion in \[Omega][{a,b}] around \
\[Theta]/2.  Tabulates 0\!\(\*SubscriptBox[\(\[Ellipsis]k\), \(max\)]\) \
itations, and adds a final element that gives the residual \
probability.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.649167156304008*^9, 
  3.6491673578668623`*^9}},ExpressionUUID->"6e974977-7acd-4611-9f60-\
87c5d532984e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeProbTableOnce", "[", 
    RowBox[{"gf_", ",", "\[Omega]_", ",", "\[Theta]_", ",", "km_Integer"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cl", ",", "\[Delta]", ",", 
       RowBox[{"tr", "=", 
        RowBox[{"TensorRank", "[", "gf", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"tr", "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{"cl", "=", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            FractionBox["\[Theta]", "2"], ")"}], 
           RowBox[{"Range", "[", 
            RowBox[{"0", ",", "km"}], "]"}]], 
          RowBox[{"PadRight", "[", 
           RowBox[{
            RowBox[{"CoefficientList", "[", 
             RowBox[{
              RowBox[{"Series", "[", 
               RowBox[{
                RowBox[{"gf", "/.", 
                 RowBox[{"\[Omega]", "\[RuleDelayed]", 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox["\[Theta]", "2"], "-", "\[Delta]"}], 
                   ")"}]}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"\[Delta]", ",", "0", ",", "km"}], "}"}]}], "]"}], 
              ",", "\[Delta]"}], "]"}], ",", 
            RowBox[{"km", "+", "1"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Append", "[", 
         RowBox[{"cl", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"gf", "/.", 
             RowBox[{"\[Omega]", ":>", "0"}]}], ")"}], "-", 
           RowBox[{"Total", "[", "cl", "]"}]}]}], "]"}]}], " ", 
       RowBox[{"(*", " ", 
        RowBox[{"appends", " ", "the", " ", "residual", " ", "probability"}], 
        " ", "*)"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"MakeProbTableOnce", "[", 
           RowBox[{"#", ",", "\[Omega]", ",", "\[Theta]", ",", "km"}], "]"}], 
          "&"}], ",", "gf", ",", 
         RowBox[{"{", "tr", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"if", " ", "gf", " ", "is", " ", "a", " ", "table"}], ",", 
        " ", 
        RowBox[{
        "applies", " ", "the", " ", "function", " ", "to", " ", "the", " ", 
         "deepest", " ", "level"}]}], " ", "*)"}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.649154252175185*^9, 3.6491543163962927`*^9}, {
   3.6491543622028*^9, 3.649154402873364*^9}, {3.649154522478467*^9, 
   3.649154553956929*^9}, {3.6491550461251163`*^9, 3.649155049381855*^9}, 
   3.649158160096315*^9, {3.6491582210937634`*^9, 3.649158222211873*^9}, {
   3.649158531859087*^9, 3.649158537017366*^9}, {3.6491586021313457`*^9, 
   3.649158602283454*^9}, {3.649158717510057*^9, 3.6491587193085527`*^9}, {
   3.649159621820941*^9, 3.649159665556945*^9}, {3.6491598115545*^9, 
   3.649159816368734*^9}, {3.649160032195632*^9, 3.6491600346619177`*^9}, 
   3.649162192976671*^9, 3.64916222986653*^9, {3.6491624590985823`*^9, 
   3.6491625171719017`*^9}, {3.6491650600884247`*^9, 3.649165085741002*^9}, {
   3.6491673966762466`*^9, 3.649167442102985*^9}, {3.6492248697162027`*^9, 
   3.6492248786992207`*^9}},ExpressionUUID->"a08d2142-a5ee-4e7d-8bac-\
90baaae42e5e"]
}, Closed]],

Cell[CellGroupData[{

Cell["Comparing direct differentiation with a series expansion", \
"Subsubsection",
 CellChangeTimes->{{3.649242784280849*^9, 
  3.649242803672371*^9}},ExpressionUUID->"452435f4-6566-4d8d-9d81-\
c629dabb8f98"],

Cell[TextData[{
 "There are two alternative methods: direct differentiation using probK, and \
another method using a series expansion.  Surprisingly, the series expansion \
is much ",
 StyleBox["slower",
  FontSlant->"Italic"],
 " when \[Theta] is given numerically.  This contrasts with the check above \
(see under probK), because here, I use MakeTableOnce to find the residual \
probability.  It seems that a series expansion will give numerical values \
faster, but I have not found a way to use this efficiency when the residual \
probabilities are calculated."
}], "Text",
 CellChangeTimes->{{3.64922579438618*^9, 3.649225899809833*^9}, {
  3.6492259623929996`*^9, 3.649225962836491*^9}, {3.649242645181168*^9, 
  3.6492427782427*^9}},ExpressionUUID->"b1d03009-afb9-42bd-92f9-cc7b8904cb17"],

Cell[TextData[{
 StyleBox["Note: ",
  FontWeight->"Bold"],
 "The example gf, sl, is calculated in the first single-deme example below "
}], "Text",
 CellChangeTimes->{{3.649305495271203*^9, 
  3.649305528091773*^9}},ExpressionUUID->"3e4358d4-3279-4df9-bbe7-\
11ec4b06c32e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sl2", "=", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"6", "+", 
        RowBox[{"\[Omega]", "[", 
         RowBox[{"{", "a", "}"}], "]"}], "+", 
        RowBox[{"\[Omega]", "[", 
         RowBox[{"{", "b", "}"}], "]"}], "+", 
        RowBox[{"\[Omega]", "[", 
         RowBox[{"{", "c", "}"}], "]"}], "+", 
        RowBox[{"\[Omega]", "[", 
         RowBox[{"{", "d", "}"}], "]"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"3", "+", 
        RowBox[{"\[Omega]", "[", 
         RowBox[{"{", "a", "}"}], "]"}], "+", 
        RowBox[{"\[Omega]", "[", 
         RowBox[{"{", "c", "}"}], "]"}], "+", 
        RowBox[{"\[Omega]", "[", 
         RowBox[{"{", 
          RowBox[{"b", ",", "d"}], "}"}], "]"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"\[Omega]", "[", 
         RowBox[{"{", "a", "}"}], "]"}], "+", 
        RowBox[{"\[Omega]", "[", 
         RowBox[{"{", 
          RowBox[{"b", ",", "c", ",", "d"}], "}"}], "]"}]}], ")"}]}], 
     ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.649240137549481*^9, 3.649240143707954*^9}, 
   3.649305560731419*^9, {3.649306376366207*^9, 
   3.649306405168487*^9}},ExpressionUUID->"84051196-05ac-44e5-b47e-\
162675653e3c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"br", "=", 
   RowBox[{"Subsets", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.649312764067527*^9, 
  3.649312788860198*^9}},ExpressionUUID->"f2408c41-e496-41c2-81af-\
fd660fdd6920"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"tblNew", "=", 
    RowBox[{"MakeProbTable", "[", 
     RowBox[{"sl2", ",", "\[Omega]", ",", "0.2", ",", "br", ",", "3", ",", 
      RowBox[{"OldMethod", "\[Rule]", "False"}]}], "]"}]}], ";"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.649221116509516*^9, 3.649221122036731*^9}, {
   3.6492214831121264`*^9, 3.649221489940205*^9}, {3.649222637944337*^9, 
   3.649222645174547*^9}, 3.6492231019594707`*^9, {3.6492247151221848`*^9, 
   3.649224735895712*^9}, 3.649225113775712*^9, {3.6492255415695868`*^9, 
   3.6492255440511723`*^9}, {3.64930638161327*^9, 3.649306382069137*^9}, {
   3.649312794273938*^9, 
   3.6493127947233257`*^9}},ExpressionUUID->"93f1af83-f9a1-48c4-9bea-\
e0a345003745"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"28.637789`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.649221497154685*^9, 3.64922152001334*^9}, 
   3.649221694586111*^9, 3.6492217685169*^9, 3.649221977168858*^9, 
   3.6492220175971003`*^9, 3.649222668053982*^9, 3.649223115016329*^9, 
   3.6492245475123034`*^9, {3.649224723209929*^9, 3.649224747065278*^9}, 
   3.6492249245486727`*^9, 3.6492251423877087`*^9, 3.649225567222731*^9, 
   3.649305602104158*^9, 3.649306406772101*^9, 3.649312817302484*^9, 
   3.650630932469108*^9},ExpressionUUID->"5452c6ab-5758-441e-9842-\
512da6f5cfd9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"tblOld", "=", 
    RowBox[{"MakeProbTable", "[", 
     RowBox[{"sl2", ",", "\[Omega]", ",", "0.24", ",", "br", ",", "3"}], 
     "]"}]}], ";"}], "]"}]], "Input",
 CellChangeTimes->{{3.649221116509516*^9, 3.649221122036731*^9}, {
   3.6492214831121264`*^9, 3.649221489940205*^9}, {3.649222637944337*^9, 
   3.649222645174547*^9}, 3.6492231019594707`*^9, {3.6492247151221848`*^9, 
   3.649224735895712*^9}, {3.649225113775712*^9, 3.64922514284457*^9}, {
   3.649225530659121*^9, 3.6492255313589478`*^9}, 3.64930639044398*^9, {
   3.649312799958516*^9, 3.649312800289997*^9}, {3.65063094316393*^9, 
   3.65063094600292*^9}},ExpressionUUID->"a76a4173-52b5-4c30-b8c1-\
492e545cd1b0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4.556284`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.649225149187916*^9, 3.649225571194862*^9, 3.649305605579277*^9, 
   3.649306410393043*^9, 3.649312820760366*^9, {3.650630937577355*^9, 
   3.6506309514311*^9}},ExpressionUUID->"b0d36d8d-af38-4282-8d8f-\
811c59bc652d"]
}, Open  ]],

Cell["\<\
When \[Theta] is kept as a symbol, the series expansion fails altogether.  \
The direct method using probK is much slower:\
\>", "Text",
 CellChangeTimes->{{3.649225966407963*^9, 3.649225987914982*^9}, {
  3.649226154348196*^9, 
  3.649226166684354*^9}},ExpressionUUID->"ed035e61-b731-4fc6-b76a-\
ebdb12d0f6cd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"tblNew\[Theta]", "=", 
    RowBox[{"MakeProbTable", "[", 
     RowBox[{
     "sl2", ",", "\[Omega]", ",", "\[Theta]", ",", "br", ",", "3", ",", 
      RowBox[{"OldMethod", "\[Rule]", "False"}]}], "]"}]}], ";"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.649221116509516*^9, 3.649221122036731*^9}, {
   3.6492214831121264`*^9, 3.649221489940205*^9}, {3.649222637944337*^9, 
   3.649222645174547*^9}, 3.6492231019594707`*^9, {3.6492247151221848`*^9, 
   3.649224735895712*^9}, 3.649225113775712*^9, {3.649225179795891*^9, 
   3.64922518439229*^9}, 3.649225364918952*^9, {3.649225559439252*^9, 
   3.649225559642448*^9}, 3.649225730674369*^9, 3.649306584788177*^9, {
   3.649312805532559*^9, 
   3.649312805801158*^9}},ExpressionUUID->"e4a75a41-53c1-471f-9c6a-\
a585990ea84c"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.649225360950671*^9, 
  3.6492254235138407`*^9},ExpressionUUID->"f5d9d3c6-9e88-49ed-97dd-\
f2dd8234810a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"tblOld\[Theta]", "=", 
    RowBox[{"MakeProbTable", "[", 
     RowBox[{"sl2", ",", "\[Omega]", ",", "\[Theta]", ",", "br", ",", "3"}], 
     "]"}]}], ";"}], "]"}]], "Input",
 CellChangeTimes->{{3.649221116509516*^9, 3.649221122036731*^9}, {
   3.6492214831121264`*^9, 3.649221489940205*^9}, {3.649222637944337*^9, 
   3.649222645174547*^9}, 3.6492231019594707`*^9, {3.6492247151221848`*^9, 
   3.649224735895712*^9}, {3.649225113775712*^9, 3.64922514284457*^9}, {
   3.649225174741865*^9, 3.649225178157481*^9}, 3.649225365920025*^9, {
   3.649225563409923*^9, 3.6492255636254797`*^9}, 3.64922573787261*^9, 
   3.649306418580283*^9, {3.64931280794139*^9, 
   3.649312808241146*^9}},ExpressionUUID->"f6fc99e8-fbdb-4068-b81f-\
c19b8dc622c8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "8.7394269999999991682670952286571264267`6.962082872356144", ",", "Null"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.6492253712860126`*^9, 3.649225574713027*^9, 3.6492257490716467`*^9, 
   3.64930561381944*^9, {3.649306414907864*^9, 3.649306427729638*^9}, 
   3.649312829592272*^9},ExpressionUUID->"398fd1c2-f0af-4a35-9e4c-\
447757c312d4"]
}, Open  ]],

Cell["The two methods do agree:", "Text",
 CellChangeTimes->{{3.64922617171437*^9, 
  3.6492261763389893`*^9}},ExpressionUUID->"1ea1993b-05a3-42b7-9992-\
bc9eede263ca"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"18", 
      RowBox[{"Total", "[", 
       RowBox[{"#", "//", "Flatten"}], "]"}]}], "&"}], "/@", 
    RowBox[{"{", 
     RowBox[{"tblNew", ",", "tblOld", ",", 
      RowBox[{"tblOld\[Theta]", "/.", 
       RowBox[{"\[Theta]", "\[Rule]", "0.2"}]}]}], "}"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Min", "[", 
      RowBox[{
       RowBox[{"tblNew", "-", "tblOld"}], "//", "Flatten"}], "]"}], ",", 
     RowBox[{"Max", "[", 
      RowBox[{
       RowBox[{"tblNew", "-", "tblOld"}], "//", "Flatten"}], "]"}]}], "}"}]}],
   "}"}]], "Input",
 CellChangeTimes->{{3.649224965275098*^9, 3.6492249817444477`*^9}, {
   3.64922520822941*^9, 3.649225294926893*^9}, {3.649225354425666*^9, 
   3.649225354768906*^9}, {3.6492255894145527`*^9, 3.649225631283682*^9}, {
   3.6492256795820503`*^9, 3.6492256915657053`*^9}, 
   3.64922591996554*^9},ExpressionUUID->"3f569188-cfc0-4846-a07c-\
04bf44c7c5bd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.9999999999999792`", ",", "0.9999999999999781`", ",", "1"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "5.834365593497204`*^-14"}], ",", 
     "6.533366900532124`*^-14"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.649224967458783*^9, 3.649224982160303*^9}, {
   3.6492256201541157`*^9, 3.649225636052909*^9}, {3.649225907673732*^9, 
   3.6492259251137857`*^9}, 3.6493056189826813`*^9, 
   3.6493064327703133`*^9},ExpressionUUID->"fbc5b923-56e7-4c4e-af8d-\
b41f9454ff38"]
}, Open  ]],

Cell[TextData[{
 StyleBox["Note: ",
  FontWeight->"Bold"],
 " It may take an unreasonably long time to replace \[Theta] by a numerical \
value. The above expression is fast, but ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Min", "[", 
    RowBox[{"tblNew", "-", 
     RowBox[{"(", 
      RowBox[{"tblOld\[Theta]", "/.", 
       RowBox[{"\[Theta]", "\[Rule]", "0.2"}]}], ")"}]}], "]"}], 
   TraditionalForm]],ExpressionUUID->"035c5276-d056-41c5-a99b-0b095787034a"],
 " fails, for obscure reasons.  It may be that ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " sometimes tries to convert a SparseArray into an enormous normal \
expression."
}], "Text",
 CellChangeTimes->{{3.649226193495637*^9, 3.649226311749592*^9}, 
   3.649305227567148*^9},ExpressionUUID->"0f379616-c7f8-4601-b8ee-\
e0dec9aca39a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"tblSeries\[Theta]", "=", 
    RowBox[{"MakePT", "[", 
     RowBox[{"sl2", ",", "\[Omega]", ",", "\[Theta]", ",", 
      RowBox[{"GetConfigsGF", "[", 
       RowBox[{"sl2", ",", "\[Omega]"}], "]"}], ",", "3"}], "]"}]}], ";"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.649302794551509*^9, 3.6493028159057417`*^9}, {
   3.6493048188390627`*^9, 3.649304845917041*^9}, {3.649304949008469*^9, 
   3.649304966528846*^9}, 3.649305122191917*^9, {3.649305171260028*^9, 
   3.649305172535309*^9}, 3.649305209457478*^9, {3.649306434681175*^9, 
   3.64930643890563*^9}},ExpressionUUID->"a3474847-1efb-4cb3-9672-\
52d343f98be5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "42.35534299999999774399839225225150585175`7.647508116353733", ",", 
   "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.649302833542584*^9, {3.649304841743568*^9, 3.649304862161371*^9}, 
   3.6493050134329967`*^9, {3.649305166612071*^9, 3.64930517547363*^9}, 
   3.6493052539816723`*^9, 3.6493056559092093`*^9, 3.64930643526757*^9, 
   3.6493064815651817`*^9},ExpressionUUID->"33ed08a3-77be-4679-bb5b-\
fa56235b0b08"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"tblSeries", "=", 
    RowBox[{"MakePT", "[", 
     RowBox[{"sl2", ",", "\[Omega]", ",", "0.2", ",", 
      RowBox[{"GetConfigsGF", "[", 
       RowBox[{"sl2", ",", "\[Omega]"}], "]"}], ",", "3"}], "]"}]}], ";"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.649302794551509*^9, 3.6493028159057417`*^9}, {
  3.6493048188390627`*^9, 3.649304845917041*^9}, {3.649304949008469*^9, 
  3.649304966528846*^9}, {3.649305122191917*^9, 3.649305126131962*^9}, {
  3.6493051594297123`*^9, 3.649305159806559*^9}, {3.64930524800248*^9, 
  3.649305252422291*^9}, {3.649306446887328*^9, 
  3.64930644875928*^9}},ExpressionUUID->"1fc545fa-0e0e-493e-a032-\
8928fab89c2d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "5.28017200000000030968294595368206501007`6.743247983054768", ",", "Null"}],
   "}"}]], "Output",
 CellChangeTimes->{3.6493052675191936`*^9, 3.64930566681351*^9, 
  3.649306486858346*^9},ExpressionUUID->"6dc05154-abd3-4a86-830a-\
ddab55764a35"]
}, Open  ]],

Cell["\<\
MakeProbTable generates a big array, in this example with 14 dimensions.  To \
compare the values, the output fromMakePT must be embedded into a table with \
the same dimensions.  \
\>", "Text",
 CellChangeTimes->{{3.64930691108945*^9, 
  3.64930699770363*^9}},ExpressionUUID->"0b15ace6-aad1-4f24-8ff6-\
87f9a5b76266"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tblSeriesBig", "=", 
  RowBox[{"EmbedTable", "[", 
   RowBox[{
    RowBox[{"tblSeries", "//", "Normal"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "9", ",", "14"}], "}"}], 
    ",", "1", ",", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"5", ",", "14"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.649306767877191*^9, 3.649306804579379*^9}, {
  3.649306839800684*^9, 
  3.649306853854134*^9}},ExpressionUUID->"101b326f-4ff7-4ffc-81e0-\
36a9e3caea4f"],

Cell[BoxData[
 TagBox[
  TemplateBox[{RowBox[{
      StyleBox[
       TagBox["SparseArray", "SummaryHead"], "NonInterpretableSummary"], 
      StyleBox["[", "NonInterpretableSummary"], 
      DynamicModuleBox[{Typeset`open$$ = False}, 
       PanelBox[
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquarePlusIconMedium"]], 
                ButtonFunction :> (Typeset`open$$ = True), Appearance -> None,
                 Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GraphicsBox[
               RasterBox[
               SparseArray[
                Automatic, {10, 10}, 0.93, {
                 1, {{0, 1, 1, 4, 4, 5, 6, 6, 8, 10, 13}, {{4}, {6}, {7}, {
                   10}, {5}, {9}, {3}, {8}, {5}, {7}, {2}, {3}, {7}}}, {0., 
                  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}}], {{0, 
                0}, {10, 10}}, {0, 1}], Frame -> False, Axes -> False, 
               AspectRatio -> 1, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}], Frame -> True, FrameTicks -> None, 
               FrameStyle -> Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], 
               FrameLabel -> {None, None}, 
               FrameTicks -> {{None, None}, {None, None}}], 
              GridBox[{{
                 RowBox[{
                   TagBox[
                   "\"Specified elements: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["15625", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    
                    RowBox[{
                    "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", 
                    ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
                    "5", ",", "5", ",", "5"}], "}"}], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquareMinusIconMedium"]], 
                ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GraphicsBox[
               RasterBox[
               SparseArray[
                Automatic, {10, 10}, 0.93, {
                 1, {{0, 1, 1, 4, 4, 5, 6, 6, 8, 10, 13}, {{4}, {6}, {7}, {
                   10}, {5}, {9}, {3}, {8}, {5}, {7}, {2}, {3}, {7}}}, {0., 
                  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}}], {{0, 
                0}, {10, 10}}, {0, 1}], Frame -> False, Axes -> False, 
               AspectRatio -> 1, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}], Frame -> True, FrameTicks -> None, 
               FrameStyle -> Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], 
               FrameLabel -> {None, None}, 
               FrameTicks -> {{None, None}, {None, None}}], 
              GridBox[{{
                 RowBox[{
                   TagBox[
                   "\"Specified elements: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["15625", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    
                    RowBox[{
                    "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", 
                    ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
                    "5", ",", "5", ",", "5"}], "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["0", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["2.56`*^-6", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["\"\"", "SummaryItem"]}]}, {
                 TagBox[
                  TagBox[
                   GridBox[{{
                    RowBox[{
                    RowBox[{"{", 
                    
                    RowBox[{
                    "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
                    ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
                    "1", ",", "1", ",", "1"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "0.03945707070707071`", ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    
                    RowBox[{
                    "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
                    ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
                    "1", ",", "1", ",", "2"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "0.003288089225589227`", ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    
                    RowBox[{
                    "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
                    ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
                    "1", ",", "1", ",", "3"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "0.00027400743546576896`", ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    
                    RowBox[{
                    "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
                    ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
                    "1", ",", "1", ",", "4"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "0.00002283395295548075`", ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    ItemBox[
                    "\"\[VerticalEllipsis]\"", Alignment -> Center, 
                    StripOnInput -> False]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                   "Column"], "SummaryItem"]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic], BaselinePosition -> 
        Baseline], DynamicModuleValues :> {}], 
      StyleBox["]", "NonInterpretableSummary"]}]},
   "CopyTag",
   DisplayFunction->(#& ),
   InterpretationFunction->(
    "SparseArray[<15625>, {5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5}]"& )],
  False,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{
  3.649306805792737*^9, {3.649306844409503*^9, 
   3.649306854468521*^9}},ExpressionUUID->"909baef2-58e3-488c-a5f2-\
95c133cb8595"]
}, Open  ]],

Cell["Miraculously, the new method gives the correct values:", "Text",
 CellChangeTimes->{{3.649307023357197*^9, 
  3.6493070410359697`*^9}},ExpressionUUID->"c1a05f5b-3fdb-4925-80f5-\
f206c4432ce0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Min", "[", 
    RowBox[{
     RowBox[{"tblSeriesBig", "-", "tblOld"}], "//", "Flatten"}], "]"}], ",", 
   RowBox[{"Max", "[", 
    RowBox[{
     RowBox[{"tblSeriesBig", "-", "tblOld"}], "//", "Flatten"}], "]"}]}], 
  "}"}]], "Input",
 CellChangeTimes->{{3.649305140315298*^9, 3.649305144960384*^9}, {
  3.6493068956506233`*^9, 
  3.6493068986128607`*^9}},ExpressionUUID->"672d4468-c577-441a-a225-\
e510c024f5cd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "7.622594596950532`*^-17"}], ",", "7.231051274686077`*^-17"}],
   "}"}]], "Output",
 CellChangeTimes->{3.6493051165965*^9, 
  3.649306899292004*^9},ExpressionUUID->"a79452af-8ccf-4c10-8c2a-\
5821d45de298"]
}, Open  ]],

Cell[TextData[{
 StyleBox["Summary:",
  FontWeight->"Bold"],
 " Three methods are implemented: direct differentiation (the default \
OldMethod->True in MakeProbTable); series expansion (OldMethod->True in \
MakeProbTable); and a more efficient series expansion scheme in MakePT.   The \
latter has about the same speed as direct differentiation for numerical \
\[Theta], but is much slower for algebraic expressions.  However, I have not \
tested it extensively."
}], "Text",
 CellChangeTimes->{{3.649307095040029*^9, 
  3.6493072703584013`*^9}},ExpressionUUID->"1ce51665-61f2-4cc9-8934-\
12d3106d2cc4"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Setting up tables of probabilities: main functions", "Subsection",
 CellChangeTimes->{{3.6483865353974*^9, 3.6483865464991837`*^9}, 
   3.649226337523493*^9, {3.649308570733994*^9, 3.6493085910673637`*^9}, 
   3.652594929578608*^9},ExpressionUUID->"ccab2c7f-002d-427b-a274-\
59b6c91e78f8"],

Cell[CellGroupData[{

Cell["likFullG", "Subsubsection",
 CellChangeTimes->{
  3.647339939584042*^9},ExpressionUUID->"c41f08ce-c61b-474e-b9ab-\
d6f1114009a7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"likFullG", "::", "usage"}], "=", 
   "\"\<likFullG[gf,\[Omega],\[Theta],rlznum,max] uses CoefficeintList to \
tabulate the probabilities of mutational configurations of to max mutations. \
By default the table of probabilities has the same dimensions as the list of \
\[Omega] of the gf. However a specific subset of \[Omega]s can be specified \
in \[Omega]list (other \[Omega] parameteres are then set to 0). If \
\[Omega]list is empty likFullG computes the marginal probability\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.640575857554448*^9, 3.640575972609573*^9}, {
  3.640576701768317*^9, 3.640576757570215*^9}, {3.64057726704331*^9, 
  3.640577275143036*^9}, {3.640577498156272*^9, 3.640577518073368*^9}, {
  3.640578105150457*^9, 3.640578118606937*^9}, {3.648517944620528*^9, 
  3.6485179741139107`*^9}, {3.651912213298126*^9, 3.65191224824783*^9}, {
  3.6519123070136423`*^9, 
  3.651912584153421*^9}},ExpressionUUID->"b40a451c-5a9a-41d2-81de-\
c67cf6d8167f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"likFullG", "[", 
    RowBox[{
    "gf_", ",", "\[Omega]_", ",", "\[Theta]_", ",", "rlznum_List", ",", 
     "max_Integer"}], "]"}], ":=", 
   RowBox[{"likFullG", "[", 
    RowBox[{"gf", ",", "\[Omega]", ",", "\[Theta]", ",", "rlznum", ",", " ", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"max", ",", 
       RowBox[{
        RowBox[{"GetConfigsGF", "[", 
         RowBox[{"gf", ",", "\[Omega]"}], "]"}], "//", "Length"}]}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.646979613423389*^9, 3.64697968322299*^9}, {
   3.646979720805832*^9, 3.646979730086338*^9}, {3.646984172656475*^9, 
   3.646984174448586*^9}, 3.651912667431573*^9, 
   3.6532105776238947`*^9},ExpressionUUID->"3c6ac7eb-b294-42e2-90e2-\
16e048ba9b7a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"likFullG", "[", 
    RowBox[{
    "gf_", ",", "\[Omega]_", ",", "\[Theta]_", ",", "rlznum_List", ",", " ", 
     "max_List"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"likFullG", "[", 
    RowBox[{"gf", ",", "\[Omega]", ",", "\[Theta]", ",", "rlznum", ",", 
     RowBox[{
      RowBox[{"GetConfigsGF", "[", 
       RowBox[{"gf", ",", "\[Omega]"}], "]"}], "//", "Sort"}], ",", "max"}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5437307340856657`*^9, 3.54373088709002*^9}, {
   3.543732820609692*^9, 3.543732946803141*^9}, {3.543733390213127*^9, 
   3.543733392854786*^9}, {3.543733932791114*^9, 3.543733936934861*^9}, {
   3.54373411739987*^9, 3.543734123648171*^9}, {3.544158516795148*^9, 
   3.544158518031231*^9}, {3.544162697894964*^9, 3.544162701583514*^9}, {
   3.544246649427737*^9, 3.54424667465248*^9}, {3.544247115474484*^9, 
   3.544247149009304*^9}, {3.544247399598826*^9, 3.544247424889368*^9}, {
   3.544423009008803*^9, 3.544423009141169*^9}, {3.546667748806864*^9, 
   3.5466677540195*^9}, {3.54666784627138*^9, 3.546667901842959*^9}, 
   3.546668027380233*^9, 3.5466702260229683`*^9, {3.5471999087358313`*^9, 
   3.547199909115028*^9}, {3.557035418637727*^9, 3.557035430122199*^9}, {
   3.573802471883849*^9, 3.5738024993016*^9}, 3.600411309761611*^9, {
   3.6018647048335733`*^9, 3.601864914288433*^9}, {3.6018651376278543`*^9, 
   3.601865236089665*^9}, {3.6018652829716167`*^9, 3.60186528668347*^9}, {
   3.601865349847983*^9, 3.6018653576128902`*^9}, {3.601865392756939*^9, 
   3.601865393346635*^9}, {3.6018655761453114`*^9, 3.601865601113167*^9}, {
   3.601865690259582*^9, 3.601865697051045*^9}, {3.601865837155189*^9, 
   3.6018658392079763`*^9}, {3.60186586981605*^9, 3.601865879061592*^9}, {
   3.601866078011161*^9, 3.60186607921708*^9}, {3.6018661172590113`*^9, 
   3.601866127925151*^9}, {3.603180378141987*^9, 3.603180378714656*^9}, {
   3.6034406552139893`*^9, 3.603440726723276*^9}, 3.61864322990322*^9, {
   3.619431942372805*^9, 3.619431953282086*^9}, {3.619432371706004*^9, 
   3.619432390670436*^9}, {3.619432453110118*^9, 3.619432466766774*^9}, {
   3.619432992896923*^9, 3.619432997593627*^9}, {3.619433028969716*^9, 
   3.619433048383924*^9}, {3.619433122608129*^9, 3.619433208159273*^9}, {
   3.6201153411517344`*^9, 3.6201153446764717`*^9}, {3.64655808477421*^9, 
   3.646558086496358*^9}, {3.646558123213777*^9, 3.646558160340358*^9}, {
   3.646559119182905*^9, 3.646559147714972*^9}, {3.646559433165585*^9, 
   3.64655943782974*^9}, {3.646559797354892*^9, 3.6465598046552353`*^9}, {
   3.646639155188121*^9, 3.646639174090283*^9}, {3.646639887169894*^9, 
   3.646639911317792*^9}, {3.646640012916504*^9, 3.646640013845196*^9}, {
   3.6466400450987463`*^9, 3.6466400540016117`*^9}, {3.646640381667796*^9, 
   3.646640467409424*^9}, {3.646640503113611*^9, 3.6466406575188217`*^9}, {
   3.646640748031365*^9, 3.64664077562612*^9}, {3.6466408347693033`*^9, 
   3.646640882837818*^9}, {3.64664110834194*^9, 3.646641157886959*^9}, {
   3.6466418048715563`*^9, 3.646641808141008*^9}, {3.64664321746495*^9, 
   3.646643218787237*^9}, {3.6466433452215557`*^9, 3.646643356548704*^9}, {
   3.6466433872040052`*^9, 3.646643423818318*^9}, {3.646643771505864*^9, 
   3.6466437800609503`*^9}, {3.646643838363558*^9, 3.646643838943091*^9}, {
   3.646643901337634*^9, 3.6466439228118763`*^9}, 3.646644183242291*^9, {
   3.6469757044828873`*^9, 3.646975715314465*^9}, {3.646975755781331*^9, 
   3.646975785525937*^9}, {3.646978233231574*^9, 3.6469783143117*^9}, {
   3.646979749253916*^9, 3.6469797942721157`*^9}, {3.646979844265044*^9, 
   3.646980014942445*^9}, 3.6469800882644444`*^9, 3.646980120222323*^9, {
   3.646981098418789*^9, 3.6469811065214243`*^9}, {3.64698114775842*^9, 
   3.64698115297534*^9}, {3.646981757256792*^9, 3.646981760296111*^9}, {
   3.646982007134624*^9, 3.646982007428183*^9}, 3.646982101057468*^9, {
   3.6469836033072653`*^9, 3.64698368744697*^9}, {3.646983916758821*^9, 
   3.646983942791333*^9}, {3.646984252950905*^9, 3.6469842703676*^9}, {
   3.646984355177435*^9, 3.646984388494343*^9}, {3.6509980594966717`*^9, 
   3.650998118119934*^9}, 
   3.651912670781233*^9},ExpressionUUID->"127cbc0c-1ccf-4969-ad50-\
f18036ebb06b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"likFullG", "[", 
    RowBox[{
    "gf_", ",", "\[Omega]_", ",", "\[Theta]_", ",", "rlznum_List", ",", 
     "\[Omega]list_", ",", "max_Integer"}], "]"}], ":=", 
   RowBox[{"likFullG", "[", 
    RowBox[{
    "gf", ",", "\[Omega]", ",", "\[Theta]", ",", "rlznum", ",", 
     "\[Omega]list", ",", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"max", ",", 
       RowBox[{"Length", "[", "\[Omega]list", "]"}]}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5437307340856657`*^9, 3.54373088709002*^9}, {
   3.543732820609692*^9, 3.543732946803141*^9}, {3.543733390213127*^9, 
   3.543733392854786*^9}, {3.543733932791114*^9, 3.543733936934861*^9}, {
   3.54373411739987*^9, 3.543734123648171*^9}, {3.544158516795148*^9, 
   3.544158518031231*^9}, {3.544162697894964*^9, 3.544162701583514*^9}, {
   3.544246649427737*^9, 3.54424667465248*^9}, {3.544247115474484*^9, 
   3.544247149009304*^9}, {3.544247399598826*^9, 3.544247424889368*^9}, {
   3.544423009008803*^9, 3.544423009141169*^9}, {3.546667748806864*^9, 
   3.5466677540195*^9}, {3.54666784627138*^9, 3.546667901842959*^9}, 
   3.546668027380233*^9, 3.5466702260229683`*^9, {3.5471999087358313`*^9, 
   3.547199909115028*^9}, {3.557035418637727*^9, 3.557035430122199*^9}, {
   3.573802471883849*^9, 3.5738024993016*^9}, 3.600411309761611*^9, {
   3.6018647048335733`*^9, 3.601864914288433*^9}, {3.6018651376278543`*^9, 
   3.601865236089665*^9}, {3.6018652829716167`*^9, 3.60186528668347*^9}, {
   3.601865349847983*^9, 3.6018653576128902`*^9}, {3.601865392756939*^9, 
   3.601865393346635*^9}, {3.6018655761453114`*^9, 3.601865601113167*^9}, {
   3.601865690259582*^9, 3.601865697051045*^9}, {3.601865837155189*^9, 
   3.6018658392079763`*^9}, {3.60186586981605*^9, 3.601865879061592*^9}, {
   3.601866078011161*^9, 3.60186607921708*^9}, {3.6018661172590113`*^9, 
   3.601866127925151*^9}, {3.603180378141987*^9, 3.603180378714656*^9}, {
   3.6034406552139893`*^9, 3.603440726723276*^9}, 3.61864322990322*^9, {
   3.619431942372805*^9, 3.619431953282086*^9}, {3.619432371706004*^9, 
   3.619432390670436*^9}, {3.619432453110118*^9, 3.619432466766774*^9}, {
   3.619432992896923*^9, 3.619432997593627*^9}, {3.619433028969716*^9, 
   3.619433048383924*^9}, {3.619433122608129*^9, 3.619433208159273*^9}, {
   3.6201153411517344`*^9, 3.6201153446764717`*^9}, {3.64655808477421*^9, 
   3.646558086496358*^9}, {3.646558123213777*^9, 3.646558160340358*^9}, {
   3.646559119182905*^9, 3.646559147714972*^9}, {3.646559433165585*^9, 
   3.64655943782974*^9}, {3.646559797354892*^9, 3.6465598046552353`*^9}, {
   3.646639155188121*^9, 3.646639174090283*^9}, {3.646639887169894*^9, 
   3.646639911317792*^9}, {3.646640012916504*^9, 3.646640013845196*^9}, {
   3.6466400450987463`*^9, 3.6466400540016117`*^9}, {3.646640381667796*^9, 
   3.646640467409424*^9}, {3.646640503113611*^9, 3.6466406575188217`*^9}, {
   3.646640748031365*^9, 3.64664077562612*^9}, {3.6466408347693033`*^9, 
   3.646640882837818*^9}, {3.64664110834194*^9, 3.646641157886959*^9}, {
   3.6466418048715563`*^9, 3.646641808141008*^9}, {3.64664321746495*^9, 
   3.646643218787237*^9}, {3.6466433452215557`*^9, 3.646643356548704*^9}, {
   3.6466433872040052`*^9, 3.646643423818318*^9}, {3.646643771505864*^9, 
   3.6466437800609503`*^9}, {3.646643838363558*^9, 3.646643838943091*^9}, {
   3.646643901337634*^9, 3.6466439228118763`*^9}, 3.646644183242291*^9, {
   3.6469757044828873`*^9, 3.646975715314465*^9}, {3.646975755781331*^9, 
   3.646975785525937*^9}, {3.646978233231574*^9, 3.6469783143117*^9}, {
   3.646979749253916*^9, 3.6469797942721157`*^9}, {3.646979844265044*^9, 
   3.646980014942445*^9}, 3.6469800882644444`*^9, 3.646980120222323*^9, {
   3.646981098418789*^9, 3.6469811065214243`*^9}, {3.64698114775842*^9, 
   3.64698115297534*^9}, {3.646981757256792*^9, 3.646981760296111*^9}, {
   3.646982007134624*^9, 3.646982007428183*^9}, 3.646982101057468*^9, {
   3.6469836033072653`*^9, 3.64698368744697*^9}, {3.646983916758821*^9, 
   3.646983942791333*^9}, {3.646984252950905*^9, 3.6469842703676*^9}, {
   3.646984343461595*^9, 3.646984344327672*^9}, {3.6469844678798723`*^9, 
   3.646984570048614*^9}, {3.647001449858623*^9, 3.6470014994207287`*^9}, {
   3.6470015631243343`*^9, 3.647001592473271*^9}, 
   3.651912673189871*^9},ExpressionUUID->"69aceb6a-b91a-4fe0-b698-\
d2c8ff80b70b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"likFullG", "[", 
    RowBox[{
    "gf_", ",", "\[Omega]_", ",", "\[Theta]_", ",", "rlznum_List", ",", 
     "\[Omega]list_", ",", "max_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "rules", ",", " ", "nc", ",", "\[Delta]s", ",", "\[Delta]smax", ",", 
       "\[Delta]"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rules", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Omega]", "[", "#", "]"}], "\[RuleDelayed]", 
           RowBox[{
            RowBox[{"\[Theta]", "/", "2"}], "-", 
            RowBox[{"\[Delta]", "[", "#", "]"}]}]}], ")"}], "&"}], "/@", 
        "\[Omega]list"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nc", "=", 
       RowBox[{"\[Omega]list", "//", "Length"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Delta]s", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Delta]", "[", "#", "]"}], "&"}], "/@", "\[Omega]list"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"\[Delta]smax", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
           "0", ",", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
          "}"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Delta]s", ",", "max"}], "}"}], "//", "Thread"}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"N", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"\[Omega]list", "==", 
             RowBox[{"{", "}"}]}], ",", 
            RowBox[{
             RowBox[{"gf", "/.", "rlznum"}], "/.", 
             RowBox[{
              RowBox[{"\[Omega]", "[", "_", "]"}], "\[Rule]", "0"}]}], ",", 
            RowBox[{"CoefficientList", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Series", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"gf", "/.", "rlznum"}], "/.", "rules"}], "/.", 
                    RowBox[{
                    RowBox[{"\[Omega]", "[", "_", "]"}], "\[Rule]", "0"}]}], 
                   ",", "##"}], "]"}], "&"}], "@@", "\[Delta]smax"}], ")"}], 
              ",", "\[Delta]s"}], "]"}]}], "]"}], "\[Times]", 
          "\[IndentingNewLine]", 
          RowBox[{"Array", "[", 
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Theta]", "/", "2"}], ")"}], 
              RowBox[{"Total", "[", 
               RowBox[{"{", "##", "}"}], "]"}]], "&"}], ",", 
            RowBox[{"max", "+", "1"}], ",", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"0", ",", "nc"}], "]"}]}], "]"}]}], ")"}], ",", 
        "Infinity"}], "]"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5437307340856657`*^9, 3.54373088709002*^9}, {
   3.543732820609692*^9, 3.543732946803141*^9}, {3.543733390213127*^9, 
   3.543733392854786*^9}, {3.543733932791114*^9, 3.543733936934861*^9}, {
   3.54373411739987*^9, 3.543734123648171*^9}, {3.544158516795148*^9, 
   3.544158518031231*^9}, {3.544162697894964*^9, 3.544162701583514*^9}, {
   3.544246649427737*^9, 3.54424667465248*^9}, {3.544247115474484*^9, 
   3.544247149009304*^9}, {3.544247399598826*^9, 3.544247424889368*^9}, {
   3.544423009008803*^9, 3.544423009141169*^9}, {3.546667748806864*^9, 
   3.5466677540195*^9}, {3.54666784627138*^9, 3.546667901842959*^9}, 
   3.546668027380233*^9, 3.5466702260229683`*^9, {3.5471999087358313`*^9, 
   3.547199909115028*^9}, {3.557035418637727*^9, 3.557035430122199*^9}, {
   3.573802471883849*^9, 3.5738024993016*^9}, 3.600411309761611*^9, {
   3.6018647048335733`*^9, 3.601864914288433*^9}, {3.6018651376278543`*^9, 
   3.601865236089665*^9}, {3.6018652829716167`*^9, 3.60186528668347*^9}, {
   3.601865349847983*^9, 3.6018653576128902`*^9}, {3.601865392756939*^9, 
   3.601865393346635*^9}, {3.6018655761453114`*^9, 3.601865601113167*^9}, {
   3.601865690259582*^9, 3.601865697051045*^9}, {3.601865837155189*^9, 
   3.6018658392079763`*^9}, {3.60186586981605*^9, 3.601865879061592*^9}, {
   3.601866078011161*^9, 3.60186607921708*^9}, {3.6018661172590113`*^9, 
   3.601866127925151*^9}, {3.603180378141987*^9, 3.603180378714656*^9}, {
   3.6034406552139893`*^9, 3.603440726723276*^9}, 3.61864322990322*^9, {
   3.619431942372805*^9, 3.619431953282086*^9}, {3.619432371706004*^9, 
   3.619432390670436*^9}, {3.619432453110118*^9, 3.619432466766774*^9}, {
   3.619432992896923*^9, 3.619432997593627*^9}, {3.619433028969716*^9, 
   3.619433048383924*^9}, {3.619433122608129*^9, 3.619433208159273*^9}, {
   3.6201153411517344`*^9, 3.6201153446764717`*^9}, {3.64655808477421*^9, 
   3.646558086496358*^9}, {3.646558123213777*^9, 3.646558160340358*^9}, {
   3.646559119182905*^9, 3.646559147714972*^9}, {3.646559433165585*^9, 
   3.64655943782974*^9}, {3.646559797354892*^9, 3.6465598046552353`*^9}, {
   3.646639155188121*^9, 3.646639174090283*^9}, {3.646639887169894*^9, 
   3.646639911317792*^9}, {3.646640012916504*^9, 3.646640013845196*^9}, {
   3.6466400450987463`*^9, 3.6466400540016117`*^9}, {3.646640381667796*^9, 
   3.646640467409424*^9}, {3.646640503113611*^9, 3.6466406575188217`*^9}, {
   3.646640748031365*^9, 3.64664077562612*^9}, {3.6466408347693033`*^9, 
   3.646640882837818*^9}, {3.64664110834194*^9, 3.646641157886959*^9}, {
   3.6466418048715563`*^9, 3.646641808141008*^9}, {3.64664321746495*^9, 
   3.646643218787237*^9}, {3.6466433452215557`*^9, 3.646643356548704*^9}, {
   3.6466433872040052`*^9, 3.646643423818318*^9}, {3.646643771505864*^9, 
   3.6466437800609503`*^9}, {3.646643838363558*^9, 3.646643838943091*^9}, {
   3.646643901337634*^9, 3.6466439228118763`*^9}, 3.646644183242291*^9, {
   3.6469757044828873`*^9, 3.646975715314465*^9}, {3.646975755781331*^9, 
   3.646975785525937*^9}, {3.646978233231574*^9, 3.6469783143117*^9}, {
   3.646979749253916*^9, 3.6469797942721157`*^9}, {3.646979844265044*^9, 
   3.646980014942445*^9}, 3.6469800882644444`*^9, 3.646980120222323*^9, {
   3.646981098418789*^9, 3.6469811065214243`*^9}, {3.64698114775842*^9, 
   3.64698115297534*^9}, {3.646981757256792*^9, 3.646981760296111*^9}, {
   3.646982007134624*^9, 3.646982007428183*^9}, 3.646982101057468*^9, {
   3.6469836033072653`*^9, 3.64698368744697*^9}, {3.646983916758821*^9, 
   3.646983942791333*^9}, {3.646984252950905*^9, 3.6469842703676*^9}, {
   3.646984343461595*^9, 3.646984344327672*^9}, {3.6469844678798723`*^9, 
   3.646984570048614*^9}, {3.647172809742971*^9, 3.6471728977712193`*^9}, 
   3.651912675649547*^9},ExpressionUUID->"0c039eb2-3315-40a1-beac-\
c2cd258ec7b2"],

Cell[TextData[{
 StyleBox["Note: ",
  FontWeight->"Bold"],
 "There is a peculiar singularity at \[Theta]=2; the likelihood calculation \
blows up at this value."
}], "Text",
 CellChangeTimes->{{3.649305495271203*^9, 3.649305528091773*^9}, {
  3.6509976970099497`*^9, 
  3.65099774364977*^9}},ExpressionUUID->"6cf26b32-985b-42eb-aedf-\
b5570371c155"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"likFullG", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
    "twoEnRXTsimpSort", "\[LeftDoubleBracket]", "2", 
     "\[RightDoubleBracket]"}], "//", "Total"}], ",", "\[Omega]", ",", "2", 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"M", "\[Rule]", "0"}], ",", 
     RowBox[{"T", "\[Rule]", "1.7"}]}], "}"}], ",", 
   RowBox[{"{", "}"}], ",", "3"}], "]"}]], "Input",
 CellChangeTimes->{{3.650998170100178*^9, 3.65099817605849*^9}, {
  3.650998267110901*^9, 3.650998288337405*^9}, {3.650998329281749*^9, 
  3.650998372368031*^9}, {3.6509984204104233`*^9, 
  3.650998431802021*^9}},ExpressionUUID->"c6620003-e79c-4b46-8a3b-\
a6abbff8f700"],

Cell[BoxData["0.022248846640217382`"], "Output",
 CellChangeTimes->{{3.65099830888183*^9, 3.650998374741892*^9}, {
   3.6509984220993032`*^9, 3.65099843262022*^9}, 3.651912690264896*^9, 
   3.651912855103222*^9},ExpressionUUID->"bc90292e-eea3-4e91-a6e1-\
235f4455b02a"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["probK", "Subsubsection",
 CellChangeTimes->{{3.640575853609971*^9, 3.640575854841469*^9}, 
   3.649128915669261*^9, 
   3.6492263353876133`*^9},ExpressionUUID->"e529623c-cf92-4a2e-a974-\
98711aac5f16"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"probK", "::", "usage"}], "=", 
   "\"\<probK[{{{a},2},{{{b,c},3},\[Ellipsis]},\[Psi],\[Omega],\[Theta]] \
gives the probability of 2 mutations ancestral to {a}, and 3 to {b,c}. If \
arguments are omitted, then the probability is summed over these classes.  If \
a table of all the probabilities is needed, it is more efficient to use \
MakeProbTable[].\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.640575857554448*^9, 3.640575972609573*^9}, {
  3.640576701768317*^9, 3.640576757570215*^9}, {3.64057726704331*^9, 
  3.640577275143036*^9}, {3.640577498156272*^9, 3.640577518073368*^9}, {
  3.640578105150457*^9, 3.640578118606937*^9}, {3.648517944620528*^9, 
  3.6485179741139107`*^9}},ExpressionUUID->"d7b473c3-f65e-4562-b437-\
cd86a76d148b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"probK", "[", 
    RowBox[{
     RowBox[{"skl", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"_List", ",", "_Integer"}], "}"}], "..."}], "}"}]}], ",", 
     "\[Psi]_", ",", "\[Omega]_", ",", "\[Theta]_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"kl", ",", "rls"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rls", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Omega]", "[", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}], "\[Rule]", 
           RowBox[{"\[Theta]", "/", "2"}]}], ")"}], "&"}], "/@", "skl"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"kl", "=", 
       RowBox[{"Last", "/@", "skl"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "\[Theta]"}], "/", "2"}], ")"}], 
         RowBox[{"Total", "[", "kl", "]"}]], 
        RowBox[{"Times", "@@", 
         RowBox[{"(", 
          RowBox[{"kl", "!"}], ")"}]}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"\[Psi]", ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"(", 
              RowBox[{"skl", "/.", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"s_List", ",", "k_Integer"}], "}"}], ":>", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Omega]", "[", "s", "]"}], ",", "k"}], "}"}]}]}], 
              ")"}]}]}], "]"}], "/.", "rls"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Omega]", "[", "_", "]"}], "\[RuleDelayed]", "0"}], 
          "}"}]}], ")"}]}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.640574976988158*^9, 3.640575050272925*^9}, {
   3.6405757659529667`*^9, 3.64057580046292*^9}, {3.6405759845318832`*^9, 
   3.640576039309659*^9}, {3.640576178681705*^9, 3.640576194799762*^9}, {
   3.6405767690776176`*^9, 3.640576814437688*^9}, {3.640576864147874*^9, 
   3.64057693274968*^9}, {3.64057697945673*^9, 3.6405770057224817`*^9}, {
   3.640577059374259*^9, 3.640577060005611*^9}, 3.640577456911639*^9, {
   3.640578124936125*^9, 3.6405782642354317`*^9}, {3.6407960648829737`*^9, 
   3.64079607964119*^9}},ExpressionUUID->"4ae31ef3-601c-4c00-afb5-\
50ca9174d576"],

Cell[TextData[{
 StyleBox["Note: ",
  FontWeight->"Bold"],
 "probK calculates the probability of a configuration ",
 Cell[BoxData[
  FormBox[
   StyleBox["k",
    FontVariations->{"Underline"->True}], TraditionalForm]],ExpressionUUID->
  "b44cdaed-6619-4c2c-84ed-8c8323eba90c"],
 " by differentiating ",
 Cell[BoxData[
  FormBox[
   StyleBox["k",
    FontVariations->{"Underline"->True}], TraditionalForm]],ExpressionUUID->
  "484cf148-ac98-4c20-9f82-3dea018dd395"],
 " times. If a full table of probabilities is needed, then it might be more \
efficient to use ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 "\[CloseCurlyQuote]s built-in series expansion, and extract the \
coefficients.  However, this is not straightforward."
}], "Text",
 CellChangeTimes->{{3.6485185790391273`*^9, 3.6485186898045273`*^9}, {
  3.649242484013975*^9, 3.6492425143004704`*^9}, {3.650630814311474*^9, 
  3.650630816998567*^9}},ExpressionUUID->"4f7b54b1-d00a-4b22-a301-\
226a272fe5c9"]
}, Closed]],

Cell[CellGroupData[{

Cell["MakeProbTable", "Subsubsection",
 CellChangeTimes->{
  3.640843612060459*^9, 3.649128942665071*^9, {3.649226319023197*^9, 
   3.6492263301414413`*^9}},ExpressionUUID->"7ae74deb-b80f-4a70-a513-\
b80c00a9fbd1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeProbTable", "::", "usage"}], "=", 
   "\"\<MakeProbTable[GF,\[Omega],\[Theta],branches,{\!\(\*SubscriptBox[\(k\),\
 \(m, 1\)]\),\[Ellipsis]}] generates a sparse array that gives the \
probability of each possible mutation type. MakeProbTable[{GF,\[Ellipsis]},\
\[Omega],\[Theta],branches,{\!\(\*SubscriptBox[\(k\), \(m, \
1\)]\),\[Ellipsis]}] generates a list of tables, all with the same \
dimensions. Generates a large sparse array, with dimensions \[Product](2+\!\(\
\*SubscriptBox[\(k\), \(max, i\)]\)), where \!\(\*SubscriptBox[\(k\), \
\(m\)]\) defines the maximum number of mtations that are counted.  The last \
entry in each column gives the residual probability - that is, the index runs \
{0,,1,\[Ellipsis],\!\(\*SubscriptBox[\(k\), \(max\)]\),residual}.  This is \
calculated using adjustTable.  The table is arranged in the same order as the \
list of branches that is supplied. Replacing {\!\(\*SubscriptBox[\(k\), \(m, \
1\)]\),\[Ellipsis]} by an integer, \!\(\*SubscriptBox[\(k\), \(m\)]\), sets \
the same maximum number of loci across all branches. OldMethod\[Rule]False] \
is a slower version that uses a series expansion rather than the default \
option of direct differentiation.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.640842946382422*^9, 3.640842979503961*^9}, {
   3.640843484211329*^9, 3.640843600239127*^9}, {3.640843653371766*^9, 
   3.6408436548024893`*^9}, {3.640843975619087*^9, 3.640843977851286*^9}, 
   3.640846440528327*^9, {3.640855695745816*^9, 3.640855803052887*^9}, {
   3.6408678181959476`*^9, 3.640867841777218*^9}, {3.649128946638563*^9, 
   3.649128950457561*^9}, {3.649167512520542*^9, 3.6491675453024273`*^9}, {
   3.649167965229828*^9, 3.649168018551893*^9}, {3.6492176612988157`*^9, 
   3.649217671387586*^9}, {3.649217717663602*^9, 3.649217723374856*^9}, 
   3.64921788787681*^9, {3.649218526802175*^9, 3.649218554352854*^9}, {
   3.6493122600378313`*^9, 3.649312417789061*^9}, {3.6493378545483313`*^9, 
   3.64933788714596*^9}},ExpressionUUID->"257f838c-6e9f-4c4f-b727-\
e7db36b2bdd6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OldMethod", "::", "usage"}], "=", 
    "\"\<OldMethod is an option for MakeProbTable; OldMethod\[Rule]False \
specifies that a series expansion, raher than direct differentiation using \
probK should be used (the default).\>\""}], ";"}], " "}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.640843613640566*^9, 3.6408440045539017`*^9}, {
   3.640844184080473*^9, 3.6408444361997843`*^9}, {3.6408463756741533`*^9, 
   3.640846375842431*^9}, {3.640846417109716*^9, 3.64084641746902*^9}, 
   3.640846453150058*^9, {3.640856030726782*^9, 3.640856030910614*^9}, {
   3.640856195178887*^9, 3.640856258906266*^9}, {3.6408587176821337`*^9, 
   3.6408587179116993`*^9}, {3.640858775825757*^9, 3.6408588599546347`*^9}, {
   3.640858927425767*^9, 3.6408589337258043`*^9}, {3.640859490904359*^9, 
   3.640859499949051*^9}, {3.6408598118159647`*^9, 3.640859835277295*^9}, 
   3.640859936546945*^9, {3.6408600437577972`*^9, 3.6408600440769873`*^9}, {
   3.646987144262879*^9, 3.646987172381156*^9}, 3.649128948864154*^9, {
   3.6491468923576727`*^9, 3.6491469292640657`*^9}, {3.649149284780066*^9, 
   3.649149285476029*^9}, {3.64916794086471*^9, 3.6491679785814667`*^9}, {
   3.6492176124787493`*^9, 3.6492177283774433`*^9}, {3.64921892258916*^9, 
   3.649218980473569*^9}, {3.649225454712614*^9, 3.649225494078476*^9}, 
   3.6493123381168337`*^9},ExpressionUUID->"292ab3f1-23b6-4450-b4fa-\
23ea2fbbd897"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "MakeProbTable", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"OldMethod", "\[Rule]", "True"}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.640843613640566*^9, 3.6408440045539017`*^9}, {
   3.640844184080473*^9, 3.6408444361997843`*^9}, {3.6408463756741533`*^9, 
   3.640846375842431*^9}, {3.640846417109716*^9, 3.64084641746902*^9}, 
   3.640846453150058*^9, {3.640856030726782*^9, 3.640856030910614*^9}, {
   3.640856195178887*^9, 3.640856258906266*^9}, {3.6408587176821337`*^9, 
   3.6408587179116993`*^9}, {3.640858775825757*^9, 3.6408588599546347`*^9}, {
   3.640858927425767*^9, 3.6408589337258043`*^9}, {3.640859490904359*^9, 
   3.640859499949051*^9}, {3.6408598118159647`*^9, 3.640859835277295*^9}, 
   3.640859936546945*^9, {3.6408600437577972`*^9, 3.6408600440769873`*^9}, {
   3.646987144262879*^9, 3.646987172381156*^9}, 3.649128948864154*^9, {
   3.6491468923576727`*^9, 3.6491469292640657`*^9}, {3.649149284780066*^9, 
   3.649149285476029*^9}, {3.64916794086471*^9, 3.6491679785814667`*^9}, {
   3.6492176124787493`*^9, 3.6492177283774433`*^9}, {3.649225478306301*^9, 
   3.649225478813648*^9}},ExpressionUUID->"d6504437-c2d7-4085-bdbb-\
65b09f0715e2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeProbTable", "::", "badList"}], "=", 
   "\"\<The list `1` of maximum numbers of mutations must have length equal \
to the list of branches, `2`.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.640843613640566*^9, 3.6408440045539017`*^9}, {
   3.640844184080473*^9, 3.6408444361997843`*^9}, {3.6408463756741533`*^9, 
   3.640846375842431*^9}, {3.640846417109716*^9, 3.64084641746902*^9}, 
   3.640846453150058*^9, {3.640856030726782*^9, 3.640856030910614*^9}, {
   3.640856195178887*^9, 3.640856258906266*^9}, {3.6408587176821337`*^9, 
   3.6408587179116993`*^9}, {3.640858775825757*^9, 3.6408588599546347`*^9}, {
   3.640858927425767*^9, 3.6408589337258043`*^9}, {3.640859490904359*^9, 
   3.640859499949051*^9}, {3.6408598118159647`*^9, 3.640859835277295*^9}, 
   3.640859936546945*^9, {3.6408600437577972`*^9, 3.6408600440769873`*^9}, {
   3.646987144262879*^9, 3.646987172381156*^9}, 3.649128948864154*^9, {
   3.6491468923576727`*^9, 3.6491469292640657`*^9}, {3.649149284780066*^9, 
   3.649149285476029*^9}, {3.64916794086471*^9, 3.6491679785814667`*^9}, {
   3.6492176124787493`*^9, 3.6492177283774433`*^9}, {3.649218573728085*^9, 
   3.649218660232098*^9}, {3.6493124941855497`*^9, 
   3.649312503892152*^9}},ExpressionUUID->"7f4214ba-f918-4175-9968-\
e4df55e0e068"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeProbTable", "::", "badBranches"}], "=", 
   "\"\<The branches represented in the GF, `1` are not a subset of the \
supplied list of brancheslist of branches, `2`.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.640843613640566*^9, 3.6408440045539017`*^9}, {
   3.640844184080473*^9, 3.6408444361997843`*^9}, {3.6408463756741533`*^9, 
   3.640846375842431*^9}, {3.640846417109716*^9, 3.64084641746902*^9}, 
   3.640846453150058*^9, {3.640856030726782*^9, 3.640856030910614*^9}, {
   3.640856195178887*^9, 3.640856258906266*^9}, {3.6408587176821337`*^9, 
   3.6408587179116993`*^9}, {3.640858775825757*^9, 3.6408588599546347`*^9}, {
   3.640858927425767*^9, 3.6408589337258043`*^9}, {3.640859490904359*^9, 
   3.640859499949051*^9}, {3.6408598118159647`*^9, 3.640859835277295*^9}, 
   3.640859936546945*^9, {3.6408600437577972`*^9, 3.6408600440769873`*^9}, {
   3.646987144262879*^9, 3.646987172381156*^9}, 3.649128948864154*^9, {
   3.6491468923576727`*^9, 3.6491469292640657`*^9}, {3.649149284780066*^9, 
   3.649149285476029*^9}, {3.64916794086471*^9, 3.6491679785814667`*^9}, {
   3.6492176124787493`*^9, 3.6492177283774433`*^9}, {3.649218573728085*^9, 
   3.649218660232098*^9}, {3.6493124941855497`*^9, 3.649312503892152*^9}, {
   3.649312596688553*^9, 3.649312597780368*^9}, {3.649312663992964*^9, 
   3.649312684140029*^9}},ExpressionUUID->"74916e1f-463f-46a6-a3e8-\
174ddd8ed764"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MakeProbTable", "[", 
    RowBox[{
    "gf_", ",", "\[Omega]_", ",", "\[Theta]_", ",", "branches_List", ",", 
     "km_Integer", ",", "opts___Rule"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"MakeProbTable", "[", 
    RowBox[{"gf", ",", "\[Omega]", ",", "\[Theta]", ",", "branches", ",", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"km", ",", 
       RowBox[{"Length", "[", "branches", "]"}]}], "]"}], ",", "opts"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeProbTable", "[", 
    RowBox[{
    "gf_", ",", "\[Omega]_", ",", "\[Theta]_", ",", "branches_List", ",", 
     RowBox[{"km", ":", 
      RowBox[{"{", "__Integer", "}"}]}], ",", "opts___Rule"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"ListQ", "[", "gf", "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"MakeProbTable", "[", 
        RowBox[{
        "#", ",", "\[Omega]", ",", "\[Theta]", ",", "branches", ",", "km", 
         ",", "opts"}], "]"}], "&"}], "/@", "gf"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"configs", "=", 
          RowBox[{"GetConfigsGF", "[", 
           RowBox[{"gf", ",", "\[Omega]"}], "]"}]}], ",", "posn", ",", "nc", 
         ",", "tt"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "km", "]"}], "\[NotEqual]", 
           RowBox[{"Length", "[", "branches", "]"}]}], ",", 
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"MakeProbTable", "::", "badList"}], ",", "km", ",", 
            "branches"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"SubsetQ", "[", 
            RowBox[{"branches", ",", "configs"}], "]"}]}], ",", 
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"MakeProbTable", "::", "badBranches"}], ",", "configs", 
            ",", "branches"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"posn", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"branches", ",", "#"}], "]"}], "&"}], "/@", "configs"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tt", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"OldMethod", "/.", 
             RowBox[{"{", "opts", "}"}]}], "/.", 
            RowBox[{"Options", "[", "MakeProbTable", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nc", "=", 
             RowBox[{"Length", "[", "configs", "]"}]}], ";", 
            RowBox[{"(*", " ", 
             RowBox[{
             "number", " ", "of", " ", "configurations", " ", "that", " ", 
              "appear", " ", "in", " ", "this", " ", "GF"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"adjustTable", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Array", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"probK", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"MapThread", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"#2", "\[Equal]", 
                    RowBox[{"#3", "+", "1"}]}], ",", "Null", ",", 
                    RowBox[{"{", 
                    RowBox[{"#1", ",", "#2"}], "}"}]}], "]"}], "&"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"configs", ",", 
                    RowBox[{"{", "##", "}"}], ",", 
                    RowBox[{
                    "km", "\[LeftDoubleBracket]", "posn", 
                    "\[RightDoubleBracket]"}]}], "}"}]}], "]"}], ",", 
                    "Null"}], "]"}], ",", "gf", ",", "\[Omega]", ",", 
                   "\[Theta]"}], "]"}], "&"}], ",", 
                RowBox[{
                 RowBox[{
                 "km", "\[LeftDoubleBracket]", "posn", 
                  "\[RightDoubleBracket]"}], "+", "2"}], ",", "0"}], "]"}], 
              ",", "nc"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"Fold", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"MakeProbTableOnce", "[", 
               RowBox[{"#1", ",", 
                RowBox[{"\[Omega]", "[", 
                 RowBox[{
                 "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                  "]"}], ",", "\[Theta]", ",", 
                RowBox[{
                "#2", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}]}], "]"}], "&"}], ",", "gf", ",", 
             RowBox[{"Transpose", "[", 
              RowBox[{"{", 
               RowBox[{"configs", ",", 
                RowBox[{
                "km", "\[LeftDoubleBracket]", "posn", 
                 "\[RightDoubleBracket]"}]}], "}"}], "]"}]}], "]"}]}], 
          "]"}]}], ";", 
        RowBox[{"EmbedTable", "[", 
         RowBox[{"tt", ",", "posn", ",", "1", ",", 
          RowBox[{"km", "+", "2"}]}], "]"}]}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.640843613640566*^9, 3.6408440045539017`*^9}, {
   3.640844184080473*^9, 3.6408444361997843`*^9}, {3.6408463756741533`*^9, 
   3.640846375842431*^9}, {3.640846417109716*^9, 3.64084641746902*^9}, 
   3.640846453150058*^9, {3.640856030726782*^9, 3.640856030910614*^9}, {
   3.640856195178887*^9, 3.640856258906266*^9}, {3.6408587176821337`*^9, 
   3.6408587179116993`*^9}, {3.640858775825757*^9, 3.6408588599546347`*^9}, {
   3.640858927425767*^9, 3.6408589337258043`*^9}, {3.640859490904359*^9, 
   3.640859499949051*^9}, {3.6408598118159647`*^9, 3.640859835277295*^9}, 
   3.640859936546945*^9, {3.6408600437577972`*^9, 3.6408600440769873`*^9}, {
   3.646987144262879*^9, 3.646987172381156*^9}, 3.649128948864154*^9, {
   3.6491468923576727`*^9, 3.6491469292640657`*^9}, {3.649149284780066*^9, 
   3.649149285476029*^9}, {3.64916794086471*^9, 3.6491679785814667`*^9}, {
   3.6492176124787493`*^9, 3.649217678577755*^9}, {3.649217739629674*^9, 
   3.649217805642517*^9}, {3.649217896010532*^9, 3.6492178989198*^9}, {
   3.649218440708651*^9, 3.649218500908229*^9}, {3.649218665769054*^9, 
   3.649218702325425*^9}, {3.64921873852604*^9, 3.6492187640430813`*^9}, {
   3.649218854614504*^9, 3.6492189030389223`*^9}, {3.649219012872717*^9, 
   3.649219013446093*^9}, {3.649219204846094*^9, 3.649219222812841*^9}, {
   3.649219297194681*^9, 3.649219297523354*^9}, 3.6492196456874313`*^9, {
   3.649220163095214*^9, 3.649220176465498*^9}, 3.649220213567402*^9, {
   3.649220973217045*^9, 3.649220976632799*^9}, {3.649221185733904*^9, 
   3.649221189334671*^9}, {3.649221232430057*^9, 3.649221246188863*^9}, {
   3.649221500631833*^9, 3.649221504208709*^9}, {3.649221679825261*^9, 
   3.649221685275629*^9}, {3.649221756994583*^9, 3.649221759247026*^9}, {
   3.6492218290537977`*^9, 3.649221834134694*^9}, {3.649221901883892*^9, 
   3.649221903659176*^9}, {3.649221950446435*^9, 3.649221958028754*^9}, {
   3.649221997746375*^9, 3.649222000675515*^9}, {3.649222573624805*^9, 
   3.6492225745446463`*^9}, {3.649224702508026*^9, 3.6492247054152393`*^9}, {
   3.649225101572669*^9, 3.64922510529937*^9}, {3.6492979200154543`*^9, 
   3.649297944360058*^9}, 3.649299483066648*^9, {3.6493124254441032`*^9, 
   3.649312483264617*^9}, {3.649312514814398*^9, 3.649312518573333*^9}, {
   3.649312585040079*^9, 3.6493126574163113`*^9}, {3.649337950788828*^9, 
   3.649337998577237*^9}},ExpressionUUID->"fdb64229-669f-4f38-afef-\
32d735f4e26a"]
}, Closed]],

Cell[CellGroupData[{

Cell["configList", "Subsubsection",
 CellChangeTimes->{
  3.640843612060459*^9, {3.646996888966198*^9, 3.646996890957553*^9}, {
   3.6473386005051003`*^9, 3.647338600769195*^9}, {3.647340515234117*^9, 
   3.6473405301537313`*^9}},ExpressionUUID->"58be12b6-a7f5-4608-8724-\
e7ba23e3ed91"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"configList", "::", "usage"}], "=", 
   "\"\<configList[t,\!\(\*SubscriptBox[\(k\), \(max\)]\)] generates a list \
of mutational configurations for a given list of maximum # of mutations per \
branch category, and a list of the position of each branch category. Used in \
likFullTab.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.64699691949686*^9, 3.646997026193758*^9}, {
  3.6473385895040627`*^9, 3.64733860882931*^9}, {3.647338702144648*^9, 
  3.64733871715695*^9}, {3.6473387480627823`*^9, 3.6473389722224092`*^9}, {
  3.647339018781226*^9, 3.647339251679962*^9}, {3.6473403910833817`*^9, 
  3.647340424286619*^9}, {3.6473404545607967`*^9, 3.64734049295327*^9}, {
  3.6473405354568863`*^9, 3.6473405399152117`*^9}, {3.647340571654387*^9, 
  3.647340704268957*^9}, {3.648386699437415*^9, 3.64838678549026*^9}, {
  3.650787288633347*^9, 3.65078728876893*^9}, {3.6509532371898127`*^9, 
  3.6509532384057693`*^9}, {3.65191262519098*^9, 
  3.651912636231586*^9}},ExpressionUUID->"20ba28fb-9d25-4ea4-8bd5-\
c1ea608d18c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"configList", "[", 
   RowBox[{"t_List", ",", "inc_", ",", "kmax_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ll", "=", 
       RowBox[{"Length", "[", "t", "]"}]}], ",", 
      RowBox[{"max", "=", 
       RowBox[{
       "kmax", "\[LeftDoubleBracket]", "t", "\[RightDoubleBracket]"}]}], ",", 
      "cons", ",", "int"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"t", "\[Equal]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{
         RowBox[{"kmax", "+", "1"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "\[Rule]", "0"}], ")"}], "&"}], "/@", "inc"}]}], 
        "]"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cons", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{
          RowBox[{"kmax", "+", "1"}], ",", 
          RowBox[{"Times", "@@", 
           RowBox[{"(", 
            RowBox[{"max", "+", "1"}], ")"}]}]}], "]"}]}], ";", 
       RowBox[{"int", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Array", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", "##", "}"}], "&"}], ",", 
            RowBox[{"max", "+", "1"}], ",", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"0", ",", "ll"}], "]"}]}], "]"}], ",", 
          RowBox[{"ll", "-", "1"}]}], "]"}]}], ";", 
       RowBox[{
        RowBox[{
         RowBox[{"ReplacePart", "[", 
          RowBox[{"#", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#", "\[Rule]", "0"}], ")"}], "&"}], "/@", "inc"}]}], 
          "]"}], "&"}], "/@", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"ReplacePart", "[", 
           RowBox[{
            RowBox[{
            "cons", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "t", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
               "\[Rule]", 
               RowBox[{"int", "\[LeftDoubleBracket]", 
                RowBox[{"k", ",", "i"}], "\[RightDoubleBracket]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "ll"}], "}"}]}], "]"}]}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", 
            RowBox[{"Length", "[", "int", "]"}]}], "}"}]}], "]"}]}]}]}], 
     "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.647166342181245*^9, 3.6471663474634542`*^9}, {
   3.6471669885683107`*^9, 3.647167006580386*^9}, {3.647167058704328*^9, 
   3.6471670624245462`*^9}, {3.6471671383918877`*^9, 
   3.6471671408289003`*^9}, {3.647167293579582*^9, 3.6471673990736017`*^9}, {
   3.647167451858838*^9, 3.6471674799142857`*^9}, {3.647167547958448*^9, 
   3.647167595196581*^9}, {3.647168034042964*^9, 3.647168273717764*^9}, {
   3.647168793190795*^9, 3.647168794393621*^9}, {3.647169835511437*^9, 
   3.647169836413589*^9}, {3.647334880721826*^9, 3.6473349027484007`*^9}, {
   3.6473349487893553`*^9, 3.647334962273172*^9}, {3.6473350325353537`*^9, 
   3.6473350358336287`*^9}, {3.647335133361023*^9, 3.647335133951318*^9}, 
   3.647335438673526*^9, {3.647335702489097*^9, 3.647335720345462*^9}, {
   3.647335915938603*^9, 3.647335937118229*^9}, {3.6473360765273323`*^9, 
   3.647336093029459*^9}, {3.64733615698783*^9, 3.647336172423401*^9}, {
   3.647336456235839*^9, 3.6473364815343733`*^9}, {3.647337442209908*^9, 
   3.6473375575221*^9}, 3.64733846147898*^9, {3.647340461008237*^9, 
   3.6473404737641773`*^9}, {3.64734053660075*^9, 3.6473405616215467`*^9}, {
   3.650792680326683*^9, 3.650792682791231*^9}, 3.650792744630178*^9, {
   3.650792807216866*^9, 3.650792810210128*^9}, {3.6507930038004217`*^9, 
   3.650793007991091*^9}, {3.650793078248457*^9, 3.6507930957087593`*^9}, {
   3.650793128041637*^9, 3.650793216707423*^9}, {3.650793574551094*^9, 
   3.6507935903779984`*^9}, {3.650801767013875*^9, 
   3.650801789336967*^9}},ExpressionUUID->"3ee62d10-4ecb-44d2-be31-\
20eef5574880"]
}, Closed]],

Cell[CellGroupData[{

Cell["likFullTab", "Subsubsection",
 CellChangeTimes->{
  3.640843612060459*^9, {3.646996888966198*^9, 3.646996890957553*^9}, {
   3.6473386005051003`*^9, 
   3.647338600769195*^9}},ExpressionUUID->"45a5a948-b581-450d-a579-\
ea55cc1dbfb4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"likFullTab", "::", "usage"}], "=", 
   "\"\<likFullTab[GF,\[Omega],\[Theta],{m->m1,T1->t1...},\!\(\*SubscriptBox[\
\(k\), \(max\)]\)_List] generates a sparse array that gives the probability \
of \!\(\*SubscriptBox[\(k\), \(i\)]\) of each possible mutation type. The \
input is a nested list of GF terms, each corresponding to a different \
equivalence class. The list \!\(\*SubscriptBox[\(k\), \(max\)]\) gives the \
maximum number of mutations on each branch type. The output has dimensions \
Times@@(2+\!\(\*SubscriptBox[\(k\), \(max\)]\)). The number of branch types \
that the GF distinguishes (which must match the length of \!\(\*SubscriptBox[\
\(k\), \(max\)]\)) defines the number of types of mutations. The last entry \
in each column gives the residual probability - that is, the index runs {0,1,\
\[Ellipsis],\!\(\*SubscriptBox[\(k\), \(max\)]\),residual}.  This is \
calculated using adjustTable.  The table is arranged in the same order as the \
list of \[Omega] indices of the GF. likFullTab works regardless of whether \
the \[Omega] variables of the GF correpsond to rooted branches or to \
combinations of branches.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.64699691949686*^9, 3.646997026193758*^9}, {
  3.6473385895040627`*^9, 3.64733860882931*^9}, {3.647338702144648*^9, 
  3.64733871715695*^9}, {3.6473387480627823`*^9, 3.6473389722224092`*^9}, {
  3.647339018781226*^9, 3.647339251679962*^9}, {3.648386815874333*^9, 
  3.64838684487565*^9}},ExpressionUUID->"15383b5d-76dd-4f65-9fce-\
04bcbad20af3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"likFullTab", "[", 
    RowBox[{
    "gf_", ",", "\[Omega]_", ",", "\[Theta]_", ",", "rlznum_List", ",", 
     "max_Integer"}], "]"}], ":=", 
   RowBox[{"likFullTab", "[", 
    RowBox[{"gf", ",", "\[Omega]", ",", "\[Theta]", ",", "rlznum", ",", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"max", ",", 
       RowBox[{
        RowBox[{"GetConfigsGF", "[", 
         RowBox[{
          RowBox[{"Total", "[", "gf", "]"}], ",", "\[Omega]"}], "]"}], "//", 
        "Length"}]}], "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.647338145665587*^9, 3.6473382441363564`*^9}, {
   3.647338381218483*^9, 3.647338385600809*^9}, {3.647338463299004*^9, 
   3.647338469830686*^9}, {3.647338517843924*^9, 3.647338520216961*^9}, {
   3.6473386116056957`*^9, 3.647338629202236*^9}, 
   3.651912789449492*^9},ExpressionUUID->"826d953d-6262-4727-8484-\
edc65b841b58"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"likFullTab", "[", 
    RowBox[{
    "gf_", ",", "\[Omega]_", ",", "\[Theta]_", ",", "rlznum_List", ",", 
     "max_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ngf", ",", "\[Omega]s", ",", "\[Omega]slen", ",", "\[Omega]sall", ",", 
       "pos\[Omega]s", ",", "ncall", ",", "\[Omega]ssub", ",", "incomp", ",", 
       "posnincomp", ",", "maxsub", ",", "posn", ",", "liktab", ",", "pl", 
       ",", "tbl"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ngf", "=", 
       RowBox[{"Length", "[", "gf", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Omega]s", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"GetConfigsGF", "[", 
          RowBox[{"#", ",", "\[Omega]"}], "]"}], "&"}], "/@", "gf"}]}], 
      RowBox[{"(*", " ", 
       RowBox[{
       "number", " ", "of", " ", "configurations", " ", "that", " ", "appear",
         " ", "in", " ", "the", " ", "GF", " ", "for", " ", "each", " ", 
        "equivalence", " ", "class"}], " ", "*)"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Omega]slen", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "#", "]"}], "&"}], "/@", "\[Omega]s"}]}], 
      RowBox[{"(*", " ", 
       RowBox[{
       "number", " ", "of", " ", "\[Omega]", " ", "terms", " ", "in", " ", 
        "each", " ", "equivalence", " ", "class"}], "*)"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Omega]sall", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"\[Omega]s", ",", "1"}], "]"}], "//", "Union"}], "//", 
        "Sort"}]}], 
      RowBox[{"(*", " ", 
       RowBox[{
       "the", " ", "total", " ", "list", " ", "of", " ", "\[Omega]", " ", 
        "terms"}], "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"pos\[Omega]s", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"\[Omega]sall", ",", "#"}], "]"}], "&"}], "/@", 
           RowBox[{
           "\[Omega]s", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "ngf"}], "}"}]}], "]"}]}], " ", ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ncall", "=", 
       RowBox[{"Length", "[", "\[Omega]sall", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Omega]ssub", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Subsets", "[", 
             RowBox[{"#", ",", 
              RowBox[{"{", "n", "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "0", ",", 
              RowBox[{"Length", "[", "#", "]"}]}], "}"}]}], "]"}], ")"}], 
         "&"}], "/@", "\[Omega]s"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"incomp", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Complement", "[", 
          RowBox[{"\[Omega]sall", ",", "#"}], "]"}], "&"}], "/@", 
        "\[Omega]s"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"posnincomp", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"\[Omega]sall", ",", "#"}], "]"}], "&"}], "/@", 
           RowBox[{
           "incomp", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}],
           "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "ngf"}], "}"}]}], "]"}]}], " ", 
      RowBox[{"(*", " ", 
       RowBox[{"the", " ", "position", " ", "of", " ", "incompatible", " ", 
        RowBox[{"branches", ".", " ", "Needs"}], " ", "testing", " ", "for", 
        " ", "cases", " ", "with", " ", "multiple", " ", "incompatible", " ", 
        "branches"}], "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"posn", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"\[Omega]sall", ",", "#"}], "]"}], "&"}], "/@", 
             RowBox[{"\[Omega]ssub", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "k", ",", "o"}], "\[RightDoubleBracket]"}]}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"o", ",", "1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"\[Omega]ssub", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "k"}], "\[RightDoubleBracket]"}], "]"}]}], 
            "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "ngf"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{
            RowBox[{
            "\[Omega]ssub", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], "//", "Length"}]}], "}"}]}], "]"}]}], 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"pos", "'"}], "ns", " ", "of", " ", "the", " ", "\[Omega]", 
        " ", "terms", " ", "of", " ", "each", " ", "equivalence", " ", 
        "class", " ", "in", " ", "\[Omega]sall"}], "*)"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"liktab", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"likFullG", "[", 
             RowBox[{
              RowBox[{"Total", "[", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                "gf", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
                "]"}], "]"}], ",", "\[Omega]", ",", "\[Theta]", ",", "rlznum",
               ",", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{"max", "\[LeftDoubleBracket]", 
               RowBox[{
               "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               "\[RightDoubleBracket]"}]}], "]"}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\[Omega]ssub", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "k"}], "\[RightDoubleBracket]"}], ",", 
               RowBox[{"posn", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "k"}], "\[RightDoubleBracket]"}]}], "}"}], "//",
              "Thread"}], ")"}]}], ")"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "ngf"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{
            RowBox[{
            "\[Omega]ssub", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], "//", "Length"}]}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"pl", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"configList", "[", 
                RowBox[{"#", ",", 
                 RowBox[{
                 "posnincomp", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], ",", "max"}], "]"}], "&"}], "/@", 
              RowBox[{"posn", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "k"}], "\[RightDoubleBracket]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "1", ",", 
               RowBox[{"Length", "[", 
                RowBox[{
                "\[Omega]ssub", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}], ",", 
           "2"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "ngf"}], "}"}]}], "]"}]}], 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "all", " ", "the", " ", "numbers", " ", "of", " ", "mutations", " ", 
         "that", " ", "will", " ", "be", " ", "tabulated"}], ";", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "\[Ellipsis]"}], "}"}], "\[Ellipsis]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["k", "max"], "+", "1"}], ",", 
           RowBox[{
            SubscriptBox["k", "max"], "+", "1"}], ",", "\[Ellipsis]"}], 
          "}"}]}]}], " ", "*)"}], ";", 
      RowBox[{"tbl", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{
              "pl", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
             ")"}], "\[Rule]", 
            RowBox[{"Flatten", "[", 
             RowBox[{
             "liktab", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
              "]"}]}], ",", 
           RowBox[{"max", "+", "2"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "ngf"}], "}"}]}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Fold", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"adjustTable", "[", 
             RowBox[{"#1", ",", "ncall", ",", "#2"}], "]"}], "&"}], ",", 
           RowBox[{
           "tbl", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], ",", 
           RowBox[{
           "pos\[Omega]s", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "ngf"}], "}"}]}], "]"}], "//", 
       "Total"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.646999694198812*^9, 3.646999699205809*^9}, {
   3.646999733368986*^9, 3.64699975376783*^9}, {3.646999783806697*^9, 
   3.6469998740693073`*^9}, {3.646999948857514*^9, 3.64699999664685*^9}, {
   3.647000077713526*^9, 3.6470000821592083`*^9}, {3.64700013785821*^9, 
   3.6470001678952503`*^9}, {3.647000248657558*^9, 3.647000269798664*^9}, {
   3.647000336809198*^9, 3.647000361909875*^9}, {3.647000411112555*^9, 
   3.647000411887237*^9}, {3.647000459864732*^9, 3.647000509744171*^9}, 
   3.6470005568888273`*^9, {3.647000846368985*^9, 3.6470010037044907`*^9}, {
   3.64700103652593*^9, 3.647001054742362*^9}, {3.647001112833459*^9, 
   3.647001141453126*^9}, {3.647001373697934*^9, 3.6470013779525843`*^9}, {
   3.647001649971034*^9, 3.647001660904386*^9}, {3.647001784321681*^9, 
   3.647001815995585*^9}, {3.647164259688438*^9, 3.647164267598893*^9}, {
   3.64716439689613*^9, 3.647164397185411*^9}, {3.647164467376635*^9, 
   3.647164520882172*^9}, {3.647164640524675*^9, 3.647164731569147*^9}, {
   3.647164824772159*^9, 3.6471648249387074`*^9}, {3.647164950136999*^9, 
   3.647164950410798*^9}, {3.647165175204102*^9, 3.6471651845074244`*^9}, {
   3.64716522289992*^9, 3.647165227634326*^9}, 3.647165504603722*^9, {
   3.647165850302162*^9, 3.6471658915551643`*^9}, {3.64716594228288*^9, 
   3.647165944333393*^9}, {3.647165983386935*^9, 3.647166026228815*^9}, {
   3.647168379136921*^9, 3.647168532255859*^9}, {3.6471685683832493`*^9, 
   3.6471686147406883`*^9}, {3.6471692609590073`*^9, 3.647169265310739*^9}, {
   3.6471698904323587`*^9, 3.647169895754849*^9}, {3.647170254910697*^9, 
   3.647170285777377*^9}, {3.647170336119816*^9, 3.647170374326193*^9}, {
   3.6471704275381536`*^9, 3.647170428172353*^9}, {3.647170488002996*^9, 
   3.647170488247666*^9}, {3.647170545484482*^9, 3.64717054598533*^9}, {
   3.647171484630142*^9, 3.64717150104739*^9}, {3.647171537384294*^9, 
   3.647171547625598*^9}, {3.647172957631122*^9, 3.647172958190346*^9}, {
   3.647173119009375*^9, 3.647173119468638*^9}, {3.647173873627705*^9, 
   3.64717388193449*^9}, {3.647173946188039*^9, 3.6471740219187*^9}, {
   3.647174125867103*^9, 3.6471741271023407`*^9}, {3.6471742689102077`*^9, 
   3.647174276731292*^9}, {3.6471743424079037`*^9, 3.6471743430750237`*^9}, {
   3.647174374589192*^9, 3.64717437572381*^9}, {3.647323785167253*^9, 
   3.647323785740099*^9}, {3.6473238405846252`*^9, 3.64732385079364*^9}, {
   3.6473239595140142`*^9, 3.6473239641235332`*^9}, {3.6473240899633102`*^9, 
   3.647324096527877*^9}, 3.647324137133547*^9, {3.6473242766185017`*^9, 
   3.647324288380994*^9}, {3.647324318768508*^9, 3.64732432528957*^9}, {
   3.6473243864202957`*^9, 3.647324403744296*^9}, {3.647327416249199*^9, 
   3.647327443984063*^9}, {3.647327567633492*^9, 3.647327611776092*^9}, 
   3.647327654585545*^9, {3.647327821241805*^9, 3.647327823630947*^9}, {
   3.647327881018456*^9, 3.647327912544376*^9}, {3.647327988057973*^9, 
   3.6473279912223454`*^9}, {3.647328136434957*^9, 3.647328149699154*^9}, {
   3.64732818859144*^9, 3.647328232367217*^9}, 3.647328266357609*^9, {
   3.647328310743718*^9, 3.64732832056944*^9}, {3.6473284478412037`*^9, 
   3.647328513991837*^9}, {3.647328557302349*^9, 3.647328559303042*^9}, {
   3.647328613226514*^9, 3.6473286215853567`*^9}, {3.647328863266204*^9, 
   3.647328868788961*^9}, {3.6473289278387136`*^9, 3.647328949348317*^9}, {
   3.6473290989006433`*^9, 3.64732912978792*^9}, {3.647329166819146*^9, 
   3.6473292231384773`*^9}, {3.647329358522621*^9, 3.647329360153625*^9}, {
   3.647329536668895*^9, 3.647329593918495*^9}, {3.647329662260867*^9, 
   3.647329733013123*^9}, {3.647329820821498*^9, 3.647329831067614*^9}, 
   3.64732990167262*^9, {3.647330085575831*^9, 3.647330085852416*^9}, {
   3.647330488029483*^9, 3.647330496563244*^9}, {3.647330893630772*^9, 
   3.647330925158643*^9}, {3.647330963883587*^9, 3.647330984691245*^9}, 
   3.6473311570263653`*^9, {3.647331573107263*^9, 3.6473316189478283`*^9}, {
   3.647331682851508*^9, 3.647331683299878*^9}, 3.6473322267681627`*^9, {
   3.64733227063888*^9, 3.647332279995716*^9}, {3.647332321844604*^9, 
   3.647332329433634*^9}, {3.6473323761997643`*^9, 3.6473324000890627`*^9}, {
   3.647333031479281*^9, 3.647333034120994*^9}, {3.64733343605237*^9, 
   3.647333437834935*^9}, {3.6473362672092133`*^9, 3.647336338270705*^9}, {
   3.647336368328807*^9, 3.647336380081468*^9}, {3.647336520009848*^9, 
   3.6473365208903723`*^9}, {3.647336688602449*^9, 3.647336691369361*^9}, {
   3.6473367806348267`*^9, 3.64733678662638*^9}, 3.647336979786607*^9, {
   3.647337041645657*^9, 3.647337052287118*^9}, {3.6473372336670637`*^9, 
   3.647337247252804*^9}, {3.647337585081506*^9, 3.6473375887308493`*^9}, {
   3.647337647827881*^9, 3.647337653223679*^9}, {3.64733771324889*^9, 
   3.647337734597793*^9}, {3.647337768602174*^9, 3.647337801753202*^9}, {
   3.647337880916542*^9, 3.647337891932749*^9}, {3.647337978908676*^9, 
   3.647338015080077*^9}, {3.647338464850338*^9, 3.6473384738093576`*^9}, {
   3.647338526292845*^9, 3.6473385282630243`*^9}, {3.6473386143454237`*^9, 
   3.647338615037263*^9}, 3.64734054627009*^9, {3.648462012676056*^9, 
   3.648462015807753*^9}, {3.650785898017173*^9, 3.650785901613495*^9}, {
   3.650787065926499*^9, 3.650787085730665*^9}, {3.650787166725665*^9, 
   3.65078716902384*^9}, {3.650787323569665*^9, 3.650787328570817*^9}, {
   3.650787537054475*^9, 3.65078753894083*^9}, 3.650787811559497*^9, {
   3.6507879160281363`*^9, 3.6507879255594473`*^9}, {3.6507890262072153`*^9, 
   3.650789048185934*^9}, {3.650790499763439*^9, 3.6507905054416227`*^9}, {
   3.650791121387022*^9, 3.650791143968557*^9}, {3.650791371801806*^9, 
   3.650791394949217*^9}, {3.65079189031695*^9, 3.650791893242444*^9}, {
   3.65079231354805*^9, 3.6507923836816063`*^9}, {3.650792437023883*^9, 
   3.6507924489869328`*^9}, {3.650792493267108*^9, 3.6507925110031223`*^9}, {
   3.650793679981207*^9, 3.650793691672586*^9}, {3.650793858976*^9, 
   3.650793972133478*^9}, {3.6507940753225117`*^9, 3.6507940858211403`*^9}, {
   3.650794118183001*^9, 3.650794174242344*^9}, {3.650794208188161*^9, 
   3.650794264359066*^9}, 3.650794346129849*^9, {3.650794411402812*^9, 
   3.6507944234808903`*^9}, {3.650794455958054*^9, 3.650794457303186*^9}, {
   3.650794522199183*^9, 3.650794530683717*^9}, {3.650794624359249*^9, 
   3.650794627499577*^9}, {3.6507949358911133`*^9, 3.650794945011621*^9}, 
   3.650795023443923*^9, {3.6507951295373*^9, 3.650795143350634*^9}, {
   3.650796653898604*^9, 3.650796655110881*^9}, {3.650797297670133*^9, 
   3.65079737856802*^9}, {3.650798325502877*^9, 3.650798370478055*^9}, {
   3.650798421977187*^9, 3.650798521053834*^9}, {3.650798608048497*^9, 
   3.650798612638813*^9}, {3.650798664131281*^9, 3.650798695110613*^9}, {
   3.650798737542169*^9, 3.650798763466545*^9}, {3.650798826272719*^9, 
   3.650798855427639*^9}, {3.650798981965352*^9, 3.6507990126326714`*^9}, {
   3.650799346738221*^9, 3.650799438369308*^9}, 3.650801253397636*^9, {
   3.650801362275193*^9, 3.650801367859193*^9}, {3.650801462717532*^9, 
   3.650801463280117*^9}, {3.650801930294503*^9, 3.650801934078467*^9}, {
   3.6508020314832582`*^9, 3.650802035722443*^9}, 3.6508713838693542`*^9, 
   3.651912792713731*^9},ExpressionUUID->"66476913-6ee5-4e55-b9b6-\
f514ba0140d3"]
}, Closed]],

Cell[CellGroupData[{

Cell["totallnL", "Subsubsection",
 CellChangeTimes->{3.640591636424046*^9, 3.649129188878124*^9, 
  3.649228879287122*^9, 3.6508725181581297`*^9, 
  3.651224522293035*^9},ExpressionUUID->"0add48fe-5d60-40a0-b043-\
2005b606edf2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"totallnL", "[", 
    RowBox[{"gf_", ",", "\[Omega]_", ",", 
     RowBox[{"\[Theta]_", "?", "NumberQ"}], ",", "rlznum_List", ",", 
     "max_List", ",", "counts_SparseArray"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"probTab", ",", "posn"}], "}"}], ",", 
     RowBox[{
      RowBox[{"probTab", "=", 
       RowBox[{"likFullTab", "[", 
        RowBox[{
        "gf", ",", "\[Omega]", ",", "\[Theta]", ",", "rlznum", ",", "max"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"posn", "=", 
       RowBox[{"probTab", "[", "\"\<NonzeroPositions\>\"", "]"}]}], ";", 
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{"Log", "[", 
         RowBox[{"probTab", "[", "\"\<NonzeroValues\>\"", "]"}], "]"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Extract", "[", 
            RowBox[{"counts", ",", "#"}], "]"}], "&"}], "/@", "posn"}], 
         ")"}]}], "]"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650784746197983*^9, 3.650784768430999*^9}, 
   3.65079958481174*^9, {3.650799646765745*^9, 3.650799650226345*^9}, {
   3.6508009807663107`*^9, 3.650800984192174*^9}, {3.650801845809001*^9, 
   3.650801847492399*^9}, {3.6508023804641523`*^9, 3.650802398207432*^9}, {
   3.650802560709681*^9, 3.65080256114811*^9}, {3.650802610103129*^9, 
   3.650802760628886*^9}, {3.650804670745363*^9, 3.650804718032611*^9}, {
   3.650804841846486*^9, 3.6508048445430107`*^9}, {3.65080492014219*^9, 
   3.650804921873021*^9}, {3.650872572955171*^9, 3.65087261028303*^9}, {
   3.651220331544826*^9, 3.651220331927487*^9}, {3.6512203653045683`*^9, 
   3.651220397695451*^9}, {3.651220433984274*^9, 3.651220438328389*^9}, {
   3.651220480304768*^9, 
   3.651220501647913*^9}},ExpressionUUID->"5ddf55b9-77c9-4fb5-b621-\
5c96e1a1db26"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"totallnL", "[", 
    RowBox[{"gf_", ",", "\[Omega]_", ",", 
     RowBox[{"\[Theta]_", "?", "NumberQ"}], ",", "rlznum_List", ",", 
     "max_Integer", ",", "counts_SparseArray"}], "]"}], ":=", 
   RowBox[{"totallnL", "[", 
    RowBox[{"gf", ",", "\[Omega]", ",", "\[Theta]", ",", "rlznum", ",", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"max", ",", 
       RowBox[{
        RowBox[{"GetConfigsGF", "[", 
         RowBox[{
          RowBox[{"Total", "[", "gf", "]"}], ",", "\[Omega]"}], "]"}], "//", 
        "Length"}]}], "]"}], ",", "counts"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6526047489864883`*^9, 3.652604779458437*^9}, {
  3.652604815739609*^9, 
  3.652604833450408*^9}},ExpressionUUID->"1d4793ab-7f69-4fc4-a102-\
4a078111e71a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["totallnL2 (Non-numeric theta)", "Subsubsection",
 CellChangeTimes->{
  3.640591636424046*^9, 3.649129188878124*^9, 3.649228879287122*^9, 
   3.6508725181581297`*^9, 3.651224522293035*^9, {3.6560705952763844`*^9, 
   3.6560706001324043`*^9}, {3.656070651412415*^9, 3.656070654100244*^9}, 
   3.656150587637514*^9, {3.6566615441392393`*^9, 
   3.656661547571969*^9}},ExpressionUUID->"53ddddf6-f80b-4361-83bb-\
1ac0e4f69d92"],

Cell["\<\
I have added the option that you specify a single max and this gets converted \
in likFullTab to the necessary list\
\>", "Text",
 CellChangeTimes->{{3.652177903706229*^9, 
  3.652177908916998*^9}},ExpressionUUID->"450aa6fe-d708-4fe0-ab2b-\
d9ea7a028bcb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"totallnL2", "[", 
    RowBox[{
    "gf_", ",", "\[Omega]_", ",", "\[Theta]_", ",", "rlznum_List", ",", 
     "max_List", ",", "counts_SparseArray"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"probTab", ",", "posn"}], "}"}], ",", 
     RowBox[{
      RowBox[{"probTab", "=", 
       RowBox[{"likFullTab", "[", 
        RowBox[{
        "gf", ",", "\[Omega]", ",", "\[Theta]", ",", "rlznum", ",", "max"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"posn", "=", 
       RowBox[{"probTab", "[", "\"\<NonzeroPositions\>\"", "]"}]}], ";", 
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{"Log", "[", 
         RowBox[{"probTab", "[", "\"\<NonzeroValues\>\"", "]"}], "]"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Extract", "[", 
            RowBox[{"counts", ",", "#"}], "]"}], "&"}], "/@", "posn"}], 
         ")"}]}], "]"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650784746197983*^9, 3.650784768430999*^9}, 
   3.65079958481174*^9, {3.650799646765745*^9, 3.650799650226345*^9}, {
   3.6508009807663107`*^9, 3.650800984192174*^9}, {3.650801845809001*^9, 
   3.650801847492399*^9}, {3.6508023804641523`*^9, 3.650802398207432*^9}, {
   3.650802560709681*^9, 3.65080256114811*^9}, {3.650802610103129*^9, 
   3.650802760628886*^9}, {3.650804670745363*^9, 3.650804718032611*^9}, {
   3.650804841846486*^9, 3.6508048445430107`*^9}, {3.65080492014219*^9, 
   3.650804921873021*^9}, {3.650872572955171*^9, 3.65087261028303*^9}, {
   3.651220331544826*^9, 3.651220331927487*^9}, {3.6512203653045683`*^9, 
   3.651220397695451*^9}, {3.651220433984274*^9, 3.651220438328389*^9}, {
   3.651220480304768*^9, 3.651220501647913*^9}, 3.656070604468423*^9, 
   3.6560706378445177`*^9},ExpressionUUID->"2b19fc9b-91da-493f-ac04-\
4879c6538495"],

Cell[BoxData[
 RowBox[{
  RowBox[{"totallnL2", "[", 
   RowBox[{
   "gf_", ",", "\[Omega]_", ",", "\[Theta]_", ",", "rlznum_List", ",", 
    "max_Integer", ",", "counts_SparseArray"}], "]"}], ":=", 
  RowBox[{"totallnL2", "[", 
   RowBox[{"gf", ",", "\[Omega]", ",", "\[Theta]", ",", "rlznum", ",", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"max", ",", 
      RowBox[{
       RowBox[{"GetConfigsGF", "[", 
        RowBox[{
         RowBox[{"Total", "[", "gf", "]"}], ",", "\[Omega]"}], "]"}], "//", 
       "Length"}]}], "]"}], ",", "counts"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.652177754457177*^9, 3.652177822915937*^9}, 
   3.652178213175745*^9, {3.6560706106447687`*^9, 
   3.656070639356207*^9}},ExpressionUUID->"066bc20d-6af7-42bd-94cc-\
43767abc194f"],

Cell["Single deme (needs brackets around the gf for likFullTab) ", "Text",
 CellChangeTimes->{{3.652000385644104*^9, 3.652000387546063*^9}, {
  3.6520004708215446`*^9, 
  3.652000533773548*^9}},ExpressionUUID->"f6c251b3-28fb-42e0-a0c8-\
434683854731"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"totallnL2", "[", 
    RowBox[{
     RowBox[{"{", "gf_", "}"}], ",", "\[Omega]_", ",", "\[Theta]_", ",", 
     "rlznum_List", ",", "max_List", ",", "counts_SparseArray"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"probTab", ",", "posn"}], "}"}], ",", 
     RowBox[{
      RowBox[{"probTab", "=", 
       RowBox[{"likFullTab", "[", 
        RowBox[{
         RowBox[{"{", "gf", "}"}], ",", "\[Omega]", ",", "\[Theta]", ",", 
         "rlznum", ",", "max"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"posn", "=", 
       RowBox[{"probTab", "[", "\"\<NonzeroPositions\>\"", "]"}]}], ";", 
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{"Log", "[", 
         RowBox[{"probTab", "[", "\"\<NonzeroValues\>\"", "]"}], "]"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Extract", "[", 
            RowBox[{"counts", ",", "#"}], "]"}], "&"}], "/@", "posn"}], 
         ")"}]}], "]"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6519988183896112`*^9, 3.651998822789743*^9}, {
  3.651999317902129*^9, 3.651999320445476*^9}, {3.651999374070693*^9, 
  3.651999375621647*^9}, {3.6520003552064037`*^9, 3.652000358342498*^9}, {
  3.652000426294428*^9, 3.652000449534623*^9}, {3.652177862704143*^9, 
  3.652177863495639*^9}, {3.656070613509811*^9, 
  3.656070630420458*^9}},ExpressionUUID->"3bb5fbca-8b7e-4a21-9b6a-\
99ab8587fc40"],

Cell[BoxData[
 RowBox[{
  RowBox[{"totallnL2", "[", 
   RowBox[{
    RowBox[{"{", "gf_", "}"}], ",", "\[Omega]_", ",", "\[Theta]_", ",", 
    "rlznum_List", ",", "max_Integer", ",", "counts_SparseArray"}], "]"}], ":=", 
  RowBox[{"totallnL2", "[", 
   RowBox[{
    RowBox[{"{", "gf", "}"}], ",", "\[Omega]", ",", "\[Theta]", ",", "rlznum",
     ",", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"max", ",", 
      RowBox[{
       RowBox[{"GetConfigsGF", "[", 
        RowBox[{
         RowBox[{"Total", "[", "gf", "]"}], ",", "\[Omega]"}], "]"}], "//", 
       "Length"}]}], "]"}], ",", "counts"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6521778746793413`*^9, 3.652177879143641*^9}, {
  3.656070615844864*^9, 
  3.6560706290205917`*^9}},ExpressionUUID->"a2f0b7a0-5814-4187-993d-\
da5cd1fefcd1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["adjustTable", "Subsubsection",
 CellChangeTimes->{3.640591636424046*^9, 3.649129188878124*^9, 
  3.649228879287122*^9},ExpressionUUID->"4629ee24-3e87-4247-acc2-\
29bffe1e30e4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"adjustTable", "::", "usage"}], "=", 
   "\"\<adjustTable[{{\[Ellipsis]},\[Ellipsis]},d] takes a table with \
dimension d in which the last element at each level is the total probability, \
and produces a table in which the last element is the residual probability.  \
This new table should sum to 1. adjustTable[{{\[Ellipsis]},\[Ellipsis]},d,k] \
makes the adjustment only for level k.  Note that d cannot be inferred from \
the depth of the table, because its elements may themselves have depth. Works \
with sparse arrays.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.640580522519785*^9, 3.640580636164969*^9}, {
  3.640600933555353*^9, 3.640600956578511*^9}, {3.640601005871625*^9, 
  3.6406010632102537`*^9}, {3.6408446271210737`*^9, 
  3.64084463587129*^9}},ExpressionUUID->"1a2f9ae0-8d65-4b22-9154-\
ee42d70a342b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"adjustTable", "[", 
    RowBox[{
     RowBox[{"t", ":", 
      RowBox[{"(", 
       RowBox[{"_List", "|", "_SparseArray"}], ")"}]}], ",", "d_Integer", ",",
      "k_Integer"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"jj", ",", "nt"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"jj", "=", 
       RowBox[{"RotateRight", "[", 
        RowBox[{
         RowBox[{"Range", "[", "d", "]"}], ",", 
         RowBox[{"k", "-", "1"}]}], "]"}]}], ";", 
      RowBox[{"nt", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"t", ",", "jj"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Transpose", "[", 
       RowBox[{
        RowBox[{"ReplacePart", "[", 
         RowBox[{"nt", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "\[Rule]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"nt", "\[LeftDoubleBracket]", 
              RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "-", 
             RowBox[{"Total", "[", 
              RowBox[{"Drop", "[", 
               RowBox[{"nt", ",", 
                RowBox[{"-", "1"}]}], "]"}], "]"}]}], ")"}]}]}], "]"}], ",", 
        RowBox[{"Normal", "[", 
         RowBox[{"SparseArray", "[", 
          RowBox[{"jj", "\[Rule]", 
           RowBox[{"Range", "[", "d", "]"}]}], "]"}], "]"}]}], "]"}]}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.640591373045816*^9, 3.640591508902577*^9}, {
   3.640601065530204*^9, 3.640601079210877*^9}, {3.640844673858938*^9, 
   3.640844694198039*^9}, {3.6408447322779093`*^9, 3.640844736886002*^9}, {
   3.64085486772892*^9, 3.640854868292383*^9}, 3.6465534880026293`*^9, 
   3.649129172746222*^9},ExpressionUUID->"e2b0bced-febb-4865-8499-\
c873c9e31f8e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"adjustTable", "[", 
    RowBox[{
     RowBox[{"t", ":", 
      RowBox[{"(", 
       RowBox[{"_List", "|", "_SparseArray"}], ")"}]}], ",", "d_Integer"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"nt", "=", "t"}], ",", "j"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"nt", "=", 
         RowBox[{"adjustTable", "[", 
          RowBox[{"nt", ",", "d", ",", "j"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "d"}], "}"}]}], "]"}], ";", "nt"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.640591373045816*^9, 3.640591543867977*^9}, {
   3.6405915740114727`*^9, 3.6405916530074472`*^9}, {3.640601201898571*^9, 
   3.640601209484951*^9}, {3.640601443201552*^9, 3.6406014433045387`*^9}, 
   3.640844687838696*^9, {3.640854871622017*^9, 3.640854872077547*^9}, {
   3.649129134627037*^9, 
   3.649129144984955*^9}},ExpressionUUID->"f927e4f6-16e9-4da9-89bd-\
b8335be97a78"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"adjustTable", "[", 
    RowBox[{
     RowBox[{"t", ":", 
      RowBox[{"(", 
       RowBox[{"_List", "|", "_SparseArray"}], ")"}]}], ",", "d_Integer", ",",
      "k_Integer"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"jj", ",", "nt"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"jj", "=", 
       RowBox[{"RotateRight", "[", 
        RowBox[{
         RowBox[{"Range", "[", "d", "]"}], ",", 
         RowBox[{"k", "-", "1"}]}], "]"}]}], ";", 
      RowBox[{"nt", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"t", ",", "jj"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Transpose", "[", 
       RowBox[{
        RowBox[{"ReplacePart", "[", 
         RowBox[{"nt", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "\[Rule]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"nt", "\[LeftDoubleBracket]", 
              RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "-", 
             RowBox[{"Total", "[", 
              RowBox[{"Drop", "[", 
               RowBox[{"nt", ",", 
                RowBox[{"-", "1"}]}], "]"}], "]"}]}], ")"}]}]}], "]"}], ",", 
        RowBox[{"Normal", "[", 
         RowBox[{"SparseArray", "[", 
          RowBox[{"jj", "\[Rule]", 
           RowBox[{"Range", "[", "d", "]"}]}], "]"}], "]"}]}], "]"}]}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.640591373045816*^9, 3.640591508902577*^9}, {
   3.640601065530204*^9, 3.640601079210877*^9}, {3.640844673858938*^9, 
   3.640844694198039*^9}, {3.6408447322779093`*^9, 3.640844736886002*^9}, {
   3.64085486772892*^9, 3.640854868292383*^9}, 3.6465534880026293`*^9, 
   3.649129172746222*^9},ExpressionUUID->"3a64bb1d-a36a-47e5-9132-\
bf3bed563ec1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "Transpose"}]], "Input",
 CellChangeTimes->{{3.650886692841949*^9, 3.650886699876686*^9}, {
  3.650886782757677*^9, 
  3.650886786307538*^9}},ExpressionUUID->"a4221c6f-52e1-4c85-912f-\
922e0b068532"],

Cell[BoxData[
 RowBox[{
  StyleBox["\<\"\!\(\*RowBox[{\\\"Transpose\\\", \\\"[\\\", StyleBox[\\\"list\
\\\", \\\"TI\\\"], \\\"]\\\"}]\) transposes the first two levels in \
\!\(\*StyleBox[\\\"list\\\", \\\"TI\\\"]\). \
\\n\!\(\*RowBox[{\\\"Transpose\\\", \\\"[\\\", RowBox[{StyleBox[\\\"list\\\", \
\\\"TI\\\"], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{SubscriptBox[StyleBox[\\\"n\\\", \\\"TI\\\"], StyleBox[\\\"1\\\", \
\\\"TR\\\"]], \\\",\\\", SubscriptBox[StyleBox[\\\"n\\\", \\\"TI\\\"], \
StyleBox[\\\"2\\\", \\\"TR\\\"]], \\\",\\\", StyleBox[\\\"\[Ellipsis]\\\", \\\
\"TR\\\"]}], \\\"}\\\"}]}], \\\"]\\\"}]\) transposes \
\!\(\*StyleBox[\\\"list\\\", \\\"TI\\\"]\) so that the \!\(\*StyleBox[\\\"k\\\
\", \\\"TI\\\"]\)\!\(\*SuperscriptBox[\\\"\[Null]\\\", \\\"th\\\"]\) level in \
\!\(\*StyleBox[\\\"list\\\", \\\"TI\\\"]\) is the \
\!\(\*SubscriptBox[StyleBox[\\\"n\\\", \\\"TI\\\"], StyleBox[\\\"k\\\", \
\\\"TI\\\"]]\)\!\(\*SuperscriptBox[\\\"\[Null]\\\", \\\"th\\\"]\) level in \
the result. \"\>", "MSG"], "\[NonBreakingSpace]", 
  ButtonBox[
   StyleBox["\[RightSkeleton]", "SR"],
   Active->True,
   BaseStyle->"Link",
   ButtonData->"paclet:ref/Transpose"]}]], "Print", "PrintUsage",
 CellChangeTimes->{3.651912692320051*^9},
 CellTags->
  "Info3651916292-2487941",ExpressionUUID->"87a7872a-7927-4268-a43f-\
4e1c75a94319"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Transpose", "[", 
  RowBox[{
   RowBox[{"ReplacePart", "[", 
    RowBox[{"nt", ",", 
     RowBox[{
      RowBox[{"-", "1"}], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"nt", "\[LeftDoubleBracket]", 
         RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "-", 
        RowBox[{"Total", "[", 
         RowBox[{"Drop", "[", 
          RowBox[{"nt", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ")"}]}]}], "]"}], ",", 
   RowBox[{"Normal", "[", 
    RowBox[{"SparseArray", "[", 
     RowBox[{"jj", "\[Rule]", 
      RowBox[{"Range", "[", "d", "]"}]}], "]"}], "]"}]}], "]"}]], "Input",Expr\
essionUUID->"b92ba1fb-8a48-488a-ac3f-6c97f9a6663d"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partd"}], "MessageName"], ":", 
  " ", "\<\"Part specification \[NoBreak]\\!\\(nt \[LeftDoubleBracket] \
\\(\\(-1\\)\\) \[RightDoubleBracket]\\)\[NoBreak] is longer than depth of \
object. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/partd\\\", ButtonNote -> \
\\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.65191269275093*^9},ExpressionUUID->"b22e3613-171d-40ff-adf5-544ef67009ce"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Drop", "::", "normal"}], "MessageName"], ":", 
  " ", "\<\"Nonatomic expression expected at position \[NoBreak]\\!\\(1\\)\
\[NoBreak] in \[NoBreak]\\!\\(Drop[\\(\\(nt, \\(\\(-1\\)\\)\\)\\)]\\)\
\[NoBreak]. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/normal\\\", ButtonNote -> \
\\\"Drop::normal\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.65191269311246*^9},ExpressionUUID->"487dccaa-0ff3-44e1-b846-0131dd3ea11d"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Range", "::", "range"}], "MessageName"], ":", 
  " ", "\<\"Range specification in \[NoBreak]\\!\\(Range[d]\\)\[NoBreak] does \
not have appropriate bounds. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/Range/range\\\", ButtonNote -> \
\\\"Range::range\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.6519126931291122`*^9},ExpressionUUID->"784b0de5-1e9a-4482-abc9-\
dc56a40b662d"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"SparseArray", "::", "pos"}], "MessageName"], ":", 
  " ", "\<\"The left-hand side of \[NoBreak]\\!\\(jj \[Rule] \
\\(\\(Range[d]\\)\\)\\)\[NoBreak] in \[NoBreak]\\!\\({jj \[Rule] \
\\(\\(Range[d]\\)\\)}\\)\[NoBreak] is not a position or pattern that will \
match a position. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/SparseArray\\\", ButtonNote -> \
\\\"SparseArray::pos\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.651912693134863*^9},ExpressionUUID->"83285e0c-2190-433c-8668-\
a29012a3c79b"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Transpose", "::", "list"}], "MessageName"], ":", 
  " ", "\<\"List expected at position \[NoBreak]\\!\\(2\\)\[NoBreak] in \
\[NoBreak]\\!\\(Transpose[\\(\\(nt, \\*TagBox[\\(SparseArray[\\(\\(jj \[Rule] \
\\(\\(Range[d]\\)\\)\\)\\)]\\), False, Rule[Editable, False], \
Rule[SelectWithContents, True]]\\)\\)]\\)\[NoBreak]. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/list\\\", ButtonNote -> \
\\\"Transpose::list\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.6519126931400957`*^9},ExpressionUUID->"984075fb-b28c-4f48-9578-\
b478cc95f378"],

Cell[BoxData[
 RowBox[{"Transpose", "[", 
  RowBox[{"nt", ",", 
   TagBox[
    RowBox[{"SparseArray", "[", 
     RowBox[{"jj", "\[Rule]", 
      RowBox[{"Range", "[", "d", "]"}]}], "]"}],
    False,
    Editable->False,
    SelectWithContents->True]}], "]"}]], "Output",
 CellChangeTimes->{
  3.651912693145545*^9},ExpressionUUID->"919aee8c-433d-4e21-82fc-\
f187c7f656e1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ReplacePart", "[", 
  RowBox[{"nt", ",", 
   RowBox[{
    RowBox[{"-", "1"}], "\[Rule]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"nt", "\[LeftDoubleBracket]", 
       RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "-", 
      RowBox[{"Total", "[", 
       RowBox[{"Drop", "[", 
        RowBox[{"nt", ",", 
         RowBox[{"-", "1"}]}], "]"}], "]"}]}], ")"}]}]}], "]"}]], "Input",Expr\
essionUUID->"7e16b02e-e036-4877-9313-05d6927b5878"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partd"}], "MessageName"], ":", 
  " ", "\<\"Part specification \[NoBreak]\\!\\(nt \[LeftDoubleBracket] \
\\(\\(-1\\)\\) \[RightDoubleBracket]\\)\[NoBreak] is longer than depth of \
object. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/partd\\\", ButtonNote -> \
\\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.651912693604459*^9},ExpressionUUID->"7f749f2c-bd14-4ba0-a71e-\
2bed486ca476"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Drop", "::", "normal"}], "MessageName"], ":", 
  " ", "\<\"Nonatomic expression expected at position \[NoBreak]\\!\\(1\\)\
\[NoBreak] in \[NoBreak]\\!\\(Drop[\\(\\(nt, \\(\\(-1\\)\\)\\)\\)]\\)\
\[NoBreak]. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/normal\\\", ButtonNote -> \
\\\"Drop::normal\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.651912693973208*^9},ExpressionUUID->"2cc73efb-e17e-4281-b376-\
ef37c35a570d"],

Cell[BoxData["nt"], "Output",
 CellChangeTimes->{
  3.6519126939902697`*^9},ExpressionUUID->"a7811ca4-5e16-4669-bbd7-\
7d0fbfc00e72"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"4", ",", "1", ",", "2", ",", "3"}], "}"}], "\[Rule]", 
  RowBox[{"Range", "[", "4", "]"}]}]], "Input",ExpressionUUID->"958a8897-8d2a-\
4ce3-a3b2-30868d133cce"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"4", ",", "1", ",", "2", ",", "3"}], "}"}], "\[Rule]", 
  RowBox[{"{", 
   RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}]], "Output",
 CellChangeTimes->{
  3.651912694418288*^9},ExpressionUUID->"9eb23cf0-e021-4700-86c9-\
057c4855d442"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SparseArray", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"4", ",", "1", ",", "2", ",", "3"}], "}"}], "\[Rule]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.650887045792952*^9, 
  3.650887062229883*^9}},ExpressionUUID->"3210eb50-8260-4c7a-bca7-\
c36379b9880a"],

Cell[BoxData[
 TagBox[
  TemplateBox[{RowBox[{
      StyleBox[
       TagBox["SparseArray", "SummaryHead"], "NonInterpretableSummary"], 
      StyleBox["[", "NonInterpretableSummary"], 
      DynamicModuleBox[{Typeset`open$$ = False}, 
       PanelBox[
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquarePlusIconMedium"]], 
                ButtonFunction :> (Typeset`open$$ = True), Appearance -> None,
                 Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GraphicsBox[
               
               RasterBox[{{{0.282325, 0.661868, 0.973082}, {0.527193, 
                0.7932440000000001, 0.9858925000000001}, {0.772061, 0.92462, 
                0.998703}, {0.258878, 0.494759, 0.9031865}}}, {{0, 0}, {4, 
                1}}, {0, 1}], AspectRatio -> 1, Axes -> False, Frame -> False,
                FrameLabel -> {None, None}, FrameStyle -> Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], 
               FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
               Directive[
                 GrayLevel[0.5, 0.4]], ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}], 
               Method -> {
                "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
                 Automatic, "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
                 Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
              GridBox[{{
                 RowBox[{
                   TagBox[
                   "\"Specified elements: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["4", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", "4", "}"}], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquareMinusIconMedium"]], 
                ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GraphicsBox[
               
               RasterBox[{{{0.282325, 0.661868, 0.973082}, {0.527193, 
                0.7932440000000001, 0.9858925000000001}, {0.772061, 0.92462, 
                0.998703}, {0.258878, 0.494759, 0.9031865}}}, {{0, 0}, {4, 
                1}}, {0, 1}], AspectRatio -> 1, Axes -> False, Frame -> False,
                FrameLabel -> {None, None}, FrameStyle -> Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], 
               FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
               Directive[
                 GrayLevel[0.5, 0.4]], ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}], 
               Method -> {
                "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
                 Automatic, "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
                 Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
              GridBox[{{
                 RowBox[{
                   TagBox[
                   "\"Specified elements: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["4", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", "4", "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["0", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["1.`", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["\"\"", "SummaryItem"]}]}, {
                 TagBox[
                  TagBox[
                   GridBox[{{
                    RowBox[{
                    RowBox[{"{", "4", "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "1", ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", "1", "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "2", ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", "2", "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "3", ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", "3", "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "4", ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}}, GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                   "Column"], "SummaryItem"]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic], BaselinePosition -> 
        Baseline], DynamicModuleValues :> {}], 
      StyleBox["]", "NonInterpretableSummary"]}]},
   "CopyTag",
   DisplayFunction->(#& ),
   InterpretationFunction->("SparseArray[<4>, {4}]"& )],
  False,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{3.650887048435289*^9, 
  3.651912694890833*^9},ExpressionUUID->"d19d4ca1-d64f-4587-a22a-\
8ba5029d815b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Normal", "[", 
  RowBox[{"SparseArray", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"4", ",", "1", ",", "2", ",", "3"}], "}"}], "\[Rule]", 
    RowBox[{"Range", "[", "4", "]"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6508869366453238`*^9, 
  3.650886944245461*^9}},ExpressionUUID->"8b18440b-0f5f-4059-b73c-\
4d36361d2e6c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "3", ",", "4", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{3.650886945744582*^9, 
  3.651912695299738*^9},ExpressionUUID->"760530eb-8c17-45c4-874e-\
487cfd9aaaa9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RotateRight", "[", 
  RowBox[{
   RowBox[{"Range", "[", "4", "]"}], ",", 
   RowBox[{"2", "-", "1"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.650886749060677*^9, 
  3.650886764749564*^9}},ExpressionUUID->"41c10cb8-0e4c-4d8e-b855-\
d86d82c57112"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4", ",", "1", ",", "2", ",", "3"}], "}"}]], "Output",
 CellChangeTimes->{{3.650886750548768*^9, 3.6508867655237103`*^9}, 
   3.651912695757465*^9},ExpressionUUID->"a669004d-cae8-41ed-aff8-\
beb3180f999d"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Comparing MakeProbTable with likFullTab and MakePT", "Subsubsection",
 CellChangeTimes->{{3.631519632254311*^9, 3.631519706356648*^9}, {
   3.6315394643289537`*^9, 3.631539474657357*^9}, 3.63308991819623*^9, {
   3.650952001791162*^9, 3.650952005694962*^9}, {3.6514866906552153`*^9, 
   3.651486769358458*^9}, {3.651915528728677*^9, 
   3.65191553997614*^9}},ExpressionUUID->"a2807e2c-3853-4519-b7f4-\
371e5bdaa2b8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"branch1", "=", 
   RowBox[{"GetConfigsGF", "[", 
    RowBox[{
     RowBox[{
     "twoEnRXTsimpSort", "\[LeftDoubleBracket]", "1", 
      "\[RightDoubleBracket]"}], ",", "\[Omega]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"branchall", "=", 
   RowBox[{"GetConfigsGF", "[", 
    RowBox[{"twoEnRXTsimpSort", ",", "\[Omega]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6508790820410147`*^9, 3.650879099203188*^9}, 
   3.650879580560959*^9},ExpressionUUID->"0c7f8a13-ad94-4101-954f-\
658c1d182b7f"],

Cell[TextData[{
 "It is unclear to me why likFullTab is more efficient than MakeProbTable. \
This tabulates probabilities under a strict divergence model with a global ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["k", "max"], "=", "3"}], TraditionalForm]],ExpressionUUID->
  "6d53cceb-0208-4deb-9a73-08550055d599"],
 " for blocks with fixed differences only. "
}], "Text",
 CellChangeTimes->{{3.650880674772213*^9, 3.6508807337190638`*^9}, {
  3.650885677239953*^9, 3.650885767543973*^9}, {3.650891227137985*^9, 
  3.650891228073732*^9}, {3.651486594306672*^9, 
  3.651486629918638*^9}},ExpressionUUID->"87c519fe-fd7d-481b-8479-\
229f6fc94e77"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{
   RowBox[{"ttKL1", "=", 
    RowBox[{"likFullTab", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
         "twoEnRXTsimpSort", "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}], "//", "Flatten"}], "//", "Total"}], 
       "}"}], ",", "\[Omega]", ",", "2.48", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"M", "\[Rule]", "0.2"}], ",", 
        RowBox[{"T", "\[Rule]", "0.37"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "3", ",", "3"}], "}"}]}], "]"}]}], ";"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.650863307449068*^9, 3.650863329800755*^9}, {
   3.650871571134795*^9, 3.650871598237874*^9}, 3.650872473402051*^9, {
   3.650873363241064*^9, 3.650873365320682*^9}, {3.650879006053166*^9, 
   3.650879014846073*^9}, {3.650879274090086*^9, 3.65087929551593*^9}, {
   3.650879372781094*^9, 3.6508793774377403`*^9}, {3.650879436606162*^9, 
   3.650879439749126*^9}, {3.6508796945862913`*^9, 3.650879695347145*^9}, {
   3.6508812453266163`*^9, 3.650881259949423*^9}, 3.650881290565473*^9, {
   3.6508815396471453`*^9, 3.650881563942905*^9}, 3.650881724311076*^9, 
   3.651912747112606*^9, {3.65191616703345*^9, 
   3.651916167218589*^9}},ExpressionUUID->"69de950c-a240-494c-80e3-\
9d28ebb48ab6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5.611387`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.650881298194106*^9, {3.650881552889484*^9, 3.650881567713491*^9}, 
   3.650881730698729*^9, 3.651912699720077*^9, {3.651912739377792*^9, 
   3.651912751907323*^9}, 3.6519128835555887`*^9, 
   3.6519161740160723`*^9},ExpressionUUID->"fffad3a6-8a1b-468d-bb43-\
a8a95922fbd3"]
}, Open  ]],

Cell["The default method used in MakeProbTable is much slower:", "Text",
 CellChangeTimes->{{3.651916123968728*^9, 3.651916151716729*^9}, {
  3.651916186543992*^9, 3.6519162033913116`*^9}, {3.651916236111519*^9, 
  3.651916255927473*^9}},ExpressionUUID->"9e451cfa-6742-4463-a1cc-\
6ec8ec9b3030"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{
   RowBox[{"ttNB1", "=", 
    RowBox[{"MakeProbTable", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
          "twoEnRXTsimpSort", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], "//", "Flatten"}], "//", "Total"}], 
        ")"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"M", "\[Rule]", "0.2"}], ",", 
         RowBox[{"T", "\[Rule]", "0.37"}]}], "}"}]}], ",", "\[Omega]", ",", 
      "2.48", ",", "branch1", ",", "3"}], "]"}]}], ";"}], "]"}]], "Input",
 CellChangeTimes->{
  3.650878995906115*^9, {3.6508790261732063`*^9, 3.650879042114286*^9}, {
   3.6508791061635313`*^9, 3.6508791309636087`*^9}, {3.650879175695717*^9, 
   3.650879227357644*^9}, {3.650879316295504*^9, 3.6508793590291147`*^9}, {
   3.650879508749755*^9, 3.6508795363179626`*^9}, {3.650879593179947*^9, 
   3.650879646908983*^9}, 3.6508796893424*^9, {3.650879787781519*^9, 
   3.650879788652299*^9}, {3.6508805550464363`*^9, 3.650880563450726*^9}, {
   3.650881213676963*^9, 3.6508812233339167`*^9}, {3.650881389134532*^9, 
   3.650881397781068*^9}, 3.6519127555038347`*^9, {3.6519161637778053`*^9, 
   3.6519161640317497`*^9}},ExpressionUUID->"89ab2ba6-39e0-4e85-a54b-\
577dd248ceaa"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"71.525645`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.6509564625070143`*^9, 3.651912729520226*^9, 
  3.651912787312767*^9, 3.6519129143496933`*^9, 
  3.651916246081105*^9},ExpressionUUID->"5e616934-39ac-4e3a-9727-\
385b32604b62"]
}, Open  ]],

Cell["\<\
Using Series expansion in MakeProbTable is almost as fast as likFullTab. I do \
not understand the difference between these  two functions ... \
\>", "Text",
 CellChangeTimes->{{3.651916123968728*^9, 3.651916151716729*^9}, {
  3.651916186543992*^9, 3.6519162033913116`*^9}, {3.651916271088208*^9, 
  3.6519162930478373`*^9}, {3.6519164417603416`*^9, 
  3.65191644592832*^9}},ExpressionUUID->"8e17fdd5-a243-4be3-88ad-\
1b23b0c03bf1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{
   RowBox[{"ttNB1b", "=", 
    RowBox[{"MakeProbTable", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
          "twoEnRXTsimpSort", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], "//", "Flatten"}], "//", "Total"}], 
        ")"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"M", "\[Rule]", "0.2"}], ",", 
         RowBox[{"T", "\[Rule]", "0.37"}]}], "}"}]}], ",", "\[Omega]", ",", 
      "2.48", ",", "branch1", ",", "3", ",", 
      RowBox[{"OldMethod", "\[Rule]", "False"}]}], "]"}]}], ";"}], 
  "]"}]], "Input",
 CellChangeTimes->{
  3.650878995906115*^9, {3.6508790261732063`*^9, 3.650879042114286*^9}, {
   3.6508791061635313`*^9, 3.6508791309636087`*^9}, {3.650879175695717*^9, 
   3.650879227357644*^9}, {3.650879316295504*^9, 3.6508793590291147`*^9}, {
   3.650879508749755*^9, 3.6508795363179626`*^9}, {3.650879593179947*^9, 
   3.650879646908983*^9}, 3.6508796893424*^9, {3.650879787781519*^9, 
   3.650879788652299*^9}, {3.6508805550464363`*^9, 3.650880563450726*^9}, {
   3.650881213676963*^9, 3.6508812233339167`*^9}, {3.650881389134532*^9, 
   3.650881397781068*^9}, 3.6519127555038347`*^9, {3.6519160144481153`*^9, 
   3.651916054481022*^9}, {3.651916088866568*^9, 3.651916109202248*^9}, {
   3.651916158489662*^9, 
   3.6519161605048647`*^9}},ExpressionUUID->"204e7e07-e278-462c-8fef-\
adc943f3f441"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"9.942594`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6509564625070143`*^9, 3.651912729520226*^9, 3.651912787312767*^9, 
   3.6519129143496933`*^9, 3.65191603877282*^9, {3.651916086300562*^9, 
   3.651916113998228*^9}, 
   3.651916256609036*^9},ExpressionUUID->"4ecf20b5-5286-4ae0-ad0b-\
bad32e329d09"]
}, Open  ]],

Cell["Both schemes give the same answer:", "Text",
 CellChangeTimes->{{3.651916450829503*^9, 3.651916479216024*^9}, 
   3.651916509592464*^9, {3.651916612123666*^9, 
   3.6519166253680153`*^9}},ExpressionUUID->"ef32391d-f778-4758-8cdd-\
9930f12a93a9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SetPrecision", "[", 
   RowBox[{
    RowBox[{"Chop", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ttNB1", "-", "ttKL1"}], ")"}], "//", "Normal"}], "]"}], ",", 
    "2"}], "]"}], "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.651915458446847*^9, 3.651915488903926*^9}, {
   3.651916306089325*^9, 3.651916306759432*^9}, {3.651916340096026*^9, 
   3.651916347014989*^9}, 
   3.651916618153133*^9},ExpressionUUID->"192bb845-9852-47fd-943d-\
2f1825149688"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[GridBox[{
        {"0"},
        {"0"},
        {"0"},
        {"0"},
        {"0"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0"},
        {"0"},
        {"0"},
        {"0"},
        {"0"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0"},
        {"0"},
        {"0"},
        {"0"},
        {"0"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0"},
        {"0"},
        {"0"},
        {"0"},
        {"0"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0"},
        {"0"},
        {"0"},
        {"0"},
        {"0"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column]},
    {
     TagBox[GridBox[{
        {"0"},
        {"0"},
        {"0"},
        {"0"},
        {"0"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0"},
        {"0"},
        {"0"},
        {"0"},
        {"0"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0"},
        {"0"},
        {"0"},
        {"0"},
        {"0"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0"},
        {"0"},
        {"0"},
        {"0"},
        {"0"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0"},
        {"0"},
        {"0"},
        {"0"},
        {"0"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column]},
    {
     TagBox[GridBox[{
        {"0"},
        {"0"},
        {"0"},
        {"0"},
        {"0"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0"},
        {"0"},
        {"0"},
        {"0"},
        {"0"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0"},
        {"0"},
        {"0"},
        {"0"},
        {"0"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0"},
        {"0"},
        {"0"},
        {"0"},
        {"0"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0"},
        {"0"},
        {"0"},
        {"0"},
        {"0"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column]},
    {
     TagBox[GridBox[{
        {"0"},
        {"0"},
        {"0"},
        {"0"},
        {"0"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0"},
        {"0"},
        {"0"},
        {"0"},
        {"0"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0"},
        {"0"},
        {"0"},
        {"0"},
        {"0"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0"},
        {"0"},
        {"0"},
        {"0"},
        {"0"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0"},
        {"0"},
        {"0"},
        {"0"},
        {"0"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column]},
    {
     TagBox[GridBox[{
        {"0"},
        {"0"},
        {"0"},
        {"0"},
        {"0"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0"},
        {"0"},
        {"0"},
        {"0"},
        {"0"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0"},
        {"0"},
        {"0"},
        {"0"},
        {"0"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0"},
        {"0"},
        {"0"},
        {"0"},
        {"0"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0"},
        {"0"},
        {"0"},
        {"0"},
        {"0"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.651915459832576*^9, 3.651915489843068*^9}, 
   3.651916310991037*^9, 3.651916349291615*^9, 
   3.651916621651165*^9},ExpressionUUID->"5100c1cd-5c69-4a01-ac2c-\
c5be20932728"]
}, Open  ]],

Cell["but maybe differ in rounding error :", "Text",
 CellChangeTimes->{{3.651916677282902*^9, 
  3.651916701866664*^9}},ExpressionUUID->"e69d3258-824a-4f77-857a-\
98023dc99265"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"ttNB1", "//", "Normal"}], ")"}], "-", 
   RowBox[{"(", 
    RowBox[{"ttKL1", "//", "Normal"}], ")"}]}], "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.6519163583336277`*^9, 3.651916399629149*^9}, {
  3.651916635790659*^9, 
  3.651916653462673*^9}},ExpressionUUID->"b54aeb11-9836-4429-a811-\
55058edb4ae0"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[GridBox[{
        {
         RowBox[{"-", "1.3877787807814457`*^-17"}]},
        {
         RowBox[{"-", "3.469446951953614`*^-17"}]},
        {
         RowBox[{"-", "3.469446951953614`*^-17"}]},
        {"3.469446951953614`*^-18"},
        {"7.632783294297951`*^-17"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"3.469446951953614`*^-18"},
        {"1.3877787807814457`*^-17"},
        {"4.0766001685454967`*^-17"},
        {"2.3418766925686896`*^-17"},
        {
         RowBox[{"-", "4.85722573273506`*^-17"}]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {
         RowBox[{"-", "1.9081958235744878`*^-17"}]},
        {"1.5612511283791264`*^-17"},
        {
         RowBox[{"-", "9.540979117872439`*^-17"}]},
        {"7.849623728795052`*^-17"},
        {"2.5673907444456745`*^-16"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {
         RowBox[{"-", "2.7755575615628914`*^-17"}]},
        {
         RowBox[{"-", "2.688821387764051`*^-17"}]},
        {"1.5222198501696482`*^-16"},
        {
         RowBox[{"-", "2.7625471354930653`*^-16"}]},
        {"3.400058012914542`*^-16"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"2.7755575615628914`*^-17"},
        {"7.771561172376096`*^-16"},
        {"4.010680676458378`*^-15"},
        {"1.9460474898203017`*^-13"},
        {
         RowBox[{"-", "1.9997892231060632`*^-13"}]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column]},
    {
     TagBox[GridBox[{
        {
         RowBox[{"-", "1.3877787807814457`*^-17"}]},
        {
         RowBox[{"-", "4.5102810375396984`*^-17"}]},
        {"1.0234868508263162`*^-16"},
        {
         RowBox[{"-", "2.0209528495129803`*^-16"}]},
        {"1.734723475976807`*^-16"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {
         RowBox[{"-", "2.2551405187698492`*^-17"}]},
        {"2.42861286636753`*^-17"},
        {
         RowBox[{"-", "3.903127820947816`*^-17"}]},
        {"1.8778381627448937`*^-16"},
        {"9.71445146547012`*^-17"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {
         RowBox[{"-", "3.8163916471489756`*^-17"}]},
        {"2.2551405187698492`*^-17"},
        {
         RowBox[{"-", "7.546047120499111`*^-17"}]},
        {"5.724587470723463`*^-17"},
        {"5.30825383648903`*^-16"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {
         RowBox[{"-", "4.2500725161431774`*^-17"}]},
        {"3.5128150388530344`*^-17"},
        {"1.2902005852577503`*^-16"},
        {
         RowBox[{"-", "1.7683337433238577`*^-16"}]},
        {"4.579669976578771`*^-16"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"2.8449465006019636`*^-16"},
        {"2.5916768731093498`*^-15"},
        {"1.4915152446448587`*^-14"},
        {"3.418376692820857`*^-13"},
        {
         RowBox[{"-", "3.6072533848852117`*^-13"}]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column]},
    {
     TagBox[GridBox[{
        {
         RowBox[{"-", "3.122502256758253`*^-17"}]},
        {"1.5612511283791264`*^-17"},
        {
         RowBox[{"-", "1.682681771697503`*^-16"}]},
        {
         RowBox[{"-", "3.859759734048396`*^-17"}]},
        {"2.3245294578089215`*^-16"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {
         RowBox[{"-", "1.734723475976807`*^-17"}]},
        {"1.734723475976807`*^-18"},
        {"4.336808689942018`*^-18"},
        {"3.903127820947816`*^-18"},
        {
         RowBox[{"-", "4.163336342344337`*^-17"}]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {
         RowBox[{"-", "7.806255641895632`*^-18"}]},
        {
         RowBox[{"-", "9.974659986866641`*^-18"}]},
        {"1.4137996329210978`*^-16"},
        {
         RowBox[{"-", "1.8778381627448937`*^-16"}]},
        {
         RowBox[{"-", "2.8449465006019636`*^-16"}]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {
         RowBox[{"-", "5.2475385148298415`*^-17"}]},
        {"1.0625181290357943`*^-17"},
        {
         RowBox[{"-", "1.0126448291014611`*^-16"}]},
        {
         RowBox[{"-", "9.524716085285156`*^-17"}]},
        {"4.917941054394248`*^-16"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"5.204170427930421`*^-16"},
        {"5.745404152435185`*^-15"},
        {"4.344441473236316`*^-14"},
        {"6.965478541176573`*^-13"},
        {
         RowBox[{"-", "7.466596785299373`*^-13"}]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column]},
    {
     TagBox[GridBox[{
        {
         RowBox[{"-", "2.949029909160572`*^-17"}]},
        {
         RowBox[{"-", "2.0816681711721685`*^-17"}]},
        {
         RowBox[{"-", "1.2576745200831851`*^-17"}]},
        {
         RowBox[{"-", "6.765421556309548`*^-17"}]},
        {"4.891920202254596`*^-16"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {
         RowBox[{"-", "4.597017211338539`*^-17"}]},
        {"1.734723475976807`*^-18"},
        {
         RowBox[{"-", "7.741203511546502`*^-17"}]},
        {
         RowBox[{"-", "5.811323644522304`*^-17"}]},
        {"8.396061623727746`*^-16"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {
         RowBox[{"-", "6.808789643208968`*^-17"}]},
        {"1.205632815803881`*^-16"},
        {
         RowBox[{"-", "1.8583225236401546`*^-16"}]},
        {
         RowBox[{"-", "4.559070135301546`*^-17"}]},
        {"1.2420620087993939`*^-15"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {
         RowBox[{"-", "6.028164079019405`*^-17"}]},
        {"8.738669510233166`*^-17"},
        {"7.009367045118786`*^-17"},
        {"3.2038174196946656`*^-16"},
        {"8.387388006347862`*^-16"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"6.140921104957897`*^-16"},
        {"3.597816489175898`*^-15"},
        {"1.7566677279479137`*^-14"},
        {"2.8428778428568613`*^-13"},
        {
         RowBox[{"-", "3.0941828960129314`*^-13"}]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column]},
    {
     TagBox[GridBox[{
        {"4.163336342344337`*^-17"},
        {
         RowBox[{"-", "1.214306433183765`*^-15"}]},
        {
         RowBox[{"-", "1.0536710393083126`*^-14"}]},
        {
         RowBox[{"-", "4.617486948355065`*^-14"}]},
        {"5.738465258531278`*^-14"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {
         RowBox[{"-", "3.400058012914542`*^-16"}]},
        {
         RowBox[{"-", "2.643718577388654`*^-15"}]},
        {
         RowBox[{"-", "2.1356180712750472`*^-14"}]},
        {
         RowBox[{"-", "5.705332040140121`*^-14"}]},
        {"8.067158052682544`*^-14"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {
         RowBox[{"-", "3.608224830031759`*^-16"}]},
        {
         RowBox[{"-", "2.8657631823136853`*^-15"}]},
        {
         RowBox[{"-", "1.6160683902199935`*^-14"}]},
        {
         RowBox[{"-", "1.7138981206477055`*^-13"}]},
        {"1.8941619106538354`*^-13"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {
         RowBox[{"-", "4.822531263215524`*^-16"}]},
        {
         RowBox[{"-", "4.133846043252731`*^-15"}]},
        {
         RowBox[{"-", "3.1601457561869495`*^-14"}]},
        {
         RowBox[{"-", "2.407362503786814`*^-13"}]},
        {"2.754341893451695`*^-13"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {
         RowBox[{"-", "2.42861286636753`*^-16"}]},
        {
         RowBox[{"-", "3.1606661732297425`*^-14"}]},
        {
         RowBox[{"-", "4.949686494004624`*^-13"}]},
        {
         RowBox[{"-", "6.275539983502387`*^-12"}]},
        {"6.807007214837402`*^-12"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6519163592763987`*^9, 3.651916401933168*^9}, {
  3.6519166447631903`*^9, 
  3.6519166555259047`*^9}},ExpressionUUID->"3a1428d8-5794-4332-b48c-\
b546f19bb4ca"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Total", "[", 
    RowBox[{"Flatten", "[", "#", "]"}], "]"}], "&"}], "/@", 
  RowBox[{"{", 
   RowBox[{"ttNB1", ",", "ttKL1"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.65088136190771*^9, 3.6508813710836782`*^9}, {
  3.650886448196327*^9, 
  3.6508864874940042`*^9}},ExpressionUUID->"ee7cc6c0-7743-418f-ad20-\
4ad4199894c6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.6708592799502007`", ",", "0.6708592799502008`"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.650881364602667*^9, 3.65088137196765*^9}, 
   3.650881640089177*^9, 3.650886452201418*^9, 3.6508864883686666`*^9, 
   3.651912730435289*^9, 
   3.651916667882106*^9},ExpressionUUID->"8c3dbc15-cdfc-4b78-9c9d-\
96834dc4087e"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Comparing likFullTab with the old scheme", "Subsubsection",
 CellChangeTimes->{{3.650952713961914*^9, 3.650952721935182*^9}, {
  3.6519085533748417`*^9, 
  3.651908568853999*^9}},ExpressionUUID->"1e9831a2-7eaf-414e-a28a-\
b2b2abc812f6"],

Cell["The probabilities of full configurations agree:", "Text",
 CellChangeTimes->{{3.650952266356874*^9, 3.650952273527001*^9}, {
  3.650952709551139*^9, 
  3.650952739831381*^9}},ExpressionUUID->"b79873ab-51d5-4803-9f08-\
72f21e7662e5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"klOLD", "=", 
   RowBox[{"quadfullNum", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2.43", ",", "0.37", ",", "0"}], "}"}], ",", "3"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.650952218943522*^9, 
  3.6509522609965763`*^9}},ExpressionUUID->"ae346e49-e83f-4a69-b86e-\
66577068ba87"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SetPrecision", "[", 
   RowBox[{
    RowBox[{"klOLD", "\[LeftDoubleBracket]", 
     RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", "2"}], "]"}], "//",
   "TableForm"}]], "Input",
 CellChangeTimes->{{3.650952276287511*^9, 3.6509522937245092`*^9}, {
  3.650952417904983*^9, 
  3.6509524244528017`*^9}},ExpressionUUID->"05614cc0-6c3a-41f7-9bbf-\
32fb47da53c7"],

Cell[BoxData[
 TagBox["2.430000000000000159872115546022541821`2.",
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6509522836380367`*^9, 3.6509524250602217`*^9, 
  3.6519127309924793`*^9},ExpressionUUID->"39b94451-91b4-4743-bc52-\
7c6c5f3731d0"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"klNEW", "=", 
   RowBox[{"likFullTab", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
        "twoEnRXTsimpSort", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}], "//", "Flatten"}], "//", "Total"}], "}"}],
      ",", "\[Omega]", ",", "2.43", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"M", "\[Rule]", "0"}], ",", 
       RowBox[{"T", "\[Rule]", "0.37"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "3", ",", "3"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6509524381164703`*^9, 3.650952480936542*^9}, {
   3.650952528118483*^9, 3.650952538685185*^9}, 
   3.650952601590517*^9},ExpressionUUID->"d33d9384-9366-4210-95b0-\
27f64eb28e18"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SetPrecision", "[", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{
      RowBox[{"klNEW", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{"1", ";;", "4"}], ",", 
        RowBox[{"1", ";;", "4"}], ",", 
        RowBox[{"1", ";;", "4"}]}], "\[RightDoubleBracket]"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}], ",", "2"}], "]"}], "//",
   "TableForm"}]], "Input",
 CellChangeTimes->{{3.650952552723406*^9, 3.65095256140485*^9}, {
  3.650952622485547*^9, 
  3.650952677319611*^9}},ExpressionUUID->"f2173dec-8593-4b7e-8807-\
367248ffb37f"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[GridBox[{
        {"0.02140175793451281130441721245460939826`2."},
        {"0.01856560963993023061213705204863799736`2."},
        {"0.01495374029640065931257009168575677904`2."},
        {"0.01148012308400543288189332713500334648`2."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0.01856560963993022714269010009502380854`2."},
        {"0.0135076972817400730447756629359901126`2."},
        {"0.00941224556998245670547120766968873795`2."},
        {"0.00664190844384239097858424472065053124`2."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0.01495374029640064890422923582491421257`2."},
        {"0.00941224556998243762351297192481069942`2."},
        {"0.00550329284514040027731507365160723566`2."},
        {"0.00336034179679116752972878323646455101`2."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0.01148012308400538604435947576121179736`2."},
        {"0.00664190844384235281466777323089445417`2."},
        {"0.00336034179679120395892177874941353366`2."},
        {"0.00172045814145373805910399500618268576`2."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column]},
    {
     TagBox[GridBox[{
        {"0.01805962446260854850632604495785926702`2."},
        {"0.01261477323190142961484294659157967544`2."},
        {"0.00907308628995699348318559884774003876`2."},
        {"0.00665134667785930583372433488875685725`2."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0.01261477323190145563569508624368609162`2."},
        {"0.00745920646302096826407712626405555056`2."},
        {"0.00464802340822249946544753029797902855`2."},
        {"0.00312574383995390617935195010090865253`2."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0.00907308628995701083042035861581098288`2."},
        {"0.00464802340822250987378838615882159502`2."},
        {"0.00242830467545181866162451456148119178`2."},
        {"0.00140838723030622080256701877942759893`2."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0.00665134667785937782474858792625127535`2."},
        {"0.00312574383995398250718489308042080665`2."},
        {"0.00140838723030625116022784837355175114`2."},
        {"0.00068119167695348138008570870738367375`2."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column]},
    {
     TagBox[GridBox[{
        {"0.01277523339591214029953292197205882985`2."},
        {"0.00775140200750745224367310726165669621`2."},
        {"0.00484901622306099181619609694848804793`2."},
        {"0.00319885687922371762456630328586015821`2."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0.00775140200750746959090786702972764033`2."},
        {"0.00425752367317852164346758669921655382`2."},
        {"0.00240614433254337590009641623112202069`2."},
        {"0.00146112132153652170447888369864131164`2."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0.00484901622306098487730219304125967028`2."},
        {"0.00240614433254332646047735089211982995`2."},
        {"0.00120829515807935610090251277171091715`2."},
        {"0.00065517491718795211903120234708808312`2."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0.00319885687922364650090378823676928732`2."},
        {"0.00146112132153642737888987745975555299`2."},
        {"0.00065517491718815182907137417700482729`2."},
        {"0.0003107832715502268803794971852028084`2."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column]},
    {
     TagBox[GridBox[{
        {"0.00890097621129064785205908805210128776`2."},
        {"0.005041247346824156636002634002124978`2."},
        {"0.00283638531712157278621977418708866026`2."},
        {"0.00165713314137727672596678285543703169`2."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0.00504124734682415143183220607170369476`2."},
        {"0.00271929226287290042030075909451625193`2."},
        {"0.00144338693499191576645468426676188756`2."},
        {"0.00079179842492483514318490911421122291`2."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0.00283638531712165648662749006803096563`2."},
        {"0.001443386934991834451291747853929337`2."},
        {"0.0007173943106605394984254253643030097`2."},
        {"0.00036645416535362949602208648691714643`2."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0.00165713314137737452100274104793697916`2."},
        {"0.00079179842492502520382574582313850442`2."},
        {"0.0003664541653537116243366522638780225`2."},
        {"0.00017267008099539356389025279714388716`2."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.650952657975883*^9, 3.650952678086615*^9}, 
   3.651912734105631*^9},ExpressionUUID->"a3a41f23-09ae-4118-a939-\
ff7138a62612"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SetPrecision", "[", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{
      RowBox[{"ttNB1", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{"1", ";;", "4"}], ",", 
        RowBox[{"1", ";;", "4"}], ",", 
        RowBox[{"1", ";;", "4"}]}], "\[RightDoubleBracket]"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}], ",", "2"}], "]"}], "//",
   "TableForm"}]], "Input",
 CellChangeTimes->{{3.65095645583031*^9, 
  3.650956461741374*^9}},ExpressionUUID->"d2bbbddc-8c6b-4329-a89b-\
9f3da1b9f285"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[GridBox[{
        {"0.02140175793451282171275806831545196474`2."},
        {"0.0185656096399302514288187637703231303`2."},
        {"0.01495374029640067145563442352340643993`2."},
        {"0.01148012308400543288189332713500334648`2."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0.01856560963993024795937181181670894148`2."},
        {"0.01350769728174010600452170649532490643`2."},
        {"0.00941224556998247058325901548414549325`2."},
        {"0.00664190844384242393833028827998532506`2."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0.01495374029640066972091094754659934551`2."},
        {"0.00941224556998246017491815962330292678`2."},
        {"0.00550329284514047487042454065431229537`2."},
        {"0.00336034179679118617800614998714081594`2."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0.01148012308400541379993509139012530795`2."},
        {"0.00664190844384241613207464638435340021`2."},
        {"0.00336034179679122651032696644790576102`2."},
        {"0.00172045814145375410529614779164830907`2."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column]},
    {
     TagBox[GridBox[{
        {"0.01805962446260855891466690081870183349`2."},
        {"0.01261477323190143308428989854519386427`2."},
        {"0.009073086289956969197056935172440717`2."},
        {"0.00665134667785933011985299856405617902`2."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0.0126147732319014382884603264756151475`2."},
        {"0.00745920646302094050850151063514203997`2."},
        {"0.00464802340822245869944584484301230987`2."},
        {"0.00312574383995385717341375375610823539`2."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0.009073086289956998687356026778161322`2."},
        {"0.00464802340822250033280926828638257575`2."},
        {"0.00242830467545181866162451456148119178`2."},
        {"0.001408387230305997890600355759715967`2."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0.00665134667785932318095909465682780137`2."},
        {"0.00312574383995392005713975791536540783`2."},
        {"0.00140838723030609525195544495801414087`2."},
        {"0.00068119167695336092522434556784105553`2."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column]},
    {
     TagBox[GridBox[{
        {"0.01277523339591216111621463369374396279`2."},
        {"0.00775140200750746004992874915728862106`2."},
        {"0.00484901622306099268355783493689159513`2."},
        {"0.00319885687922372673186455216409740387`2."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0.00775140200750748954022784076300922607`2."},
        {"0.00425752367317851904138237273400591221`2."},
        {"0.00240614433254345439633370418164304283`2."},
        {"0.00146112132153664617088828503455033569`2."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0.00484901622306102737802735447303348337`2."},
        {"0.00240614433254339454837378298179828562`2."},
        {"0.00120829515807950073347232233800241374`2."},
        {"0.00065517491718801489433698925779481215`2."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0.00319885687922371068567239937863178056`2."},
        {"0.00146112132153662036687657987954480632`2."},
        {"0.00065517491718829407639640427518656907`2."},
        {"0.00031078327155066885539511090108533153`2."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column]},
    {
     TagBox[GridBox[{
        {"0.00890097621129065132150604000571547658`2."},
        {"0.00504124734682416097281132394414271403`2."},
        {"0.00283638531712156888309195323927269783`2."},
        {"0.00165713314137730361418066049594699507`2."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0.00504124734682418178949303566582784697`2."},
        {"0.00271929226287277465284875077600190707`2."},
        {"0.00144338693499186957944213638427299884`2."},
        {"0.00079179842492482852955165695263417547`2."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0.00283638531712159143449714093776492518`2."},
        {"0.00144338693499187673517647478860226329`2."},
        {"0.00071739431066029728766009210261245244`2."},
        {"0.0003664541653535820079669316218229369`2."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0.0016571331413772940732015426235079758`2."},
        {"0.00079179842492472791559005029782269958`2."},
        {"0.00036645416535335199447603882205726222`2."},
        {"0.00017267008099590487363479696103496508`2."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.650956464301981*^9, 
  3.651912734422635*^9},ExpressionUUID->"45f0c130-2d37-4155-8ab9-\
0e826ee630eb"]
}, Open  ]],

Cell["The residual probs for AA_BB topologies also agree:", "Text",
 CellChangeTimes->{{3.6509559068831367`*^9, 3.650955951816041*^9}, {
  3.650967997850875*^9, 
  3.6509680244187117`*^9}},ExpressionUUID->"8066f65f-ce5f-443a-a348-\
27602364f0f9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SetPrecision", "[", 
   RowBox[{
    RowBox[{"oldD2", "=", 
     RowBox[{"klOLD", "\[LeftDoubleBracket]", 
      RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], ",", "2"}], "]"}],
   "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.650952768851171*^9, 3.6509528196276293`*^9}, {
  3.650956662398754*^9, 
  3.650956673629526*^9}},ExpressionUUID->"07e9d553-e75c-465f-a9f5-\
db4d23a94b9c"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partd"}], "MessageName"], ":", 
  " ", "\<\"Part specification \
\[NoBreak]\\!\\(\\(\\(quadfullNum[\\(\\(\\(\\({2.43`, 0.37`, 0}\\)\\), \
3\\)\\)]\\)\\) \[LeftDoubleBracket] \\(\\(2, 1\\)\\) \[RightDoubleBracket]\\)\
\[NoBreak] is longer than depth of object. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/partd\\\", ButtonNote -> \
\\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.651912734828926*^9},ExpressionUUID->"c1711fe8-ee53-4646-b94c-\
97cb2617f266"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partd"}], "MessageName"], ":", 
  " ", "\<\"Part specification \
\[NoBreak]\\!\\(\\(\\(quadfullNum[\\(\\(\\(\\({2.\
430000000000000159872115546022541821`2., \
0.36999999999999999555910790149937383831`2., 0}\\)\\), 3.`2.\\)\\)]\\)\\) \
\[LeftDoubleBracket] \\(\\(2, 1\\)\\) \[RightDoubleBracket]\\)\[NoBreak] is \
longer than depth of object. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/partd\\\", ButtonNote -> \
\\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.651912735092634*^9},ExpressionUUID->"441bf293-d62a-41a1-acb8-\
4528173b69b6"],

Cell[BoxData[
 TagBox[
  RowBox[{
   RowBox[{"quadfullNum", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "2.430000000000000159872115546022541821`2.", ",", 
       "0.36999999999999999555910790149937383831`2.", ",", "0"}], "}"}], ",", 
     "3.`2."}], "]"}], "\[LeftDoubleBracket]", 
   RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.650956667450488*^9, 3.650956674866496*^9}, 
   3.651912735107265*^9},ExpressionUUID->"70bb34e7-c831-422e-816f-\
f0a1e1317c2a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SetPrecision", "[", 
   RowBox[{
    RowBox[{"newD2", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{"#", ",", 
            RowBox[{"-", "1"}]}], "]"}], "&"}], "/@", 
         RowBox[{"Drop", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{"klNEW", ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}], 
            "\[LeftDoubleBracket]", 
            RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"-", "1"}]}], "]"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{"#", ",", 
            RowBox[{"-", "1"}]}], "]"}], "&"}], "/@", 
         RowBox[{"Drop", "[", 
          RowBox[{
           RowBox[{"klNEW", "\[LeftDoubleBracket]", 
            RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"-", "1"}]}], "]"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{"#", ",", 
            RowBox[{"-", "1"}]}], "]"}], "&"}], "/@", 
         RowBox[{"Drop", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{"klNEW", ",", 
              RowBox[{"{", 
               RowBox[{"3", ",", "1", ",", "2"}], "}"}]}], "]"}], 
            "\[LeftDoubleBracket]", 
            RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"-", "1"}]}], "]"}]}]}], "}"}], "//", "Normal"}]}], ",", 
    "2"}], "]"}], "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.65095288811526*^9, 3.650952995453281*^9}, {
   3.650953030693699*^9, 3.6509530672089376`*^9}, {3.6509561018721657`*^9, 
   3.650956106903165*^9}, {3.650956540975568*^9, 3.650956614698119*^9}, 
   3.650956718820271*^9},ExpressionUUID->"1747b248-3796-494f-b858-\
1634e46a7554"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[GridBox[{
        {"0.02138748411910306596039887949700641911`2."},
        {"0.01171484435399798573751439789702999406`2."},
        {"0.00611887750700573079809529986050620209`2."},
        {"0.0031517735452071572732624105128707015`2."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0.01171484435399791634857535882474621758`2."},
        {"0.00629847764640543983372111824792227708`2."},
        {"0.00321348868358029698955036224106152076`2."},
        {"0.00161278489601319845181404133427349734`2."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0.00611887750700573773698920376773457974`2."},
        {"0.00321348868358043576742844038562907372`2."},
        {"0.00159267182824299538546064525235124165`2."},
        {"0.00077463442737428760825890705632446043`2."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0.00315177354520704278151299604360247031`2."},
        {"0.00161278489601279773069109069183468819`2."},
        {"0.0007746344273734974417155996206929558`2."},
        {"0.00036372069447762828478531993425804103`2."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column]},
    {
     TagBox[GridBox[{
        {"0.03027567505886340215592866798033355735`2."},
        {"0.01743741207292209827173223857244011015`2."},
        {"0.00764915188539840723569440683604625519`2."},
        {"0.00325218834033160625329728077304025646`2."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0.0166770258322660319683095053733268287`2."},
        {"0.00779950455576115808664638962000026368`2."},
        {"0.00322082454829817135810721140387613559`2."},
        {"0.00139068653280786762305165638053949806`2."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0.00748002184624371735388592696835985407`2."},
        {"0.00310653787493886737736126235631672898`2."},
        {"0.00126025568570962455405837232547128224`2."},
        {"0.00056250535784588447107967823512808536`2."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0.00303898417646137827818897392262442736`2."},
        {"0.00118385769860416753540555134804890258`2."},
        {"0.00048220044317199596550782558779246756`2."},
        {"0.00022376914821290502105588515746603662`2."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column]},
    {
     TagBox[GridBox[{
        {"0.03027567505886331888920182109359302558`2."},
        {"0.01667702583226597645715827411549980752`2."},
        {"0.00748002184624418225977748875266115647`2."},
        {"0.00303898417646194726748909431535139447`2."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0.01743741207292244521642743393385899253`2."},
        {"0.00779950455576122053669152478505566251`2."},
        {"0.00310653787494348521125431261680205353`2."},
        {"0.001183857698606119099316025256030116`2."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0.00764915188541208032613205602956440998`2."},
        {"0.00322082454830179693017200293070345651`2."},
        {"0.00126025568576113369823055165852565551`2."},
        {"0.00048220044318691979157165405922569335`2."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column], 
     TagBox[GridBox[{
        {"0.00325218834037727111407889424299355596`2."},
        {"0.00139068653286926989520733144445330254`2."},
        {"0.00056250535827411830835931283445461304`2."},
        {"0.00022376914828370255555745060860317608`2."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {{
            Offset[0.2]}}, "RowsIndexed" -> {}}],
      Column]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.650952898765122*^9, 3.650952906430279*^9}, {
   3.65095296537217*^9, 3.650952996573297*^9}, {3.650953041513843*^9, 
   3.6509530676463327`*^9}, 3.6509561078407307`*^9, {3.650956571985969*^9, 
   3.650956616199132*^9}, 
   3.6519127354839363`*^9},ExpressionUUID->"3acf683a-a7e2-4089-b155-\
2092ebd94926"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SetPrecision", "[", 
   RowBox[{
    RowBox[{"oldD1", "=", 
     RowBox[{"{", 
      RowBox[{"klOLD", "\[LeftDoubleBracket]", 
       RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}], "}"}]}], ",", 
    "2"}], "]"}], "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.650956826413121*^9, 3.650956854078081*^9}, {
   3.65095705618347*^9, 3.6509570628221407`*^9}, 3.650957188862076*^9, {
   3.6509680559522676`*^9, 
   3.650968072159562*^9}},ExpressionUUID->"a67dfb04-8486-44fe-adab-\
44b6c15cc0d2"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partw"}], "MessageName"], ":", 
  " ", "\<\"Part \[NoBreak]\\!\\(3\\)\[NoBreak] of \
\[NoBreak]\\!\\(quadfullNum[\\(\\(\\(\\({2.43`, 0.37`, 0}\\)\\), 3\\)\\)]\\)\
\[NoBreak] does not exist. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/partw\\\", ButtonNote -> \
\\\"Part::partw\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.651912735779912*^9},ExpressionUUID->"bbb76652-fe89-4269-a5f5-\
78cd831b77f3"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partw"}], "MessageName"], ":", 
  " ", "\<\"Part \[NoBreak]\\!\\(3\\)\[NoBreak] of \
\[NoBreak]\\!\\(quadfullNum[\\(\\(\\(\\({2.\
430000000000000159872115546022541821`2., \
0.36999999999999999555910790149937383831`2., 0}\\)\\), 3.`2.\\)\\)]\\)\
\[NoBreak] does not exist. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/partw\\\", ButtonNote -> \
\\\"Part::partw\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.651912736000101*^9},ExpressionUUID->"29315f4f-44ca-4a04-b463-\
5a00496b6fb4"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       RowBox[{"quadfullNum", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "2.430000000000000159872115546022541821`2.", ",", 
           "0.36999999999999999555910790149937383831`2.", ",", "0"}], "}"}], 
         ",", "3.`2."}], "]"}], "\[LeftDoubleBracket]", 
       RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6509568438480673`*^9, 3.650956854765684*^9}, 
   3.650957063892455*^9, 3.6509571894039373`*^9, {3.6509680683035994`*^9, 
   3.650968072589493*^9}, 
   3.651912736015435*^9},ExpressionUUID->"bcb6d530-8d02-4276-b2d8-\
c212e9e4e3d7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SetPrecision", "[", 
   RowBox[{
    RowBox[{"newD1", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"klNEW", ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}], 
         "\[LeftDoubleBracket]", 
         RowBox[{
          RowBox[{"-", "1"}], ",", 
          RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"klNEW", "\[LeftDoubleBracket]", 
         RowBox[{
          RowBox[{"-", "1"}], ",", 
          RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"klNEW", ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "1", ",", "2"}], "}"}]}], "]"}], 
         "\[LeftDoubleBracket]", 
         RowBox[{
          RowBox[{"-", "1"}], ",", 
          RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}], "}"}], "//", 
      "Normal"}]}], ",", "2"}], "]"}], "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.65095288811526*^9, 3.650952995453281*^9}, {
   3.650953030693699*^9, 3.6509530672089376`*^9}, {3.6509561018721657`*^9, 
   3.650956106903165*^9}, {3.650956540975568*^9, 3.650956614698119*^9}, {
   3.650956718820271*^9, 3.6509567624071074`*^9}, {3.650956867041882*^9, 
   3.650956882609977*^9}, {3.650957091279214*^9, 3.650957110215807*^9}, {
   3.650957235016823*^9, 3.6509572372950907`*^9}, 3.6509680454908323`*^9, {
   3.650968077770822*^9, 
   3.650968088041163*^9}},ExpressionUUID->"665210f3-d294-46f3-98c4-\
1ebdc40e7123"],

Cell[BoxData[
 TagBox[GridBox[{
    {"0.00388869484534473675019228267046855763`2.", 
     "0.00185266742308456966448204639164032415`2.", 
     "0.00082751390618997222592412299491115846`2.", 
     "0.0003590262567822041436804703096186131`2.", 
     "0.00029823593779595893721312549473623221`2."},
    {"0.00266685194164324734789062176787410863`2.", 
     "0.00100407859088386119950087049801368266`2.", 
     "0.00040504310936169407586504576102015562`2.", 
     "0.00018707575952858854911875496895845572`2.", 
     "0.00029823593779595893721312549473623221`2."},
    {"0.00388869484528518716270895083653158508`2.", 
     "0.00185266742301918446722552857863774989`2.", 
     "0.00082751390570463302653880788284368464`2.", 
     "0.00035902625669476714159733532483187446`2.", 
     "0.00029823593779595893721312549473623221`2."}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.650952898765122*^9, 3.650952906430279*^9}, {
   3.65095296537217*^9, 3.650952996573297*^9}, {3.650953041513843*^9, 
   3.6509530676463327`*^9}, 3.6509561078407307`*^9, {3.650956571985969*^9, 
   3.650956616199132*^9}, 3.650956765065441*^9, 3.650956883709683*^9, {
   3.650957098407331*^9, 3.650957110582386*^9}, 3.650957237943705*^9, 
   3.6509680477146*^9, 3.650968088840198*^9, 
   3.651912736310782*^9},ExpressionUUID->"405b4fea-c5d3-497d-bc2e-\
b764f337b545"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Simplifying genealogies", "Subsection",
 CellChangeTimes->{{3.64851881228259*^9, 3.64851881624151*^9}, {
   3.649333555079255*^9, 3.649333556423012*^9}, 
   3.652594935146371*^9},ExpressionUUID->"9e7b65a5-8602-4342-93d1-\
542154e0af70"],

Cell[CellGroupData[{

Cell["unRoot", "Subsubsection",
 CellChangeTimes->{{3.6408686012397003`*^9, 3.640868617770273*^9}, {
   3.6467177221270313`*^9, 3.646717724559108*^9}, 3.64851891620654*^9, 
   3.649230532552003*^9, 
   3.649333553000515*^9},ExpressionUUID->"20077d3f-fe20-49d1-8dcc-\
989012951d6a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"unRoot", "::", "usage"}], "=", 
   "\"\<unRoot[gf,\[Omega]] relabels the \[Omega] variables of a GF to \
eliminate the root. Each \[Omega] corresponding to a branch of an unrooted \
genealogy is labeled by the two sets of leaves on either side - for example, \
a new variable \[Omega][{{a},{b,c,d}}] is generated that replaces \
\[Omega][{a}] and \[Omega][{b,c,d}]\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.64086862094767*^9, 3.640868723361521*^9}, {
   3.6467177343867483`*^9, 3.646717906547887*^9}, {3.648386854514851*^9, 
   3.648386880073951*^9}, 3.6485188070715437`*^9, {3.648518894125914*^9, 
   3.648518938537064*^9}},ExpressionUUID->"5a5d5eed-2b87-41c7-b750-\
b338634db276"],

Cell[BoxData[
 RowBox[{
  RowBox[{"unRoot", "[", 
   RowBox[{"gf_", ",", "\[Omega]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"r\[Omega]", ",", "rall", ",", "rcomp"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"r\[Omega]", "=", 
      RowBox[{"GetConfigsGF", "[", 
       RowBox[{"gf", ",", "\[Omega]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rall", "=", 
      RowBox[{
       RowBox[{"r\[Omega]", "//", "Flatten"}], "//", "Union"}]}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{
      "this", " ", "may", " ", "need", " ", "to", " ", "be", " ", "changed", 
       " ", "to", " ", "allow", " ", "for", " ", "genes", " ", "that", " ", 
       "are", " ", "themselves", " ", 
       RowBox[{"lists", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"rcomp", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Complement", "[", 
         RowBox[{"rall", ",", "#"}], "]"}], "&"}], "/@", "r\[Omega]"}]}], ";", 
     RowBox[{"gf", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Omega]", "[", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}], "\[Rule]", 
           RowBox[{"\[Omega]", "[", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "]"}]}], ")"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"r\[Omega]", ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Sort", "[", "#", "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"r\[Omega]", ",", "rcomp"}], "}"}], "//", "Thread"}],
                ")"}]}], ")"}]}], "}"}], "//", "Thread"}], ")"}]}], 
       "}"}]}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.646716315542646*^9, 3.6467163847961073`*^9}, {
   3.646716439235901*^9, 3.646716524172421*^9}, {3.646716695781507*^9, 
   3.646716926439479*^9}, {3.646716980487464*^9, 3.6467171093673363`*^9}, {
   3.646717347130001*^9, 3.6467174244408407`*^9}, {3.646717474160054*^9, 
   3.6467174841843843`*^9}, 3.646717924684495*^9, {3.646718582201331*^9, 
   3.646718589457149*^9}, {3.6467186442422123`*^9, 3.64671864701593*^9}, {
   3.646718678897995*^9, 3.64671868016813*^9}, {3.6467187266013327`*^9, 
   3.646718746721702*^9}, {3.646718929393923*^9, 3.646718943854789*^9}, {
   3.646719007138398*^9, 3.646719020393457*^9}, 3.648518919407668*^9, {
   3.648518991685203*^9, 
   3.6485190119979677`*^9}},ExpressionUUID->"7335d1b1-cc7b-43c7-afda-\
821df754cd4e"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Making simulated data", "Subsection",
 CellChangeTimes->{{3.6484623184526443`*^9, 3.648462326809866*^9}, 
   3.649226570969022*^9, 
   3.652594940801898*^9},ExpressionUUID->"09eda746-da76-4d4b-bcb0-\
7327208483fa"],

Cell[CellGroupData[{

Cell["makeSample", "Subsubsection",
 CellChangeTimes->{{3.6408686012397003`*^9, 
  3.640868617770273*^9}},ExpressionUUID->"ef6e0631-8544-4161-a50f-\
5629c920191a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"makeSample", "::", "usage"}], "=", "\"\<makeSample[\!\(\*
StyleBox[\"probs\",
FontSlant->\"Italic\"]\),n] draws n random samples according to the table of \
probabilities, and tabulates them in a sparse array that has the same form as \
the supplied table of probabilities.  \!\(\*
StyleBox[\"probs\",
FontSlant->\"Italic\"]\) may be a list or a sparse array.\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.64086862094767*^9, 3.640868723361521*^9}, {
  3.648462348076356*^9, 
  3.648462355640877*^9}},ExpressionUUID->"fc57d353-3038-464a-8680-\
47897927d254"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"makeSample", "[", 
    RowBox[{
     RowBox[{"pt", ":", 
      RowBox[{"(", 
       RowBox[{"_SparseArray", "|", "_List"}], ")"}]}], ",", "n_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"rls", "=", 
       RowBox[{"ArrayRules", "[", "pt", "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"SparseArray", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "\[Rule]", 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         ")"}], "&"}], "/@", 
       RowBox[{"Tally", "[", 
        RowBox[{"RandomChoice", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"rls", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"rls", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ")"}]}], 
          ",", "n"}], "]"}], "]"}]}], "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.640868701267112*^9, 3.640868764475628*^9}, {
  3.640868805634309*^9, 3.640868806297227*^9}, {3.6485178790588827`*^9, 
  3.648517901311778*^9}},ExpressionUUID->"2273d568-105c-4e69-8df1-\
fac099044539"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Summarising real data", "Subsection",
 CellChangeTimes->{{3.6484623184526443`*^9, 3.648462326809866*^9}, {
   3.648494327604176*^9, 3.648494335105941*^9}, {3.649062020450708*^9, 
   3.649062023073571*^9}, {3.650607568289318*^9, 3.650607577848393*^9}, 
   3.652594945226306*^9},ExpressionUUID->"00e19ed4-004a-4d2f-bb83-\
43f04e8a4fc8"],

Cell[CellGroupData[{

Cell["replaceMax", "Subsubsection",
 CellChangeTimes->{{3.5800243136350203`*^9, 3.5800243178992443`*^9}, 
   3.603538056459055*^9, 3.6098293995613728`*^9, {3.648493958079331*^9, 
   3.6484939583914003`*^9}, 
   3.650607675530051*^9},ExpressionUUID->"1ed74e00-af53-4cdb-a36f-\
794fdb7a1866"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"replaceMax", "::", "usage"}], "=", 
   "\"\<replaceMax[l_List,{max_,pos_}] replaces mutation counts > \
\!\(\*SubscriptBox[\(k\), \(max\)]\) with \!\(\*SubscriptBox[\(k\), \(\(max\)\
\(\\\ \)\)]\)+1. This function is needed for configcounts. \>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.609829413485471*^9, 3.609829453008335*^9}, 
   3.6098295633774652`*^9, {3.634915599048242*^9, 3.634915601132962*^9}, {
   3.647676886605483*^9, 3.647676890957909*^9}, 3.6476839357243958`*^9, {
   3.648493961329638*^9, 3.648494173771408*^9}, {3.6484942362736473`*^9, 
   3.648494261211205*^9}, {3.650607699290142*^9, 3.6506077247413177`*^9}, {
   3.650607797093759*^9, 3.650607882878664*^9}, {3.651912151956059*^9, 
   3.651912160776847*^9}},ExpressionUUID->"2d10d401-ed95-40c2-a364-\
b3ddf1088e16"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"replaceMax", "[", 
    RowBox[{"l_List", ",", 
     RowBox[{"{", 
      RowBox[{"max_", ",", "pos_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"ReplacePart", "[", 
        RowBox[{"#", ",", 
         RowBox[{"pos", "\[Rule]", 
          RowBox[{"max", "+", "1"}]}]}], "]"}], "&"}], "/@", 
      RowBox[{"(", 
       RowBox[{"Select", "[", 
        RowBox[{"l", ",", 
         RowBox[{
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "pos", "\[RightDoubleBracket]"}], ">",
            "max"}], "&"}]}], "]"}], ")"}]}], ",", 
     RowBox[{"Select", "[", 
      RowBox[{"l", ",", 
       RowBox[{
        RowBox[{
         RowBox[{
         "#", "\[LeftDoubleBracket]", "pos", "\[RightDoubleBracket]"}], 
         "\[LessSlantEqual]", "max"}], "&"}]}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.609584222324357*^9, 3.609584227424573*^9}, {
   3.6095842913278*^9, 3.60958433953519*^9}, {3.609584478495235*^9, 
   3.609584540657233*^9}, {3.609584596586052*^9, 3.609584710882535*^9}, {
   3.6095847420810127`*^9, 3.609584766338819*^9}, {3.609584800065015*^9, 
   3.609584950177423*^9}, {3.609586998138843*^9, 3.609587038422431*^9}, {
   3.6095870705349483`*^9, 3.609587070662179*^9}, {3.6095871255431967`*^9, 
   3.60958746598149*^9}, {3.609587826751408*^9, 3.609587848728653*^9}, {
   3.609744611105032*^9, 3.6097446217850657`*^9}, {3.609745982204377*^9, 
   3.6097459978484917`*^9}, {3.609746278985833*^9, 3.609746312727016*^9}, {
   3.6097620525819902`*^9, 3.609762061765668*^9}, {3.609762230267967*^9, 
   3.609762262698598*^9}, {3.609762383433483*^9, 3.60976254992484*^9}, 
   3.609842040378034*^9, 3.6194322370500917`*^9, {3.64767690532371*^9, 
   3.647677029791995*^9}, {3.6476771296426992`*^9, 3.647677164349203*^9}, {
   3.6476774223663273`*^9, 3.6476774882159643`*^9}, {3.647677542911224*^9, 
   3.647677583967635*^9}, {3.647677733862587*^9, 3.6476777467589607`*^9}, {
   3.647678325192009*^9, 3.64767834012741*^9}, {3.64767840105529*^9, 
   3.647678409232025*^9}, {3.64767856733492*^9, 3.6476785882101917`*^9}, {
   3.647679300714965*^9, 3.647679313293911*^9}, {3.647681054383995*^9, 
   3.647681194976433*^9}, {3.647681282875847*^9, 3.6476813227458773`*^9}, {
   3.647681356407596*^9, 3.6476813616408577`*^9}, {3.647681531283163*^9, 
   3.647681541000996*^9}, {3.647681580281694*^9, 3.647681642348319*^9}, 
   3.647682019266851*^9, {3.647682746170767*^9, 3.647682746866478*^9}, {
   3.647682935034985*^9, 
   3.647682937111841*^9}},ExpressionUUID->"0236bc3f-8887-4868-b0b2-\
51064b7cc403"]
}, Closed]],

Cell[CellGroupData[{

Cell["configCounts", "Subsubsection",
 CellChangeTimes->{{3.5800243136350203`*^9, 3.5800243178992443`*^9}, 
   3.603538056459055*^9, 3.6098293995613728`*^9, {3.648493958079331*^9, 
   3.6484939583914003`*^9}, {3.650782762689159*^9, 
   3.650782768361164*^9}},ExpressionUUID->"572c8e32-9a49-4a2c-88a9-\
1e4d5323c740"],

Cell[TextData[{
 StyleBox["Note:",
  FontWeight->"Bold"],
 " configcounts works for arbitrary sample sizes. It is worthwhile to do this \
data summarizing step outside of ",
 StyleBox["Mathematica ",
  FontSlant->"Italic"],
 "when dealing with large datasets or counting mutational configurations \
repeatedly, e.g. in sliding windows."
}], "Text",
 CellChangeTimes->{{3.634915624994659*^9, 3.634915655985436*^9}, {
   3.647684187053857*^9, 3.64768429633247*^9}, 3.648386609405918*^9, {
   3.648493943716523*^9, 3.648493950057706*^9}, {3.648494185013486*^9, 
   3.648494226955196*^9}, {3.648494340733572*^9, 3.6484944139863*^9}, {
   3.6506076244651537`*^9, 3.6506076342736692`*^9}, {3.650607893200663*^9, 
   3.6506079892327747`*^9}},ExpressionUUID->"65ba1246-b206-4a2e-abbc-\
9720e97f206c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"configCounts", "::", "usage"}], "=", 
   "\"\<configcounts[l,max] counts blockwise mutational configurations for \
arbitrary number of mutation types. The input is a list of counts of those \
types in all blocks which should have the same ordering as the sorted list of \
\[Omega] terms of the GF. max is either a list of maxima or a single global \
maximum for all mutation types\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.609829413485471*^9, 3.609829453008335*^9}, 
   3.6098295633774652`*^9, {3.634915599048242*^9, 3.634915601132962*^9}, {
   3.647676886605483*^9, 3.647676890957909*^9}, 3.6476839357243958`*^9, {
   3.648493961329638*^9, 3.648494173771408*^9}, {3.6484942362736473`*^9, 
   3.648494261211205*^9}, {3.650782771104411*^9, 
   3.650782771430812*^9}},ExpressionUUID->"f608abe0-c916-4a14-a486-\
90f1cf2025ca"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"configCounts", "[", 
    RowBox[{"l_List", ",", "max_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ll", "=", 
        RowBox[{"Length", "[", "max", "]"}]}], ",", "r", ",", "truncl", ",", 
       RowBox[{"maxt", "=", 
        RowBox[{"max", "+", "1"}]}], ",", "counts"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"max", ",", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", "ll"}], "]"}]}], "}"}], "//", "Thread"}]}], ";", 
      RowBox[{"truncl", "=", 
       RowBox[{"Fold", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"replaceMax", "[", 
           RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", "l", ",", "r"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"counts", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "+",
              "1"}], ")"}], "\[Rule]", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
          ")"}], "&"}], "/@", 
        RowBox[{"Tally", "[", "truncl", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"SparseArray", "[", 
       RowBox[{"counts", ",", 
        RowBox[{"max", "+", "2"}]}], "]"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.647681666135387*^9, 3.647681695375505*^9}, {
   3.647681791215955*^9, 3.647681896032943*^9}, {3.647681936761718*^9, 
   3.647681954185371*^9}, {3.6476819847542*^9, 3.647682005313284*^9}, {
   3.6476820542672358`*^9, 3.647682084296722*^9}, 3.647682116281983*^9, {
   3.647682227362294*^9, 3.6476822324968767`*^9}, {3.647682265354684*^9, 
   3.64768232708993*^9}, {3.6476823842267036`*^9, 3.647682458035964*^9}, {
   3.647682502700032*^9, 3.647682541570771*^9}, {3.6476828514047823`*^9, 
   3.6476828831469183`*^9}, {3.64768301350014*^9, 3.647683021739245*^9}, {
   3.647683492252385*^9, 3.6476834923553133`*^9}, {3.647683681517623*^9, 
   3.64768389079834*^9}, {3.647684035389344*^9, 3.647684036479693*^9}, {
   3.6476845536365643`*^9, 3.647684554050926*^9}, 3.647684710532655*^9, {
   3.647684784841509*^9, 3.647684843834524*^9}, {3.647684953742975*^9, 
   3.64768499391494*^9}, {3.647686032473057*^9, 3.6476860566955557`*^9}, {
   3.647686159331931*^9, 3.647686271482883*^9}, {3.647686368325342*^9, 
   3.6476863711882277`*^9}, {3.647686441452284*^9, 3.6476864453083467`*^9}, {
   3.6484939634811*^9, 3.648493975429147*^9}, {3.65078277387912*^9, 
   3.650782774185463*^9}, {3.650792610214121*^9, 
   3.650792615542267*^9}},ExpressionUUID->"8d776ae1-f491-42a7-b7cd-\
459b3411c58a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"configCounts", "[", 
    RowBox[{"l_List", ",", "max_Integer"}], "]"}], ":=", 
   RowBox[{"configCounts", "[", 
    RowBox[{"l", ",", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"max", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"l", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "]"}]}], "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.647681666135387*^9, 3.647681695375505*^9}, {
   3.647681791215955*^9, 3.647681896032943*^9}, {3.647681936761718*^9, 
   3.647681954185371*^9}, {3.6476819847542*^9, 3.647682005313284*^9}, {
   3.6476820542672358`*^9, 3.647682084296722*^9}, 3.647682116281983*^9, {
   3.647682227362294*^9, 3.6476822324968767`*^9}, {3.647682265354684*^9, 
   3.64768232708993*^9}, {3.6476823842267036`*^9, 3.647682458035964*^9}, {
   3.647682502700032*^9, 3.647682541570771*^9}, {3.6476828514047823`*^9, 
   3.6476828831469183`*^9}, {3.64768301350014*^9, 3.647683021739245*^9}, {
   3.647683492252385*^9, 3.6476834923553133`*^9}, {3.647683681517623*^9, 
   3.64768389079834*^9}, {3.647684035389344*^9, 3.647684082195257*^9}, 
   3.647684305576324*^9, 3.647684830229619*^9, {3.647686413017045*^9, 
   3.647686418817227*^9}, {3.6484939670927277`*^9, 3.648493970863701*^9}, {
   3.648494266925915*^9, 3.648494267254032*^9}, {3.650782777118483*^9, 
   3.6507827845978527`*^9}},ExpressionUUID->"c69edca0-e8dc-45fb-b68d-\
0324d613e31a"]
}, Closed]],

Cell[CellGroupData[{

Cell["FindkMax", "Subsubsection",
 CellChangeTimes->{{3.5800243136350203`*^9, 3.5800243178992443`*^9}, 
   3.603538056459055*^9, 3.6098293995613728`*^9, {3.648493958079331*^9, 
   3.6484939583914003`*^9}, {3.650782762689159*^9, 3.650782768361164*^9}, 
   3.650870959805119*^9},ExpressionUUID->"f2a18b7b-a6c9-445a-ba2b-\
088d76724a3d"],

Cell[TextData[{
 StyleBox["Note:",
  FontWeight->"Bold"],
 " Hard coded for 4 types, need to generalize to any # of branch types."
}], "Text",
 CellChangeTimes->{{3.634915624994659*^9, 3.634915655985436*^9}, {
   3.647684187053857*^9, 3.64768429633247*^9}, 3.648386609405918*^9, {
   3.648493943716523*^9, 3.648493950057706*^9}, {3.648494185013486*^9, 
   3.648494226955196*^9}, {3.648494340733572*^9, 3.6484944139863*^9}, {
   3.6506076244651537`*^9, 3.6506076342736692`*^9}, {3.650607893200663*^9, 
   3.6506079892327747`*^9}, {3.6508712824867*^9, 3.6508713476934233`*^9}, 
   3.6519076958933287`*^9},ExpressionUUID->"083ad4c7-9428-48ea-ae96-\
9901c7e0dece"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FindkMax", "::", "usage"}], "=", 
   "\"\<For a given threshold p and a dataset consiting of a list of \
blockwise counts l, FindkMax[l,p] gives the kmax for each branch type such \
that (%l >\!\(\*SubscriptBox[\(k\), \(max\)]\))<p. The output is a vector of \
kmax values and the total fraction of blocks > \!\(\*SubscriptBox[\(k\), \
\(max\)]\).\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.609829413485471*^9, 3.609829453008335*^9}, 
   3.6098295633774652`*^9, {3.634915599048242*^9, 3.634915601132962*^9}, {
   3.647676886605483*^9, 3.647676890957909*^9}, 3.6476839357243958`*^9, {
   3.648493961329638*^9, 3.648494173771408*^9}, {3.6484942362736473`*^9, 
   3.648494261211205*^9}, {3.650782771104411*^9, 3.650782771430812*^9}, {
   3.6508709761265917`*^9, 3.65087127618885*^9}, {3.651911924320888*^9, 
   3.651911931981488*^9}},ExpressionUUID->"0524f46b-e839-4b24-a537-\
2a7fc7fc3ec6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindkMax", "[", 
   RowBox[{"l_List", ",", "p_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ll", "=", 
       RowBox[{
        RowBox[{"l", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "//",
         "Length"}]}], ",", "cond", ",", "kmax"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cond", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Sort", "[", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              ")"}], "&"}], "/@", "l"}], ",", 
           RowBox[{
            RowBox[{"#", ">", "0"}], "&"}]}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "ll"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"kmax", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"cond", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", 
          RowBox[{"-", 
           RowBox[{"Round", "[", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
              "cond", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              "]"}], "*", "p"}], "]"}]}]}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "ll"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"{", 
      RowBox[{"kmax", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Select", "[", 
            RowBox[{"l", ",", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                ">", 
                RowBox[{
                "kmax", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}], "||", 
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                ">", 
                RowBox[{
                "kmax", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}]}], "||", 
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
                ">", 
                RowBox[{
                "kmax", "\[LeftDoubleBracket]", "3", 
                 "\[RightDoubleBracket]"}]}], "||", 
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
                ">", 
                RowBox[{
                "kmax", "\[LeftDoubleBracket]", "4", 
                 "\[RightDoubleBracket]"}]}]}], "&"}]}], "]"}], "//", 
           "Length"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"l", "//", "Length"}], ")"}]}], "//", "N"}]}], "}"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650865842706854*^9, 3.650865912631237*^9}, {
  3.6508659602477913`*^9, 3.650866098801526*^9}, {3.6508684500748262`*^9, 
  3.650868583539837*^9}, {3.650868776339548*^9, 3.650868828340369*^9}, {
  3.650868869516499*^9, 3.6508689011649323`*^9}, {3.650868963933464*^9, 
  3.650868979613575*^9}, {3.65086920854944*^9, 3.65086922932524*^9}, {
  3.6508692740379953`*^9, 3.6508693054713173`*^9}, {3.650869409615803*^9, 
  3.6508694268240957`*^9}, {3.6508694800064583`*^9, 3.650869484230455*^9}, {
  3.65086952836843*^9, 3.6508696785457897`*^9}, {3.650870167444953*^9, 
  3.650870190497426*^9}},ExpressionUUID->"6aa4d4c1-df44-47a8-a8f9-\
201dddf416f5"]
}, Closed]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1024, 655},
WindowMargins->{{126, Automatic}, {Automatic, 92}},
Magnification:>1.25 Inherited,
FrontEndVersion->"11.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (April 27, \
2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Info3651916292-2487941"->{
  Cell[742332, 19185, 1335, 25, 
  1553, "Print", "ExpressionUUID" -> "87a7872a-7927-4268-a43f-4e1c75a94319",
   CellTags->"Info3651916292-2487941"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Info3651916292-2487941", 871715, 22522}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 182, 3, 38, "Text", "ExpressionUUID" -> \
"f7a4efa7-ff31-4f88-a6b9-9d9bb1f99926"],
Cell[CellGroupData[{
Cell[765, 27, 453, 7, 115, "Title", "ExpressionUUID" -> \
"3a0687c2-ed86-4466-9947-9281ca3059ca"],
Cell[1221, 36, 577, 9, 86, "Text", "ExpressionUUID" -> \
"21f9aa25-4abe-43ca-88ba-f3d750f5cd6f"],
Cell[CellGroupData[{
Cell[1823, 49, 252, 4, 54, "Subsection", "ExpressionUUID" -> \
"a447e314-ab41-4d3e-b70c-48d5c5b7f011"],
Cell[CellGroupData[{
Cell[2100, 57, 185, 3, 44, "Subsubsection", "ExpressionUUID" -> \
"64aeef17-fe0c-4aed-9ef8-ebccd2807961"],
Cell[2288, 62, 1930, 36, 261, "Text", "ExpressionUUID" -> \
"e2e479dd-4549-49fe-8275-56c8a15f1c12"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4255, 103, 230, 4, 44, "Subsubsection", "ExpressionUUID" -> \
"844119fc-2f2a-4249-b396-1da2c6103043"],
Cell[4488, 109, 667, 11, 110, "Text", "ExpressionUUID" -> \
"9e41d31d-7ab5-4fbc-af86-368b9741598e"],
Cell[5158, 122, 1014, 16, 133, "Text", "ExpressionUUID" -> \
"55f4cd3b-4ce7-417c-ae22-cc4823ca2d4c"],
Cell[6175, 140, 960, 18, 252, "Text", "ExpressionUUID" -> \
"f92675d8-e811-4724-94ba-e8d4b1c185d7"],
Cell[7138, 160, 744, 13, 133, "Text", "ExpressionUUID" -> \
"97f46963-a78f-4d60-a391-3b067709095c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7919, 178, 163, 3, 44, "Subsubsection", "ExpressionUUID" -> \
"7042b99e-8114-4b47-b926-f5cdf2df9e63"],
Cell[8085, 183, 636, 11, 110, "Text", "ExpressionUUID" -> \
"7334a2a7-c99b-4d09-83d7-0e37bc1e4caf"],
Cell[8724, 196, 515, 9, 110, "Text", "ExpressionUUID" -> \
"89f80040-ddcc-4cc9-b539-9e8c7602cbe1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9276, 210, 229, 8, 44, "Subsubsection", "ExpressionUUID" -> \
"ba2660ee-e049-4625-b9fa-cbc0be43d981"],
Cell[9508, 220, 1424, 44, 92, "Text", "ExpressionUUID" -> \
"84f33182-6d41-4e98-b4eb-5db68bf49f1e"],
Cell[10935, 266, 743, 17, 62, "Text", "ExpressionUUID" -> \
"3d69a7b8-f1c0-473d-92ff-98a0a3721787"],
Cell[11681, 285, 619, 12, 86, "Text", "ExpressionUUID" -> \
"fdc4232c-aa3e-42fe-9f00-f3a07cc5f15b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[12349, 303, 229, 4, 81, "Section", "ExpressionUUID" -> \
"326bfea6-c39b-4cee-9c1b-6358a0449362"],
Cell[CellGroupData[{
Cell[12603, 311, 217, 4, 54, "Subsection", "ExpressionUUID" -> \
"8ed832cc-ea33-4ff6-ac79-acf68ebdaf5d"],
Cell[CellGroupData[{
Cell[12845, 319, 135, 3, 478, "Subsubsection", "ExpressionUUID" -> \
"074b4d2e-2d98-40d8-9198-6aa03a338e73"],
Cell[12983, 324, 415, 10, 61697, "Input", "ExpressionUUID" -> \
"502f5bef-fbcd-4889-a62e-50e95d3b2592",
 InitializationCell->True],
Cell[13401, 336, 1963, 58, 78126, "Input", "ExpressionUUID" -> \
"6998dca8-c099-4bf9-bc74-2a6947d4de5d",
 InitializationCell->True],
Cell[15367, 396, 193, 4, 28675, "Text", "ExpressionUUID" -> \
"587c77e1-2cbf-46cf-9b9a-9aa031a1cc22"],
Cell[15563, 402, 315, 9, 28675, "Text", "ExpressionUUID" -> \
"3a14f1d0-3cd2-49b5-a003-4fe0b0078bd0"],
Cell[CellGroupData[{
Cell[15903, 415, 315, 8, 28227, "Input", "ExpressionUUID" -> \
"37562080-7547-48c9-b2fc-e8a43a33af86"],
Cell[16221, 425, 195, 5, 26463, "Output", "ExpressionUUID" -> \
"bd7027e5-28b1-4ff7-9e0f-3652be669990"]
}, Closed]],
Cell[16431, 433, 280, 8, 28675, "Text", "ExpressionUUID" -> \
"a652f8f8-dee6-41f0-aedb-3a2f96bd2e91"],
Cell[CellGroupData[{
Cell[16736, 445, 315, 8, 28227, "Input", "ExpressionUUID" -> \
"b654a977-3a10-4176-bd8e-e34b254873cf"],
Cell[17054, 455, 187, 5, 26463, "Output", "ExpressionUUID" -> \
"67a55135-e5ba-401d-b188-fd8ab8ed0eaf"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[17290, 466, 156, 2, 382, "Subsubsection", "ExpressionUUID" -> \
"ecf1388c-e184-4237-8b47-f101b7f6678c"],
Cell[17449, 470, 879, 16, 78126, "Input", "ExpressionUUID" -> \
"41c92cdf-6e5c-445d-9807-62ca0ce4c9b0",
 InitializationCell->True],
Cell[18331, 488, 1165, 32, 61697, "Input", "ExpressionUUID" -> \
"c87a5841-0c26-49c2-bb02-18a2abe09eb3",
 InitializationCell->True],
Cell[19499, 522, 1742, 52, 67678, "Text", "ExpressionUUID" -> \
"df85d171-d1ae-46f0-aaa2-970f3127f93b"]
}, Closed]],
Cell[CellGroupData[{
Cell[21278, 579, 163, 3, 382, "Subsubsection", "ExpressionUUID" -> \
"923f18b6-adf4-4479-82ea-2b45611314da"],
Cell[21444, 584, 792, 15, 62501, "Input", "ExpressionUUID" -> \
"b3d499eb-1346-4fab-90ae-8156850352ae",
 InitializationCell->True],
Cell[22239, 601, 1246, 33, 35828, "Input", "ExpressionUUID" -> \
"80b21b43-8228-4d24-bec9-9a3bfae9bb0e",
 InitializationCell->True],
Cell[23488, 636, 664, 22, 22922, "Text", "ExpressionUUID" -> \
"a2848378-2cc3-4c95-a80a-d94ac41701be"],
Cell[CellGroupData[{
Cell[24177, 662, 399, 11, 21171, "Input", "ExpressionUUID" -> \
"d9aabede-a630-4c5a-9ba4-48d90338685e"],
Cell[24579, 675, 387, 12, 26463, "Output", "ExpressionUUID" -> \
"1ff5fac7-0fc4-4bf1-8bda-49260330ba51"]
}, Closed]],
Cell[24981, 690, 669, 20, 20033, "Text", "ExpressionUUID" -> \
"c15a53fc-d624-46fc-b365-9710fdc88426"],
Cell[CellGroupData[{
Cell[25675, 714, 472, 12, 21171, "Input", "ExpressionUUID" -> \
"439becb0-9149-4161-b28c-8a1cd9900b16"],
Cell[26150, 728, 399, 13, 26463, "Output", "ExpressionUUID" -> \
"26de7c2c-8991-4471-804f-0d970d128db7"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[26598, 747, 164, 3, 382, "Subsubsection", "ExpressionUUID" -> \
"eb08f095-d55d-4382-8ee9-013088866cfe"],
Cell[26765, 752, 511, 11, 49363, "Input", "ExpressionUUID" -> \
"a294714f-e9ca-4cbe-8457-0cb4912f94a7",
 InitializationCell->True],
Cell[27279, 765, 351, 9, 22587, "Input", "ExpressionUUID" -> \
"965b652a-2ba6-4687-bd9e-d2d385e3897c",
 InitializationCell->True],
Cell[27633, 776, 1980, 51, 76415, "Input", "ExpressionUUID" -> \
"801b0ad3-4e9c-4033-a962-91cea8bf0198",
 InitializationCell->True],
Cell[29616, 829, 587, 14, 22922, "Text", "ExpressionUUID" -> \
"f99fb33b-7e8c-4f92-946c-d5522321e7cc"],
Cell[CellGroupData[{
Cell[30228, 847, 493, 14, 22587, "Input", "ExpressionUUID" -> \
"ee2d2288-886a-43ca-a533-4ef068b68613"],
Cell[30724, 863, 10559, 388, 163820, "Output", "ExpressionUUID" -> \
"808d5727-1310-4a6c-b08a-9b7e0618fe40"]
}, Closed]],
Cell[CellGroupData[{
Cell[41320, 1256, 525, 15, 16937, "Input", "ExpressionUUID" -> \
"95395ca8-ebc8-4af6-81f3-ba9dbe9988a8"],
Cell[41848, 1273, 201, 5, 26463, "Output", "ExpressionUUID" -> \
"38d39f74-bae8-4c7f-a0d0-974161180059"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[42098, 1284, 161, 3, 382, "Subsubsection", "ExpressionUUID" -> \
"e8a2aed4-3551-4cdc-b019-c58dbe5c9a43"],
Cell[42262, 1289, 773, 18, 48125, "Text", "ExpressionUUID" -> \
"422b373e-fa98-424a-9c33-49082341091a"],
Cell[43038, 1309, 359, 9, 28227, "Input", "ExpressionUUID" -> \
"99c083bd-9def-42f4-b5fc-34b0707238e4",
 InitializationCell->True],
Cell[43400, 1320, 784, 23, 28227, "Input", "ExpressionUUID" -> \
"d1677830-95b5-4070-97dc-a3507b4d2055",
 InitializationCell->True],
Cell[44187, 1345, 321, 8, 28675, "Text", "ExpressionUUID" -> \
"2b034d71-7500-4399-860e-2ac7fff16624"],
Cell[CellGroupData[{
Cell[44533, 1357, 271, 7, 28227, "Input", "ExpressionUUID" -> \
"f8485a2b-6eaa-4784-b595-241b3bfcdabe"],
Cell[44807, 1366, 830, 28, 26463, "Output", "ExpressionUUID" -> \
"e2bfb1fc-dfbd-4ff9-b986-8f1ab0e0062e"]
}, Closed]],
Cell[45652, 1397, 409, 11, 28675, "Text", "ExpressionUUID" -> \
"f688d631-7a75-439f-a0c1-58e4788f353c"],
Cell[CellGroupData[{
Cell[46086, 1412, 269, 7, 28227, "Input", "ExpressionUUID" -> \
"1c3143ed-b2f1-4189-9f4b-61abbef148ac"],
Cell[46358, 1421, 8095, 285, 129503, "Output", "ExpressionUUID" -> \
"02402006-efdb-4bcc-8da4-511a7134be00"]
}, Closed]],
Cell[CellGroupData[{
Cell[54490, 1711, 302, 8, 28227, "Input", "ExpressionUUID" -> \
"ff1ae728-8759-426a-bf1a-cb52871b41bf"],
Cell[54795, 1721, 131, 3, 26463, "Output", "ExpressionUUID" -> \
"13598d37-71a5-4acf-9ab3-495a8001ba1c"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[54975, 1730, 174, 3, 382, "Subsubsection", "ExpressionUUID" -> \
"c5d572ea-26e2-4968-9059-e5753eb37c9c"],
Cell[55152, 1735, 801, 19, 835, "Text", "ExpressionUUID" -> \
"e91de41e-f259-40f9-843e-1cf593a852e5"],
Cell[CellGroupData[{
Cell[55978, 1758, 2108, 50, 2562, "Input", "ExpressionUUID" -> \
"6571711a-6152-4135-8583-777311ae919b"],
Cell[58089, 1810, 1228, 29, 152358, "Output", "ExpressionUUID" -> \
"128fcc25-d233-40fa-afa4-bcaacbd5da67"]
}, Closed]],
Cell[59332, 1842, 658, 18, 737, "Text", "ExpressionUUID" -> \
"dc836fb1-2f75-491e-9a73-1c98cf3e86da"],
Cell[CellGroupData[{
Cell[60015, 1864, 798, 24, 835, "Input", "ExpressionUUID" -> \
"31afedfd-e921-47ec-8c36-b833531a6d16"],
Cell[60816, 1890, 724, 22, 28227, "Output", "ExpressionUUID" -> \
"3b044db7-ed1c-49c9-9a25-ae4d86804035"]
}, Closed]],
Cell[61555, 1915, 175, 3, 737, "Text", "ExpressionUUID" -> \
"4da63e05-fe7f-412c-99c0-671bc4c70270"],
Cell[61733, 1920, 77087, 1268, 9351, "Input", "ExpressionUUID" -> \
"f266b7cc-3268-4bc1-af86-812b1a69594e"]
}, Closed]],
Cell[CellGroupData[{
Cell[138857, 3193, 159, 3, 382, "Subsubsection", "ExpressionUUID" -> \
"8a6907f6-d834-4953-88e4-94f4c3d1ba3b"],
Cell[139019, 3198, 429, 10, 61697, "Input", "ExpressionUUID" -> \
"3a4ce4bd-b986-48d6-95c8-6f5beedd1e73",
 InitializationCell->True],
Cell[139451, 3210, 1133, 31, 78126, "Input", "ExpressionUUID" -> \
"11ef8699-b8c3-4cb3-a610-1d3b7475a33d",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[140633, 3247, 296, 4, 43, "Subsection", "ExpressionUUID" -> \
"0f17e556-9c84-4b17-af83-cd41fc646a2e"],
Cell[CellGroupData[{
Cell[140954, 3255, 89, 0, 44, "Subsubsection", "ExpressionUUID" -> \
"2581fa0b-9613-45d4-9c65-2c201e061751"],
Cell[141046, 3257, 2624, 41, 6557, "Input", "ExpressionUUID" -> \
"67bd780e-f933-4ff4-98d0-612ce68cec0a",
 InitializationCell->True],
Cell[143673, 3300, 2310, 45, 1438, "Input", "ExpressionUUID" -> \
"8d19bd57-053a-484e-a59d-7bd4bf5f9ef8",
 InitializationCell->True],
Cell[145986, 3347, 3869, 85, 5018, "Input", "ExpressionUUID" -> \
"cfc236ec-0504-41da-8cc1-aed15d039338",
 InitializationCell->True],
Cell[149858, 3434, 8115, 191, 11368, "Input", "ExpressionUUID" -> \
"5a00e024-704f-4bbe-a4fd-bcbdfddb79c6",
 InitializationCell->True],
Cell[157976, 3627, 874, 21, 1391, "Text", "ExpressionUUID" -> \
"6f7503e5-4993-4132-8be2-82e59462e2ce"],
Cell[158853, 3650, 513, 11, 835, "Text", "ExpressionUUID" -> \
"abe1135b-9aef-42e0-a5c1-dd5ab51c05d5"],
Cell[CellGroupData[{
Cell[159391, 3665, 373, 10, 835, "Input", "ExpressionUUID" -> \
"ed4a3e72-dbb5-410e-ad7f-950ca7fd2ac3"],
Cell[159767, 3677, 152, 3, 835, "Output", "ExpressionUUID" -> \
"7cd490f3-c1a9-4902-a6db-ef23943e12bb"]
}, Open  ]],
Cell[159934, 3683, 373, 8, 835, "Text", "ExpressionUUID" -> \
"5f906413-2ac0-47f1-b65c-f4719431f5cc"],
Cell[CellGroupData[{
Cell[160332, 3695, 950, 28, 835, "Input", "ExpressionUUID" -> \
"21c570a2-5c36-41fc-84f7-a393d69f78b7"],
Cell[161285, 3725, 394, 10, 835, "Output", "ExpressionUUID" -> \
"60890c30-50d8-4c87-92c5-e6a03d585a60"]
}, Open  ]],
Cell[161694, 3738, 508, 11, 835, "Text", "ExpressionUUID" -> \
"f327042f-69bf-40a4-9175-1f07054afe58"],
Cell[CellGroupData[{
Cell[162227, 3753, 734, 23, 835, "Input", "ExpressionUUID" -> \
"4e4c986b-f769-4d92-b18e-e166afd7f0fc"],
Cell[162964, 3778, 231, 5, 835, "Output", "ExpressionUUID" -> \
"15846b39-91c8-4dec-a64e-a9924b4e1ad8"]
}, Open  ]],
Cell[163210, 3786, 784, 19, 1438, "Text", "ExpressionUUID" -> \
"ab7c987f-55d7-4c5b-81a3-3966a9236f76"],
Cell[CellGroupData[{
Cell[164019, 3809, 1089, 28, 835, "Input", "ExpressionUUID" -> \
"47a3cba9-4a71-413f-818d-f01facde48a9"],
Cell[165111, 3839, 1701, 51, 1391, "Output", "ExpressionUUID" -> \
"dea33539-a749-4dbf-be90-f51f674cb5dc"]
}, Open  ]],
Cell[166827, 3893, 330, 9, 835, "Text", "ExpressionUUID" -> \
"d722d91d-e663-44d0-a7bd-782703758edc"],
Cell[CellGroupData[{
Cell[167182, 3906, 1303, 36, 835, "Input", "ExpressionUUID" -> \
"b993c862-135f-4cdb-a3d9-88696157adda"],
Cell[168488, 3944, 589, 16, 835, "Output", "ExpressionUUID" -> \
"3a5b3590-7371-4399-a139-f2a4b9f0173c"]
}, Open  ]],
Cell[169092, 3963, 286, 8, 835, "Text", "ExpressionUUID" -> \
"28df6ca7-346a-4914-a10b-b555620b5ff6"],
Cell[CellGroupData[{
Cell[169403, 3975, 1380, 37, 835, "Input", "ExpressionUUID" -> \
"02a4cc28-0677-4c4c-a630-b9e6bde3d1b1"],
Cell[170786, 4014, 1673, 58, 1438, "Output", "ExpressionUUID" -> \
"76340fd8-7fe3-4c28-9eb1-632a0df681bd"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[172508, 4078, 134, 3, 35, "Subsubsection", "ExpressionUUID" -> \
"08197be9-9ef7-453d-a481-90f09b68d4bc"],
Cell[172645, 4083, 1355, 23, 4272, "Input", "ExpressionUUID" -> \
"94754a15-2050-4bc8-8b57-270fefec9189",
 InitializationCell->True],
Cell[174003, 4108, 653, 13, 835, "Input", "ExpressionUUID" -> \
"bea4a3a2-59b0-4939-a1dc-6244ce7171ef",
 InitializationCell->True],
Cell[174659, 4123, 1385, 34, 1438, "Input", "ExpressionUUID" -> \
"a7d09c71-4537-402b-b03c-32f25c42f6db",
 InitializationCell->True],
Cell[176047, 4159, 1481, 39, 3127, "Input", "ExpressionUUID" -> \
"1bbafd58-0170-4600-b488-a01adb7a94bb",
 InitializationCell->True],
Cell[177531, 4200, 1081, 32, 2002, "Input", "ExpressionUUID" -> \
"c6d6864b-fcd0-40e3-a7a3-afd87a5af402",
 InitializationCell->True],
Cell[178615, 4234, 2204, 64, 4272, "Input", "ExpressionUUID" -> \
"2e6899c5-b78a-4677-8f84-c95fb1d1efc8",
 InitializationCell->True],
Cell[180822, 4300, 248, 7, 835, "Text", "ExpressionUUID" -> \
"b6507b80-f75f-47c7-86a4-7a6b02b5e910"],
Cell[CellGroupData[{
Cell[181095, 4311, 320, 9, 835, "Input", "ExpressionUUID" -> \
"93d82a3d-e9d1-4939-8613-b68f7de2e37a"],
Cell[181418, 4322, 569, 20, 835, "Output", "ExpressionUUID" -> \
"116af4c4-4faa-4371-ac53-d01638ee3c44"]
}, Open  ]],
Cell[182002, 4345, 441, 13, 891, "Text", "ExpressionUUID" -> \
"d5f93be5-2ffa-45b2-a649-a88ac808c860"],
Cell[CellGroupData[{
Cell[182468, 4362, 379, 12, 835, "Input", "ExpressionUUID" -> \
"c9e1abd1-1a84-44e5-8cee-d8b398134bbd"],
Cell[182850, 4376, 275, 9, 835, "Output", "ExpressionUUID" -> \
"73f4bb8f-fe0a-4dc5-9d2e-db6138952342"]
}, Open  ]],
Cell[183140, 4388, 346, 8, 835, "Text", "ExpressionUUID" -> \
"86b587e6-8ad0-4e98-8723-2b4b0c06b9db"],
Cell[CellGroupData[{
Cell[183511, 4400, 665, 15, 835, "Input", "ExpressionUUID" -> \
"0a1f2d4a-1118-4e92-a220-e758196a29d7"],
Cell[184179, 4417, 30278, 998, 519816, "Output", "ExpressionUUID" -> \
"e4545564-a141-4c03-8c0f-7e8cb3b9b44a"]
}, Closed]],
Cell[214472, 5418, 291, 5, 737, "Text", "ExpressionUUID" -> \
"dbaec02f-60bf-4c40-97df-119532810518"],
Cell[CellGroupData[{
Cell[214788, 5427, 531, 14, 835, "Input", "ExpressionUUID" -> \
"cbe4964e-ea80-4ffe-8b83-c2cf67e51518"],
Cell[215322, 5443, 3745, 136, 2002, "Output", "ExpressionUUID" -> \
"56f922e8-175d-4451-aaca-d4b49421adf6"]
}, Open  ]],
Cell[219082, 5582, 1028, 28, 1453, "Text", "ExpressionUUID" -> \
"5acdb7eb-cad5-494c-86f0-1fb3cdb8f155"],
Cell[CellGroupData[{
Cell[220135, 5614, 716, 22, 835, "Input", "ExpressionUUID" -> \
"2c5d2bb0-664f-4a3e-8175-d9cd78dd7149"],
Cell[220854, 5638, 444, 14, 835, "Output", "ExpressionUUID" -> \
"1e7658b7-8e44-4546-acb4-4c68bef80d57"]
}, Open  ]],
Cell[221313, 5655, 1742, 52, 2097, "Text", "ExpressionUUID" -> \
"415fcbba-8a0b-45a6-8b53-a96cfee9967d"],
Cell[223058, 5709, 354, 8, 835, "Text", "ExpressionUUID" -> \
"e8eb7cbe-1f46-40f8-ac46-100324d0ebd1"]
}, Closed]],
Cell[CellGroupData[{
Cell[223449, 5722, 184, 4, 35, "Subsubsection", "ExpressionUUID" -> \
"59c2b858-19b0-475f-bf67-ba779edcf2a3"],
Cell[223636, 5728, 1158, 20, 62501, "Input", "ExpressionUUID" -> \
"d36e7862-70fb-4bbd-bd8e-b9ac6c1f7110",
 InitializationCell->True],
Cell[224797, 5750, 1088, 25, 22587, "Input", "ExpressionUUID" -> \
"e86cd6d0-f540-42bf-9c83-6d180477be5f",
 InitializationCell->True],
Cell[225888, 5777, 226, 7, 22922, "Text", "ExpressionUUID" -> \
"6070d45e-8fbb-48d2-b984-f348528c7760"]
}, Closed]],
Cell[CellGroupData[{
Cell[226151, 5789, 157, 3, 35, "Subsubsection", "ExpressionUUID" -> \
"737e3dd8-a292-4228-8696-79555d007ac7"],
Cell[226311, 5794, 691, 14, 35828, "Input", "ExpressionUUID" -> \
"5fd9da0a-90ae-45f4-bf3b-92bb7c65bf26",
 InitializationCell->True],
Cell[227005, 5810, 1495, 35, 49363, "Input", "ExpressionUUID" -> \
"a3d51502-7b9c-4621-b40d-86f9f12955f6",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[228537, 5850, 211, 4, 35, "Subsubsection", "ExpressionUUID" -> \
"02b2cf0e-9605-4864-98e1-7f6ddb3e75fc"],
Cell[228751, 5856, 384, 9, 22587, "Input", "ExpressionUUID" -> \
"ab794894-1d72-4611-97cd-7e8f450b196d",
 InitializationCell->True],
Cell[229138, 5867, 572, 16, 22587, "Input", "ExpressionUUID" -> \
"657acbd3-4c26-470d-8271-766da023ffee",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[229747, 5888, 218, 4, 35, "Subsubsection", "ExpressionUUID" -> \
"46c06752-90e0-453d-9d3d-be993bf61793"],
Cell[229968, 5894, 424, 10, 22587, "Input", "ExpressionUUID" -> \
"0b05257e-a7d1-4267-9767-d7d8d649f656",
 InitializationCell->True],
Cell[230395, 5906, 582, 15, 22587, "Input", "ExpressionUUID" -> \
"03ee06da-0ca2-4c1c-b26d-bb5e26f62e84",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[231014, 5926, 211, 4, 35, "Subsubsection", "ExpressionUUID" -> \
"9f00eaee-a0c3-46a5-a9eb-30e9a1ad4577"],
Cell[231228, 5932, 740, 14, 2483, "Input", "ExpressionUUID" -> \
"70d5a0af-1ac3-4ceb-9720-ae692810ec47",
 InitializationCell->True],
Cell[231971, 5948, 1467, 34, 2483, "Input", "ExpressionUUID" -> \
"8f405b22-4024-4f73-a317-cec9b78152e3",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[233475, 5987, 161, 3, 35, "Subsubsection", "ExpressionUUID" -> \
"d985a7b0-998d-4394-89c9-a0dc5b33465f"],
Cell[233639, 5992, 605, 14, 139, "Input", "ExpressionUUID" -> \
"d2b3cc18-e546-4041-87fc-2269d489910f",
 InitializationCell->True],
Cell[234247, 6008, 510, 15, 87, "Input", "ExpressionUUID" -> \
"c9818029-35c9-4144-977a-b3612c0e287c",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[234794, 6028, 141, 3, 44, "Subsubsection", "ExpressionUUID" -> \
"1d5e5e10-68b9-4f90-9c3b-95ffc8b3e2f3"],
Cell[234938, 6033, 586, 12, 22587, "Input", "ExpressionUUID" -> \
"74394061-48f7-4d86-812f-edd297e37869",
 InitializationCell->True],
Cell[235527, 6047, 1018, 30, 36722, "Input", "ExpressionUUID" -> \
"df9f7f96-6f16-4899-9010-14838c778756",
 InitializationCell->True],
Cell[236548, 6079, 266, 7, 22922, "Text", "ExpressionUUID" -> \
"ab5ad28c-37df-44cd-9e7e-3a454475fc3b"],
Cell[CellGroupData[{
Cell[236839, 6090, 1043, 27, 22587, "Input", "ExpressionUUID" -> \
"e9ff2071-c5f2-4489-a146-98417710d7b4"],
Cell[237885, 6119, 700, 18, 21171, "Output", "ExpressionUUID" -> \
"e13468c5-23d8-4821-aac1-79f780928855"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[238634, 6143, 189, 3, 35, "Subsubsection", "ExpressionUUID" -> \
"656e961f-21d6-4b40-809e-243fbd781929"],
Cell[238826, 6148, 502, 11, 22587, "Input", "ExpressionUUID" -> \
"c52f1af0-f8ee-4347-85e5-6e9b4f87bf3a",
 InitializationCell->True],
Cell[239331, 6161, 1751, 46, 49925, "Input", "ExpressionUUID" -> \
"ac279f8e-9173-412e-a669-725033b66a89",
 InitializationCell->True],
Cell[241085, 6209, 352, 9, 22922, "Text", "ExpressionUUID" -> \
"ac9e3311-f96a-40a6-a058-511998e615c1"],
Cell[CellGroupData[{
Cell[241462, 6222, 834, 23, 22587, "Input", "ExpressionUUID" -> \
"1a585cfb-eebe-400c-a379-d35a93aa9918"],
Cell[242299, 6247, 463, 12, 22587, "Output", "ExpressionUUID" -> \
"373acdf4-8e38-4ce9-935a-c5a1d69cef4c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[242799, 6264, 831, 24, 22587, "Input", "ExpressionUUID" -> \
"2bfcf3b5-f168-4dce-ad30-8e3da3f923af"],
Cell[243633, 6290, 572, 17, 22587, "Output", "ExpressionUUID" -> \
"92f9ef06-9ab4-4ee3-a2a5-8a0728116cd5"]
}, Open  ]],
Cell[244220, 6310, 193, 3, 22922, "Text", "ExpressionUUID" -> \
"cb1cf122-99b0-4757-bce5-ff286a3c34a4"],
Cell[CellGroupData[{
Cell[244438, 6317, 819, 24, 22587, "Input", "ExpressionUUID" -> \
"c2ecc48d-bed4-47dd-b80e-ece61ace5d12"],
Cell[245260, 6343, 488, 15, 22587, "Output", "ExpressionUUID" -> \
"2adc1528-aebf-4b67-b2f5-a37e03c9794a"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[245797, 6364, 166, 3, 35, "Subsubsection", "ExpressionUUID" -> \
"8bf25564-71fa-4233-8a47-fb7e8c52f3d5"],
Cell[245966, 6369, 389, 9, 2483, "Input", "ExpressionUUID" -> \
"2aaada0d-7e81-48b9-8792-705f4d14b64e",
 InitializationCell->True],
Cell[246358, 6380, 561, 14, 1035, "Input", "ExpressionUUID" -> \
"0db856c8-6daf-43f6-af18-dd4190891868",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[246968, 6400, 263, 4, 54, "Subsection", "ExpressionUUID" -> \
"2eef33ad-4cf9-40c8-95ed-6ac172d60282"],
Cell[CellGroupData[{
Cell[247256, 6408, 159, 3, 44, "Subsubsection", "ExpressionUUID" -> \
"58529069-2eb3-4146-bde3-9cd56c5ee74d"],
Cell[247418, 6413, 1586, 26, 1797, "Input", "ExpressionUUID" -> \
"9ab565f9-400d-4e1b-92cd-cfc613cf09f0",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[249041, 6444, 164, 3, 35, "Subsubsection", "ExpressionUUID" -> \
"7c140e51-e2df-449a-a00a-470ca6650d74"],
Cell[249208, 6449, 1530, 25, 113, "Input", "ExpressionUUID" -> \
"f949fc07-bbb8-4c91-a796-91e4de380434",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[250775, 6479, 161, 3, 44, "Subsubsection", "ExpressionUUID" -> \
"02922003-270a-4c05-ad7e-5b964a556504"],
Cell[250939, 6484, 1620, 26, 139, "Input", "ExpressionUUID" -> \
"0fefccfe-082c-4f8c-a8f7-cb74bcc2ca4f",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[252596, 6515, 157, 3, 44, "Subsubsection", "ExpressionUUID" -> \
"66b92d20-c698-482c-8e04-403da9c9243e"],
Cell[252756, 6520, 515, 11, 139, "Input", "ExpressionUUID" -> \
"68b12fe8-77ab-4c79-a2ac-c63daf119797",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[253308, 6536, 160, 3, 44, "Subsubsection", "ExpressionUUID" -> \
"c3e321dc-d8c5-49d7-ac35-991937c12847"],
Cell[253471, 6541, 1941, 31, 165, "Input", "ExpressionUUID" -> \
"2096ac4b-28d7-4fec-906c-ffc532a7c012",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[255449, 6577, 162, 3, 44, "Subsubsection", "ExpressionUUID" -> \
"e0e60506-d4c3-4132-ad94-f69aaf0a3a10"],
Cell[255614, 6582, 715, 14, 165, "Input", "ExpressionUUID" -> \
"3a5cc303-cd34-4577-b564-ea50658806f8",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[256366, 6601, 164, 3, 44, "Subsubsection", "ExpressionUUID" -> \
"c5de2121-0401-4872-b96c-e8e79e85b665"],
Cell[256533, 6606, 745, 15, 139, "Input", "ExpressionUUID" -> \
"25e03a16-53c7-4cbc-bef3-558fbc55fbd3",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[257315, 6626, 170, 3, 44, "Subsubsection", "ExpressionUUID" -> \
"5607642b-b2a2-4bc0-9070-9781391c0d8c"],
Cell[257488, 6631, 792, 15, 165, "Input", "ExpressionUUID" -> \
"ff4ebd12-618e-442e-8379-bf7cdee7d6bd",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[258329, 6652, 246, 4, 54, "Subsection", "ExpressionUUID" -> \
"a7e6d3f1-e227-42f6-96e3-82391a46b518"],
Cell[CellGroupData[{
Cell[258600, 6660, 263, 4, 44, "Subsubsection", "ExpressionUUID" -> \
"2385a367-0622-410d-a317-3a8e61eab1c6"],
Cell[258866, 6666, 2265, 36, 425, "Input", "ExpressionUUID" -> \
"1125bfe6-c8b3-456f-aa88-9884fedf0bb9",
 InitializationCell->True],
Cell[261134, 6704, 1876, 30, 60, "Input", "ExpressionUUID" -> \
"1f5adf99-f571-4c82-ab15-f2ae038a50fe",
 InitializationCell->True],
Cell[263013, 6736, 2947, 58, 113, "Input", "ExpressionUUID" -> \
"f8a7b838-1c5e-4c84-a6c6-2ba93d622e8d",
 InitializationCell->True],
Cell[265963, 6796, 4476, 100, 191, "Input", "ExpressionUUID" -> \
"56ba8e01-60fc-48c2-969a-b7fc456c277c",
 InitializationCell->True],
Cell[270442, 6898, 377, 11, 40, "Input", "ExpressionUUID" -> \
"ba439269-4c19-4666-9240-785ca38b6c77"],
Cell[270822, 6911, 639, 21, 40, "Input", "ExpressionUUID" -> \
"c2583a5b-472a-4def-b161-295225782597"],
Cell[271464, 6934, 302, 8, 38, "Text", "ExpressionUUID" -> \
"379636ec-7686-4a36-a203-a459c073c22f"],
Cell[CellGroupData[{
Cell[271791, 6946, 567, 16, 40, "Input", "ExpressionUUID" -> \
"4fa55ef0-4f0c-444b-b460-5e54ac5f52d9"],
Cell[272361, 6964, 2931, 98, 173, "Output", "ExpressionUUID" -> \
"0f08b3b8-43ad-4c20-9a80-90099181c633"]
}, Open  ]],
Cell[275307, 7065, 173, 3, 38, "Text", "ExpressionUUID" -> \
"0c3c2463-3fbd-496f-bdc4-071f4ff1075e"],
Cell[CellGroupData[{
Cell[275505, 7072, 730, 21, 67, "Input", "ExpressionUUID" -> \
"a8eb518b-2a29-42f6-ac53-b65d97808050"],
Cell[276238, 7095, 1915, 62, 107, "Output", "ExpressionUUID" -> \
"4a94a71c-d435-4461-98f6-aee3f01a79d7"]
}, Open  ]],
Cell[278168, 7160, 895, 20, 110, "Text", "ExpressionUUID" -> \
"43378933-dfdb-42bb-ba48-f6c3836b0e36"],
Cell[CellGroupData[{
Cell[279088, 7184, 880, 26, 67, "Input", "ExpressionUUID" -> \
"e5d1c99c-f8c2-4e9d-8419-234cdb86efbe"],
Cell[279971, 7212, 5569, 181, 211, "Output", "ExpressionUUID" -> \
"900f068a-382b-45f1-926c-5d74cdf5aa4d"]
}, Open  ]],
Cell[285555, 7396, 220, 5, 38, "Text", "ExpressionUUID" -> \
"282e5df0-4baa-477f-ac82-e4dc7f87371b"],
Cell[CellGroupData[{
Cell[285800, 7405, 1148, 33, 67, "Input", "ExpressionUUID" -> \
"de43f6bd-41d2-4a05-b34a-9474187a63ad"],
Cell[286951, 7440, 2816, 92, 117, "Output", "ExpressionUUID" -> \
"6222dcc8-a13e-4568-b8f8-eaa1bf5289fe"]
}, Open  ]],
Cell[289782, 7535, 531, 11, 86, "Text", "ExpressionUUID" -> \
"221b6dc2-d3d9-40ab-a3b3-8068fba1fc76"],
Cell[290316, 7548, 1296, 23, 157, "Text", "ExpressionUUID" -> \
"dfab4f1b-8e39-4040-b86f-dd88531ad18c"],
Cell[291615, 7573, 512, 10, 62, "Text", "ExpressionUUID" -> \
"2e0c8d98-9418-434f-9ec4-5d4ae80196ee"]
}, Open  ]],
Cell[CellGroupData[{
Cell[292164, 7588, 166, 3, 44, "Subsubsection", "ExpressionUUID" -> \
"6f1dd9fb-4945-48dc-b29c-8d32d9872a5f"],
Cell[292333, 7593, 1617, 26, 347, "Input", "ExpressionUUID" -> \
"c00e4666-d602-44f4-92ad-35280df039e2",
 InitializationCell->True],
Cell[293953, 7621, 4131, 106, 262, "Input", "ExpressionUUID" -> \
"3e74101a-4587-4feb-9f56-e5f4c7fae8f4",
 InitializationCell->True],
Cell[298087, 7729, 780, 18, 86, "Text", "ExpressionUUID" -> \
"e39d57c7-8ce2-446d-85cd-bdaec2990d4d"],
Cell[CellGroupData[{
Cell[298892, 7751, 923, 26, 67, "Input", "ExpressionUUID" -> \
"51e88353-c1b8-42ab-b587-1e7afbee6ec4"],
Cell[299818, 7779, 16458, 548, 569, "Output", "ExpressionUUID" -> \
"88587f28-ce64-4c53-9fb1-93b7cd21419b"]
}, Open  ]],
Cell[316291, 8330, 769, 14, 133, "Text", "ExpressionUUID" -> \
"63841bd5-2252-4042-a0d6-7c9ce8b0c5bc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[317097, 8349, 166, 3, 44, "Subsubsection", "ExpressionUUID" -> \
"733c23f5-eb4b-4c4c-a264-4694ca43b640"],
Cell[317266, 8354, 1119, 19, 3127, "Input", "ExpressionUUID" -> \
"13cd041e-0ad8-4b3c-ace4-c2de4e53e13d",
 InitializationCell->True],
Cell[318388, 8375, 4022, 93, 5108, "Input", "ExpressionUUID" -> \
"b2b0d0da-3b40-44fe-ba96-40c9b319ff9b",
 InitializationCell->True],
Cell[322413, 8470, 588, 16, 835, "Text", "ExpressionUUID" -> \
"3580ddde-4d6e-46a1-a9a3-8e8f842c979d"],
Cell[CellGroupData[{
Cell[323026, 8490, 857, 24, 835, "Input", "ExpressionUUID" -> \
"f1192e9c-79d3-492a-b08d-e6b99dc4592e"],
Cell[323886, 8516, 4634, 156, 6816, "Output", "ExpressionUUID" -> \
"3021b68e-3746-4b75-bf9b-25d8482d6f02"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[328569, 8678, 194, 4, 35, "Subsubsection", "ExpressionUUID" -> \
"b36a117b-ffc0-424c-b66e-b4c6f27fe894"],
Cell[328766, 8684, 1053, 19, 3721, "Input", "ExpressionUUID" -> \
"b03e8fe0-171e-4294-bfdb-b3583dc64077",
 InitializationCell->True],
Cell[329822, 8705, 3214, 80, 3202, "Input", "ExpressionUUID" -> \
"16ed5869-dcf7-43a0-a422-f3837b69cada",
 InitializationCell->True],
Cell[333039, 8787, 314, 8, 835, "Text", "ExpressionUUID" -> \
"1470887e-93af-4026-a3b9-774ae59129fa"],
Cell[CellGroupData[{
Cell[333378, 8799, 736, 21, 835, "Input", "ExpressionUUID" -> \
"36c95429-68df-443b-b16d-dc0bbbade321"],
Cell[334117, 8822, 1981, 65, 1438, "Output", "ExpressionUUID" -> \
"2ae9ff95-baa3-4300-8ef5-3fb3b966bd9e"]
}, Open  ]],
Cell[336113, 8890, 718, 22, 835, "Input", "ExpressionUUID" -> \
"0e0642dd-2ab1-4976-9c2c-cb1eadc0fca0"],
Cell[CellGroupData[{
Cell[336856, 8916, 1190, 35, 835, "Input", "ExpressionUUID" -> \
"f06f15a2-481b-4b0f-91a1-e4f7da0333ec"],
Cell[338049, 8953, 2645, 87, 1438, "Output", "ExpressionUUID" -> \
"45b121ee-73ad-47ba-b2d2-5fe7640640c7"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[340743, 9046, 136, 3, 35, "Subsubsection", "ExpressionUUID" -> \
"df7dba8a-7673-453d-b630-35b6e47c80d8"],
Cell[340882, 9051, 925, 17, 3127, "Input", "ExpressionUUID" -> \
"4c7c8344-20b6-4227-ab0f-f94e435c191e",
 InitializationCell->True],
Cell[341810, 9070, 3409, 88, 2562, "Input", "ExpressionUUID" -> \
"37f07199-e06b-4c22-91d2-435f18a984ba",
 InitializationCell->True],
Cell[345222, 9160, 342, 8, 835, "Text", "ExpressionUUID" -> \
"7687bf0f-a177-4335-8dd5-06ba0329fcda"],
Cell[CellGroupData[{
Cell[345589, 9172, 831, 24, 835, "Input", "ExpressionUUID" -> \
"938d23c7-b25d-4992-b47f-9c7f5acd684a"],
Cell[346423, 9198, 2467, 79, 1831, "Output", "ExpressionUUID" -> \
"c9bed43e-b37f-4461-a458-e552ed2b6305"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[348939, 9283, 177, 3, 35, "Subsubsection", "ExpressionUUID" -> \
"bfa69e9c-8e10-472c-ac60-6e822c9ee023"],
Cell[349119, 9288, 1025, 26, 1487, "Text", "ExpressionUUID" -> \
"55eac8c8-711a-46b8-9315-09197d84165c"],
Cell[350147, 9316, 1717, 52, 1258, "DisplayFormulaNumbered", "ExpressionUUID" \
-> "01abee08-37cf-4568-9a8b-a715c9d79c77"],
Cell[351867, 9370, 950, 24, 858, "Text", "ExpressionUUID" -> \
"ec86960f-d217-4f64-b7be-4753aa75ae8d"],
Cell[352820, 9396, 1400, 38, 1258, "DisplayFormulaNumbered", "ExpressionUUID" \
-> "d71165b5-6124-4964-8a6e-bf638b84b568"],
Cell[354223, 9436, 844, 20, 1483, "Text", "ExpressionUUID" -> \
"74cb6099-5218-4fe6-9685-9bf8ce88ca30"]
}, Closed]],
Cell[CellGroupData[{
Cell[355104, 9461, 147, 3, 35, "Subsubsection", "ExpressionUUID" -> \
"2b83c85f-c9df-46fa-a658-b9376c12ea46"],
Cell[355254, 9466, 766, 15, 3127, "Input", "ExpressionUUID" -> \
"a785977a-aa1f-48c2-aa95-61a009a7507b",
 InitializationCell->True],
Cell[356023, 9483, 2357, 63, 2647, "Input", "ExpressionUUID" -> \
"8b828670-2c61-4843-a9b5-0a65f8c69a07",
 InitializationCell->True],
Cell[358383, 9548, 806, 21, 1487, "Text", "ExpressionUUID" -> \
"a6e11cb6-4fde-408b-850e-c10f443b36c4"],
Cell[CellGroupData[{
Cell[359214, 9573, 603, 15, 835, "Input", "ExpressionUUID" -> \
"9a33599e-5d82-4c7b-bb6f-6e8bc9bbc4b6"],
Cell[359820, 9590, 3678, 121, 8108, "Output", "ExpressionUUID" -> \
"cb8ce1c5-92d1-4fcf-ab6f-ec21cc81a1e1"]
}, Open  ]],
Cell[363513, 9714, 351, 7, 835, "Text", "ExpressionUUID" -> \
"e074cde3-c1dc-40f6-9451-c2cac6ac1ef9"],
Cell[CellGroupData[{
Cell[363889, 9725, 780, 21, 835, "Input", "ExpressionUUID" -> \
"6357dab6-90c8-4593-9752-0665fcd32aad"],
Cell[364672, 9748, 1651, 50, 2895, "Output", "ExpressionUUID" -> \
"28ca282e-d770-4ac0-becd-f4893b88d5e5"]
}, Open  ]],
Cell[366338, 9801, 513, 11, 1391, "Text", "ExpressionUUID" -> \
"39eea5c1-14ec-4c32-8ebc-8566555aaa2a"],
Cell[CellGroupData[{
Cell[366876, 9816, 865, 22, 835, "Input", "ExpressionUUID" -> \
"b2c1750a-5fe5-41ad-abda-041c38899ba7"],
Cell[367744, 9840, 2681, 87, 1831, "Output", "ExpressionUUID" -> \
"88e69b19-dac9-4f80-b438-3e289fce5b58"]
}, Open  ]],
Cell[370440, 9930, 1097, 23, 2895, "Text", "ExpressionUUID" -> \
"9d49fd19-9fd2-45bc-b8e8-91b0814af3eb"]
}, Closed]],
Cell[CellGroupData[{
Cell[371574, 9958, 134, 2, 35, "Subsubsection", "ExpressionUUID" -> \
"f3483288-e2c9-45b2-8931-c6a2d6b5707b"],
Cell[371711, 9962, 403, 10, 22587, "Input", "ExpressionUUID" -> \
"9e6d8480-79eb-41f4-b8a4-b21ade637d23",
 InitializationCell->True],
Cell[372117, 9974, 1267, 38, 39487, "Input", "ExpressionUUID" -> \
"3f35a1b2-65db-4842-b6e9-0f2a40941887",
 InitializationCell->True],
Cell[373387, 10014, 203, 3, 22922, "Text", "ExpressionUUID" -> \
"25b8b44f-636c-4a19-8fc3-f93fa94eba02"],
Cell[CellGroupData[{
Cell[373615, 10021, 383, 11, 22587, "Input", "ExpressionUUID" -> \
"c85b7c71-365f-44a2-8adb-27375fa910ab"],
Cell[374001, 10034, 233, 5, 35283, "Output", "ExpressionUUID" -> \
"c06af14f-9c11-47f6-b586-b77b8664dd19"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[374283, 10045, 158, 3, 35, "Subsubsection", "ExpressionUUID" -> \
"08786181-4242-4ad7-9acf-88603dee9623"],
Cell[374444, 10050, 501, 11, 49363, "Input", "ExpressionUUID" -> \
"7a7ede01-6d7b-4d58-9426-a666d837420b",
 InitializationCell->True],
Cell[374948, 10063, 2317, 63, 54152, "Input", "ExpressionUUID" -> \
"024a09d3-9a3e-421c-8bfa-ff99f5d3dfb4",
 InitializationCell->True],
Cell[377268, 10128, 173, 3, 22922, "Text", "ExpressionUUID" -> \
"29aea5ee-0dd1-45d0-8c1f-4c0b2170c570"],
Cell[CellGroupData[{
Cell[377466, 10135, 585, 16, 25282, "Input", "ExpressionUUID" -> \
"302844b2-b90e-4e4f-b7cf-9880df224375"],
Cell[378054, 10153, 1677, 48, 36722, "Output", "ExpressionUUID" -> \
"0293559f-75bb-4cbb-8047-402089e3fe24"]
}, Open  ]],
Cell[379746, 10204, 168, 3, 22922, "Text", "ExpressionUUID" -> \
"faf86b82-4e0b-4565-87e9-88005a19fef7"],
Cell[CellGroupData[{
Cell[379939, 10211, 468, 12, 22587, "Input", "ExpressionUUID" -> \
"c9665215-9b6a-4762-86ec-df49e928fd03"],
Cell[380410, 10225, 207, 4, 21171, "Output", "ExpressionUUID" -> \
"8cf21b09-987b-4d8a-bc6a-a12760b88389"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[380678, 10236, 383, 7, 54, "Subsection", "ExpressionUUID" -> \
"f9841e23-5c30-4dda-a7c3-3e1b0ca39524"],
Cell[CellGroupData[{
Cell[381086, 10247, 238, 4, 44, "Subsubsection", "ExpressionUUID" -> \
"62207c9a-1fcf-4fe9-9c97-d1d4c5e5a0f4"],
Cell[381327, 10253, 3882, 65, 607, "Input", "ExpressionUUID" -> \
"562aa119-1ee4-4942-b432-bd6ad206b3b4",
 InitializationCell->True],
Cell[385212, 10320, 2331, 45, 87, "Input", "ExpressionUUID" -> \
"a7d10949-1fe6-4eb8-9827-d83287197889",
 InitializationCell->True],
Cell[387546, 10367, 12432, 259, 687, "Input", "ExpressionUUID" -> \
"49a8f2d2-7b6c-4fd5-b5cd-1afe51be7348",
 InitializationCell->True],
Cell[399981, 10628, 17855, 396, 1042, "Input", "ExpressionUUID" -> \
"62de9448-b1a6-4c1e-ba69-807b956fc678",
 InitializationCell->True],
Cell[417839, 11026, 517, 10, 86, "Text", "ExpressionUUID" -> \
"608cd069-9f99-42ff-a311-68686588e081"],
Cell[CellGroupData[{
Cell[418381, 11040, 540, 18, 40, "Input", "ExpressionUUID" -> \
"65264c3c-53cb-42f3-b662-f6e55bcf6940"],
Cell[418924, 11060, 432, 14, 40, "Output", "ExpressionUUID" -> \
"01e6238f-0c49-4146-bb2e-35d605644445"]
}, Open  ]],
Cell[419371, 11077, 344, 8, 62, "Text", "ExpressionUUID" -> \
"2287873f-9710-49c5-89f1-ceab135086da"],
Cell[CellGroupData[{
Cell[419740, 11089, 395, 11, 40, "Input", "ExpressionUUID" -> \
"f5b18150-099d-4161-bf2e-bec136584367"],
Cell[420138, 11102, 1288, 41, 61, "Output", "ExpressionUUID" -> \
"392054f6-8450-4b05-bbea-9699ac6e26ae"]
}, Open  ]],
Cell[421441, 11146, 363, 7, 62, "Text", "ExpressionUUID" -> \
"959202bd-5713-4199-8a88-a3e774c7bb43"],
Cell[CellGroupData[{
Cell[421829, 11157, 1101, 28, 67, "Input", "ExpressionUUID" -> \
"7d2d1f48-e593-40ec-85cf-57ebd08c6d08"],
Cell[422933, 11187, 4882, 129, 192, "Output", "ExpressionUUID" -> \
"213b337e-7393-4118-a106-e1d49ff3b66c"]
}, Open  ]],
Cell[427830, 11319, 270, 6, 38, "Text", "ExpressionUUID" -> \
"e81a5993-aa46-48b2-923b-71d2180c2657"],
Cell[CellGroupData[{
Cell[428125, 11329, 1073, 27, 40, "Input", "ExpressionUUID" -> \
"1600d4b5-2537-4074-bda9-3cc0bc02d110"],
Cell[429201, 11358, 7317, 226, 361, "Output", "ExpressionUUID" -> \
"d812b2cc-ed47-468b-bbe7-16f6ae846b1f"]
}, Open  ]],
Cell[436533, 11587, 563, 17, 41, "Text", "ExpressionUUID" -> \
"2a5a4030-4b70-4710-ab3d-43b8554f9985"],
Cell[CellGroupData[{
Cell[437121, 11608, 1164, 28, 40, "Input", "ExpressionUUID" -> \
"ff1061a1-1f54-4dc4-859f-064524a26f41"],
Cell[438288, 11638, 3687, 108, 192, "Output", "ExpressionUUID" -> \
"905110ef-234d-4fd4-9c14-cadffe1dd3f5"]
}, Open  ]],
Cell[441990, 11749, 953, 28, 68, "Text", "ExpressionUUID" -> \
"44930104-2430-4318-b011-e2cd9fac8682"],
Cell[442946, 11779, 654, 12, 86, "Text", "ExpressionUUID" -> \
"6e077b25-9ae8-40d2-a0d0-381798cde3bb"],
Cell[CellGroupData[{
Cell[443625, 11795, 700, 21, 40, "Input", "ExpressionUUID" -> \
"dd968676-0050-4b0e-8daa-8d25a7998c67"],
Cell[444328, 11818, 2049, 65, 89, "Output", "ExpressionUUID" -> \
"699d7ff8-b7ad-4da3-8233-d0d0e3e0aab4"]
}, Open  ]],
Cell[446392, 11886, 868, 26, 41, "Text", "ExpressionUUID" -> \
"3f3d2b7f-3b82-4b15-b5a0-97596013a9e2"],
Cell[CellGroupData[{
Cell[447285, 11916, 1193, 34, 67, "Input", "ExpressionUUID" -> \
"df28291c-3142-47e3-8752-29c8191a066c"],
Cell[448481, 11952, 3560, 104, 145, "Output", "ExpressionUUID" -> \
"7417dd22-badb-4bff-975e-844b13f62e66"]
}, Open  ]],
Cell[452056, 12059, 634, 20, 41, "Text", "ExpressionUUID" -> \
"0bbb89ec-a431-41fa-a104-6d6e571798d3"],
Cell[CellGroupData[{
Cell[452715, 12083, 1004, 28, 67, "Input", "ExpressionUUID" -> \
"f5fe1e4f-0647-40e7-961c-d3c60b2cd4ca"],
Cell[453722, 12113, 6025, 186, 372, "Output", "ExpressionUUID" -> \
"ade4fff7-5d73-4a60-a423-af3d38399729"]
}, Open  ]],
Cell[459762, 12302, 873, 28, 40, "Text", "ExpressionUUID" -> \
"4dd04d66-589f-461c-9db0-b67f592c3cb9"],
Cell[CellGroupData[{
Cell[460660, 12334, 896, 23, 40, "Input", "ExpressionUUID" -> \
"a0d8ff2e-9335-429b-94e6-2af3aad3b116"],
Cell[461559, 12359, 2274, 69, 119, "Output", "ExpressionUUID" -> \
"19ba0b81-ac6a-4b5c-b64d-438db066ffa3"]
}, Open  ]],
Cell[463848, 12431, 518, 12, 64, "Text", "ExpressionUUID" -> \
"dfe90ad1-3aee-4ca4-a7cb-6928a08ee6b7"],
Cell[CellGroupData[{
Cell[464391, 12447, 976, 27, 40, "Input", "ExpressionUUID" -> \
"0241e1fb-2c6e-49ec-ad85-9a595c98da34"],
Cell[465370, 12476, 3455, 109, 145, "Output", "ExpressionUUID" -> \
"29478ea4-4e81-4ef3-9603-422e1c097acf"]
}, Open  ]],
Cell[468840, 12588, 188, 3, 38, "Text", "ExpressionUUID" -> \
"a44cb23a-30f3-4fed-9e9e-e3192660efc5"],
Cell[CellGroupData[{
Cell[469053, 12595, 974, 27, 40, "Input", "ExpressionUUID" -> \
"d7fa24c8-1369-4e47-9dda-c5f1241504a9"],
Cell[470030, 12624, 6648, 209, 229, "Output", "ExpressionUUID" -> \
"7771521c-2363-4280-b5b2-b12265c9720c"]
}, Open  ]],
Cell[476693, 12836, 1129, 26, 112, "Text", "ExpressionUUID" -> \
"d1e5810c-e2e4-4806-b5fb-26ca30ca52d9"],
Cell[477825, 12864, 326, 8, 38, "Text", "ExpressionUUID" -> \
"9a0797ce-973f-42d4-8e4f-9f8eefaa6c9a"],
Cell[478154, 12874, 3310, 97, 206, "Text", "ExpressionUUID" -> \
"53f5c150-7f56-46bc-b740-038d6e3f0687"],
Cell[481467, 12973, 2092, 49, 187, "Text", "ExpressionUUID" -> \
"765dcc97-c4f8-4cb1-84dc-ef6f594fdfc1"],
Cell[483562, 13024, 2237, 60, 165, "Text", "ExpressionUUID" -> \
"72ffb8ba-a692-4f55-8a0f-e0d459d64416"],
Cell[485802, 13086, 521, 10, 86, "Text", "ExpressionUUID" -> \
"040c9753-6e52-4964-a077-954649ff3a09"],
Cell[486326, 13098, 1410, 36, 112, "Text", "ExpressionUUID" -> \
"13fc2569-8d7f-4e56-980b-209873307ef0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[487773, 13139, 219, 4, 44, "Subsubsection", "ExpressionUUID" -> \
"e030c2a5-d574-4b8f-8af8-55342a9f08bd"],
Cell[487995, 13145, 1526, 39, 1816, "Text", "ExpressionUUID" -> \
"4ceadc21-729a-4e70-8767-d23d0b360d8b"],
Cell[CellGroupData[{
Cell[489546, 13188, 1671, 43, 1438, "Input", "ExpressionUUID" -> \
"915a15d6-861d-4430-bae6-f4b5b4a3a99a"],
Cell[491220, 13233, 15699, 467, 17522, "Output", "ExpressionUUID" -> \
"6bd6f7e1-67b7-47e4-b865-3b18f9910cb9"]
}, Open  ]],
Cell[506934, 13703, 255, 6, 835, "Text", "ExpressionUUID" -> \
"5541413f-eb70-4b53-a6d4-8a0c72b35db7"],
Cell[CellGroupData[{
Cell[507214, 13713, 554, 15, 835, "Input", "ExpressionUUID" -> \
"da9ba172-33fc-4b5b-99fe-14f0e0e58e5d"],
Cell[507771, 13730, 299, 5, 835, "Output", "ExpressionUUID" -> \
"68fadf14-7f2c-4ff8-ae65-52831488531d"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[508119, 13741, 239, 4, 35, "Subsubsection", "ExpressionUUID" -> \
"10809c65-9764-4623-8794-c90584244ad9"],
Cell[508361, 13747, 1332, 28, 2020, "Text", "ExpressionUUID" -> \
"4d2c6bc1-0e96-47be-81b6-9fc6dcd647b4"],
Cell[509696, 13777, 1011, 19, 3127, "Input", "ExpressionUUID" -> \
"a212c021-53ae-4856-9f90-5a2873699853",
 InitializationCell->True],
Cell[510710, 13798, 2077, 62, 2647, "Input", "ExpressionUUID" -> \
"29589014-8c8e-4d20-a187-14895c7aad3f",
 InitializationCell->True],
Cell[512790, 13862, 2741, 75, 2647, "Input", "ExpressionUUID" -> \
"c66cee82-2155-4b3c-9d75-fc338fcaaad6",
 InitializationCell->True],
Cell[515534, 13939, 495, 9, 1391, "Text", "ExpressionUUID" -> \
"4bdf4f9e-ede4-4bfb-b09b-f6b38cfe3eb9"]
}, Closed]],
Cell[CellGroupData[{
Cell[516066, 13953, 290, 5, 35, "Subsubsection", "ExpressionUUID" -> \
"7e4316e5-bc1a-406e-9328-acbd16f20786"],
Cell[516359, 13960, 572, 15, 62, "Text", "ExpressionUUID" -> \
"556d66d5-3551-4468-9a83-60284451d928"],
Cell[516934, 13977, 6334, 205, 295, "Input", "ExpressionUUID" -> \
"0f4b66a7-8240-462d-9d56-270f3793195b",
 InitializationCell->True],
Cell[523271, 14184, 1806, 28, 113, "Input", "ExpressionUUID" -> \
"044b78b0-607c-4dd1-bc36-85a4b4ed5f20",
 InitializationCell->True],
Cell[525080, 14214, 11060, 214, 427, "Input", "ExpressionUUID" -> \
"f8d2a1fb-e1f3-4fac-a104-aec85d439b34",
 InitializationCell->True],
Cell[536143, 14430, 11616, 233, 531, "Input", "ExpressionUUID" -> \
"da6069a1-0cae-4199-b3f3-ad23b5f57116",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[547796, 14668, 166, 3, 44, "Subsubsection", "ExpressionUUID" -> \
"68721e2a-9e93-4098-8f3d-1484ab893b5b"],
Cell[547965, 14673, 368, 9, 2246, "Input", "ExpressionUUID" -> \
"32eef98a-4afb-4bae-8aca-8b4717f5f773",
 InitializationCell->True],
Cell[548336, 14684, 1836, 29, 2246, "Input", "ExpressionUUID" -> \
"9e671b1e-4e51-44b9-9a47-2e5ec93462ba",
 InitializationCell->True],
Cell[550175, 14715, 1171, 33, 3103, "Input", "ExpressionUUID" -> \
"fc065f7f-f303-4c0e-84e2-5a122c9428d3",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[551383, 14753, 283, 5, 35, "Subsubsection", "ExpressionUUID" -> \
"7a50a36e-b050-4543-b1c1-53aa2ffc1f3d"],
Cell[551669, 14760, 659, 13, 3103, "Input", "ExpressionUUID" -> \
"e579f094-6c2a-4537-a867-e9d459df4431",
 InitializationCell->True],
Cell[552331, 14775, 1405, 34, 2288, "Input", "ExpressionUUID" -> \
"8567fb9f-bddd-471a-b015-f6b4431bff81",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[553773, 14814, 384, 6, 35, "Subsubsection", "ExpressionUUID" -> \
"bb12cf6e-ae27-4d84-a641-40224df81f1f"],
Cell[554160, 14822, 3425, 87, 6163, "Input", "ExpressionUUID" -> \
"c1562e3d-6942-4c7c-825c-b386133b2d80",
 InitializationCell->True],
Cell[557588, 14911, 8155, 129, 24640, "Input", "ExpressionUUID" -> \
"f952f8e4-9ed4-455c-978b-17d3a51b9ea3",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[565792, 15046, 319, 6, 54, "Subsection", "ExpressionUUID" -> \
"03e82bf8-1ab6-4f7a-a017-be45778d0f38"],
Cell[CellGroupData[{
Cell[566136, 15056, 357, 5, 110, "Subsubsection", "ExpressionUUID" -> \
"c4b4fcad-c870-4950-816c-6a28d6834f06"],
Cell[566496, 15063, 1256, 29, 276, "Text", "ExpressionUUID" -> \
"c000fddd-6b57-4871-89d0-1cf895874b56"],
Cell[567755, 15094, 1359, 38, 145, "Text", "ExpressionUUID" -> \
"2a15aed1-766a-4c2f-a21f-404a81aab9cf"],
Cell[569117, 15134, 3106, 69, 400, "Text", "ExpressionUUID" -> \
"ece8de39-b3b7-4500-bff5-b2406edd52e9"],
Cell[572226, 15205, 824, 20, 93, "Text", "ExpressionUUID" -> \
"8e263dba-7dca-41eb-b46c-4c61bf74914a"],
Cell[573053, 15227, 2941, 95, 190, "DisplayFormulaNumbered", "ExpressionUUID" \
-> "cc20af6b-9fb4-4e9e-9eb0-bbdbf143f93a"],
Cell[575997, 15324, 12125, 209, 401, "Text", "ExpressionUUID" -> \
"19dc37ce-18c8-46d6-9192-9e6df9a19a9e"],
Cell[588125, 15535, 2422, 60, 478, "Text", "ExpressionUUID" -> \
"665d8535-407f-446d-8f16-682e466b9470"],
Cell[590550, 15597, 698, 21, 97, "Input", "ExpressionUUID" -> \
"a90f1c07-bc7e-4db0-ac73-0ebf7a329f64"],
Cell[CellGroupData[{
Cell[591273, 15622, 1382, 33, 156, "Input", "ExpressionUUID" -> \
"eb243e28-cc4e-494f-82fe-c61c91a91a5e"],
Cell[592658, 15657, 3521, 70, 783, "Output", "ExpressionUUID" -> \
"7ba37ba4-dba1-4065-8d90-9dc5c56166d7"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[596228, 15733, 167, 3, 110, "Subsubsection", "ExpressionUUID" -> \
"a0a8df80-dc21-443b-9629-6f14e9336732"],
Cell[596398, 15738, 398, 10, 1391, "Text", "ExpressionUUID" -> \
"adf2e1e4-68db-41e8-a40a-5fd1a7f0caf4"],
Cell[596799, 15750, 273, 7, 835, "Text", "ExpressionUUID" -> \
"b3fd2e72-aabb-48f0-93b6-4d02554ce06c"],
Cell[CellGroupData[{
Cell[597097, 15761, 223, 5, 835, "Input", "ExpressionUUID" -> \
"cdef0339-1314-402a-ba2c-1d8cfa56e817"],
Cell[597323, 15768, 1099, 33, 1487, "Output", "ExpressionUUID" -> \
"6272fd32-a093-4b61-868a-daa918b5b8a7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[598459, 15806, 1465, 36, 2002, "Input", "ExpressionUUID" -> \
"15e72907-ef98-4388-bb44-52b0527417ef"],
Cell[599927, 15844, 335, 8, 835, "Output", "ExpressionUUID" -> \
"bfcad04c-5177-4b90-a5e2-af8cabcf5c41"]
}, Open  ]],
Cell[CellGroupData[{
Cell[600299, 15857, 1663, 44, 2346, "Input", "ExpressionUUID" -> \
"aa987f8f-0e12-4471-ac5c-7bf3018a7d39"],
Cell[601965, 15903, 293, 8, 835, "Output", "ExpressionUUID" -> \
"47698cd0-04f7-4207-9aec-618638d00611"]
}, Open  ]],
Cell[CellGroupData[{
Cell[602295, 15916, 1521, 37, 2002, "Input", "ExpressionUUID" -> \
"c89e43cf-68b4-4de3-8e40-d3c3251d3446"],
Cell[603819, 15955, 357, 8, 835, "Output", "ExpressionUUID" -> \
"5d7e1c76-d4df-485f-bf7f-d96eaa58144c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[604213, 15968, 1787, 47, 3012, "Input", "ExpressionUUID" -> \
"4e68d238-6457-4f2e-a3f4-d16c0cff5f7c"],
Cell[606003, 16017, 319, 8, 835, "Output", "ExpressionUUID" -> \
"8dac5d31-1ac3-4d04-85f5-23e0b64fcdf2"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[606371, 16031, 292, 4, 110, "Subsubsection", "ExpressionUUID" -> \
"9a29e350-f1c8-4b01-9ef8-c95f58f7b076"],
Cell[606666, 16037, 575, 10, 1391, "Text", "ExpressionUUID" -> \
"3b8b278b-7755-4aaa-b45a-62c2b1b274ce"],
Cell[607244, 16049, 564, 14, 858, "Text", "ExpressionUUID" -> \
"e0216508-7db9-4228-8fd8-d8ec90c13490"],
Cell[607811, 16065, 2058, 74, 1221, "DisplayFormulaNumbered", \
"ExpressionUUID" -> "b21699b6-cab9-4c03-a204-437386eea53f"],
Cell[609872, 16141, 826, 13, 1971, "Text", "ExpressionUUID" -> \
"8e219450-8f71-4bda-ab14-7ed9b3d0d633"]
}, Closed]],
Cell[CellGroupData[{
Cell[610735, 16159, 136, 3, 88, "Subsubsection", "ExpressionUUID" -> \
"f85ff6dd-9855-4db2-84ee-41830937466c"],
Cell[610874, 16164, 1089, 19, 3127, "Input", "ExpressionUUID" -> \
"934d12da-fbf8-4b84-880c-2bc329e1e974",
 InitializationCell->True],
Cell[611966, 16185, 2189, 55, 2932, "Input", "ExpressionUUID" -> \
"7c1c533f-dc4f-47fd-b4ac-22eb8b70a146",
 InitializationCell->True],
Cell[614158, 16242, 1877, 49, 2562, "Input", "ExpressionUUID" -> \
"498aaa8d-74d7-48d4-968c-e87859e2475b",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[616072, 16296, 184, 4, 88, "Subsubsection", "ExpressionUUID" -> \
"e4d137ab-56a7-4316-b1b8-724365a90720",
 InitializationCell->True],
Cell[616259, 16302, 1007, 18, 3127, "Input", "ExpressionUUID" -> \
"bcf86b9c-25a2-450a-9dbe-6bc0d0fef1d3",
 InitializationCell->True],
Cell[617269, 16322, 2246, 62, 3721, "Input", "ExpressionUUID" -> \
"eba6b25b-28eb-43bf-8712-7cec3a733716",
 InitializationCell->True],
Cell[619518, 16386, 460, 10, 2543, "Text", "ExpressionUUID" -> \
"94e069c0-dc6a-4292-8655-861bab784f71"],
Cell[619981, 16398, 926, 19, 2002, "Text", "ExpressionUUID" -> \
"02a6a7e4-7682-4e6a-9cce-5e3900c61a1f"],
Cell[620910, 16419, 298, 8, 835, "Text", "ExpressionUUID" -> \
"5f0fef75-f46b-45d8-832f-6f44a54d2430"]
}, Closed]],
Cell[CellGroupData[{
Cell[621245, 16432, 212, 4, 88, "Subsubsection", "ExpressionUUID" -> \
"44a76455-4240-461e-80ca-7f4904df1d10"],
Cell[621460, 16438, 1509, 25, 14190, "Input", "ExpressionUUID" -> \
"1dd34a72-a578-4a67-8253-de54b89553ee",
 InitializationCell->True],
Cell[622972, 16465, 3746, 87, 20596, "Input", "ExpressionUUID" -> \
"0554d48e-f830-4a1e-be74-79e25d304e0a",
 InitializationCell->True],
Cell[626721, 16554, 485, 11, 3165, "Text", "ExpressionUUID" -> \
"8a99e8d4-61f5-424e-99d9-2f04b3c0799b"],
Cell[CellGroupData[{
Cell[627231, 16569, 791, 21, 3165, "Input", "ExpressionUUID" -> \
"91565fa6-e5d5-427c-8e98-52610362e4c8"],
Cell[628025, 16592, 1350, 38, 3165, "Output", "ExpressionUUID" -> \
"a39ed7cf-f04d-49e1-bdda-c0526ad854b0"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[629424, 16636, 164, 3, 110, "Subsubsection", "ExpressionUUID" -> \
"b4bf1bda-069d-4676-b1be-60d282ad2659"],
Cell[629591, 16641, 429, 10, 3270, "Text", "ExpressionUUID" -> \
"aee69680-0622-4c48-8a15-45b44fb6cc7c"],
Cell[630023, 16653, 641, 13, 3165, "Input", "ExpressionUUID" -> \
"328f8b9a-8545-449f-a1a0-1fb247e0647c",
 InitializationCell->True],
Cell[630667, 16668, 709, 19, 3165, "Input", "ExpressionUUID" -> \
"d886e4a1-721f-42e8-9adc-3284fb236712",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[631413, 16692, 144, 3, 88, "Subsubsection", "ExpressionUUID" -> \
"e69a2f90-18c0-4b04-8428-b5eca8b958d2"],
Cell[631560, 16697, 796, 15, 3127, "Input", "ExpressionUUID" -> \
"6e974977-7acd-4611-9f60-87c5d532984e",
 InitializationCell->True],
Cell[632359, 16714, 3346, 78, 4432, "Input", "ExpressionUUID" -> \
"a08d2142-a5ee-4e7d-8bac-90baaae42e5e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[635742, 16797, 209, 4, 110, "Subsubsection", "ExpressionUUID" -> \
"452435f4-6566-4d8d-9d81-c629dabb8f98"],
Cell[635954, 16803, 797, 14, 1971, "Text", "ExpressionUUID" -> \
"b1d03009-afb9-42bd-92f9-cc7b8904cb17"],
Cell[636754, 16819, 273, 7, 835, "Text", "ExpressionUUID" -> \
"3e4358d4-3279-4df9-bbe7-11ec4b06c32e"],
Cell[637030, 16828, 1295, 36, 1487, "Input", "ExpressionUUID" -> \
"84051196-05ac-44e5-b47e-162675653e3c"],
Cell[638328, 16866, 380, 11, 835, "Input", "ExpressionUUID" -> \
"f2408c41-e496-41c2-81af-fd660fdd6920"],
Cell[CellGroupData[{
Cell[638733, 16881, 752, 15, 835, "Input", "ExpressionUUID" -> \
"93f1af83-f9a1-48c4-9bea-e0a345003745"],
Cell[639488, 16898, 591, 10, 835, "Output", "ExpressionUUID" -> \
"5452c6ab-5758-441e-9842-512da6f5cfd9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[640116, 16913, 740, 14, 835, "Input", "ExpressionUUID" -> \
"a76a4173-52b5-4c30-b8c1-492e545cd1b0"],
Cell[640859, 16929, 326, 7, 835, "Output", "ExpressionUUID" -> \
"b0d36d8d-af38-4282-8d8f-811c59bc652d"]
}, Open  ]],
Cell[641200, 16939, 321, 7, 835, "Text", "ExpressionUUID" -> \
"ed035e61-b731-4fc6-b76a-ebdb12d0f6cd"],
Cell[CellGroupData[{
Cell[641546, 16950, 835, 17, 835, "Input", "ExpressionUUID" -> \
"e4a75a41-53c1-471f-9c6a-a585990ea84c"],
Cell[642384, 16969, 161, 3, 835, "Output", "ExpressionUUID" -> \
"f5d9d3c6-9e88-49ed-97dd-f2dd8234810a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[642582, 16977, 801, 15, 835, "Input", "ExpressionUUID" -> \
"f6fc99e8-fbdb-4068-b81f-c19b8dc622c8"],
Cell[643386, 16994, 385, 9, 835, "Output", "ExpressionUUID" -> \
"398fd1c2-f0af-4a35-9e4c-447757c312d4"]
}, Open  ]],
Cell[643786, 17006, 168, 3, 835, "Text", "ExpressionUUID" -> \
"1ea1993b-05a3-42b7-9992-bc9eede263ca"],
Cell[CellGroupData[{
Cell[643979, 17013, 978, 26, 835, "Input", "ExpressionUUID" -> \
"3f569188-cfc0-4846-a07c-04bf44c7c5bd"],
Cell[644960, 17041, 572, 14, 977, "Output", "ExpressionUUID" -> \
"fbc5b923-56e7-4c4e-af8d-b41f9454ff38"]
}, Open  ]],
Cell[645547, 17058, 803, 21, 1438, "Text", "ExpressionUUID" -> \
"0f379616-c7f8-4601-b8ee-e0dec9aca39a"],
Cell[CellGroupData[{
Cell[646375, 17083, 677, 14, 835, "Input", "ExpressionUUID" -> \
"a3474847-1efb-4cb3-9672-52d343f98be5"],
Cell[647055, 17099, 463, 10, 835, "Output", "ExpressionUUID" -> \
"33ed08a3-77be-4679-bb5b-fa56235b0b08"]
}, Open  ]],
Cell[CellGroupData[{
Cell[647555, 17114, 712, 15, 835, "Input", "ExpressionUUID" -> \
"1fc545fa-0e0e-493e-a032-8928fab89c2d"],
Cell[648270, 17131, 286, 7, 835, "Output", "ExpressionUUID" -> \
"6dc05154-abd3-4a86-830a-ddab55764a35"]
}, Open  ]],
Cell[648571, 17141, 328, 7, 1378, "Text", "ExpressionUUID" -> \
"0b15ace6-aad1-4f24-8ff6-87f9a5b76266"],
Cell[CellGroupData[{
Cell[648924, 17152, 521, 13, 835, "Input", "ExpressionUUID" -> \
"101b326f-4ff7-4ffc-81e0-36a9e3caea4f"],
Cell[649448, 17167, 10518, 218, 1906, "Output", "ExpressionUUID" -> \
"909baef2-58e3-488c-a5f2-95c133cb8595"]
}, Open  ]],
Cell[659981, 17388, 198, 3, 835, "Text", "ExpressionUUID" -> \
"c1a05f5b-3fdb-4925-80f5-f206c4432ce0"],
Cell[CellGroupData[{
Cell[660204, 17395, 464, 13, 835, "Input", "ExpressionUUID" -> \
"672d4468-c577-441a-a225-e510c024f5cd"],
Cell[660671, 17410, 261, 7, 977, "Output", "ExpressionUUID" -> \
"a79452af-8ccf-4c10-8c2a-5821d45de298"]
}, Open  ]],
Cell[660947, 17420, 603, 12, 1971, "Text", "ExpressionUUID" -> \
"1ce51665-61f2-4cc9-8934-12d3106d2cc4"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[661599, 17438, 295, 4, 43, "Subsection", "ExpressionUUID" -> \
"ccab2c7f-002d-427b-a274-59b6c91e78f8"],
Cell[CellGroupData[{
Cell[661919, 17446, 135, 3, 44, "Subsubsection", "ExpressionUUID" -> \
"c41f08ce-c61b-474e-b9ab-d6f1114009a7"],
Cell[662057, 17451, 1046, 19, 337, "Input", "ExpressionUUID" -> \
"b40a451c-5a9a-41d2-81de-c67cf6d8167f",
 InitializationCell->True],
Cell[663106, 17472, 817, 20, 90, "Input", "ExpressionUUID" -> \
"3c6ac7eb-b294-42e2-90e2-16e048ba9b7a",
 InitializationCell->True],
Cell[663926, 17494, 4276, 66, 156, "Input", "ExpressionUUID" -> \
"127cbc0c-1ccf-4969-ad50-f18036ebb06b",
 InitializationCell->True],
Cell[668205, 17562, 4403, 69, 90, "Input", "ExpressionUUID" -> \
"69aceb6a-b91a-4fe0-b698-d2c8ff80b70b",
 InitializationCell->True],
Cell[672611, 17633, 7019, 139, 558, "Input", "ExpressionUUID" -> \
"0c039eb2-3315-40a1-beac-c2cd258ec7b2",
 InitializationCell->True],
Cell[679633, 17774, 349, 9, 90, "Text", "ExpressionUUID" -> \
"6cf26b32-985b-42eb-aedf-b5570371c155"],
Cell[CellGroupData[{
Cell[680007, 17787, 664, 17, 90, "Input", "ExpressionUUID" -> \
"c6620003-e79c-4b46-8a3b-a6abbff8f700"],
Cell[680674, 17806, 269, 4, 90, "Output", "ExpressionUUID" -> \
"bc90292e-eea3-4e91-a6e1-235f4455b02a"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[680992, 17816, 207, 4, 35, "Subsubsection", "ExpressionUUID" -> \
"e529623c-cf92-4a2e-a974-98711aac5f16"],
Cell[681202, 17822, 817, 15, 2562, "Input", "ExpressionUUID" -> \
"d7b473c3-f65e-4562-b437-cd86a76d148b",
 InitializationCell->True],
Cell[682022, 17839, 2548, 67, 3721, "Input", "ExpressionUUID" -> \
"4ae31ef3-601c-4c00-afb5-50ca9174d576",
 InitializationCell->True],
Cell[684573, 17908, 973, 25, 1391, "Text", "ExpressionUUID" -> \
"4f7b54b1-d00a-4b22-a301-226a272fe5c9"]
}, Closed]],
Cell[CellGroupData[{
Cell[685583, 17938, 214, 4, 35, "Subsubsection", "ExpressionUUID" -> \
"7ae74deb-b80f-4a70-a513-b80c00a9fbd1"],
Cell[685800, 17944, 2118, 32, 5400, "Input", "ExpressionUUID" -> \
"257f838c-6e9f-4c4f-b727-e7db36b2bdd6",
 InitializationCell->True],
Cell[687921, 17978, 1465, 24, 2002, "Input", "ExpressionUUID" -> \
"292ab3f1-23b6-4450-b4fa-23ea2fbbd897",
 InitializationCell->True],
Cell[689389, 18004, 1258, 21, 835, "Input", "ExpressionUUID" -> \
"d6504437-c2d7-4085-bdbb-65b09f0715e2",
 InitializationCell->True],
Cell[690650, 18027, 1350, 22, 835, "Input", "ExpressionUUID" -> \
"7f4214ba-f918-4175-9968-e4df55e0e068",
 InitializationCell->True],
Cell[692003, 18051, 1464, 23, 1438, "Input", "ExpressionUUID" -> \
"74916e1f-463f-46a6-a3e8-174ddd8ed764",
 InitializationCell->True],
Cell[693470, 18076, 8000, 170, 9378, "Input", "ExpressionUUID" -> \
"fdb64229-669f-4f38-afef-32d735f4e26a",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[701507, 18251, 287, 5, 35, "Subsubsection", "ExpressionUUID" -> \
"58be12b6-a7f5-4608-8724-e7ba23e3ed91"],
Cell[701797, 18258, 1094, 19, 2002, "Input", "ExpressionUUID" -> \
"20ba28fb-9d25-4ea4-8bd5-c1ea608d18c8",
 InitializationCell->True],
Cell[702894, 18279, 4278, 100, 3127, "Input", "ExpressionUUID" -> \
"3ee62d10-4ecb-44d2-be31-20eef5574880",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[707209, 18384, 239, 5, 35, "Subsubsection", "ExpressionUUID" -> \
"45a5a948-b581-450d-a579-ea55cc1dbfb4"],
Cell[707451, 18391, 1599, 25, 2703, "Input", "ExpressionUUID" -> \
"15383b5d-76dd-4f65-9fce-04bcbad20af3",
 InitializationCell->True],
Cell[709053, 18418, 937, 22, 652, "Input", "ExpressionUUID" -> \
"826d953d-6262-4727-8484-edc65b841b58",
 InitializationCell->True],
Cell[709993, 18442, 17128, 348, 5871, "Input", "ExpressionUUID" -> \
"66476913-6ee5-4e55-b9b6-f514ba0140d3",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[727158, 18795, 228, 4, 35, "Subsubsection", "ExpressionUUID" -> \
"0add48fe-5d60-40a0-b043-2005b606edf2"],
Cell[727389, 18801, 1910, 42, 139, "Input", "ExpressionUUID" -> \
"5ddf55b9-77c9-4fb5-b621-5c96e1a1db26",
 InitializationCell->True],
Cell[729302, 18845, 830, 20, 113, "Input", "ExpressionUUID" -> \
"1d4793ab-7f69-4fc4-a102-4a078111e71a",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[730169, 18870, 428, 7, 44, "Subsubsection", "ExpressionUUID" -> \
"53ddddf6-f80b-4361-83bb-1ac0e4f69d92"],
Cell[730600, 18879, 265, 6, 38, "Text", "ExpressionUUID" -> \
"450aa6fe-d708-4fe0-ab2b-d9ea7a028bcb"],
Cell[730868, 18887, 1930, 42, 139, "Input", "ExpressionUUID" -> \
"2b19fc9b-91da-493f-ac04-4879c6538495",
 InitializationCell->True],
Cell[732801, 18931, 798, 19, 113, "Input", "ExpressionUUID" -> \
"066bc20d-6af7-42bd-94cc-43767abc194f",
 InitializationCell->True],
Cell[733602, 18952, 251, 4, 38, "Text", "ExpressionUUID" -> \
"f6c251b3-28fb-42e0-a0c8-434683854731"],
Cell[733856, 18958, 1508, 36, 139, "Input", "ExpressionUUID" -> \
"3bb5fbca-8b7e-4a21-9b6a-99ab8587fc40",
 InitializationCell->True],
Cell[735367, 18996, 827, 21, 113, "Input", "ExpressionUUID" -> \
"a2f0b7a0-5814-4187-993d-da5cd1fefcd1",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[736231, 19022, 182, 3, 44, "Subsubsection", "ExpressionUUID" -> \
"4629ee24-3e87-4247-acc2-29bffe1e30e4"],
Cell[736416, 19027, 896, 16, 11925, "Input", "ExpressionUUID" -> \
"1a2f9ae0-8d65-4b22-9154-ee42d70a342b",
 InitializationCell->True],
Cell[737315, 19045, 1825, 47, 7757, "Input", "ExpressionUUID" -> \
"e2b0bced-febb-4865-8499-c873c9e31f8e",
 InitializationCell->True],
Cell[739143, 19094, 1106, 31, 7757, "Input", "ExpressionUUID" -> \
"f927e4f6-16e9-4da9-89bd-b8335be97a78",
 InitializationCell->True],
Cell[740252, 19127, 1825, 47, 7757, "Input", "ExpressionUUID" -> \
"3a64bb1d-a36a-47e5-9132-bf3bed563ec1",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[742102, 19178, 227, 5, 3165, "Input", "ExpressionUUID" -> \
"a4221c6f-52e1-4c85-912f-922e0b068532"],
Cell[742332, 19185, 1335, 25, 1553, "Print", "ExpressionUUID" -> \
"87a7872a-7927-4268-a43f-4e1c75a94319",
 CellTags->"Info3651916292-2487941"]
}, Open  ]],
Cell[CellGroupData[{
Cell[743704, 19215, 693, 19, 3165, "Input", "ExpressionUUID" -> \
"b92ba1fb-8a48-488a-ac3f-6c97f9a6663d"],
Cell[744400, 19236, 565, 11, 1553, "Message", "ExpressionUUID" -> \
"b22e3613-171d-40ff-adf5-544ef67009ce"],
Cell[744968, 19249, 570, 11, 1553, "Message", "ExpressionUUID" -> \
"487dccaa-0ff3-44e1-b846-0131dd3ea11d"],
Cell[745541, 19262, 522, 11, 1553, "Message", "ExpressionUUID" -> \
"784b0de5-1e9a-4482-abc9-dc56a40b662d"],
Cell[746066, 19275, 635, 13, 1553, "Message", "ExpressionUUID" -> \
"83285e0c-2190-433c-8668-a29012a3c79b"],
Cell[746704, 19290, 691, 13, 1553, "Message", "ExpressionUUID" -> \
"984075fb-b28c-4f48-9578-b478cc95f378"],
Cell[747398, 19305, 372, 12, 1553, "Output", "ExpressionUUID" -> \
"919aee8c-433d-4e21-82fc-f187c7f656e1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[747807, 19322, 468, 13, 3165, "Input", "ExpressionUUID" -> \
"7e16b02e-e036-4877-9313-05d6927b5878"],
Cell[748278, 19337, 568, 12, 1553, "Message", "ExpressionUUID" -> \
"7f749f2c-bd14-4ba0-a71e-2bed486ca476"],
Cell[748849, 19351, 573, 12, 1553, "Message", "ExpressionUUID" -> \
"2cc73efb-e17e-4281-b376-ef37c35a570d"],
Cell[749425, 19365, 133, 3, 1553, "Output", "ExpressionUUID" -> \
"a7811ca4-5e16-4669-bbd7-7d0fbfc00e72"]
}, Open  ]],
Cell[CellGroupData[{
Cell[749595, 19373, 211, 5, 3165, "Input", "ExpressionUUID" -> \
"958a8897-8d2a-4ce3-a3b2-30868d133cce"],
Cell[749809, 19380, 292, 8, 1553, "Output", "ExpressionUUID" -> \
"9eb23cf0-e021-4700-86c9-057c4855d442"]
}, Open  ]],
Cell[CellGroupData[{
Cell[750138, 19393, 357, 9, 3165, "Input", "ExpressionUUID" -> \
"3210eb50-8260-4c7a-bca7-c36379b9880a"],
Cell[750498, 19404, 9045, 186, 1553, "Output", "ExpressionUUID" -> \
"d19d4ca1-d64f-4587-a22a-8ba5029d815b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[759580, 19595, 360, 9, 3165, "Input", "ExpressionUUID" -> \
"8b18440b-0f5f-4059-b73c-4d36361d2e6c"],
Cell[759943, 19606, 217, 5, 1553, "Output", "ExpressionUUID" -> \
"760530eb-8c17-45c4-874e-487cfd9aaaa9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[760197, 19616, 270, 7, 3165, "Input", "ExpressionUUID" -> \
"41c10cb8-0e4c-4d8e-b855-d86d82c57112"],
Cell[760470, 19625, 244, 5, 1553, "Output", "ExpressionUUID" -> \
"a669004d-cae8-41ed-aff8-beb3180f999d"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[760763, 19636, 422, 6, 35, "Subsubsection", "ExpressionUUID" -> \
"a2807e2c-3853-4519-b7f4-371e5bdaa2b8"],
Cell[761188, 19644, 542, 14, 1438, "Input", "ExpressionUUID" -> \
"0c7f8a13-ad94-4101-954f-658c1d182b7f"],
Cell[761733, 19660, 657, 14, 1438, "Text", "ExpressionUUID" -> \
"87c519fe-fd7d-481b-8479-229f6fc94e77"],
Cell[CellGroupData[{
Cell[762415, 19678, 1343, 30, 835, "Input", "ExpressionUUID" -> \
"69de950c-a240-494c-80e3-9d28ebb48ab6"],
Cell[763761, 19710, 382, 8, 1258, "Output", "ExpressionUUID" -> \
"fffad3a6-8a1b-468d-bb43-a8a95922fbd3"]
}, Open  ]],
Cell[764158, 19721, 295, 4, 808, "Text", "ExpressionUUID" -> \
"9e451cfa-6742-4463-a1cc-6ec8ec9b3030"],
Cell[CellGroupData[{
Cell[764478, 19729, 1319, 29, 835, "Input", "ExpressionUUID" -> \
"89ab2ba6-39e0-4e85-a54b-577dd248ceaa"],
Cell[765800, 19760, 282, 6, 1258, "Output", "ExpressionUUID" -> \
"5e616934-39ac-4e3a-9727-385b32604b62"]
}, Open  ]],
Cell[766097, 19769, 442, 8, 835, "Text", "ExpressionUUID" -> \
"8e17fdd5-a243-4be3-88ad-1b23b0c03bf1"],
Cell[CellGroupData[{
Cell[766564, 19781, 1478, 33, 1438, "Input", "ExpressionUUID" -> \
"204e7e07-e278-462c-8fef-adc943f3f441"],
Cell[768045, 19816, 357, 8, 1258, "Output", "ExpressionUUID" -> \
"4ecf20b5-5286-4ae0-ad0b-bad32e329d09"]
}, Open  ]],
Cell[768417, 19827, 251, 4, 835, "Text", "ExpressionUUID" -> \
"ef32391d-f778-4758-8cdd-9930f12a93a9"],
Cell[CellGroupData[{
Cell[768693, 19835, 503, 13, 835, "Input", "ExpressionUUID" -> \
"192bb845-9852-47fd-943d-2f1825149688"],
Cell[769199, 19850, 13579, 423, 11472, "Output", "ExpressionUUID" -> \
"5100c1cd-5c69-4a01-ac2c-c5be20932728"]
}, Open  ]],
Cell[782793, 20276, 178, 3, 835, "Text", "ExpressionUUID" -> \
"e69d3258-824a-4f77-857a-98023dc99265"],
Cell[CellGroupData[{
Cell[782996, 20283, 376, 10, 835, "Input", "ExpressionUUID" -> \
"b54aeb11-9836-4429-a811-55058edb4ae0"],
Cell[783375, 20295, 17961, 487, 13085, "Output", "ExpressionUUID" -> \
"3a1428d8-5794-4332-b48c-b546f19bb4ca"]
}, Open  ]],
Cell[CellGroupData[{
Cell[801373, 20787, 370, 10, 835, "Input", "ExpressionUUID" -> \
"ee7cc6c0-7743-418f-ad20-4ad4199894c6"],
Cell[801746, 20799, 358, 8, 1258, "Output", "ExpressionUUID" -> \
"8c3dbc15-cdfc-4b78-9c9d-96834dc4087e"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[802153, 20813, 242, 4, 35, "Subsubsection", "ExpressionUUID" -> \
"1e9831a2-7eaf-414e-a28a-b2b2abc812f6"],
Cell[802398, 20819, 238, 4, 835, "Text", "ExpressionUUID" -> \
"b79873ab-51d5-4803-9f08-72f21e7662e5"],
Cell[802639, 20825, 335, 10, 835, "Input", "ExpressionUUID" -> \
"ae346e49-e83f-4a69-b86e-66577068ba87"],
Cell[CellGroupData[{
Cell[802999, 20839, 402, 10, 835, "Input", "ExpressionUUID" -> \
"05614cc0-6c3a-41f7-9bbf-32fb47da53c7"],
Cell[803404, 20851, 281, 6, 1553, "Output", "ExpressionUUID" -> \
"39b94451-91b4-4743-bc52-7c6c5f3731d0"]
}, Open  ]],
Cell[803700, 20860, 768, 21, 835, "Input", "ExpressionUUID" -> \
"d33d9384-9366-4210-95b0-27f64eb28e18"],
Cell[CellGroupData[{
Cell[804493, 20885, 630, 17, 835, "Input", "ExpressionUUID" -> \
"f2173dec-8593-4b7e-8807-367248ffb37f"],
Cell[805126, 20904, 11339, 261, 1553, "Output", "ExpressionUUID" -> \
"a3a41f23-09ae-4118-a939-ff7138a62612"]
}, Open  ]],
Cell[CellGroupData[{
Cell[816502, 21170, 581, 16, 835, "Input", "ExpressionUUID" -> \
"d2bbbddc-8c6b-4329-a89b-9f3da1b9f285"],
Cell[817086, 21188, 11312, 261, 1553, "Output", "ExpressionUUID" -> \
"45f0c130-2d37-4155-8ab9-0e826ee630eb"]
}, Open  ]],
Cell[828413, 21452, 246, 4, 835, "Text", "ExpressionUUID" -> \
"8066f65f-ce5f-443a-a348-27602364f0f9"],
Cell[CellGroupData[{
Cell[828684, 21460, 431, 11, 835, "Input", "ExpressionUUID" -> \
"07e9d553-e75c-465f-a9f5-db4d23a94b9c"],
Cell[829118, 21473, 639, 13, 1553, "Message", "ExpressionUUID" -> \
"c1711fe8-ee53-4646-b94c-97cb2617f266"],
Cell[829760, 21488, 721, 15, 1553, "Message", "ExpressionUUID" -> \
"441bf293-d62a-41a1-acb8-4528173b69b6"],
Cell[830484, 21505, 563, 15, 1553, "Output", "ExpressionUUID" -> \
"70bb34e7-c831-422e-816f-f0a1e1317c2a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[831084, 21525, 1972, 53, 2002, "Input", "ExpressionUUID" -> \
"1747b248-3796-494f-b858-1634e46a7554"],
Cell[833059, 21580, 8845, 203, 1553, "Output", "ExpressionUUID" -> \
"3acf683a-a7e2-4089-b155-2092ebd94926"]
}, Open  ]],
Cell[CellGroupData[{
Cell[841941, 21788, 536, 13, 835, "Input", "ExpressionUUID" -> \
"a67dfb04-8486-44fe-adab-44b6c15cc0d2"],
Cell[842480, 21803, 569, 12, 1553, "Message", "ExpressionUUID" -> \
"bbb76652-fe89-4269-a5f5-78cd831b77f3"],
Cell[843052, 21817, 651, 14, 1553, "Message", "ExpressionUUID" -> \
"29315f4f-44ca-4a04-b463-5a00496b6fb4"],
Cell[843706, 21833, 1160, 31, 1553, "Output", "ExpressionUUID" -> \
"bcb6d530-8d02-4276-b2d8-c212e9e4e3d7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[844903, 21869, 1599, 39, 1438, "Input", "ExpressionUUID" -> \
"665210f3-d294-46f3-98c4-1ebdc40e7123"],
Cell[846505, 21910, 1782, 37, 1553, "Output", "ExpressionUUID" -> \
"405b4fea-c5d3-497d-bc2e-b764f337b545"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[848348, 21954, 242, 4, 54, "Subsection", "ExpressionUUID" -> \
"9e7b65a5-8602-4342-93d1-542154e0af70"],
Cell[CellGroupData[{
Cell[848615, 21962, 281, 5, 44, "Subsubsection", "ExpressionUUID" -> \
"20077d3f-fe20-49d1-8dcc-989012951d6a"],
Cell[848899, 21969, 761, 14, 2562, "Input", "ExpressionUUID" -> \
"5a5d5eed-2b87-41c7-b750-b338634db276",
 InitializationCell->True],
Cell[849663, 21985, 2765, 67, 3721, "Input", "ExpressionUUID" -> \
"7335d1b1-cc7b-43c7-afda-821df754cd4e",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[852477, 22058, 220, 4, 54, "Subsection", "ExpressionUUID" -> \
"09eda746-da76-4d4b-bcb0-7327208483fa"],
Cell[CellGroupData[{
Cell[852722, 22066, 163, 3, 44, "Subsubsection", "ExpressionUUID" -> \
"ef6e0631-8544-4161-a50f-5629c920191a"],
Cell[852888, 22071, 635, 15, 268, "Input", "ExpressionUUID" -> \
"fc57d353-3038-464a-8680-47897927d254",
 InitializationCell->True],
Cell[853526, 22088, 1424, 38, 197, "Input", "ExpressionUUID" -> \
"2273d568-105c-4e69-8df1-fac099044539",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[854999, 22132, 340, 5, 54, "Subsection", "ExpressionUUID" -> \
"00e19ed4-004a-4d2f-bb83-43f04e8a4fc8"],
Cell[CellGroupData[{
Cell[855364, 22141, 290, 5, 44, "Subsubsection", "ExpressionUUID" -> \
"1ed74e00-af53-4cdb-a36f-794fdb7a1866"],
Cell[855657, 22148, 865, 16, 1438, "Input", "ExpressionUUID" -> \
"2d10d401-ed95-40c2-a364-b3ddf1088e16",
 InitializationCell->True],
Cell[856525, 22166, 2683, 56, 835, "Input", "ExpressionUUID" -> \
"0236bc3f-8887-4868-b0b2-51064b7cc403",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[859245, 22227, 316, 5, 35, "Subsubsection", "ExpressionUUID" -> \
"572c8e32-9a49-4a2c-88a9-1e4d5323c740"],
Cell[859564, 22234, 792, 16, 1391, "Text", "ExpressionUUID" -> \
"65ba1246-b206-4a2e-abbc-9720e97f206c"],
Cell[860359, 22252, 902, 16, 2562, "Input", "ExpressionUUID" -> \
"f608abe0-c916-4a14-a486-90f1cf2025ca",
 InitializationCell->True],
Cell[861264, 22270, 2867, 64, 2562, "Input", "ExpressionUUID" -> \
"8d776ae1-f491-42a7-b7cd-459b3411c58a",
 InitializationCell->True],
Cell[864134, 22336, 1466, 27, 835, "Input", "ExpressionUUID" -> \
"c69edca0-e8dc-45fb-b68d-0324d613e31a",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[865637, 22368, 334, 5, 35, "Subsubsection", "ExpressionUUID" -> \
"f2a18b7b-a6c9-445a-ba2b-088d76724a3d"],
Cell[865974, 22375, 660, 12, 835, "Text", "ExpressionUUID" -> \
"083ad4c7-9428-48ea-ae96-9901c7e0dece"],
Cell[866637, 22389, 966, 17, 2562, "Input", "ExpressionUUID" -> \
"0524f46b-e839-4b24-a537-2a7fc7fc3ec6",
 InitializationCell->True],
Cell[867606, 22408, 3705, 96, 2562, "Input", "ExpressionUUID" -> \
"6aa4d4c1-df44-47a8-a8f9-201dddf416f5",
 InitializationCell->True]
}, Closed]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

